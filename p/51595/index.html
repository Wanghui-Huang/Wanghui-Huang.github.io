<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start --><link href="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.2/css/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•° | royhuang's blog</title><meta name="author" content="Wanghui Huang"><meta name="copyright" content="Wanghui Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ğŸŒŸã€ŠC++ä»é›¶å¼€å§‹ã€‹ ç³»åˆ—ï¼Œå¼€å§‹æ›´æ–°ä¸­â€¦  C++ä»é›¶å¼€å§‹https:&#x2F;&#x2F;hwh.zone&#x2F;p&#x2F;62712 ä¸‰ã€å‡½æ•° 3.1 åŸºæœ¬æ¦‚å¿µ  æ€ä¹ˆå®šä¹‰å‡½æ•°ï¼Ÿ  ä»¥å‰ï¼Œæˆ‘æ¯”è¾ƒå€¾å‘å°†å‡½æ•°å®šä¹‰ä¸ºé¡ºåºæ‰§è¡Œçš„è¯­å¥é›†åˆã€‚ç°åœ¨æˆ‘è®¤ä¸ºæ›´æ°å½“çš„è¯´æ³•åº”è¯¥æ˜¯ï¼šå‡½æ•°æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„è¯­å¥åºåˆ—ï¼Œæ—¨åœ¨å®Œæˆç‰¹å®šçš„å·¥ä½œã€‚ C++ ä¸­å‡½æ•°ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š 1234return_type function_name( parameter_">
<meta property="og:type" content="article">
<meta property="og:title" content="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°">
<meta property="og:url" content="https://hwh.zone/p/51595/index.html">
<meta property="og:site_name" content="royhuang&#39;s blog">
<meta property="og:description" content="ğŸŒŸã€ŠC++ä»é›¶å¼€å§‹ã€‹ ç³»åˆ—ï¼Œå¼€å§‹æ›´æ–°ä¸­â€¦  C++ä»é›¶å¼€å§‹https:&#x2F;&#x2F;hwh.zone&#x2F;p&#x2F;62712 ä¸‰ã€å‡½æ•° 3.1 åŸºæœ¬æ¦‚å¿µ  æ€ä¹ˆå®šä¹‰å‡½æ•°ï¼Ÿ  ä»¥å‰ï¼Œæˆ‘æ¯”è¾ƒå€¾å‘å°†å‡½æ•°å®šä¹‰ä¸ºé¡ºåºæ‰§è¡Œçš„è¯­å¥é›†åˆã€‚ç°åœ¨æˆ‘è®¤ä¸ºæ›´æ°å½“çš„è¯´æ³•åº”è¯¥æ˜¯ï¼šå‡½æ•°æ˜¯ä¸€ä¸ªå¯é‡ç”¨çš„è¯­å¥åºåˆ—ï¼Œæ—¨åœ¨å®Œæˆç‰¹å®šçš„å·¥ä½œã€‚ C++ ä¸­å‡½æ•°ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š 1234return_type function_name( parameter_">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg">
<meta property="article:published_time" content="2021-12-09T05:31:37.851Z">
<meta property="article:modified_time" content="2022-01-29T10:15:44.898Z">
<meta property="article:author" content="Wanghui Huang">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="æ•™ç¨‹">
<meta property="article:tag" content="C++åŸºç¡€">
<meta property="article:tag" content="å‡½æ•°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg"><link rel="shortcut icon" href="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat-modified.png"><link rel="canonical" href="https://hwh.zone/p/51595/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"XVCM04DNZ4","apiKey":"137b0bbc59574cb11c2e8fed36fb30fb","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"æœç´¢æ–‡ç« ","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":"true# copy button","highlightLang":false,"highlightHeightLimit":400},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":80,"languages":{"author":"ä½œè€…: Wanghui Huang","link":"é“¾æ¥: ","source":"æ¥æº: royhuang's blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-01-29 18:15:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="google-site-verification" content="uO6C17u7YuZfMWvThEQ9nOGQS4GIN2zAM6hC4tH-RiM" /><meta name="baidu-site-verification" content="code-nRnoDyQJPT" /><script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?13a4aefcbad9616a1f5859538d0d882e"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">36</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa-fw fa-fw fas fa-comment-dots"></i><span> è¯´è¯´</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ç›®å½•</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">royhuang's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa-fw fa-fw fas fa-comment-dots"></i><span> è¯´è¯´</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ç›®å½•</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-12-09T05:31:37.851Z" title="å‘è¡¨äº 2021-12-09 13:31:37">2021-12-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-01-29T10:15:44.898Z" title="æ›´æ–°äº 2022-01-29 18:15:44">2022-01-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C++</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/">ä»é›¶å¼€å§‹</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E5%9F%BA%E7%A1%80/">C++åŸºç¡€</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">27.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>102åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="twikoo_visitors"></span></span></div></div></div><article class="post-content" id="article-container"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><blockquote>
<p>ğŸŒŸ<a href="https://hwh.zone/p/62712/">ã€ŠC++ä»é›¶å¼€å§‹ã€‹</a> ç³»åˆ—ï¼Œå¼€å§‹æ›´æ–°ä¸­â€¦</p>
</blockquote>
<div class="tag link"><a class="link-card" title="C++ä»é›¶å¼€å§‹" href="https://hwh.zone/p/62712"><div class="left"><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat-modified.png"/></div><div class="right"><p class="text">C++ä»é›¶å¼€å§‹</p><p class="url">https://hwh.zone/p/62712</p></div></a></div>
<h2 id="ä¸‰ã€å‡½æ•°">ä¸‰ã€å‡½æ•°</h2>
<h3 id="3-1-åŸºæœ¬æ¦‚å¿µ">3.1 åŸºæœ¬æ¦‚å¿µ</h3>
<blockquote>
<p>æ€ä¹ˆå®šä¹‰å‡½æ•°ï¼Ÿ</p>
</blockquote>
<p>ä»¥å‰ï¼Œæˆ‘æ¯”è¾ƒå€¾å‘å°†å‡½æ•°å®šä¹‰ä¸º<strong>é¡ºåºæ‰§è¡Œçš„è¯­å¥é›†åˆ</strong>ã€‚ç°åœ¨æˆ‘è®¤ä¸ºæ›´æ°å½“çš„è¯´æ³•åº”è¯¥æ˜¯ï¼š<strong>å‡½æ•°æ˜¯ä¸€ä¸ª<u>å¯é‡ç”¨</u>çš„è¯­å¥åºåˆ—ï¼Œæ—¨åœ¨å®Œæˆç‰¹å®šçš„å·¥ä½œ</strong>ã€‚<br>
C++ ä¸­å‡½æ•°ä¸€èˆ¬å½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">( parameter_list )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// body of the function</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢åŒ…å«ä¸€ä¸ªå‡½æ•°çš„æ‰€æœ‰ç»„æˆéƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>è¿”å›ç±»å‹(return_type)</strong>ï¼šä¸€ä¸ªå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ï¼Œ<strong>return_type</strong> æ˜¯å‡½æ•°è¿”å›çš„å€¼çš„æ•°æ®ç±»å‹ã€‚ä¸éœ€è¦è¿”å›å€¼ï¼Œreturn_type æ˜¯å…³é”®å­— <strong>void</strong>ã€‚</li>
<li><strong>å‡½æ•°åç§°(function_name)</strong>ï¼šå‡½æ•°çš„å®é™…åç§°ï¼Œ<strong>å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ä¸€èµ·æ„æˆäº†å‡½æ•°ç­¾å</strong>ã€‚
<ul>
<li>æ‰€è°“â€ç­¾åâ€œåˆ™æ„å‘³ç€è¿™å¯ä»¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå‡½æ•°ã€‚</li>
</ul>
</li>
<li><strong>å‚æ•°åˆ—è¡¨(parameter_list)</strong>ï¼šå‚æ•°å°±åƒæ˜¯å ä½ç¬¦ã€‚å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå¯å‘å‚æ•°ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼è¢«ç§°ä¸ºå®é™…å‚æ•°ï¼Œå‚æ•°åˆ—è¡¨åŒ…æ‹¬å‡½æ•°å‚æ•°çš„<strong>ç±»å‹ã€é¡ºåºã€æ•°é‡</strong>ã€‚
<ul>
<li>å‚æ•°åˆ—è¡¨çš„é¡ºåºã€ç±»å‹ã€æ•°é‡ä¸å®Œå…¨ä¸€è‡´çš„è¯ï¼Œå½¢æˆä¸åŒå‡½æ•°ç­¾åï¼Œå³æ˜¯ä¸åŒå‡½æ•°ã€‚</li>
</ul>
</li>
<li><strong>å‡½æ•°ä¸»ä½“(boby)</strong>ï¼šå‡½æ•°ä¸»ä½“åŒ…å«ä¸€ç»„å®šä¹‰å‡½æ•°æ‰§è¡Œä»»åŠ¡çš„è¯­å¥ã€‚</li>
</ul>
<p>ç‰¹åˆ«çš„ï¼ŒC++æ˜¯ä¸æ”¯æŒåµŒå¥—å‡½æ•°çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç¼–è¯‘å‡ºé”™</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">max1</span><span class="params">(<span class="keyword">int</span> num1=<span class="number">0</span>, <span class="keyword">int</span> num2)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> num1&gt;num2?num1:num2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-1-1-å‰å‘å£°æ˜ğŸŒŸ">3.1.1 å‰å‘å£°æ˜ğŸŒŸ</h4>
<h5 id="å‰å‘å£°æ˜åˆè¯†">å‰å‘å£°æ˜åˆè¯†</h5>
<p>åœ¨å¾ˆå¤šIDEä¸­ï¼Œå¦‚æœä½ å°è¯•åœ¨mainå‡½æ•°ä½¿ç”¨æœªåœ¨ä¹‹å‰å®šä¹‰çš„å‡½æ•°ï¼Œä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main</span><br><span class="line">&#123;</span><br><span class="line">   <span class="built_in">max</span>(<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¿”å›ä¸¤ä¸ªæ•°ä¸­è¾ƒå¤§çš„é‚£ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> num1&gt;num2?num1:num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸º<strong>maxå‡½æ•°å®šä¹‰åœ¨mainå‡½æ•°ä¹‹åï¼Œé¡ºåºç¼–è¯‘åˆ°ä»£ç ç¬¬6è¡Œmax(1,2)æ—¶æ‰¾ä¸åˆ°maxçš„å®šä¹‰</strong>ï¼Œæ‰€ä»¥mainä¸çŸ¥é“maxæ˜¯ä»€ä¹ˆï¼ˆæ˜¯çš„æ€ä¹ˆè¿™ä¹ˆç¬¨ï¼Ÿï¼‰ã€‚</p>
<p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ï¼š</p>
<ul>
<li>
<p><strong>å°†maxå‡½æ•°æ•´ä½“å®šä¹‰åœ¨mainå‡½æ•°å‰</strong>ï¼›</p>
</li>
<li>
<p><strong>å‰å‘å£°æ˜</strong>ã€‚</p>
<p>å‰å‘å£°æ˜å‘Šè¯‰ç¼–è¯‘å™¨æ ‡è¯†ç¬¦åœ¨å®é™…å®šä¹‰ä¹‹å‰å°±å·²ç»å­˜åœ¨ï¼Œè¿™æ ·ç¼–è¯‘å™¨ä¼š<u>åœ¨é“¾æ¥æ—¶è¿›è¡Œç¬¦å·é“¾æ¥å¯»æ‰¾æ ‡è¯†ç¬¦çš„å®šä¹‰</u>ã€‚</p>
<blockquote>
<p>æ„Ÿè§‰å’Œexternå…³é”®å­—å¾ˆåƒï¼Ÿè¯·è§ä¸‹èŠ‚å¯¹æ¯”ã€‚</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>; <span class="comment">// å‰å‘å£°æ˜</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">max</span>(<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// ç¼–è¯‘æ­£ç¡®</span></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è¿”å›ä¸¤ä¸ªæ•°ä¸­è¾ƒå¤§çš„é‚£ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> num1&gt;num2?num1:num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœmaxå®šä¹‰åœ¨å…¶å®ƒæ–‡ä»¶ï¼ˆmax.cppï¼‰ä¸­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*max.cpp*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> num1&gt;num2?num1:num2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ åœ¨mainä¸­ï¼ˆå®šä¹‰åœ¨main.cppï¼‰ä¸­ï¼Œå¯ä»¥ä¸é€šè¿‡include â€œmain.cppâ€è€Œä½¿ç”¨å‰ç½®å£°æ˜ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*main.cpp*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span> </span>; <span class="comment">// å‰å‘å£°æ˜,ä¼šåœ¨é“¾æ¥çš„æ—¶å€™å¯»æ‰¾maxçš„å®šä¹‰ï¼Œç¼–è¯‘å™¨æ—¶ä¸æŠ¥é”™</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">max</span>(<span class="number">1</span>,<span class="number">2</span>); <span class="comment">// ç¼–è¯‘æ­£ç¡®</span></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘ï¼ˆä¸€åˆ‡æ­£å¸¸ï¼‰ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ main.cpp max.cpp -o main.out</span><br><span class="line">./main.out</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>ä½†ç»è¿‡æˆ‘çš„å®è·µï¼Œåœ¨å¾ˆå¤šç¼–è¯‘å™¨ä¸­è¿›è¡Œäº†ä¼˜åŒ–ã€‚<strong>åŒä¸€ä¸ªæ–‡ä»¶çš„å‡½æ•°</strong>å³ä½¿ä¸è¿›è¡Œå‰å‘å£°æ˜ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>
<p>è€Œä¸”ï¼Œåœ¨<a target="_blank" rel="noopener" href="https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/headers/?highlight=%E5%89%8D%E5%90%91%E5%A3%B0%E6%98%8E#forward-declarations">Google code style</a> ä¹Ÿæ˜ç¡®æŒ‡å‡ºå°½é‡ä¸è¦ä½¿ç”¨å‰ç½®å£°æ˜ï¼š</p>
<blockquote>
<p>å°½å¯èƒ½åœ°é¿å…ä½¿ç”¨å‰ç½®å£°æ˜ã€‚ä½¿ç”¨ <code>#include</code> åŒ…å«éœ€è¦çš„å¤´æ–‡ä»¶å³å¯ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220116163129065.png" alt="image-20220116163129065"></p>
</blockquote>
<p><strong>é‚£ä¹ˆï¼Œå‰å‘å£°æ˜è¿˜å­˜åœ¨çš„æ„ä¹‰æ˜¯ä»€ä¹ˆ</strong>ï¼Ÿ</p>
<ol>
<li>å‡å°‘ç¼–è¯‘æ—¶é—´ã€‚ä½¿ç”¨includeä¹Ÿå¯ä»¥ä½¿ç”¨åˆ«çš„çš„æ–‡ä»¶ä¸­å®šä¹‰çš„å˜é‡ï¼Œä½†æ˜¯ä¹Ÿä¼šæŠŠå¤´æ–‡ä»¶å…¶å®ƒä¸éœ€è¦çš„å˜é‡å¼•å…¥ã€‚å¦‚æœåªæ˜¯éœ€è¦ä½¿ç”¨å¾ˆå°‘çš„å¤–éƒ¨å˜é‡ï¼Œä½¿ç”¨å‰å‘å£°æ˜èƒ½å‡å°‘ç¼–è¯‘çš„å¤´æ–‡ä»¶å±•å¼€ã€‚</li>
<li>æ‰“ç ´å¾ªç¯å¼•ç”¨ã€‚</li>
</ol>
<h5 id="å¾ªç¯å¼•ç”¨">å¾ªç¯å¼•ç”¨</h5>
<p>å‰ç½®å£°æ˜ç°åœ¨<strong>ç”¨æ¥è§£å†³å¤šæ–‡ä»¶ä¸­å¾ªç¯å¼•ç”¨çš„é—®é¢˜</strong>ã€‚</p>
<p>ä»¥ç±»å¾ªç¯å¼•ç”¨ä¸ºä¾‹ã€‚</p>
<p><strong>æƒ³è±¡è¿™ä¹ˆä¸€ä¸ªæƒ…å†µï¼šA.hå®šä¹‰äº†Class Aï¼Œå®ƒéœ€è¦å¼•ç”¨B.hå®šä¹‰çš„Class Bï¼Œä¹Ÿå°±æ˜¯è¦å†™å…¥#include â€œB.hâ€ ï¼›ç±»ä¼¼çš„æƒ…å†µï¼ŒB.hä¹Ÿéœ€è¦å†™å…¥#include â€œA.hâ€</strong>ã€‚</p>
<p>è¿™å°±é€ æˆäº†ä¸¤ä¸ªç±»äº’ç›¸å¼•ç”¨ï¼Œä½†ç”±äºC++è›‹ç–¼é¡ºåºç¼–è¯‘çš„è§„åˆ™ã€‚å¦‚æœæ˜¯å…ˆç¼–è¯‘A.hï¼Œå¼•ç”¨çš„ç±»Båˆ™æ‰¾ä¸åˆ°å®ç°çš„å®šä¹‰ï¼›å¦‚æœæ˜¯å…ˆç¼–è¯‘B.hï¼Œåˆ™æ‰¾ä¸åˆ°ç±»Açš„å®šä¹‰ã€‚å½¢æˆâ€œå…ˆæœ‰é¸¡è¿˜æœ‰å…ˆæœ‰è›‹â€çš„ä¸–çºªéš¾é¢˜ã€‚</p>
<p>æˆ‘ä»¬ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* A.h */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> A_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;B.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      B *b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* B.h */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> B_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;A.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      A *a;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*test.cpp*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;A.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;B.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   A a;</span><br><span class="line">   B b;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°è¯•ç¼–è¯‘ä¸€ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++  test.cpp -o test.out</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºåœ¨<code>B.h</code>ä¸­æ‰¾ä¸åˆ°<code>A</code>çš„å®šä¹‰ï¼š<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211227163519959.png" alt="image-20211227163519959"></p>
<p><strong>ç°åœ¨æˆ‘ä»¬ä»åº•å±‚ç¼–è¯‘è¿‡ç¨‹æ¢è®¨ä¸‹è¿™ä¸ªå¾ªç¯å¼•ç”¨å‡ºç°çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆ</strong>ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ç¼–è¯‘å››å¤§æµç¨‹ä¸ºï¼šé¢„ç¼–è¯‘â†’ç¼–è¯‘â†’æ±‡ç¼–â†’é“¾æ¥ï¼Œå…ˆçœ‹çœ‹é¢„ç¼–è¯‘æºæ–‡ä»¶test.cppäº§ç”Ÿçš„test.iã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -E  test.cpp  -o test.i</span><br></pre></td></tr></table></figure>
<p>é¢„ç¼–è¯‘åå†…å®¹å¦‚ä¸‹ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211227171957061.png" alt="image-20211227171957061"></p>
<p>ä¸‹é¢æ˜¯<code>test.i</code>ä¸­å…·ä½“å†…å®¹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      A *a;  <span class="comment">// å‰é¢æ²¡æœ‰Açš„å®šä¹‰</span></span><br><span class="line">&#125;;</span><br><span class="line"># <span class="number">4</span> <span class="string">&quot;A.h&quot;</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      B *b;</span><br><span class="line">&#125;;</span><br><span class="line"># <span class="number">10</span> <span class="string">&quot;test.cpp&quot;</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   A a;</span><br><span class="line">   B b;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œtest.iä¸­<strong>ç¬¬6è¡Œä»£ç <code>A* a</code>ï¼Œåœ¨ç±»Bä¸­å¼•ç”¨äº†<code>A</code> ï¼Œä½†æ˜¯å‰é¢æ²¡æœ‰å…³äº<code>A</code> çš„å®šä¹‰</strong>ã€‚è¿™ä¸ºåé¢ç¼–è¯‘å‡ºé”™åŸ‹ä¸‹äº†ä¼ç¬”ã€‚</p>
<p>é¢„ç¼–è¯‘åå®Œæˆåï¼Œæˆ‘ä»¬è¿›è¡Œç¬¬2ä¸ªé˜¶æ®µï¼šç¼–è¯‘ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -S test.cpp -o  test.s</span><br></pre></td></tr></table></figure>
<p>Errorï¼å‡ºç°äº†æœ€å¼€å§‹çš„â€œæœªå®šä¹‰â€é”™è¯¯ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211227210145942.png" alt="image-20211227210145942"></p>
<p>ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªé”™è¯¯åœ¨ç¼–è¯‘é˜¶æ®µå°±äº§ç”Ÿäº†ï¼šå½“C++<strong>æŒ‰é¡ºåºç¼–è¯‘</strong>åˆ° <code>A *a</code> è¿™è¡Œæ—¶ï¼Œç¼–è¯‘å™¨è¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œå‘ç°<strong>åœ¨å‰é¢æ‰¾ä¸åˆ°<code>A</code>ç›¸å…³çš„å®šä¹‰</strong>ï¼Œäºæ˜¯æŠ¥é”™ã€‚</p>
<p><strong>æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜</strong>ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨<code>B.h</code> ä¸­è¿›è¡Œå‰å‘å£°æ˜ï¼Œè§£å†³è¿™ä¸ªé”™è¯¯ã€‚</p>
<ul>
<li><strong>ç±»ä¼¼äºå…¨å±€å˜é‡ï¼Œè¿™æ ·<code>A</code>ä½œç”¨èŒƒå›´å°±åˆ°æœ¬æ–‡ä»¶ç»“å°¾ï¼šå³ç¼–è¯‘å™¨è¿˜ä¼šåœ¨<code>test.i</code> ä¸­å…¶å®ƒä½ç½®å¯»æ‰¾<code>A</code>çš„å®šä¹‰</strong>ï¼›</li>
<li><strong>ä¸ä»…å¦‚æ­¤ï¼Œå³ä½¿<code>test.i</code>ä¸­ä¸å­˜åœ¨ï¼Œç¼–è¯‘å™¨è¿˜ä¼šåœ¨é“¾æ¥æ—¶ç¬¦å·è§£ææ—¶å¯»æ‰¾Açš„å®šä¹‰ï¼Œè€Œä¸æ˜¯åœ¨ç¼–è¯‘æ—¶å°±æŠ¥é”™</strong>ã€‚</li>
</ul>
<p>è¿™æ ·ç¼–è¯‘å™¨å°±ä¸ä¼šåœ¨ç¼–è¯‘é˜¶æ®µæŠ¥é”™äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> B_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> B_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;A.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>;</span>  <span class="comment">// å‰å‘å£°æ˜ï¼Œ</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   <span class="keyword">private</span>:</span><br><span class="line">      A *a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>æ–°çš„é¢„ç¼–è¯‘æ–‡ä»¶<code>test.i</code>æ–‡ä»¶ä¹Ÿåœ¨ç›¸åº”ä½ç½®å¤šäº†ä¸€è¡Œ<code>Class A;</code>ï¼ˆå…¶ä½™æ— å˜åŒ–ï¼‰:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p><strong>å¦‚æœä¸ä½¿ç”¨#ifndef ã€#define å’Œ#endif</strong>ï¼Ÿ</p>
<p>#ifndef ã€#define å’Œ#endifï¼Œå³æ¡ä»¶ç¼–è¯‘ï¼šåªæœ‰æ»¡è¶³è¦æ±‚ä»£ç æ‰å‚ä¸ç¼–è¯‘ï¼Œå¦åˆ™ä¸å‚ä¸ç¼–è¯‘ã€‚åŸºæœ¬ç”¨æ³•ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> æ ‡è¯†ç¬¦  </span></span><br><span class="line">ç¨‹åºæ®µ<span class="number">1</span>  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span>  </span></span><br><span class="line">ç¨‹åºæ®µ<span class="number">2</span>  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œå¯¹B.hå’ŒA.héƒ½ä½¿ç”¨äº†æ¡ä»¶ç¼–è¯‘ï¼š<strong>é˜²æ­¢å¤´æ–‡ä»¶è¢«é‡å¤å®šä¹‰ï¼Œåœ¨é“¾æ¥æ—¶å‡ºç°å¤§é‡é‡å®šä¹‰é”™è¯¯</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> A_H <span class="comment">// æˆ–B_H</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> A_H <span class="comment">// æˆ–B_H</span></span></span><br><span class="line"><span class="comment">// A_Hæˆ–B_Hä¸­çš„ä»£ç  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>ä»¥<code>A.h</code>ä¸ºä¾‹ï¼š</p>
<ol>
<li>å¦‚æœ<code>A.h</code>è¢«<u>ç¬¬ä¸€ä¸ªæ–‡ä»¶</u>å¼•å…¥æ—¶ï¼Œä¼šå®šä¹‰æ ‡è¯†ç¬¦<code>A_H</code> ï¼Œè¿™ä¸ªæ—¶å€™<code>A.h</code>å…¶åçš„ä»£ç ä¼šè¢«é¢„ç¼–è¯‘æ’å…¥åˆ°æ–‡ä»¶ä¸­ï¼›</li>
<li>å¦‚æœ<u>å…¶å®ƒæ–‡ä»¶</u>å­˜åœ¨ä»£ç <code>#include â€œA.hâ€</code> ï¼Œå°è¯•é¢„ç¼–è¯‘æ›¿æ¢ä¸º<code>A.h</code>ä¸­å†…å®¹ï¼›</li>
<li>å› ä¸º<code>A_H</code> å·²è¢«å®šä¹‰ï¼Œç›´æ¥è·³è½¬åˆ°<code>#endif</code>ç»“æŸï¼Œ<strong>é¿å…äº†å¤´æ–‡ä»¶é‡å¤å¼•å…¥</strong>ã€‚</li>
</ol>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œå¦‚æœå¯¹B.hå’ŒA.héƒ½<u>ä¸ä½¿ç”¨</u>æ¡ä»¶ç¼–è¯‘ï¼Œ<strong>é¢„ç¼–è¯‘æ—¶ä¸ä½†ä¼šå‡ºç°é‡å®šä¹‰é”™è¯¯è¿˜ä¼šå‡ºç°æ— é™åµŒå¥—</strong>ï¼š</p>
<ol>
<li>main.cppä¸­ï¼š#include â€œA.hâ€ è¢«æ›¿æ¢ä¸ºA.hä¸­å…·ä½“å†…å®¹ï¼›</li>
<li>A.hä¸­ï¼š ç”±äºåœ¨å¤´æ–‡ä»¶å¼•å…¥äº† #include â€œB.hâ€ ï¼Œæ‰€ä»¥ #include â€œB.hâ€ä¹Ÿä¼šè¢«æ›¿æ¢ä¸ºB.hä¸­å…·ä½“å†…å®¹ï¼›</li>
<li>B.hä¸­ï¼š é‡å¤å¼•å…¥äº† #include â€œA.hâ€ï¼Œé‡å¤æ›¿æ¢å¤´æ–‡ä»¶A.hï¼Œè·³è½¬åˆ°æ­¥éª¤2å‘ç”Ÿæ— é™åµŒå¥—ã€‚</li>
</ol>
<h5 id="externå’Œå‰å‘å£°æ˜">externå’Œå‰å‘å£°æ˜</h5>
<p>externå’Œå‰å‘å£°æ˜ä½œç”¨éå¸¸ç›¸ä¼¼ï¼š<strong>éƒ½å¯ä»¥ç”¨æ¥å£°æ˜<u>å‡½æ•°/ç»“æ„ä½“/ç±»</u>ç­‰æ˜¯åœ¨å¤–éƒ¨å®šä¹‰çš„ï¼Œè¿™æ ·åœ¨ç¼–è¯‘æ—¶ä¸å‡ºé”™ï¼Œåœ¨é“¾æ¥æ—¶ä¼šåœ¨å…¶å®ƒ<code>.o</code>å¯»æ‰¾ç›¸å…³å®šä¹‰</strong>ã€‚</p>
<p>ä½†æ˜¯externå…³é”®å­—å’Œå‰å‘å£°æ˜ä¹Ÿæœ‰äº›ä¸åŒï¼š</p>
<ol>
<li><strong>externå¯ä»¥ä½œç”¨äºå˜é‡</strong>ï¼Œå‰å‘å£°æ˜æ— æ³•å£°æ˜å˜é‡ï¼ˆå˜é‡ä¼šé»˜è®¤åˆå§‹åŒ–ï¼‰ï¼Œåªèƒ½å£°æ˜å‡½æ•°/ç»“æ„ä½“/ç±»ç­‰ï¼›</li>
<li><strong>externè¿˜æœ‰extern â€œCâ€ç›¸å…³ç”¨æ³•</strong>ï¼›</li>
<li><strong>externæ˜¯ä¸€ä¸ªå…³é”®å­—</strong>ï¼Œå‰å‘å£°æ˜æ˜¯ç§å£°æ˜æ–¹å¼ï¼ˆä½¿ç”¨å‰å£°æ˜ï¼‰ã€‚</li>
</ol>
<h5 id="æœ€ä½³å®è·µï¼šextern-å‰å‘å£°æ˜-include">æœ€ä½³å®è·µï¼šextern/å‰å‘å£°æ˜/include</h5>
<ul>
<li>
<p><strong>å¦‚æœåªæ˜¯<u>å°‘é‡</u>åœ°è¦ä½¿ç”¨åˆ«çš„æ–‡ä»¶ä¸­å®šä¹‰çš„å˜é‡/å‡½æ•°/ç»“æ„ä½“/ç±»ç­‰</strong>ï¼šè¯·ä½¿ç”¨externå…³é”®å­—ï¼Œå®ƒå¯ä»¥å‡å°‘ç¼–è¯‘æ—¶é—´ï¼›</p>
<p>è™½ç„¶å‡½æ•°/ç»“æ„ä½“/ç±»ç­‰ä½¿ç”¨å‰å‘å£°æ˜ä¹Ÿå¯ä»¥ä½†ä¸æ¨èï¼Œä½¿ç”¨externæ›´å¥½ã€‚</p>
</li>
<li>
<p><strong>æ‰“ç ´å¾ªç¯å¼•ç”¨</strong>ã€‚å‰å‘å£°æ˜ã€‚</p>
</li>
<li>
<p><strong>å…¶ä½™æƒ…å†µä½¿ç”¨includeæ›´å¥½</strong>ï¼Œä»£ç é€»è¾‘æ›´æ¸…æ™°ã€‚</p>
</li>
</ul>
<h4 id="3-1-2-æœ€ä½³å®è·µï¼šä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‡½æ•°">3.1.2 æœ€ä½³å®è·µï¼šä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‡½æ•°</h4>
<p>ä½œä¸ºæ›¾ç»ç¨šå«©çš„ï¼ˆç°åœ¨ä¸é‚£ä¹ˆç¨šå«©çš„ï¼‰ç¨‹åºå‘˜ï¼Œä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‡½æ•°æ˜¯ä¸€ä¸ªæŒºçº ç»“çš„é—®é¢˜ã€‚å‚è€ƒ<a href="learncpp.com">learncpp</a> ä¸­å»ºè®®ï¼š</p>
<ul>
<li><strong>å¤šæ¬¡å‡ºç°çš„è¯­å¥åº”è¯¥ç»„æˆä¸€ä¸ªå‡½æ•°</strong>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä»¥ç›¸åŒçš„æ–¹å¼å¤šæ¬¡è¯»å–ç”¨æˆ·çš„è¾“å…¥ï¼Œé‚£ä¹ˆè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡½æ•°å€™é€‰ã€‚</li>
<li><strong>å…·æœ‰æ˜ç¡®å®šä¹‰çš„è¾“å…¥å’Œè¾“å‡ºç›®æ ‡çš„ä»£ç </strong>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè¦æ’åºçš„é¡¹ç›®åˆ—è¡¨ï¼Œé‚£ä¹ˆè¿›è¡Œæ’åºçš„ä»£ç å°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½ï¼Œ<u>å³ä½¿å®ƒåªå®Œæˆäº†ä¸€æ¬¡</u>ã€‚è¾“å…¥æ˜¯æœªæ’åºçš„åˆ—è¡¨ï¼Œè¾“å‡ºæ˜¯æ’åºçš„åˆ—è¡¨ã€‚</li>
<li><strong>ä¸€ä¸ªå‡½æ•°åº”è¯¥æ‰§è¡Œæœ‰ä¸”åªæœ‰ä¸€é¡¹ä»»åŠ¡</strong>ã€‚</li>
<li><strong>å½“ä¸€ä¸ªå‡½æ•°å˜å¾—å¤ªé•¿ã€å¤ªå¤æ‚æˆ–éš¾ä»¥ç†è§£æ—¶</strong>ã€‚å¯ä»¥å°†å…¶æ‹†åˆ†ä¸ºå¤šä¸ªå­å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é‡æ„ã€‚</li>
</ul>
<h3 id="3-2-å‡½æ•°é‡è½½">3.2 å‡½æ•°é‡è½½</h3>
<p>åœ¨å‰é¢æˆ‘ä»¬æåˆ°ï¼šå‡½æ•°é€šè¿‡å‡½æ•°ç­¾åæ¥å”¯ä¸€ç¡®å®šä¸€ä¸ªå‡½æ•°ï¼Œè€Œå‡½æ•°ç­¾åç”± <u>å‡½æ•°å&amp;å‚æ•°åˆ—è¡¨</u> ç»„æˆã€‚</p>
<p>æ¯”å¦‚ï¼Œ<strong>ä¸¤ä¸ªå‡½æ•°å‡½æ•°åç›¸åŒè€Œå‚æ•°åˆ—è¡¨ä¸åŒï¼Œè¿™ä¸ªæ—¶å€™æ˜¯åŒä¸€å‡½æ•°å—</strong>ï¼Ÿ</p>
<p>æ˜¾ç„¶ä¸æ˜¯ï¼Œå› ä¸ºå‡½æ•°ç­¾åä¸­çš„å‚æ•°åˆ—è¡¨ä¸åŒï¼Œå› æ­¤æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™ä¹Ÿå°±æ˜¯<strong>å‡½æ•°é‡è½½</strong>ã€‚</p>
<h4 id="3-2-1-ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°é‡è½½ï¼Ÿ">3.2.1 ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°é‡è½½ï¼Ÿ</h4>
<p>é‡è½½å‡½æ•°é€šå¸¸ç”¨æ¥å‘½åä¸€ç»„åŠŸèƒ½ç›¸ä¼¼çš„å‡½æ•°ã€‚è¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ol>
<li>å‡å°‘äº†å‡½æ•°åçš„æ•°é‡ï¼›</li>
<li>é¿å…äº†åå­—ç©ºé—´çš„æ±¡æŸ“ï¼Œå¯¹äºç¨‹åºçš„å¯è¯»æ€§æœ‰å¾ˆå¤§çš„å¥½å¤„ã€‚</li>
</ol>
<p>è¯·çœ‹ä¸‹ä¾‹ã€‚</p>
<p>æˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡½æ•°ï¼šä¸€ä¸ªè¿”å›ä¸¤ä¸ªæ•´æ•°ç›¸åŠ çš„å€¼ï¼Œä¸€ä¸ªè¿”å›ä¸¤ä¸ªæµ®ç‚¹æ•°ç›¸åŠ çš„å€¼ã€‚æˆ‘ä»¬<strong>å®šä¹‰äº†å¤šä¸ªåç§°ä½†æå…¶ç›¸ä¼¼ï¼ˆåŠŸèƒ½ã€åå­—etc.ï¼‰çš„å‡½æ•°</strong>ã€‚å®ƒä»¬æ ¸å¿ƒåŠŸèƒ½è™½ç„¶éƒ½æ˜¯addï¼Œä½†å´å¯¹åº”å¤šä¸ªä¸åŒçš„å‡½æ•°åï¼Œå¢åŠ äº†è®°å¿†è´Ÿæ‹…ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">addInteger</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">addDouble</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¼˜é›…çš„åšæ³•åº”è¯¥æ˜¯ï¼š<strong>æ¯ä¸ªå‡½æ•°åŒåï¼Œç¼–è¯‘å™¨é å‚æ•°<u>ç±»å‹</u>ã€<u>æ•°é‡</u>ã€<u>é¡ºåº</u>æ¥è‡ªåŠ¨åŒ¹é…è°ƒç”¨</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">add</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(<span class="number">1</span>,<span class="number">2</span>);   <span class="comment">// åŒ¹é…ç¬¬ä¸€ä¸ªadd</span></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>); <span class="comment">// åŒ¹é…ç¬¬äºŒä¸ªadd</span></span><br><span class="line">    <span class="built_in">add</span>(<span class="number">3.4</span>,<span class="number">5</span>); <span class="comment">// åŒ¹é…ç¬¬ä¸‰ä¸ªadd</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-2-2-äºŒä¹‰æ€§åŒ¹é…">3.2.2 äºŒä¹‰æ€§åŒ¹é…</h4>
<p>å‰é¢ä»‹ç»çš„éƒ½æ˜¯ä¼ é€’çš„å‚æ•°å’Œå®šä¹‰å‡½æ•°å‚æ•°å®Œå…¨åŒ¹é…çš„ç®€å•æƒ…å†µã€‚ä½†å®é™…ä¸Šï¼Œè¿˜ä¼šå‡ºç°<strong>å‡½æ•°è°ƒç”¨ä¸­çš„å‚æ•°ç±»å‹ä¸ä»»ä½•é‡è½½å‡½æ•°ä¸­çš„å‚æ•°ç±»å‹ä¸å®Œå…¨åŒ¹é…</strong> ã€‚</p>
<p>è¿™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print int : &quot;</span>&lt;&lt; x &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span> d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print double : &quot;</span>&lt;&lt; d &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print int : 97</span><br></pre></td></tr></table></figure>
<p>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ<code>print('a')</code> åŒ¹é…äº† <code>print(int)</code>? <code>97</code>åˆæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºç¼–è¯‘å™¨å¦‚æœæ‰¾ä¸åˆ°å®Œå…¨åŒ¹é…çš„å‡½æ•°ï¼Œ<strong>ä¼šè‡ªåŠ¨è¿›è¡Œéšå¼è½¬æ¢å°†æŸäº›çª„æ•´æ•°å’Œæµ®ç‚¹ç±»å‹è‡ªåŠ¨æå‡ä¸ºæ›´å®½ç±»å‹</strong>ã€‚æ‰€æœ‰è¿™é‡Œçš„<code>char('a')</code> è‡ªåŠ¨æå‡ä¸º<code>int</code> ï¼ŒåŒ¹é…åˆ°äº†<code>print(int)</code> , <code>97</code>æ˜¯<code>a</code> çš„ASCIIç¼–ç ã€‚</p>
<p>ç‰¹åˆ«çš„ï¼Œç”±äºåŒ¹é…åˆ°äº†<code>print(int)</code> ï¼Œä¾¿ä¸ä¼šè‡ªåŠ¨ç»§ç»­æå‡ç±»å‹å»åŒ¹é…<code>print(double)</code>ã€‚</p>
<p>å…³äº<u>ç±»å‹è½¬æ¢</u> ä¼šåœ¨ç¬¬åç« ç»Ÿä¸€æ€»ç»“ï¼Œè¿™é‡Œå…ˆç®€å•äº†è§£ä¸‹å³å¯ã€‚</p>
<blockquote>
<p>ç‰¹åˆ«çš„ï¼Œ<strong>å¦‚æœä¸Šè¿°è¿‡ç¨‹ï¼ˆæ•°å­—è½¬æ¢æ‰¾ä¸åˆ°ï¼‰æœªæ‰¾åˆ°åŒ¹é…é¡¹ï¼Œç¼–è¯‘å™¨å°†å°è¯•é€šè¿‡ä»»ä½•ç”¨æˆ·å®šä¹‰çš„è½¬æ¢æ‰¾åˆ°åŒ¹é…é¡¹</strong>ã€‚</p>
</blockquote>
<p>è¿™æ¶‰åŠåˆ°<u>ç±»å‹é‡è½½</u>ï¼Œä¼šåœ¨ä¸‹ç¯‡æ–‡ç« <u>é¢å¯¹å¯¹è±¡</u> è¿›è¡Œè®²è§£ã€‚è¿™é‡Œåªè¦äº†è§£è¿™ä¸ªä¾‹å­å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">0</span>; &#125; <span class="comment">// ç”¨æˆ·è‡ªå®šä¹‰ä»Xè½¬æ¢int</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    X x; </span><br><span class="line">    <span class="built_in">print</span>(x);  <span class="comment">// åŒ¹é…print(int)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™é‡Œä¾‹å­ä¸­ï¼ˆä¹Ÿæ˜¯ä¸€èˆ¬å‡½æ•°å‚æ•°åŒ¹é…æµç¨‹æ€»ç»“ï¼‰ï¼š</p>
<ol>
<li>ç¼–è¯‘å™¨å¯»æ‰¾æ˜¯å¦å­˜åœ¨<code>print(X)</code> ï¼Œä¸å­˜åœ¨è½¬è‡³ç¬¬2æ­¥ï¼›</li>
<li>ç¼–è¯‘å™¨æ£€æŸ¥<code>x</code>æ˜¯å¦å¯ä»¥ç±»å‹æå‡ï¼Œä¸èƒ½è¿›è¡Œç¬¬3æ­¥ï¼›</li>
<li>ç¼–è¯‘å™¨å°†æŸ¥æ‰¾ä»»ä½•ç”¨æˆ·å®šä¹‰çš„è½¬æ¢ï¼Œå­˜åœ¨ï¼Œè¿›è¡Œè½¬æ¢ã€‚</li>
</ol>
<h3 id="3-3-å‡½æ•°æ¨¡æ¿">3.3 å‡½æ•°æ¨¡æ¿</h3>
<p>åœ¨å‰é¢<u>å‡½æ•°é‡è½½</u>ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å°†ä¸¤ä¸ª<u>åŠŸèƒ½ç›¸ä¼¼ä»…å‚æ•°åˆ—è¡¨ä¸åŒ</u>çš„å‡½æ•°ï¼Œ<u>æ”¹ä¸ºåŒåå‡½æ•°</u>è®©ç¼–è¯‘å™¨é€šè¿‡å‡½æ•°ç­¾åæ¥åŒºåˆ†ï¼Œå‡å°‘äº†æ€ç»´è´Ÿæ‹…ã€‚</p>
<p>ä½†æ˜¯è€ƒè™‘ä¸€ç§æ›´ç‰¹æ®Šçš„æƒ…å†µï¼Œ<u>ä¸¤ä¸ªå‡½æ•°ä¸ä»…åŠŸèƒ½æå…¶ç›¸ä¼¼ï¼Œè¿å‚æ•°åˆ—è¡¨çš„ä¸ªæ•°éƒ½ç›¸åŒ</u>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print result : &quot;</span>&lt;&lt; x+y &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print result : &quot;</span>&lt;&lt; x+y &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">print</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">   <span class="built_in">print</span>(<span class="number">3.0</span>,<span class="number">4.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»æ„Ÿè§‰å“ªé‡Œä¸å¯¹ï¼Œä¼¼ä¹é€ æˆäº†å¾ˆå¤šä»£ç é‡å¤ï¼Ÿå®ƒä»¬åªæ˜¯å‚æ•°ç±»å‹ä¸åŒå•Šï¼Œå‡½æ•°ä½“ã€åå­—ä»€ä¹ˆéƒ½ä¸€æ ·ï¼Ÿ</p>
<p>åœ¨C++ä¸­æä¾›äº†å‡½æ•°æ¨¡æ¿ï¼Œç”¨æ¥ä¼˜é›…åœ°åº”å¯¹è¿™ç§æƒ…å†µã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;    <span class="comment">// templateå’Œtypenameæ˜¯å…³é”®å­—ï¼ŒTæ˜¯ç±»å‹å</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print result : &quot;</span>&lt;&lt; x+y &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">print</span>(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">   <span class="built_in">print</span>(<span class="number">3.0</span>,<span class="number">4.0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸é”™ï¼Œä¸€åˆ‡é¡ºçœ¼äº†å¾ˆå¤šã€‚</p>
<h4 id="3-3-1-æ¨¡æ¿å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ">3.3.1 æ¨¡æ¿å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</h4>
<p>åœ¨å‰æ–‡æˆ‘ä»¬ä»‹ç»äº†å‡½æ•°æ¨¡æ¿ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;    </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     cout &lt;&lt; <span class="string">&quot;print result : &quot;</span>&lt;&lt; x+y &lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†å‡½æ•°æ¨¡æ¿å®é™…ä¸Šå¹¶ä¸æ˜¯å‡½æ•°â€”â€”å®ƒä»¬çš„ä»£ç ä¸æ˜¯ç›´æ¥ç¼–è¯‘æˆ–æ‰§è¡Œçš„ã€‚å‡½æ•°æ¨¡æ¿åªæœ‰ä¸€ä¸ªåŠŸèƒ½ï¼š<strong>ä¸ºæ¯ä¸ªå…·æœ‰ä¸€ç»„å”¯ä¸€å‚æ•°ç±»å‹çš„å‡½æ•°ï¼Œè°ƒç”¨åˆ›å»ºï¼ˆå¹¶ç¼–è¯‘ï¼‰ä¸€ä¸ªå‡½æ•°</strong>ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†ä¸€ä¸ªä¸åŒä»¥å¾€çš„æ¨¡æ¿å‡½æ•°è°ƒç”¨æ–¹å¼<code>funName&lt;actual_type&gt;(arg1, arg2)</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;print result : &quot;</span>&lt;&lt; x+y &lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    print&lt;<span class="keyword">int</span>&gt;(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="comment">// print(1,2);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†ç›¸æ¯”<code>funName(arg1, arg2)</code> è¿™ç§æ–¹å¼ï¼Œä¸Šé¢çš„æ‰æ˜¯æ›´æ¥è¿‘æœ¬è´¨çš„è°ƒç”¨æ–¹å¼ã€‚</p>
<p>å› ä¸º<code>print(1,2)</code>ï¼Œæœ¬è´¨å°±æ˜¯ç¼–è¯‘å™¨å…‹éš†äº†å‡½æ•°æ¨¡æ¿<code>void print(T x, T y)</code>ï¼Œå°†æ¨¡æ¿ç±»å‹<code>T</code>æ›¿æ¢ä¸ºæˆ‘ä»¬æŒ‡å®šçš„å®é™…ç±»å‹<code>&lt;int&gt;</code>ï¼Œæœ€ç»ˆç”ŸæˆæŒ‡å®šç±»å‹çš„å‡½æ•°<code>void print&lt;int&gt;(int x, int y)</code> ã€‚</p>
<blockquote>
<p>äº²çœ¼çœ‹ä¸€çœ‹ï¼šå®ä¾‹åŒ–å®Œæˆåç¼–è¯‘çš„å†…å®¹ã€‚</p>
</blockquote>
<p>ç”±äºç›´æ¥ä½¿ç”¨ <code>g++ -S</code> ç”Ÿæˆçš„æ˜¯æ±‡ç¼–ä»£ç ï¼Œä¸å¤ªç›´è§‚ï¼Œæˆ‘ä»¬å€ŸåŠ©https://cppinsights.io/ è§‚å¯Ÿæ¨¡æ¿å®ä¾‹åŒ–åçš„ä»£ç ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print&lt;<span class="keyword">int</span>&gt;(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">print&lt;<span class="keyword">double</span>&gt;(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220111224749061.png" alt="image-20220111224749061"></p>
<p>å®ä¾‹åŒ–åï¼Œç¼–è¯‘å™¨ç¡®å®ç”Ÿæˆäº†ä¸¤ä¸ªå‡½æ•°ï¼š<code>void print&lt;int&gt;(int x, int y)</code>ã€<code>void print&lt;double&gt;(double x, double y)</code>ä¾›æˆ‘ä»¬è°ƒç”¨ã€‚</p>
<p>ä¸Šè¿°<strong>ä»å‡½æ•°æ¨¡æ¿åˆ›å»ºæŒ‡å®šç±»å‹çš„å‡½æ•°çš„è¿‡ç¨‹ï¼Œç§°ä¸ºå‡½æ•°æ¨¡æ¿å®ä¾‹åŒ–</strong>ã€‚å¦‚æœè¿™ä¸ªè¿‡ç¨‹æ˜¯å› ä¸ºå‡½æ•°è°ƒç”¨è€Œäº§ç”Ÿçš„ï¼Œåˆ™ç§°ä¸º<strong>éšå¼å®ä¾‹åŒ–</strong>ã€‚</p>
<ul>
<li>
<p><strong>å®ä¾‹åŒ–å‡½æ•°æ¯æ¬¡è°ƒç”¨éƒ½ä¼šå‘ç”Ÿå—</strong>ï¼Ÿä»…åœ¨<strong>ç¬¬ä¸€æ¬¡</strong>å‡½æ•°è°ƒç”¨æ—¶å®ä¾‹åŒ–ï¼Œå¯¹è¯¥å‡½æ•°çš„è¿›ä¸€æ­¥è°ƒç”¨å°†è·¯ç”±ï¼ˆæŒ‡å‘ï¼‰åˆ°å·²å®ä¾‹åŒ–çš„å‡½æ•°ã€‚</p>
</li>
<li>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šä¼˜å…ˆä½¿ç”¨æ™®é€šå‡½æ•°è°ƒç”¨æ–¹å¼ï¼Œå³<code>print(1,2)</code> ã€‚</p>
</li>
</ul>
<h4 id="3-3-2-å¤šä¸ªå‡½æ•°æ¨¡æ¿ç±»å‹">3.3.2 å¤šä¸ªå‡½æ•°æ¨¡æ¿ç±»å‹</h4>
<p>å¤šä¸ªå‡½æ•°æ¨¡æ¿ç±»å‹é€‚ç”¨äºå‡½æ•°æ‹¥æœ‰å¤šä¸ªä¸åŒç±»å‹å‚æ•°çš„æƒ…å†µã€‚</p>
<p>è¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function">T <span class="title">max</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">max</span>(<span class="number">2</span>, <span class="number">3.5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;  <span class="comment">// compile error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç»§ç»­å¾€ä¸‹é˜…è¯»å‰ï¼Œè¯·æ€è€ƒï¼šä¸ºä»€ä¹ˆç¼–è¯‘ä¼šå‡ºé”™ï¼Ÿæœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•å—ï¼Ÿ</p>
<ul>
<li>
<p><strong>ä¸ºä»€ä¹ˆç¼–è¯‘å‡ºé”™</strong>ï¼Ÿ</p>
<ol>
<li>æ ¹æ®è°ƒç”¨çš„å‡½æ•°<code>max(2, 3.5)</code> ï¼Œç¼–è¯‘å™¨ä¼šå°è¯•å¯»æ‰¾åŒ¹é…çš„å‡½æ•°ï¼Œæ²¡æ‰¾åˆ°è½¬ä¸‹ä¸€æ­¥ï¼›</li>
<li>ç¼–è¯‘å™¨å°è¯•æ ¹æ®å‡½æ•°æ¨¡æ¿<code>max(T,T)</code>ï¼Œç”Ÿæˆå‡½æ•°<code>max(int,double)</code> ã€‚æ˜¾ç„¶è¿™æ˜¯ä¸å¯èƒ½ç”Ÿæˆ<strong>ä¸åŒç±»å‹</strong>çš„å‚æ•°ã€‚</li>
<li>å‡½æ•°è°ƒç”¨è§£æå‡ºé”™ã€‚</li>
</ol>
<p>å½“ç„¶ä½ å¯èƒ½è¿˜ä¼šé—®ï¼š<strong>ä¸ºä»€ä¹ˆç¼–è¯‘å™¨ä¸ä¼šç”Ÿæˆå‡½æ•°<code>max(double,double)</code>ï¼Œè¿™è°ƒç”¨æ—¶<code>max(int,double)</code> ä¸­<code>int</code>å¯ä»¥éšå¼è½¬æ¢ä¸º<code>double</code>å‘¢</strong>?</p>
<p>å› æ­¤ï¼Œç±»å‹è½¬æ¢ä»…åœ¨è§£æå‡½æ•°é‡è½½æ—¶è¿›è¡Œï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œæ¨¡æ¿å‚æ•°æ¨å¯¼æ—¶è¿›è¡Œã€‚</p>
</li>
<li>
<p><strong>æœ‰ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•å—</strong>ï¼Ÿ</p>
<p>å½“ç„¶ï¼Œæœ€ç®€å•åŠæ³•æ˜¯ä¼ å‚æ—¶ä¾¿è¿›è¡Œç±»å‹è½¬æ¢ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="built_in">max</span>(<span class="keyword">static_cast</span>&lt;<span class="keyword">double</span>&gt;(<span class="number">2</span>), <span class="number">3.5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å‡½æ•°æ¨¡æ¿å°±å¯ä»¥ç”Ÿæˆå‡½æ•°<code>max(double,double)</code>ï¼Œä»è€Œæ­£ç¡®è¢«è°ƒç”¨äº†ã€‚ä½†è¿™å¾ˆä¸coolã€‚</p>
<p>æˆ–è€…ä½ åˆæƒ³åˆ°äº†ï¼Œæˆ‘ä»¬ä¸æ˜¯æ–°å­¦ä¼šä¸€ç§è°ƒç”¨å‡½æ•°æ¨¡æ¿çš„æ–¹æ³•å—ï¼Œå®ƒå¯ä»¥<u>æ˜¾ç¤ºæŒ‡å®šè½¬æ¢ç±»å‹ï¼Œç¼–è¯‘å™¨å°±ä¸ç”¨è‡ªå·±å»æ¨å¯¼äº†</u>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; max&lt;<span class="keyword">double</span>&gt;(<span class="number">2</span>, <span class="number">3.5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>; </span><br></pre></td></tr></table></figure>
<p>è¿™ä¹Ÿæ˜¯okçš„ã€‚</p>
<p>ä½†æœ€ä½³çš„è§£å†³åŠæ³•ï¼Œè¿˜æ˜¯ä»æ ¹æºè§£å†³ï¼šæ—¢ç„¶æ˜¯è°ƒç”¨å‚æ•°ç±»å‹æœ‰å¤šä¸ªï¼Œè€Œæ¨¡æ¿å‡½æ•°å‚æ•°ç±»å‹åªæœ‰ä¸€ä¸ªå¯¼è‡´å‡ºç°ä¸Šé¢çš„é—®é¢˜ã€‚</p>
<p>é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥å®šä¹‰æ¨¡æ¿å‡½æ•°æ—¶ä¹Ÿå®šä¹‰ä¸ºå¤šä¸ªç±»å‹å‘¢ï¼Ÿ</p>
</li>
<li>
<p><strong>å¤šä¸ªæ¨¡æ¿ç±»å‹å‚æ•°</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function">T <span class="title">max</span><span class="params">(T x, U y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">max</span>(<span class="number">2</span>, <span class="number">3.5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;  <span class="comment">// compile error</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œä¸€åˆ‡çœ‹èµ·æ¥æŒºä¸é”™ï¼Œè®©æˆ‘ä»¬è¾“å‡ºä¸€ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>å•Šï¼Ÿå¤§æƒŠå¤±è‰²ã€‚ä¸ºä»€ä¹ˆè¾“å‡ºç»“æœæ˜¯3è€Œä¸æ˜¯3.5ï¼Ÿ</p>
<p>å› ä¸ºå‡½æ•°å†…éƒ¨ç»“æœ<code>3.5</code>ä¸º<code>double</code> ç±»å‹ï¼Œè¿”å›çš„æ˜¯<code>T</code>ç±»å‹ï¼Œå·²ç»è¢«ç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ï¼ˆæ ¹æ®ä¼ çš„å‚æ•°<code>2</code>ï¼‰æ›¿æ¢ä¸º<code>int</code> ç±»å‹ã€‚å› æ­¤å°†3.5å¼ºåˆ¶è½¬æ¢ä¸º3ã€‚</p>
<p>é‚£æˆ‘ä»¬ç›´æ¥æŒ‡å®šè¿”å›ç±»å‹<code>T</code> å˜ä¸º<code>U</code> ä¸å°±è¡Œäº†å—ï¼Ÿå¾ˆå¯æƒœï¼Œä¸è¡Œã€‚<strong>å› ä¸ºTã€Uçš„å®é™…ç±»å‹éƒ½æ˜¯æ ¹æ®è°ƒç”¨æ—¶ä¼ çš„å‚æ•°è¿›è¡Œæ¨æ–­çš„ï¼Œè€Œè°ƒç”¨æ—¶ä¼ é€’å‚æ•°çš„ä½ç½®å¯ä»¥éšæ„æ¢åŠ¨</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cout &lt;&lt; max(2, 3.5) &lt;&lt; &#x27;\n&#x27;; </span></span><br><span class="line">cout &lt;&lt; <span class="built_in">max</span>(<span class="number">3.5</span>, <span class="number">2</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>; </span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶<code>U</code>è¢«æ¨æ–­ä¸º<code>int</code> ç±»å‹ã€‚æ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨<code>auto</code>å…³é”®å­—ï¼Œ<strong>è‡ªåŠ¨æ¨å¯¼å‡½æ•°çš„è¿”å›ç±»å‹</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">max</span><span class="params">(T x, U y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x &gt; y) ? x : y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.5</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œä¸€åˆ‡éƒ½å¥½èµ·æ¥äº†ã€‚å…³äº<code>auto</code>å…³é”®å­—è¿˜ä¼šåœ¨åé¢åšæ›´è¯¦ç»†çš„æ€»ç»“ï¼Œå¸Œæœ›ä½ æœ‰äº†ä¸ªåˆæ­¥çš„è®¤è¯†ã€‚</p>
</li>
</ul>
<h3 id="3-4-å‡½æ•°å‚æ•°ğŸŒŸ">3.4 å‡½æ•°å‚æ•°ğŸŒŸ</h3>
<blockquote>
<p>âš ï¸ æœ¬èŠ‚çŸ¥è¯†è®¾è®¡åˆ°è¾ƒå¤šæŒ‡é’ˆå’Œå¼•ç”¨ç›¸å…³å†…å®¹ï¼Œæ­¤å‰æ— åŸºç¡€å»ºè®®å…ˆé˜…è¯»ï¼š<u>ç¬¬äºŒç« ï¼šæŒ‡é’ˆå’Œå¼•ç”¨</u>ã€‚</p>
</blockquote>
<p>åœ¨æ­£å¼æ¢è®¨å‡½æ•°å‚æ•°å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹å‡½æ•°ä¸­çš„ä¸¤ç§å‚æ•°ï¼š</p>
<ul>
<li><strong>å½¢å¼å‚æ•°</strong>ï¼šå‡½æ•°å£°æ˜æ—¶è¡¨ç¤ºçš„å˜é‡ï¼Œå‡½æ•°è°ƒç”¨æ—¶æ‰åˆ†é…å†…å­˜ã€‚</li>
<li><strong>å®é™…å‚æ•°</strong>ï¼šè°ƒç”¨å‡½æ•°æ•°å®é™…ä¼ é€’çš„å‚æ•°å€¼ï¼Œå¿…é¡»æ˜¯ç¡®å®šçš„å€¼ã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">// x,y æ˜¯å½¢å‚</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">foo</span>(<span class="number">6</span>, <span class="number">7</span>); <span class="comment">// 6,7 æ˜¯å®å‚ï¼Œè¢«èµ‹å€¼ç»™å½¢å‚x,y</span></span><br></pre></td></tr></table></figure>
<p>å®ƒä»¬æ›´å¤šçš„åŒºåˆ«ä¼šåœ¨3.4.6èŠ‚ä¸­è¿›è¡Œå¯¹æ¯”ã€‚</p>
<p>æœ¬èŠ‚æ ¸å¿ƒï¼šæŒ‰å€¼ä¼ é€’ã€æŒ‰å¼•ç”¨ä¼ é€’å’ŒæŒ‰æŒ‡é’ˆä¼ é€’ï¼Œè¿™ 3 ç§å‘å‡½æ•°ä¼ é€’å‚æ•°çš„ä¸»è¦æ–¹å¼ã€‚æˆ‘ä»¬ä¸€èµ·äº†è§£ä¸‹å§ã€‚</p>
<h4 id="3-4-1-æŒ‰å€¼ä¼ é€’">3.4.1 æŒ‰å€¼ä¼ é€’</h4>
<ul>
<li>
<p><strong>ä»€ä¹ˆæ˜¯æŒ‰å€¼ä¼ é€’</strong>ï¼Ÿ</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>C++ ä¸­çš„éæŒ‡é’ˆå‚æ•°éƒ½æ˜¯æŒ‰å€¼ä¼ é€’ï¼šå®å‚çš„å€¼è¢«å¤åˆ¶åˆ°ç›¸åº”å‡½æ•°å½¢å‚ä¸­</strong>ã€‚</p>
<p>æŒ‰å€¼ä¼ é€’æ—¢ç„¶æ˜¯å¤åˆ¶ï¼Œå³åªæ˜¯å°†å®å‚çš„å‰¯æœ¬ä¼ é€’ç»™å‡½æ•°ï¼Œé‚£ä¹ˆå‡½æ•°ä¿®æ”¹å‰¯æœ¬ï¼ˆå½¢å‚ï¼‰çš„å€¼æ˜¯ä¸èƒ½å½±å“åˆ°å®å‚å€¼ã€‚è¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    y = <span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x&#123; <span class="number">5</span> &#125;;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="built_in">foo</span>(x); <span class="comment">// å®å‚xå¤åˆ¶ä¸€ä»½ç»™y</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;x = &quot;</span> &lt;&lt; x &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x = 5</span><br><span class="line">x = 5</span><br></pre></td></tr></table></figure>
<p><code>x</code>çš„å€¼å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œè™½ç„¶<code>foo</code> å‡½æ•°å†…å®¹ä¿®æ”¹äº†ä¼ é€’è¿‡æ¥çš„å€¼ï¼Œä½†é‚£åªæ˜¯<code>x</code>çš„å‰¯æœ¬ã€‚</p>
<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211231000603042.png" alt="image-20211231000603042" style="zoom:80%;" />
<p>ä¸Šå›¾å¯¹è¿™ä¸€è¿‡ç¨‹è¿›è¡Œå½¢è±¡è¯´æ˜ï¼Œæ³¨æ„åˆ°å®å‚xã€å½¢å‚yå¯¹åº”çš„æ˜¯ä¸åŒå†…å­˜åŒºåŸŸï¼ˆåœ°å€éƒ½ä¸ä¸€æ ·ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä»€ä¹ˆæ—¶å€™ç”¨å€¼ä¼ é€’</strong>ï¼Ÿ</p>
<p>æŒ‰å€¼ä¼ é€’é€šå¸¸ç”¨äºéœ€è¦ä¼ é€’çš„å‚æ•°ä¸å¸Œæœ›è¢«ä¿®æ”¹çš„æ—¶å€™ï¼Œå®å‚å¯ä»¥æ˜¯ï¼š<u>å˜é‡ï¼ˆä¾‹å¦‚ xï¼‰ã€æ•°å­—ï¼ˆä¾‹å¦‚ 6ï¼‰ã€è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚ x+1ï¼‰ã€ç»“æ„å’Œç±»ä»¥åŠæšä¸¾æ•°</u>ã€‚</p>
<p>ä½†æ˜¯æŒ‰å€¼ä¼ é€’ä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œåº”è¯¥é¿å…ä»¥ä¸‹å‡ ç§æƒ…å†µä½¿ç”¨ï¼š</p>
<ol>
<li>å¤åˆ¶ç»“æ„å’Œç±»ã€‚å¤åˆ¶ç»“æ„å’Œç±»å¼€é”€è¿‡å¤§ï¼Œå¯¼è‡´æ˜æ˜¾æ€§èƒ½æŸå¤±ï¼›</li>
<li>å¸Œæœ›å‚æ•°è¢«æ”¹å˜ï¼›</li>
<li>è¿”å›å¤šä¸ªå€¼ã€‚</li>
</ol>
<p>å…¶å®ƒæƒ…å†µä¼˜å…ˆè€ƒè™‘å€¼ä¼ é€’ã€‚</p>
</li>
</ul>
<h4 id="3-4-2-æŒ‰å¼•ç”¨ä¼ é€’">3.4.2 æŒ‰å¼•ç”¨ä¼ é€’</h4>
<ul>
<li>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å¼•ç”¨ä¼ é€’</strong>ï¼Ÿ</p>
<p>åœ¨å‰é¢æˆ‘ä»¬è¯´åˆ°å€¼ä¼ é€’çš„å‡ ä¸ªç¼ºç‚¹ï¼šå¤åˆ¶ç»“æ„å’Œç±»å¼€é”€å¤§ã€æ— æ³•æ”¹å˜å‚æ•°ã€åªèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚</p>
<p>å¯¹åº”ï¼Œå¦‚æœä½ ä¸å¸Œæœ›ä»¥ä¸Šå‘ç”Ÿï¼Œè¯·ä½¿ç”¨å¼•ç”¨ä¼ é€’ã€‚</p>
<p><strong>å¼•ç”¨å°±ç›¸å½“äºå˜é‡åˆ«åï¼Œæ“ä½œå¼•ç”¨ç­‰ä»·äºç›´æ¥æ“ä½œæœ¬ä½“å˜é‡</strong>ã€‚è¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAdd</span><span class="params">(<span class="keyword">int</span> x_add_1, <span class="keyword">int</span>&amp; y_add_2,<span class="keyword">int</span>&amp; z_add_3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x_add_1 += <span class="number">1</span>;</span><br><span class="line">    y_add_2 += <span class="number">2</span>;</span><br><span class="line">    z_add_3 += <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// print(1.2,2);</span></span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span> ,y = <span class="number">0</span> , z =<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">getAdd</span>(x,y,z);</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; y &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; z &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°è¿‡ç¨‹ç®€ç•¥åˆ†æã€‚</p>
<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211231160958522.png" alt="image-20211231160958522" style="zoom:80%;" />
<ul>
<li>å¼•ç”¨ä¼ é€’å˜é‡ <code>y</code> ã€<code>z</code> å‡è¢«ä¿®æ”¹ï¼ˆ<code>x</code>å€¼ä¼ é€’æœªè¢«ä¿®æ”¹ï¼‰ã€‚</li>
</ul>
<p>ç±»ä¼¼å€¼ä¼ é€’ã€‚ä¾‹å¦‚ï¼Œå¼•ç”¨ä¼ é€’ä¸­çš„<code>y_add_2</code> ä¹Ÿæ˜¯è¢«è°ƒå‡½æ•°æ ˆä¸Šçš„ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå®ƒä¿å­˜äº†<code>y</code>çš„åœ°å€ã€‚å¯¹äºå¼•ç”¨å‚æ•°çš„<strong>ä»»ä½•å¤„ç†éƒ½ä¼šé€šè¿‡é—´æ¥å¯»å€ï¼Œç­‰ä»·ç›´æ¥æ“ä½œå®å‚<code>y</code>æœ¬ä½“</strong>ã€‚</p>
<p>ç‰¹åˆ«çš„ï¼Œå¼•ç”¨è¿˜æœ‰å‡ ä¸ªç‰¹ç‚¹ï¼ˆ2.2èŠ‚ï¼‰ï¼š</p>
<ul>
<li>å¼•ç”¨å¿…é¡»ä½¿ç”¨å³å€¼è¿›è¡Œåˆå§‹åŒ–ï¼Œé™¤éæ˜¯æ‰§è¡Œå¸¸é‡çš„å¼•ç”¨ï¼›</li>
<li>å¼•ç”¨ä¼ é€’å€¼å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥ä¸å¿…æ‹…å¿ƒç©ºå€¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¿™ä¹ˆæ£’äº†ä½ åé¢è¿˜è®²æŒ‡é’ˆä¼ é€’å¹²å˜›</strong>ï¼Ÿ</p>
<blockquote>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ç¡®å®æ¨èå°½é‡ä½¿ç”¨å¼•ç”¨ä¼ é€’å‚æ•°ï¼Œä½†æ˜¯åœ°å€ä¼ é€’å‚æ•°è¿˜æ˜¯æœ‰å®ƒçš„ç”¨æ­¦ä¹‹åœ°ã€‚</p>
</blockquote>
<p>æ¯”å¦‚ï¼Œå¼•ç”¨ä¼ é€’å€¼å¯ä»¥ä½¿å¾—å‡½æ•°â€œè¿”å›â€å¤šä¸ªå€¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAdd</span><span class="params">(<span class="keyword">int</span> x_add_1, <span class="keyword">int</span>&amp; y_add_2,<span class="keyword">int</span>&amp; z_add_3)</span></span>;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è§‚å¯Ÿè¿™ä¸ªè¡¨è¾¾å¼ï¼Œè¾“å…¥å‚æ•°<code>x_add_1</code> ï¼Œå’Œè¾“å‡ºå‚æ•°ï¼ˆè¿”å›å€¼ï¼‰<code>y_add_2</code>ã€<code>z_add_3</code> æ”¾åœ¨ä¸€å—ï¼Œæ— æ³•å¾ˆå¥½çš„åŒºåˆ†å“ªäº›æ˜¯è¦è¢«ä¿®æ”¹çš„ï¼ˆè¾“å‡ºå‚æ•°ï¼‰ã€‚æ¯•ç«Ÿï¼Œ<strong>å®ƒä»¬è¿è°ƒç”¨éƒ½æ˜¯è¿™ä¹ˆç›¸ä¼¼</strong>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">int</span> x = <span class="number">0</span> ,y = <span class="number">0</span> , z =<span class="number">0</span>;</span><br><span class="line"><span class="built_in">getAdd</span>(x,y,z);</span><br></pre></td></tr></table></figure>
<p>ä½ èƒ½åŒºåˆ†å“ªäº›æ˜¯<code>xã€yã€z</code>å“ªäº›è¾“å‡ºå‚æ•°å—ï¼Ÿ</p>
</li>
</ul>
<h4 id="3-4-3-æŒ‰æŒ‡é’ˆä¼ é€’">3.4.3 æŒ‰æŒ‡é’ˆä¼ é€’</h4>
<ul>
<li>
<p><strong>ä¸ºä»€ä¹ˆè¦éœ€è¦æŒ‡é’ˆä¼ é€’å€¼</strong>?</p>
<p>å‰é¢è¯´åˆ°ï¼Œå¼•ç”¨ä¼ å€¼ç”¨æ¥â€œè¿”å›â€å¤šä¸ªå‚æ•°æ—¶ï¼Œå¾ˆéš¾åŒºåˆ†å“ªäº›å‚æ•°æ˜¯è¾“å‡ºå‚æ•°ï¼Œè¿è°ƒç”¨æ—¶éƒ½è¿‡åˆ†ç›¸ä¼¼ï¼ˆå¤šèƒèƒæäººå¿ƒæ€æ˜¯å§ï¼Ÿï¼‰ã€‚</p>
<p>ä¸Šé¢ä»£ç ä¿®æ”¹ä¸ºæŒ‡é’ˆä¼ å€¼åï¼Œå‡½æ•°å½¢å‚ç”±<code>&amp;</code>å˜ä¸º<code>*</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAdd</span><span class="params">(<span class="keyword">int</span> x_add_1, <span class="keyword">int</span>* y_add_2,<span class="keyword">int</span>* z_add_3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     x_add_1 += <span class="number">1</span>;</span><br><span class="line">    *y_add_2 += <span class="number">2</span>;  <span class="comment">// y_add_2å­˜çš„æ˜¯yçš„åœ°å€ï¼Œä½¿ç”¨*æ“ä½œç¬¦å–å€¼</span></span><br><span class="line">    *z_add_3 += <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è°ƒç”¨æ—¶ï¼ˆ<strong>yã€zå¯ä»¥å¾ˆå¥½çš„è®¤å‡ºæ˜¯è¾“å‡ºå‚æ•°</strong>ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x = <span class="number">0</span> ,y = <span class="number">0</span> , z =<span class="number">0</span>;</span><br><span class="line"><span class="built_in">getAdd</span>(x,&amp;y,&amp;z);  <span class="comment">// &amp;--å–åœ°å€è¿ç®—ç¬¦</span></span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ï¼Œ<code>y_add_2</code> è·å–äº†å½¢å‚<code>&amp;y</code>ä¿å­˜çš„å€¼ï¼Œå³å˜é‡<code>y</code>çš„å†…å­˜åœ°å€ã€‚é€šè¿‡å–å€¼è¿ç®—ç¬¦<code>*y_add_2</code> ï¼Œå¯ä»¥è·å–å˜é‡<code>y</code>çš„å†…å­˜åŒºåŸŸæ“ä½œæƒï¼Œå³å¯ä»¥ä¿®æ”¹<code>y</code>çš„å€¼äº†ï¼ˆ+2ï¼‰ã€‚å› æ­¤å˜é‡<code>y</code>çš„å€¼è¢«ä¿®ï¼Œ<code>z</code>åŒç†ã€‚</p>
</li>
<li>
<p><strong>æƒŠè®¶ï¼æŒ‡é’ˆå…¶å®å€¼ä¼ é€’</strong>ï¼Ÿ</p>
<p>è¿™å°±æ˜¯è¯´æˆ‘ä»¬åƒå€¼ä¼ é€’ä¸€æ ·å°†<strong>å®å‚çš„å€¼ï¼ˆä¸€èˆ¬æ˜¯æŸä¸ªå˜é‡çš„åœ°å€ï¼‰å¤åˆ¶äº†ä¸€ä»½ç»™å½¢å‚</strong>ï¼Œå½¢å‚<u>ä¹Ÿä½œä¸ºå±€éƒ¨å˜é‡åœ¨æ ˆä¸­å¼€è¾Ÿäº†å†…å­˜ç©ºé—´</u>ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼ŒæŒ‡é’ˆæ˜¯æŒ‰å€¼ä¼ é€’çš„ï¼å½“ç„¶ï¼Œè¿™å…¶å®æ²¡å¤šå¤§æƒŠè®¶ï¼ˆé™¤éä½ å’Œä½œè€…ä¸€æ ·æ˜¯ä¸ªæƒŠè®¶æ€ªï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬æ—©åœ¨<u>2.1èŠ‚</u>åˆ†æè¿‡ï¼ŒæŒ‡é’ˆæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå®ƒæœ‰è‡ªå·±çš„å€¼ï¼ˆå…¶å®ƒå˜é‡çš„åœ°å€ï¼‰å’Œè‡ªå·±çš„åœ°å€ã€‚</p>
<p>è¯·çœ‹ä¸‹ä¾‹ï¼Œè¯•åˆ†æï¼š<strong>ä¸ºä»€ä¹ˆ<code>pfive</code>å€¼æ²¡æœ‰è¢«ä¿®æ”¹æˆåŠŸï¼Ÿ</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜é‡ pträ¿å­˜äº†p_fiveçš„å€¼ï¼ˆfiveçš„åœ°å€ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setNull</span><span class="params">(<span class="keyword">int</span>* ptr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ptr = <span class="literal">NULL</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> five = <span class="number">5</span>;</span><br><span class="line">    cout&lt;&lt;&amp;five&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">int</span>* pfive = &amp;five; <span class="comment">// p_five = &amp;five = 0x7ffdb136b8e4</span></span><br><span class="line">    cout&lt;&lt;&amp;pfive&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">setNull</span>(pfive); <span class="comment">// å°†p_fiveæŒ‡å‘null</span></span><br><span class="line">    cout&lt;&lt;pfive&lt;&lt;endl; <span class="comment">// è¾“å‡ºæ­¤æ—¶p_fiveå†…å­˜åœ°å€</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x7ffd037a0ecc</span><br><span class="line">0x7ffd037a0ec0</span><br><span class="line">0x7ffd037a0ea8</span><br><span class="line">0x7ffd037a0ecc</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶<code>pfive</code>æ²¡æœ‰ä¿®æ”¹æˆåŠŸï¼ˆNULLï¼‰ã€‚æ•´ä¸ªè¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220109145535610.png" alt="image-20220109145535610"></p>
</li>
</ul>
<ol>
<li>
<p>å±€éƒ¨å˜é‡<code>pfive</code> ä¿å­˜äº†<code>&amp;five</code>çš„å€¼ï¼Œå³<code>five</code> çš„åœ°å€ï¼›</p>
</li>
<li>
<p>éšå<code>pfive</code>ä½œä¸ºå®å‚ï¼Œå…¶å€¼ï¼ˆ<code>five</code>åœ°å€ï¼‰å¤åˆ¶ç»™å½¢å‚<code>ptr</code>ï¼Œç¼–è¯‘å™¨ç»™å½¢å‚<code>ptr</code>å¼€è¾Ÿäº†ç©ºé—´ä¸“é—¨ä¿å­˜<code>five</code>åœ°å€ï¼›</p>
</li>
<li>
<p>éšå<code>ptr=NULL</code>ï¼Œä½†æ˜¯å½±å“ä¸åˆ°<code>pfive</code>ï¼ŒäºŒè€…æ˜¯ä¸åŒçš„å˜é‡æ‹¥æœ‰å„è‡ªç‹¬ç«‹çš„ç©ºé—´ã€‚</p>
</li>
</ol>
<p>è¿™éªŒè¯äº†æˆ‘ä»¬ä¹‹å‰çš„ç»“è®ºï¼š<strong>æŒ‡é’ˆä¼ å€¼åªæ˜¯å¤åˆ¶äº†å®å‚å€¼ç»™å½¢å‚ï¼Œåªä¸è¿‡è¿™ä¸ªå®å‚å€¼ä¸€èˆ¬æ˜¯æŸä¸ªå˜é‡çš„åœ°å€</strong>ã€‚</p>
<p><strong>é‚£å¦‚æœæˆ‘ä»¬æƒ³åœ¨æŒ‡é’ˆä¼ å€¼æ—¶ä¿®æ”¹å½¢å‚å°±å¯ä»¥å½±å“å®å‚</strong>ï¼Ÿ</p>
<p>æ˜¾ç„¶è¿™å°±æ˜¯å¼•ç”¨çš„åšæ³•ï¼Œå¯¹å½¢å‚çš„ä»»ä½•ä¿®æ”¹ç›´æ¥ç­‰ä»·æ“ä½œå®å‚æœ¬ä½“ã€‚ä¸è¿‡ä¸ºäº†æ›´å¥½çš„è®²è§£ï¼Œæˆ‘ä»¬å…ˆæ€»ç»“ä¸€ä¸‹å‰é¢å¼•ç”¨ã€æŒ‡é’ˆä¼ å€¼çš„ç”¨æ³•ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“å¼•ç”¨ç›¸å½“äºå˜é‡çš„åˆ«åï¼Œä½¿ç”¨å¼•ç”¨æ—¶å¯ä»¥è®¤ä¸ºå°±æ˜¯åœ¨ä½¿ç”¨å˜é‡æœ¬èº«ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>&amp; a_ref = a;  <span class="comment">// ä½¿ç”¨a_refå’Œä½¿ç”¨aæ²¡ä»€ä¹ˆåŒºåˆ«</span></span><br></pre></td></tr></table></figure>
<p>åˆå¦‚ä¹‹å‰çš„å¼•ç”¨ä¼ å€¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>&amp; var)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// var = ...;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">func</span>(tmp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶å½¢å‚æ˜¯<code>int&amp; var</code> ï¼Œå®å‚<code>tmp</code> ï¼Œå®å‚å€¼åˆå§‹åŒ–å½¢å‚<code>var</code>ï¼Œå°±ç›¸å½“äºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>&amp; var = tmp;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥æ¨å¹¿åˆ°å‡½æ•°å…¶ä½™å‚æ•°ä¼ é€’æƒ…å†µï¼š</p>
<ul>
<li>
<p>å€¼ä¼ é€’</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> var)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// var = ...;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">func</span>(tmp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®å‚å€¼åˆå§‹åŒ–å½¢å‚<code>var</code>ç­‰ä»·äºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> var = tmp;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æŒ‡é’ˆä¼ é€’</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>* var)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// *var = ...;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">func</span>(&amp;tmp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®å‚å€¼åˆå§‹åŒ–å½¢å‚<code>var</code>ç­‰ä»·äºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* var = &amp;tmp;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å¥½äº†ï¼Œæ¥å—äº†ä¸Šé¢çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´<strong>æ€ä¹ˆä¿®æ”¹å½¢å‚<code>ptr</code> ç­‰ä»·äºä¿®æ”¹å®å‚<code>pfive</code></strong>ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜é‡ pträ¿å­˜äº†p_fiveçš„å€¼ï¼ˆfiveçš„åœ°å€ï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setNull</span><span class="params">(<span class="keyword">int</span>* ptr)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ptr = <span class="literal">NULL</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> five = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">int</span>* pfive = &amp;five; </span><br><span class="line">    <span class="built_in">setNull</span>(pfive); <span class="comment">// å°†p_fiveæŒ‡å‘null</span></span><br><span class="line">    cout&lt;&lt;p_five&lt;&lt;endl; <span class="comment">// è¾“å‡ºæ­¤æ—¶p_fiveå†…å­˜åœ°å€</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶ï¼Œ<strong>å¼•ç”¨</strong>å¯ä»¥åšåˆ°è¿™ç‚¹ï¼šå°†<code>ptr</code> è§†ä¸º<code>pfive</code>çš„åˆ«åï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>*&amp; ptr = pfive;</span><br></pre></td></tr></table></figure>
<p>åªéœ€å°†ç¬¬5è¡Œä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setNull</span><span class="params">(<span class="keyword">int</span>*&amp; ptr)</span></span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å†å°è¯•è¾“å‡ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="comment">// è¡¨ç¤ºæŒ‡é’ˆæŒ‡å‘NULL</span></span><br></pre></td></tr></table></figure>
<h4 id="3-4-4-æœ€ä½³å®è·µ">3.4.4 æœ€ä½³å®è·µ</h4>
<h5 id="ä¼ å¼•ç”¨å¿«è¿˜æ˜¯ä¼ æŒ‡é’ˆå¿«ï¼Ÿ">ä¼ å¼•ç”¨å¿«è¿˜æ˜¯ä¼ æŒ‡é’ˆå¿«ï¼Ÿ</h5>
<p>è™½ç„¶å‰é¢çš„åˆ†æï¼Œä½ å¯¹å¼•ç”¨å’ŒæŒ‡é’ˆä¼ é€’æœ‰ä¸€å®šçš„äº†è§£ã€åŒºåˆ†ã€‚</p>
<p><strong>ä½†å¦‚æœè¦ä½ å›ç­”è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼šæ˜¯ä¼ å¼•ç”¨å¿«è¿˜æ˜¯ä¼ æŒ‡é’ˆå¿«</strong>ï¼Ÿ</p>
<p>å…ˆä¸Šç»“è®ºï¼šä¸€æ ·å¿«ã€‚</p>
<p><strong>å› ä¸ºå¼•ç”¨å°±æ˜¯ç‰¹æ®Šçš„æŒ‡é’ˆï¼Œå®ƒåº•å±‚å®ç°å’ŒæŒ‡é’ˆæ˜¯ä¸€è‡´çš„</strong>ã€‚</p>
<p>å‡†å¤‡ä¸€æ®µåœ°å€ä¼ å‚ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>* y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    *y = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">func</span>(&amp;x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>main</code>å¯¹åº”æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">main:</span><br><span class="line">        # ä¿å­˜mainæ ˆå¸§ä¿¡æ¯</span><br><span class="line">        pushq   %rbp</span><br><span class="line">        movq    %rsp, %rbp</span><br><span class="line">        subq    $16, %rsp </span><br><span class="line">        # ç”¨0åˆå§‹åŒ–xï¼ˆå¯¹åº”åœ°å€ä¸º-4(%rbp)ï¼Œå¹¶å°†xå‹æ ˆ</span><br><span class="line">        movl    $0, -4(%rbp)</span><br><span class="line">        # å°†xåœ°å€ä¿å­˜åˆ°å¯„å­˜å™¨raxä¸­ï¼Œç„¶åä¿å­˜åœ¨rdiä¸­</span><br><span class="line">        leaq    -4(%rbp), %rax </span><br><span class="line">        movq    %rax, %rdi</span><br><span class="line">        # è°ƒç”¨å‡½æ•°func</span><br><span class="line">        call    _Z4funcPi</span><br><span class="line">        movl    $0, %eax</span><br><span class="line">        leave</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°<code>main</code>ä¸­æœ€ç»ˆå°†å®å‚<code>&amp;x</code>ï¼ˆå˜é‡<code>x</code>çš„åœ°å€ï¼‰ä¿å­˜åœ¨å¯„å­˜å™¨<code>rdi</code>ä¸­ ã€‚</p>
<p>æ¥ç€æˆ‘ä»¬å¼€å§‹é‡å¤´æˆ<code>func</code>å‡½æ•°ï¼š<strong>æŒ‡é’ˆé€šè¿‡ä¿å­˜å˜é‡åœ°å€åˆ°å¯„å­˜å™¨ä¸­ï¼Œå®ç°å¯¹å˜é‡æ‰€åœ¨å†…å­˜åŒºåŸŸè¿›è¡Œä¿®æ”¹</strong>ï¼Œå› æ­¤ä¿®æ”¹æŒ‡é’ˆå°±æ˜¯ç›´æ¥å½±å“å˜é‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">_Z4funcPi:</span><br><span class="line">        # ä¿å­˜funcæ ˆå¸§ç›¸å…³ä¿¡æ¯</span><br><span class="line">        pushq   %rbp</span><br><span class="line">        movq    %rsp, %rbp</span><br><span class="line">        # è¿›è¡Œåœ°å€å¤åˆ¶ï¼šå°†å¯„å­˜å™¨rdiçš„å€¼ï¼ˆå®å‚&amp;xï¼‰å¤åˆ¶ç»™å½¢å‚yï¼ˆå¯¹åº”åœ°å€-8(%rbp)ï¼‰ï¼Œå¹¶å°†yå‹æ ˆ</span><br><span class="line">        movq    %rdi, -8(%rbp)</span><br><span class="line">        # è¿›è¡Œèµ‹å€¼è¿ç®—ï¼šå…ˆç”¨å¯„å­˜å™¨raxä¿å­˜å½¢å‚yçš„çš„å€¼ï¼ˆxçš„åœ°å€ï¼‰ï¼Œç„¶åå°†2å¤åˆ¶ç»™x</span><br><span class="line">        movq    -8(%rbp), %rax</span><br><span class="line">        movl    $2, (%rax)</span><br><span class="line">        nop</span><br><span class="line">        popq    %rbp</span><br><span class="line">        # è¿”å›main</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å°†ä¸Šè¿°ä»£ç ä»åœ°å€ä¼ é€’æ”¹ä¸ºå¼•ç”¨ä¼ é€’ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>&amp; y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    y = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span> ;</span><br><span class="line">    <span class="built_in">func</span>(x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å…¶æ±‡ç¼–ä»£ç ï¼šä¸èƒ½è¯´æ¯«ä¸ç›¸å¹²ï¼Œåªèƒ½è¯´å’Œä¹‹å‰æŒ‡é’ˆä¼ å€¼çš„æ±‡ç¼–ä»£ç å®Œå…¨<strong>ä¸€æ¨¡ä¸€æ ·</strong>ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220109193419428.png" alt="image-20220109193419428"></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å¼•ç”¨æœ¬è´¨å’ŒæŒ‡é’ˆä¸€æ ·ï¼Œéƒ½æ˜¯é€šè¿‡ä¿å­˜å˜é‡å¯¹åº”å†…å­˜åŒºåŸŸåœ°å€ï¼Œæ¥å®ç°æ“ä½œå˜é‡</strong>ã€‚å¯¹å¼•ç”¨çš„ä»»ä½•æ“ä½œï¼Œéƒ½ä¼šé€šè¿‡é—´æ¥å¯»å€ç›´æ¥æ“ä½œå˜é‡æœ¬èº«ï¼Œåªä¸è¿‡ç›¸æ¯”æŒ‡é’ˆéšè—äº†ä¸€äº›ç»†èŠ‚ï¼ˆç¼–è¯‘å™¨å¯¹ä½¿ç”¨å¼•ç”¨ä¼šè‡ªåŠ¨åŠ ä¸Š<code>*</code>ï¼Œ<u>2.2.1èŠ‚</u>ï¼‰ã€‚</p>
<h5 id="å‚æ•°ä¼ é€’é€‰æ‹©è§„åˆ™">å‚æ•°ä¼ é€’é€‰æ‹©è§„åˆ™</h5>
<blockquote>
<p>æœ‰å¼•é€‰å¼•ã€‚</p>
</blockquote>
<p><strong>ä¼˜å…ˆé€‰ç”¨å¼•ç”¨ä¼ é€’ï¼ˆå¼•ç”¨ï¼šæ‹œæ‰˜äº†</strong>ï¼‰ï¼Œé™¤éï¼š</p>
<ol>
<li><strong>å¸Œæœ›å‚æ•°ä¸è¢«ä¿®æ”¹</strong>ï¼Œé€‰æ‹©æŒ‰å€¼ä¼ é€’ï¼Œå¦åˆ™è½¬ä¸‹ä¸€æ­¥ï¼›</li>
<li><u><strong>éœ€è¦è¿”å›ç©ºæŒ‡é’ˆã€orè¿”å›å±€éƒ¨å˜é‡å†…å­˜ã€ORæ•°ç»„</strong></u>ï¼Œé€‰æ‹©æŒ‰æŒ‡é’ˆä¼ é€’ï¼Œå¦åˆ™è½¬ä¸‹ä¸€æ­¥ã€‚</li>
</ol>
<h5 id="æ•°ç»„æ€ä¹ˆä½¿ç”¨å¼•ç”¨ä¼ å‚ï¼Ÿ">æ•°ç»„æ€ä¹ˆä½¿ç”¨å¼•ç”¨ä¼ å‚ï¼Ÿ</h5>
<p>è¿™æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„é—®é¢˜ã€‚</p>
<p>å…ˆçœ‹çœ‹æ•°ç»„çš„å¼•ç”¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> array[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"><span class="built_in"><span class="keyword">int</span></span> (&amp;arr)[<span class="number">5</span>] = array;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶æ•°ç»„çš„ç±»å‹å¯ä»¥è®¤ä¸ºæ˜¯<code>int [5]</code> ï¼Œ<code>&amp;arr</code> ä¾¿æ˜¯å£°æ˜ä¸€ä¸ª<code>array</code>çš„åˆ«åã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¦‚æ­¤ä½¿ç”¨æ•°ç»„çš„å¼•ç”¨ä½œä¸ºå‚æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_array</span><span class="params">(<span class="keyword">int</span> (&amp;arr)[<span class="number">5</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> array[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">   <span class="built_in">modify_array</span>(array);</span><br><span class="line">   cout&lt;&lt;array[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®è¢«æˆåŠŸä¿®æ”¹äº†ã€‚ä½†<code>int (&amp;arr)[5]</code> ç¼–è¯‘å™¨<u>è¦æ£€æŸ¥æ•°ç»„å®å‚å’Œå½¢å‚çš„å¤§å°</u>ï¼Œæ‰©å±•æ€§å¤ªå·®ï¼</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¨¡æ¿è¿›è¡Œæ”¹è¿›ï¼ˆå…¶ä½™ä¸å˜ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">int</span> N&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify_array</span><span class="params">(T (&amp;arr)[N])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> array[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">   <span class="built_in">modify_array</span>(array);</span><br><span class="line">   cout&lt;&lt;array[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®Œç¾ï¼</p>
<h4 id="3-4-5-å‚æ•°ä¼ é€’æ€»ç»“">3.4.5 å‚æ•°ä¼ é€’æ€»ç»“</h4>
<blockquote>
<p>ä¸€äº›é¢è¯•å¸¸è€ƒé¢˜å¯¹å‰é¢æ‰€å­¦è¿›è¡Œæ€»ç»“å’ŒéªŒè¯ã€‚</p>
</blockquote>
<ul>
<li>
<p><strong>å½¢å‚å’Œå®å‚çš„åŒºåˆ«</strong>ï¼Ÿ</p>
<ul>
<li><strong>ä½•æ—¶åˆ†é…å†…å­˜</strong>ï¼š<strong>å½¢å‚å˜é‡åªæœ‰åœ¨è¢«è°ƒç”¨æ—¶æ‰åˆ†é…å†…å­˜å•å…ƒ</strong>ï¼Œåœ¨è°ƒç”¨ç»“æŸæ—¶ï¼Œ å³åˆ»é‡Šæ”¾æ‰€åˆ†é…çš„å†…å­˜å•å…ƒï¼ˆè¿™ä¸€éƒ¨åˆ†å†…å®¹è¿˜ä¼šåœ¨<u>8.6å‡½æ•°è¿”å›å€¼</u> è¯¦ç»†ä¸¾ä¾‹ï¼‰ï¼›å®å‚åœ¨è°ƒç”¨å‰å°±å·²ç»åˆ†é…äº†å†…å­˜ã€‚</li>
<li><strong>å‚æ•°ç±»å‹</strong>ï¼š å®å‚å¯ä»¥æ˜¯å¸¸é‡ã€å˜é‡ã€è¡¨è¾¾å¼ã€å‡½æ•°ç­‰ï¼Œåœ¨è¿›è¡Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œå®ƒä»¬<strong>éƒ½å¿…é¡»å…·æœ‰ç¡®å®šçš„å€¼</strong>ï¼›å®å‚å’Œå½¢å‚åœ¨æ•°é‡ä¸Šï¼Œç±»å‹ä¸Šï¼Œé¡ºåºä¸Šåº”ä¸¥æ ¼ä¸€è‡´ï¼Œ å¦åˆ™ä¼šå‘ç”Ÿâ€œç±»å‹ä¸åŒ¹é…â€çš„é”™è¯¯ã€‚</li>
<li><strong>å•å‘ä¼ é€’</strong>ã€‚åªèƒ½æŠŠå®å‚çš„å€¼ä¼ é€ç»™å½¢å‚ï¼Œè€Œä¸èƒ½æŠŠå½¢å‚çš„å€¼åå‘åœ°ä¼ é€ç»™å®å‚ã€‚</li>
</ul>
</li>
<li>
<p><strong>å€¼ä¼ é€’ã€æŒ‡é’ˆä¼ é€’ã€å¼•ç”¨ä¼ é€’çš„åŒºåˆ«</strong>ï¼Ÿ</p>
<p>è¯·çœ‹ä¸‹è¡¨ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">å€¼ä¼ é€’</th>
<th style="text-align:center">å¼•ç”¨ä¼ é€’</th>
<th style="text-align:center">æŒ‡é’ˆï¼ˆåœ°å€ï¼‰ä¼ é€’</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>æ‹·è´å†…å®¹</strong></td>
<td style="text-align:center">å®å‚çš„å‰¯æœ¬ï¼ˆæ•°ç»„ä¾‹å¤–ï¼Œä¼šé€€åŒ–ä¸ºæŒ‡é’ˆï¼‰</td>
<td style="text-align:center">ç»™å®å‚èµ·ä¸ªåˆ«å</td>
<td style="text-align:center">æŒ‡é’ˆï¼ˆ4å­—èŠ‚æˆ–8å­—èŠ‚ï¼‰</td>
</tr>
<tr>
<td style="text-align:center"><strong>æ•ˆç‡</strong></td>
<td style="text-align:center">ä½ï¼Œç‰¹åˆ«æ˜¯æ‹·è´ç»“æ„ä½“æˆ–ç±»å¯¹è±¡æ—¶</td>
<td style="text-align:center">é«˜ï¼ˆæ¨èï¼‰ï¼Œèµ·ä¸ªåˆ«åå³å¯</td>
<td style="text-align:center">é«˜ï¼Œæ‹·è´æŒ‡é’ˆå³å¯</td>
</tr>
<tr>
<td style="text-align:center"><strong>æ˜¯å¦ä¿®æ”¹</strong></td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:center">æ˜¯</td>
<td style="text-align:center">ä¸èƒ½ä¿®æ”¹ä¸ºå…¶å®ƒå¯¹è±¡çš„å¼•ç”¨</td>
</tr>
<tr>
<td style="text-align:center"><strong>åˆå§‹åŒ–</strong></td>
<td style="text-align:center">ä¸å¿…è¦</td>
<td style="text-align:center">ä¸€å®šè¦</td>
<td style="text-align:center">ä¸å¿…è¦</td>
</tr>
<tr>
<td style="text-align:center"><strong>ä½•æ—¶ä½¿ç”¨</strong></td>
<td style="text-align:center">å‚æ•°ä¸å¸Œæœ›è¢«ä¿®æ”¹æ—¶</td>
<td style="text-align:center"><strong>ä¼˜å…ˆé€‰ç”¨å¼•ç”¨</strong>ã€ä¼ é€’<strong>ç»“æ„æˆ–ç±»å¯¹è±¡</strong>ã€å¸Œæœ›å‚æ•°è¢«ä¿®æ”¹</td>
<td style="text-align:center">è¿”å›å¤šä¸ªå€¼ã€éœ€ä¼ é€’ç©ºæŒ‡é’ˆï¼ˆå¼•ä¼ é€’ç”¨ä¸å…è®¸ç©ºå€¼ï¼‰ã€è¿”å›<strong>å±€éƒ¨å˜é‡å†…å­˜ï¼ˆ3.5ä¸­è¯¦è¿°ï¼‰</strong></td>
</tr>
</tbody>
</table>
</li>
<li>
<p><strong>æŒ‡é’ˆä¼ é€’ã€å¼•ç”¨ä¼ é€’åº•å±‚åŒºåˆ«</strong>ï¼Ÿ</p>
<ul>
<li>
<p><strong>æŒ‡é’ˆä¼ é€’æœ¬è´¨æ˜¯å€¼ä¼ é€’</strong>ã€‚å€¼ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œè¢«è°ƒå‡½æ•°çš„å½¢å¼å‚æ•°ä½œä¸ºè¢«è°ƒå‡½æ•°çš„å±€éƒ¨å˜é‡å¤„ç†ï¼Œä¼šåœ¨æ ˆä¸­å¼€è¾Ÿå†…å­˜ç©ºé—´ä»¥å­˜æ”¾ç”±ä¸»è°ƒå‡½æ•°ä¼ é€’è¿›æ¥çš„<strong>å®å‚å€¼</strong>ï¼Œä»è€Œå½¢æˆäº†å®å‚çš„ä¸€ä¸ªå‰¯æœ¬ï¼ˆæ›¿èº«ï¼‰ã€‚</p>
<p>æ‰€ä»¥å½¢å‚æŒ‡é’ˆï¼ˆå†…å®¹ï¼‰å˜äº†ï¼ˆä¿å­˜äº†å…¶å®ƒå˜é‡åœ°å€ï¼‰ï¼Œå®å‚æŒ‡é’ˆä¸ä¼šå˜ã€‚</p>
</li>
<li>
<p><strong>å¼•å‡ºä¼ é€’æœ¬è´¨æ˜¯é—´æ¥å¯»å€</strong>ã€‚å¼•ç”¨å‚æ•°ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œè¢«è°ƒå‡½æ•°çš„å½¢å¼å‚æ•°ä¹Ÿä½œä¸ºå±€éƒ¨å˜é‡åœ¨æ ˆä¸­å¼€è¾Ÿäº†å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯è¿™æ—¶å­˜æ”¾çš„æ˜¯ç”±ä¸»è°ƒå‡½æ•°æ”¾è¿›æ¥çš„<strong>å®å‚çš„åœ°å€</strong>ã€‚è¢«è°ƒå‡½æ•°å¯¹å½¢å‚ï¼ˆæœ¬ä½“ï¼‰çš„ä»»ä½•æ“ä½œéƒ½è¢«å¤„ç†æˆ<strong>é—´æ¥å¯»å€</strong>ï¼Œé€šè¿‡æ ˆä¸­å­˜æ”¾çš„åœ°å€è®¿é—®ä¸»è°ƒå‡½æ•°ä¸­çš„å®å‚å˜é‡ã€‚</p>
</li>
<li>
<p><strong>ç¬¦å·è¡¨ä¸åŒ</strong>ã€‚ç¨‹åºåœ¨ç¼–è¯‘æ—¶åˆ†åˆ«å°†æŒ‡é’ˆå’Œå¼•ç”¨æ·»åŠ åˆ°ç¬¦å·è¡¨ä¸Šï¼Œç¬¦å·è¡¨ä¸­è®°å½•çš„æ˜¯å˜é‡ååŠå˜é‡æ‰€å¯¹åº”åœ°å€ã€‚æŒ‡é’ˆå˜é‡åœ¨ç¬¦å·è¡¨ä¸Šå¯¹åº”çš„<u>åœ°å€å€¼</u>ä¸º<strong>æŒ‡é’ˆå˜é‡çš„åœ°å€å€¼</strong>ï¼Œè€Œå¼•ç”¨åœ¨ç¬¦å·è¡¨ä¸Šå¯¹åº”çš„<u>åœ°å€å€¼</u>ä¸º<strong>å¼•ç”¨å¯¹è±¡çš„åœ°å€å€¼</strong>ï¼ˆä¸å®å‚åå­—ä¸åŒï¼Œåœ°å€ç›¸åŒï¼Œç¼–è¯‘å™¨ç›´æ¥å¤„ç†ä¸ºæ“ä½œå¼•ç”¨å¯¹è±¡ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<h4 id="3-4-6-ç‰¹æ®Šå‚æ•°">3.4.6 ç‰¹æ®Šå‚æ•°</h4>
<p>åœ¨è¿™ä¸€å°èŠ‚å°†æ¥è®¤è¯†ä¸‹æ¯”è¾ƒç‰¹æ®Šçš„ä¸¤ç±»å‚æ•°ã€‚</p>
<ul>
<li>
<p><strong>å‘½ä»¤è¡Œå‚æ•°</strong></p>
<p>å¦‚æœä½ è¿è¡Œè¿‡ä¸€äº›å¼€æºä»£ç /åº“ï¼Œç»å¸¸ä¼šè¦æ±‚ä½ è¾“å…¥æŒ‡å®šå‚æ•°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ program arg1 arg2</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª<strong>å¯ä»¥å‘å…¶ä»–å‡½æ•°è¾“å…¥å‚æ•°çš„æ–¹æ³•</strong>ï¼Œç‰¹åˆ«æ˜¯<u>ä½ æ— æ³•ä¿®æ”¹æºç æˆ–ç¨‹åºéœ€è¦ç”¨æˆ·æä¾›å‚æ•°æ—¶</u>ã€‚å½“ç„¶ï¼Œè¿˜å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶å®ç°ï¼Œè¿™é‡Œæš‚ä¸è¡¨ã€‚</p>
<p>ä¸‹é¢å½¢å¼çš„mainå‡½æ•°å¯ä»¥æ¥å—å‘½ä»¤è¡Œå‚æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span></span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>argc</code>ï¼šä¼ é€’çš„å‚æ•°é‡ä¸ªæ•°ï¼Œè‡³å°‘ä¸º1ï¼Œå› ä¸ºè‡³å°‘å­˜åœ¨<code>argv[0]</code> æŒ‡å‘å‡½æ•°æœ¬èº«åç§°ï¼›</li>
<li><code>argv</code>ï¼š Cé£æ ¼äºŒç»´æ•°ç»„ï¼Œå­˜å‚¨å‚æ•°ã€‚ä¾‹å¦‚ï¼Œ<code>argv[0][0]</code>æŒ‡å‘ç¬¬ä¸€ä¸ªæ•°ç»„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œ<code>argv[0]</code>æ˜¯ç¬¬ä¸€ä¸ªæ•°ç»„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„åœ°å€ã€‚</li>
</ul>
<p>ä¸€ä¸ªç®€å•çš„ç¨‹åºï¼Œæ‰“å°ç”¨æˆ·è¾“å…¥çš„å§“åå’Œå¹´é¾„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc , <span class="keyword">char</span>* argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;the count of paramters: &quot;</span>&lt;&lt; argc&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;the name of program: &quot;</span>&lt;&lt; argv[<span class="number">0</span>] &lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;your name: &quot;</span>&lt;&lt; argv[<span class="number">1</span>]&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;your age: &quot;</span>&lt;&lt; argv[<span class="number">2</span>]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220102165327119.png" alt="image-20220102165327119"></p>
<p>ç‰¹åˆ«çš„ï¼Œæ“ä½œç³»ç»Ÿå¯¹å¦‚ä½•å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼ˆ<strong>å¦‚åŒå¼•å·å’Œåæ–œæ </strong>ï¼‰æœ‰ç‰¹æ®Šçš„è§„åˆ™ã€‚</p>
<ul>
<li>
<p><strong>åŒå¼•å·</strong>ï¼šä»¥åŒå¼•å·ä¼ é€’çš„å­—ç¬¦ä¸²è¢«è®¤ä¸ºæ˜¯åŒä¸€å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼ˆå³ä½¿å®ƒä»¬ä¹‹é—´å­˜åœ¨ç©ºæ ¼ï¼‰ï¼›</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test.out <span class="string">&quot;royhuang cqu&quot;</span>  <span class="number">25</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>æ–œæ </strong>ï¼šå¦‚æœè¦åŒ…å«æ–‡å­—åŒå¼•å·ï¼Œåˆ™å¿…é¡»åæ–œæ åŒå¼•å·ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test.out \<span class="string">&quot;royhuang\&quot;  25</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p><strong>çœç•¥å·ï¼ˆå¯å˜å‚æ•°</strong>ï¼‰</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æˆ‘ä»¬çœ‹åˆ°çš„æ‰€æœ‰å‡½æ•°ä¸­ï¼Œå‡½æ•°å°†é‡‡ç”¨çš„å‚æ•°æ•°é‡å¿…é¡»äº‹å…ˆçŸ¥é“ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå°†<u>å¯å˜æ•°é‡</u>çš„å‚æ•°ä¼ é€’ç»™å‡½æ•°ä¼šå¾ˆæœ‰ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">return_type <span class="title">function_name</span><span class="params">(argument_list, ...)</span></span>;</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼šæˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ä¸€ç»„æ•´æ•°çš„å¹³å‡å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdarg&gt;</span> <span class="comment">// needed to use ellipsis</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findAverage</span><span class="params">(<span class="keyword">int</span> count, ...)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> sum&#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡é¢„å®šä¹‰å®va_listè·å–å‚æ•°åˆ—è¡¨</span></span><br><span class="line">    va_list list;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡å®va_startå¯¹va_liståˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">va_start</span>(list, count);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ±‚å’Œ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> arg&#123; <span class="number">0</span> &#125;; arg &lt; count; ++arg)</span><br><span class="line">    &#123;</span><br><span class="line">         <span class="comment">// é€šè¿‡å®va_argè·å–å…·ä½“å‚æ•°</span></span><br><span class="line">         sum += <span class="built_in">va_arg</span>(list, <span class="keyword">int</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨å®Œåé€šè¿‡å®va_endæ¸…ç†va_list</span></span><br><span class="line">    <span class="built_in">va_end</span>(list);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sum / count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">findAverage</span>(<span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="built_in">findAverage</span>(<span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°ç»“æœè¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3.5</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥è¿™å¾ˆæ£’ã€‚ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸æ¨èä½¿ç”¨çœç•¥å·ï¼š</p>
<ol>
<li>
<p><strong>çœç•¥å·å¾ˆå±é™©ï¼šæ— æ³•åˆ¤æ–­ä¼ é€’çš„å‚æ•°ä¸ªæ•°æ˜¯æ­£ç¡®</strong></p>
<p>å‡è®¾ä½ åªä¼ é€’äº†5ä¸ªå‚æ•°ï¼Œè€Œå®é™…è¦æ±‚æ˜¯6ä¸ªï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">findAverage</span>(<span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>åœ¨ä½œè€…çš„æœºå™¨ä¸Šï¼Œè¿™äº§ç”Ÿäº†å¥‡æ€ªçš„ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">699773</span><br></pre></td></tr></table></figure>
<p><code>va_arg(list, int)</code> è¿”å›çš„å‰5ä¸ªå€¼æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å€¼ã€‚å®ƒè¿”å›çš„ç¬¬ 6 ä¸ªå€¼ï¼ˆ<strong>æ²¡æœ‰æŠ¥é”™</strong>ï¼‰æ˜¯ä¸€ä¸ªåƒåœ¾å€¼å †æ ˆã€‚ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªåƒåœ¾ç­”æ¡ˆã€‚</p>
</li>
<li>
<p><strong>çœç•¥å·å¾ˆå±é™©ï¼šç±»å‹æ£€æŸ¥è¢«æš‚åœ</strong></p>
<p>å¦‚æœä½ å°è¯•ä¼ é€’ä¸€ä¸ªæµ®ç‚¹æ•°ï¼ˆ<code>1.0</code>ï¼‰ä½œä¸ºå‚æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">findAverage</span>(<span class="number">6</span>, <span class="number">1.0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸€å®šè®©ä½ å¤§åƒä¸€æƒŠï¼ˆè¿™æ˜¯ä»€ä¹ˆï¼Ÿè¿™ä¹ˆå¤§çš„æ•°å­—ï¼Ÿï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.78782e+008</span><br></pre></td></tr></table></figure>
<p>è¿™æ˜¯å› ä¸º<code>va_arg(list, int)</code> æŒ‡å®šé¢„æœŸç±»å‹æ˜¯<code>int</code> ï¼Œä½†æ˜¯æˆ‘ä»¬åˆä¼ é€’doubleç±»å‹å‚æ•°ã€‚è¿™å¯¼è‡´ï¼š</p>
<ul>
<li>va_arg çš„ç¬¬ä¸€æ¬¡è°ƒç”¨å°†åªè¯»å– double çš„å‰ 4 ä¸ªå­—èŠ‚ï¼ˆäº§ç”Ÿåƒåœ¾ç»“æœï¼‰ï¼›</li>
<li>va_arg çš„ç¬¬äºŒæ¬¡è°ƒç”¨å°†è¯»å– double çš„å 4 ä¸ªå­—èŠ‚ï¼ˆäº§ç”Ÿå¦ä¸€ä¸ªåƒåœ¾ç»“æœï¼‰ï¼›</li>
<li>å› æ­¤ï¼Œæˆ‘ä»¬çš„æ€»ä½“ç»“æœæ˜¯åƒåœ¾ã€‚</li>
</ul>
</li>
<li>
<p><strong>é™å®šçœç•¥å·ï¼šå‚æ•°æ•°é‡å’Œç±»å‹</strong></p>
<p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥äººä¸ºçš„ä¼ é€’ä¸€ä¸ªâ€œè§£ç å™¨å­—ç¬¦ä¸²â€ï¼Œå®ƒå‘Šè¯‰ç¨‹åºå¦‚ä½•è§£é‡Šå‚æ•°ï¼ˆé™å®šäº†æ•°é‡å’Œç±»å‹ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdarg&gt;</span> <span class="comment">// needed to use ellipsis</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findAverage</span><span class="params">(std::string decoder, ...)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">double</span> sum&#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">	va_list list;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">va_start</span>(list, decoder);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">char</span> codetype&#123; decoder[count] &#125;;</span><br><span class="line">		<span class="built_in"><span class="keyword">switch</span></span> (codetype)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;\0&#x27;</span>:</span><br><span class="line">			<span class="built_in">va_end</span>(list);</span><br><span class="line">			<span class="keyword">return</span> sum / count;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">			sum += <span class="built_in">va_arg</span>(list, <span class="keyword">int</span>);</span><br><span class="line">			++count;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">			sum += <span class="built_in">va_arg</span>(list, <span class="keyword">double</span>);</span><br><span class="line">			++count;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">findAverage</span>(<span class="string">&quot;iiiii&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">findAverage</span>(<span class="string">&quot;iiiiii&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">findAverage</span>(<span class="string">&quot;iiddi&quot;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3.5</span>, <span class="number">4.5</span>, <span class="number">5</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥å¾ˆå¥½ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µæˆ‘ä»¬å®Œå…¨æœ‰å…¶å®ƒåˆç†çš„è§£å†³æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼š<strong>ä¸ºä»€ä¹ˆä¸å°†<code>...</code> æ¢æˆä¸€ä¸ªæ•°ç»„</strong>ï¼Ÿ</p>
</li>
<li>
<p><strong>æ¢æˆå…¶å®ƒæ–¹æ¡ˆï¼šåŠ¨æ€æ•°ç»„</strong></p>
<p>ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬éƒ½è¦é¿å…ä½¿ç”¨çœç•¥å·ï¼Œé€‰æ‹©å…¶å®ƒçš„æ–¹æ¡ˆã€‚æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¼ é€’ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">findAverage</span><span class="params">(<span class="keyword">int</span> len, <span class="keyword">int</span>* nums)</span></span>;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h3 id="3-5-å‡½æ•°è¿”å›å€¼">3.5 å‡½æ•°è¿”å›å€¼</h3>
<p>åœ¨å‰é¢æˆ‘ä»¬å­¦ä¹ äº†<u>æŒ‰å€¼ã€å¼•ç”¨å’Œåœ°å€</u>å‘å‡½æ•°<strong>ä¼ é€’å‚æ•°</strong>ï¼Œå¦‚æœä½œä¸ºå‡½æ•°<strong>è¿”å›å€¼</strong>ä¼šæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ</p>
<ul>
<li>æŒ‰å€¼è¿”å›çš„æ˜¯<code>value</code>çš„å‰¯æœ¬ï¼Ÿ</li>
<li>æŒ‰æŒ‡é’ˆè¿”å›çš„æ˜¯<code>value</code>çš„åœ°å€ï¼Ÿå±€éƒ¨å˜é‡åœ¨é€€å‡ºå‡½æ•°è¢«é”€æ¯æ—¶ï¼Œå®ƒçš„åœ°å€ä¸æ˜¯æ²¡æœ‰äº†å—ï¼Ÿ</li>
<li>æŒ‰å¼•ç”¨è¿”å›çš„æ˜¯<code>value</code>çš„åˆ«åï¼Ÿå±€éƒ¨å˜é‡åœ¨é€€å‡ºå‡½æ•°è¢«é”€æ¯æ—¶ï¼Œåˆ«åè¿˜æœ‰ç”¨å—ï¼Ÿ</li>
</ul>
<p>è¯·çœ‹ä¸‹æ–‡åˆ†è§£ã€‚</p>
<h4 id="3-5-1-æŒ‰å€¼è¿”å›">3.5.1 æŒ‰å€¼è¿”å›</h4>
<p>å’ŒæŒ‰å€¼ä¼ å‚ä¸€æ ·ï¼ŒæŒ‰å€¼è¿”å›å¾ˆå®‰å…¨ï¼Œå› ä¸ºå®ƒ<strong>åªè¿”å›<code>value</code>çš„å‰¯æœ¬ï¼Œä¸ç”¨æ‹…å¿ƒè¿”å›ä¹‹å<code>value</code>å‘ç”Ÿä»€ä¹ˆå˜åŒ–</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">doubleValue</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value&#123; x * <span class="number">2</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span> value; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="built_in">doubleValue</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå®ƒçš„ç¼ºç‚¹ä¹Ÿå’ŒæŒ‰å€¼ä¼ å‚ä¸€è‡´ï¼Œè¿”å›å¤§å‹ç»“æ„æˆ–ç±»æ—¶å¾ˆæ…¢ã€‚ä¸€èˆ¬å¸Œæœ›å€¼ä¸è¢«ä¿®æ”¹æˆ–è€…è¿”å›å±€éƒ¨å˜é‡æ—¶ä½¿ç”¨å€¼ä¼ é€’ã€‚</p>
<p><strong>è¿”å›å±€éƒ¨å˜é‡ï¼Ÿå‡½æ•°è°ƒç”¨ç»“æŸæ—¶å±€éƒ¨å˜é‡ä¸å°±è¢«é”€æ¯äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½è¿”å›</strong>ï¼Ÿ</p>
<p>åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­æ˜¯å±€éƒ¨å˜é‡è¢«å‹åˆ°æ ˆä¸­ï¼Œå½“å‡½æ•°é€€å‡ºæ—¶ï¼Œä¸´æ—¶å˜é‡å‡ºæ ˆï¼Œç¡®å®å·²ç»è¢«é”€æ¯ã€‚</p>
<p><strong>ä½†å±€éƒ¨å˜é‡ä½œä¸ºè¿”å›å€¼æ—¶åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œæœ‰äº›ç‰¹åˆ«çš„å˜åŒ–</strong>ã€‚</p>
<ul>
<li>
<p>Cè¯­è¨€é‡Œè§„å®šï¼š16bitç¨‹åºä¸­ï¼Œè¿”å›å€¼ä¿å­˜åœ¨axå¯„å­˜å™¨ä¸­ï¼Œ32bitç¨‹åºä¸­ï¼Œè¿”å›å€¼ä¿æŒåœ¨eaxå¯„å­˜å™¨ä¸­ï¼Œå¦‚æœæ˜¯64bitè¿”å›å€¼ï¼Œedxå¯„å­˜å™¨ä¿å­˜é«˜32bitï¼Œeaxå¯„å­˜å™¨ä¿å­˜ä½32bitã€‚</p>
</li>
<li>
<p>ç”±æ­¤å¯è§ï¼Œå‡½æ•°è°ƒç”¨ç»“æŸåï¼Œ<strong>è¿”å›å€¼è¢«ä¸´æ—¶å­˜å‚¨åˆ°å¯„å­˜å™¨ä¸­</strong>ï¼Œå¹¶æ²¡æœ‰æ”¾åˆ°å †æˆ–æ ˆä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å†…å­˜æ²¡æœ‰å…³ç³»äº†ã€‚</p>
<p>ä¸‹å›¾çš„æ±‡ç¼–ä»£ç ä¹Ÿè¡¨æ˜äº†è¿™ä¸€ç‚¹ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220112002905629.png" alt="image-20220112002905629"></p>
</li>
</ul>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºå•¥ï¼šä¸Šè¿°ä»£ç valueè™½ç„¶ä½œä¸ºè¿”å›å€¼ä½†ä¹Ÿæ˜¯å±€éƒ¨å˜é‡ï¼Œå‡½æ•°è°ƒç”¨ç»“æŸæ—¶ï¼Œä¾æ—§æ­£ç¡®è¿”å›äº†å…¶å€¼ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥ç‰¹åˆ«å…³æ³¨ä¸€ä¸‹æŒ‰åœ°å€/å¼•ç”¨è¿”å›å±€éƒ¨å˜é‡çš„æƒ…å†µã€‚</p>
<h4 id="3-5-2-æŒ‰æŒ‡é’ˆè¿”å›">3.5.2 æŒ‰æŒ‡é’ˆè¿”å›</h4>
<p>å’ŒæŒ‰æŒ‡é’ˆä¼ é€’å‚æ•°ç±»ä¼¼ï¼ŒæŒ‰æŒ‡é’ˆè¿”å›çš„åªæ˜¯<strong>å°†<code>value</code> çš„åœ°å€å¤åˆ¶ä¸€ä»½è¿”å›</strong>ï¼Œæ‰€ä»¥é€Ÿåº¦å¾ˆå¿«ã€‚</p>
<ul>
<li>
<p><strong>å±é™©ï¼šè¿”å›å±€éƒ¨å˜é‡åœ°å€</strong></p>
<p>å±€éƒ¨å˜é‡åœ¨å‡½æ•°é€€å‡ºæ—¶å°±ä¼šè¢«é”€æ¯ï¼Œå¦‚æœå°è¯•è¿”å›å±€éƒ¨å˜é‡çš„åœ°å€ï¼Œè¿™ç§è¡Œä¸ºéå¸¸çš„å±é™©ï¼ˆåœ°å€å¯¹åº”çš„å†…å­˜å¯èƒ½å·²è¢«é‡Šæ”¾ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">doubleValue</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">int</span> d_value = i*<span class="number">2</span>;</span><br><span class="line">     <span class="keyword">return</span> &amp;d_value; <span class="comment">// è¿”å›å±€éƒ¨å˜é‡åœ°å€</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span>* p = <span class="built_in">doubleValue</span>(value);</span><br><span class="line">    cout&lt;&lt;*p&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220103143317023.png" alt="image-20220103143317023"></p>
<p>ç¼–è¯‘å™¨ï¼ˆVSCodeï¼‰ç»™å‡ºäº†è­¦å‘Šï¼Œè™½ç„¶è¾“å‡ºå€¼å¾ˆå¹¸è¿æ˜¯æ­£ç¡®çš„ã€‚ä½†è¿™æ˜¯å› ä¸ºå±€éƒ¨å˜é‡<code>d_value</code>å¯¹åº”æ ˆç©ºé—´è¿˜å­˜åœ¨æ²¡æœ‰è¢«é‡æ–°åˆ†é…ä½¿ç”¨ï¼Œé€šè¿‡åœ°å€è·å–åˆ°äº†æ­£ç¡®çš„å€¼ã€‚</p>
<p>å¾ˆæ˜¾ç„¶è¿™ç§åšæ³•å¾ˆå±é™©ï¼Œä½ å¹¶ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å°±è¿”å›çš„æ˜¯ä¸€ä¸ªåƒåœ¾å€¼ï¼Œå› æ­¤ä¸å»ºè®®ä½ å»å°è¯•ã€‚</p>
</li>
<li>
<p><strong>é‚£æŒ‰æŒ‡é’ˆè¿”å›è¿˜æœ‰ä»€ä¹ˆç”¨é€”å—</strong>ï¼Ÿ</p>
<p><strong>æŒ‰æŒ‡é’ˆè¿”å›å¸¸ç”¨äºå°†åŠ¨æ€å†…å­˜è¿”å›ç»™è°ƒç”¨è€…</strong>ï¼Œå› ä¸ºåŠ¨æ€åˆ†é…çš„å†…å­˜ä¸ä¼šåœ¨å‡½æ•°é€€å‡ºæ—¶è¢«é”€æ¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">allocateArray</span><span class="params">(<span class="keyword">int</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">int</span>[size]; <span class="comment">// åŠ¨æ€åˆ†é…ç©ºé—´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span>* array&#123; <span class="built_in">allocateArray</span>(<span class="number">25</span>) &#125;;</span><br><span class="line">    <span class="keyword">delete</span>[] array;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡ï¼Œåˆ†é…ç©ºé—´ï¼ˆnew[]ï¼‰å’Œåˆ é™¤ç©ºé—´ï¼ˆdelete[]ï¼‰åœ¨ä»£ç ä¸åŒçš„å‡½æ•°ä¸­ï¼Œä½¿å¾—è°è´Ÿè´£åˆ é™¤èµ„æºå’Œæ˜¯å¦éœ€è¦åˆ é™¤èµ„æºå˜å¾—æœ‰ç‚¹éš¾ä»¥ç†è§£ã€‚</p>
<p>è¿™é‡Œæ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆï¼Œç¬¬äºŒç« æœ‰ç›¸å…³ä»‹ç»ã€‚</p>
<p><strong>å¦å¤–ä¸€ä¸ªç”¨é€”å°±æ˜¯è¿”å›æŒ‰åœ°å€ä¼ é€’çš„å‚æ•°</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">doubleValue</span><span class="params">(<span class="keyword">int</span>* p_i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     *p_i = (*p_i)*<span class="number">2</span>;</span><br><span class="line">     <span class="keyword">return</span> p_i; <span class="comment">// è¿”å›æŒ‡é’ˆå‚æ•°p_i</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span>* p = <span class="built_in">doubleValue</span>(&amp;value);</span><br><span class="line">    cout&lt;&lt;p&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>ä¸è¯´è¯´è¿”å›åœ°å€å…¶å®ƒç”¨é€”å—</strong>ï¼Ÿ</p>
<p>æ—¢ç„¶æåˆ°è¿”å›åœ°å€å¾ˆå¿«ï¼Œé‚£ç”¨æ¥è¿”å›ç»“æ„ä½“ã€ç±»ä¸åº”è¯¥å¾ˆå¥½å—ï¼Ÿç„¶è€Œå¹¶ä¸æ˜¯ã€‚é“ç†åŒå‚æ•°ä¼ é€’ä¸­å°½é‡å»ºè®®ä½¿ç”¨å¼•ç”¨ä¸€æ ·ï¼š</p>
<ol>
<li>å¼•ç”¨æ›´å®‰å…¨ã€‚å¼•ç”¨ä¸€å®šä¼šè¢«åˆå§‹åŒ–ï¼Œä¸èƒ½ä¸ºç©ºã€‚</li>
<li>å¼•ç”¨æ•ˆç‡æ›´å¥½ã€‚æ¯”å¦‚å®ƒä¸ç”¨ç®¡ç†æŒ‡é’ˆææ„é‡Šæ”¾ä¹‹ç±»çš„é—®é¢˜ã€‚</li>
</ol>
</li>
</ul>
<h4 id="3-5-3-æŒ‰å¼•ç”¨è¿”å›">3.5.3 æŒ‰å¼•ç”¨è¿”å›</h4>
<p>ä¸æŒ‰æŒ‡é’ˆè¿”å›ç±»ä¼¼ï¼ŒæŒ‰å¼•ç”¨è¿”å›çš„å€¼ä¸èƒ½æ˜¯å±€éƒ¨å˜é‡ã€‚</p>
<ul>
<li>
<p><strong>å±é™©ï¼šä¸è¦è¿”å›å±€éƒ¨å¼•ç”¨</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>&amp; <span class="title">doubleValue</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">int</span> d_value = i*<span class="number">2</span>;</span><br><span class="line">     <span class="keyword">return</span> d_value;  <span class="comment">// è¿”å›å±€éƒ¨å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; ref = <span class="built_in">doubleValue</span>(value);</span><br><span class="line">    cout&lt;&lt;ref&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é“ç†åŒä¸ŠæŒ‰æŒ‡é’ˆè¿”å›ï¼Œé™¤éä½ æƒ³å“ªå¤©æ”¶åˆ°ä¸€ä¸ªå¯¹åƒåœ¾çš„å¼•ç”¨ã€‚</p>
</li>
<li>
<p><strong>ä»€ä¹ˆæ—¶å€™æŒ‰å¼•ç”¨è¿”å›</strong></p>
<p>é™¤äº†ä¸Šè¿°è¯´çš„æŒ‰å€¼è¿”å›ã€æŒ‰æŒ‡é’ˆè¿”å›çš„æƒ…å†µï¼Œå…¶å®ƒæ—¶å€™ä¸€èˆ¬éƒ½å»ºè®®æŒ‰å¼•ç”¨è¿”å›ã€‚</p>
<p><strong>æ¯”å¦‚è¿”å›å¤§å‹æ•°æ®ç»“æ„ã€ç±»ç­‰ï¼Œä»¥åŠè¿”å›æŒ‰å¼•ç”¨ä¼ é€’å‚æ•°æ—¶</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>&amp; <span class="title">doubleValue</span><span class="params">(<span class="keyword">int</span>&amp; i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     i = i*<span class="number">2</span>;</span><br><span class="line">     <span class="keyword">return</span> i;    <span class="comment">// è¿”å›æŒ‰å¼•ç”¨ä¼ é€’çš„å‚æ•°i</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> value = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; ref = <span class="built_in">doubleValue</span>(value);</span><br><span class="line">    cout&lt;&lt;ref&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-5-4-å°ç»“">3.5.4 å°ç»“</h4>
<p><strong>ç¼–ç æ—¶é€‰æ‹©ä½•ç§æ–¹å¼è¿”å›å‚æ•°</strong>ï¼Ÿ</p>
<p>å’Œé€‰æ‹©ä½•ç§æ–¹å¼ä¼ é€’å‚æ•°å¾ˆåƒï¼š</p>
<ol>
<li>ä¸æƒ³ä¿®æ”¹<code>value</code>å°±æ˜¯æƒ³è¿”å›<code>value</code>ä¸€ä¸ªå‰¯æœ¬ï¼Œorè¿”å›å±€éƒ¨å˜é‡ï¼ˆè§ä¸‹èŠ‚è¿°ï¼‰ç”¨å€¼ä¼ é€’ï¼Œå¦åˆ™è½¬ä¸‹ä¸€æ­¥ï¼›</li>
<li>éœ€è¦åŠ¨æ€å†…å­˜åˆ†é…æ—¶ã€è¿”å›æŒ‰åœ°å€ä¼ é€’çš„å‚æ•°ï¼Œé€‰æ‹©åœ°å€ä¼ é€’ï¼Œå¦åˆ™è½¬ä¸‹ä¸€æ­¥ï¼›</li>
<li>å…¶å®ƒæƒ…å†µï¼Œä¸€èˆ¬é€‰ç”¨å¼•ç”¨ä¼ é€’ï¼ˆè¿”å¤§å‹ç»“æ„ä½“ã€ç±»ã€æŒ‰å¼•ç”¨ä¼ é€’çš„å‚æ•°ï¼‰ã€‚</li>
</ol>
<h4 id="3-5-5-è¿”å›å¤šä¸ªå€¼">3.5.5 è¿”å›å¤šä¸ªå€¼</h4>
<p>åœ¨<u>3.4.3</u> ä»‹ç»äº†ä½¿ç”¨åœ°å€ä¼ é€’å‚æ•°ï¼Œè¾¾åˆ°ç±»ä¼¼è¿”å›å¤šä¸ªå‚æ•°çš„æ•ˆæœã€‚ä½†æ˜¯è¿™ç§åšæ³•æ¯”è¾ƒåˆ«æ‰­ï¼Œä¹Ÿä¸å¤Ÿä¼˜é›…ã€‚C++æœ‰ä¸¤ç§æ¯”è¾ƒå¥½çš„æ–¹å¼ï¼š</p>
<ol>
<li>
<p><strong>ä½¿ç”¨ç»“æ„ä½“</strong></p>
<p>å°†è¦è¿”å›çš„å¤šä¸ªå‚æ•°å®šä¹‰ä¸ºä¸€ä¸ªç»“æ„ä½“ï¼Œæœ€åç›´æ¥è¿”å›ç»“æ„ä½“ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">S</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> m_x;</span><br><span class="line">	<span class="keyword">double</span> m_y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">S <span class="title">add</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	S s;</span><br><span class="line">	s.m_x++;</span><br><span class="line">	s.m_y++;</span><br><span class="line">	<span class="keyword">return</span> s;  <span class="comment">// å€¼ä¼ é€’ï¼Œå¤åˆ¶ä¸€ä¸ªsçš„å‰¯æœ¬è¿”å›</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	S s = <span class="built_in">add</span>();</span><br><span class="line">	cout &lt;&lt; s.m_x &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; s.m_y &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç›¸æ¯”è¿”å›æ•°ç»„ï¼Œç»“æ„ä½“å…è®¸å®šä¹‰æ›´å¤šç±»å‹çš„å€¼ï¼Œæ˜¾ç„¶æ›´çµæ´»ã€‚å…ƒç»„ <code>std::tuple</code> ä¹Ÿå¯ä»¥å®šä¹‰ä¸åŒç±»å‹å…ƒç´ åºåˆ—ã€‚</p>
</li>
<li>
<p><strong>ä½¿ç”¨å…ƒç»„</strong></p>
<p>è§ä¸‹ä¾‹ï¼Œä½¿ç”¨å…ƒç»„è¿”å›å¤šä¸ªä¸åŒç±»å‹çš„å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">tuple&lt;<span class="keyword">int</span>, <span class="keyword">double</span>&gt; <span class="title">returnTuple</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> &#123; <span class="number">5</span>, <span class="number">6.7</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	tuple s&#123; <span class="built_in">returnTuple</span>() &#125;; </span><br><span class="line">	cout &lt;&lt; get&lt;<span class="number">0</span>&gt;(s) &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; get&lt;<span class="number">1</span>&gt;(s) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>; </span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="3-6-å†…è”å‡½æ•°">3.6 å†…è”å‡½æ•°</h3>
<p>å‡½æ•°ç»™æˆ‘ä»¬æä¾›äº†éå¸¸å¤šæœ‰ç”¨çš„åŠŸèƒ½ï¼š</p>
<ul>
<li>ä»£ç å¯ä»¥é‡å¤ä½¿ç”¨ï¼›</li>
<li>æä¾›ç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿å‚æ•°ç±»å‹åŒ¹é…ï¼ˆç±»ä¼¼å‡½æ•°çš„å®ä¸ä¼šï¼‰ï¼›</li>
<li>ä¾¿äºé˜…è¯»ã€è°ƒè¯•ï¼›</li>
<li>â€¦</li>
</ul>
<h4 id="3-6-1-é‚£å‡½æ•°æœ‰ä»€ä¹ˆç¼ºç‚¹å—ï¼Ÿ">3.6.1 é‚£å‡½æ•°æœ‰ä»€ä¹ˆç¼ºç‚¹å—ï¼Ÿ</h4>
<p>å‡½æ•°çš„ä¸€ä¸ªä¸»è¦ç¼ºç‚¹æ˜¯æ¯æ¬¡<strong>è°ƒç”¨å‡½æ•°</strong>æ—¶ï¼Œéƒ½ä¼šå‘ç”Ÿä¸€å®šé‡çš„æ€§èƒ½å¼€é”€ï¼ˆä¸­æ–­ç­‰ï¼‰ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>CPU å¿…é¡»å­˜å‚¨å®ƒæ­£åœ¨æ‰§è¡Œçš„å½“å‰æŒ‡ä»¤çš„åœ°å€ï¼ˆå› æ­¤å®ƒçŸ¥é“ç¨åè¿”å›åˆ°å“ªé‡Œï¼‰ä»¥åŠå…¶ä»–å¯„å­˜å™¨ï¼›</li>
<li>å¿…é¡»åˆ›å»ºæ‰€æœ‰å‡½æ•°å‚æ•°å¹¶èµ‹å€¼ï¼Œå¹¶ä¸”ç¨‹åºå¿…é¡»è·³è½¬åˆ°æ–°ä½ç½®ï¼›</li>
<li>â€¦</li>
</ol>
<p>å½“ç„¶ï¼Œ<strong>å¯¹äºå¤§å‹å¤æ‚çš„å‡½æ•°ï¼Œå‡½æ•°è°ƒç”¨æ—¶é—´ç›¸æ¯”å‡½æ•°è¿è¡Œæ—¶é—´å¾®ä¸è¶³é“ã€‚ä½†æ˜¯å¯¹äºæ¯”è¾ƒè½»å·§çš„å‡½æ•°ï¼Œè‹¥æ˜¯é¢‘ç¹è°ƒç”¨ï¼Œå‡½æ•°è°ƒç”¨çš„æ—¶é—´ä¾¿å¾ˆå¯è§‚äº†</strong>ã€‚</p>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›è½»å·§åˆè¢«ç»å¸¸è°ƒç”¨çš„å‡½æ•°ï¼Œæœ€å¥½ä¸å¥½è¿›è¡Œè¿™äº›å¤æ‚è°ƒç”¨ã€è¿”å›æ“ä½œã€‚</p>
<p>å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿç±»ä¼¼äºé¢„ç¼–è¯‘å¤´æ–‡ä»¶çš„æ›¿æ¢ï¼Œç›´æ¥æŠŠ<strong>å‡½æ•°ä½“åµŒå…¥åˆ°æ¯ä¸€ä¸ªè°ƒç”¨äº†å®ƒçš„åœ°æ–¹ï¼Œé‡å¤åœ°åµŒå…¥</strong>ã€‚</p>
<p>è¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">min</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &gt; y ? y : x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">min</span>(<span class="number">5</span>, <span class="number">6</span>) ;</span><br><span class="line">    <span class="built_in">min</span>(<span class="number">3</span>, <span class="number">2</span>) ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>min(int,int)</code> è¢«å£°æ˜ä¸ºå†…è”å‡½æ•°ã€‚åœ¨ç¼–è¯‘æ—¶ï¼Œç›¸å½“ç›´æ¥åœ¨ç›¸åº”è°ƒç”¨ä½ç½®æ›¿æ¢ä¸ºå®é™…<code>min(int,int)</code>å‡½æ•°ä½“ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">5</span> &gt; <span class="number">6</span> ? <span class="number">6</span> : <span class="number">5</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span> &gt; <span class="number">2</span> ? <span class="number">2</span> : <span class="number">3</span> ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å°é—®é¢˜ï¼šå†…è”å‡½æ•°è¿™ä¹ˆæ£’ï¼Œé‚£æŠŠæ‰€æœ‰çš„å‡½æ•°å†™æˆå†…è”å‡½æ•°?</p>
</blockquote>
<p>å†…è”å‡½æ•°ä»¥ä»£ç å¤æ‚ä¸ºä»£ä»·ï¼Œå®ƒä»¥çœå»å‡½æ•°è°ƒç”¨çš„å¼€é”€æ¥æé«˜æ‰§è¡Œæ•ˆç‡ã€‚</p>
<ul>
<li><strong>åªé€‚åˆæ¯”è¾ƒç®€å•çš„å‡½æ•°</strong>ã€‚æ‰€ä»¥ä¸€æ–¹é¢å¦‚æœå†…è”å‡½æ•°ä½“å†…ä»£ç æ‰§è¡Œæ—¶é—´ç›¸æ¯”å‡½æ•°è°ƒç”¨å¼€é”€è¾ƒå¤§ï¼Œåˆ™æ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰ï¼›</li>
<li><strong>å ç”¨å†…å­˜ç©ºé—´å¤š</strong>ã€‚å¦ä¸€æ–¹é¢æ¯ä¸€å¤„å†…è”å‡½æ•°çš„è°ƒç”¨éƒ½è¦å¤åˆ¶ä»£ç ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ç©ºé—´ã€‚</li>
</ul>
<p>å…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ç­–ç•¥ã€‚</p>
<h4 id="3-6-2-å†…è”å‡½æ•°ä»€ä¹ˆæ—¶å€™è¢«æ›¿æ¢ï¼Ÿ">3.6.2 å†…è”å‡½æ•°ä»€ä¹ˆæ—¶å€™è¢«æ›¿æ¢ï¼Ÿ</h4>
<p>åœ¨å‰é¢æˆ‘ä»¬çŸ¥é“ï¼Œå®ä¼šç”±é¢„å¤„ç†å™¨å¯¹å®è¿›è¡Œæ›¿ä»£ï¼ˆé¢„ç¼–è¯‘é˜¶æ®µï¼‰ã€‚è€Œå†…è”å‡½æ•°ä¹Ÿä¼šé€šè¿‡ç¼–è¯‘å™¨æ¥å®ç°å±•å¼€æ›¿æ¢ï¼ˆç¼–è¯‘é˜¶æ®µï¼‰ã€‚</p>
<blockquote>
<p>ä¸ºäº†æ›´å¥½åœ°éªŒè¯æ‰€å­¦ï¼Œæˆ‘ä»¬é€šè¿‡åæ±‡ç¼–æ¥å¯¹æ¯”åŠ ä¸Š<code>inline</code>å‰åä»£ç çš„ä¸åŒä¹‹å¤„å¯¹æ¯”ã€‚</p>
</blockquote>
<p>å‡†å¤‡ä¸€ä¸ªæ›´ç®€å•çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span>  <span class="title">add</span><span class="params">(<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    y++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">add</span>(x);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶åè¿›è¡Œåæ±‡ç¼–ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">g++ -save-temps -fverbose-asm -g  test.cpp -o test.out</span><br><span class="line">objdump -S --disassemble test.out</span><br></pre></td></tr></table></figure>
<p>å…³é”®æ€§ä»£ç æˆªå›¾å¦‚ä¸‹ï¼š</p>
<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220103183107580.png" alt="image-20220103183107580" style="zoom:80%;" />
<p>å¯ä»¥çœ‹åˆ°<code>main</code> <strong>å‡½æ•°ä½“å†…</strong>è¢«ç›´æ¥æ’å…¥äº†<code>add</code>å‡½æ•°çš„ä»£ç ï¼ˆç»¿è‰²æ¡†ï¼‰ã€‚</p>
<p>ä½†æ˜¯å¦‚æœ<code>add</code>å‡½æ•°æ˜¯éå†…è”å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é˜²æ­¢ç¼–è¯‘å™¨è‡ªå·±ä¼˜åŒ–ï¼Œå¼ºåˆ¶å£°æ˜ä¸ºéå†…è”å‡½æ•°</span></span><br><span class="line"><span class="keyword">int</span> __attribute__ ((noinline)) <span class="built_in">add</span>(<span class="keyword">int</span> y)</span><br></pre></td></tr></table></figure>
<p>åæ±‡ç¼–ç»“æœå¦‚å›¾æ‰€ç¤ºï¼Œ<code>add</code>å‡½æ•°ä»£ç å¹¶æ²¡æœ‰æ’å…¥åˆ°<code>main</code>å‡½æ•°ä½“å†…ã€‚</p>
<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220103183933062.png" alt="image-20220103183933062" style="zoom:80%;" />
<h4 id="3-6-3-å†…è”å‡½æ•°å’Œå®å¯¹æ¯”">3.6.3 å†…è”å‡½æ•°å’Œå®å¯¹æ¯”</h4>
<p>ä¸€ä¸ªå¸¸è€ƒçš„é¢è¯•é¢˜ï¼ŒåŠ æ·±ä¸‹å°è±¡ã€‚</p>
<ol>
<li><strong>æ›¿æ¢æ—¶æœº</strong>ã€‚å®åœ¨é¢„ç¼–è¯‘æ—¶è¢«æ›¿æ¢ï¼Œå†…è”å‡½æ•°æ˜¯åœ¨è¿è¡Œæ—¶ï¼ˆè‡³å°‘ä¸æ˜¯é¢„ç¼–è¯‘æ—¶ï¼‰ï¼›</li>
<li><strong>è°ƒè¯•</strong>ã€‚å†…è”å‡½æ•°åœ¨è¿è¡Œæ—¶å¯è°ƒè¯•ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥;</li>
<li><strong>å®‰å…¨</strong>ã€‚ç¼–è¯‘å™¨ä¼šå¯¹å†…è”å‡½æ•°çš„å‚æ•°ç±»å‹åšå®‰å…¨æ£€æŸ¥æˆ–è‡ªåŠ¨ç±»å‹è½¬æ¢ï¼ˆåŒæ™®é€šå‡½æ•°ï¼‰ï¼Œè€Œå®å®šä¹‰åˆ™ä¸ä¼šï¼›</li>
<li><strong>è®¿é—®</strong>ã€‚å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œå®å®šä¹‰åˆ™ä¸èƒ½ã€‚</li>
</ol>
<h3 id="3-7-å‡½æ•°æŒ‡é’ˆ">3.7 å‡½æ•°æŒ‡é’ˆ</h3>
<h4 id="3-7-1-å‡½æ•°å’ŒæŒ‡é’ˆ">3.7.1 å‡½æ•°å’ŒæŒ‡é’ˆ</h4>
<p>åœ¨å‰ä¸€èŠ‚ï¼Œé€šè¿‡åæ±‡ç¼–ï¼Œä½ ä¹Ÿçœ‹åˆ°äº†ï¼ˆåœ¨<code>main</code>å‡½æ•°ä¸­ï¼‰è°ƒç”¨ï¼ˆ<code>add</code>ï¼‰å‡½æ•°æ˜¯é€šè¿‡ä¸€ä¸ªåœ°å€ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">callq 40052d&lt;_Z3addi&gt;</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ <code>40052d</code> ä¾¿æ˜¯å‡½æ•°<code>add</code> çš„åœ°å€ã€‚è®©æˆ‘ä»¬å°è¯•æ‰“å°ä¸€ä¸‹å‡½æ•°åœ°å€ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// å¦‚æœä½ çš„ç¼–è¯‘å™¨æ‰“å°å‡ºæ¥çš„åœ°å€æ˜¯1</span></span><br><span class="line">   <span class="comment">// éœ€è¦è½¬æ¢ä¸ºç©ºæŒ‡é’ˆï¼Œå¼ºåˆ¶ç¼–è¯‘å™¨æ‰“å°å‡ºåœ°å€ï¼š(void*)func</span></span><br><span class="line">   cout&lt;&lt;func&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x4007ad</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå°±åƒæŒ‡é’ˆä¸€æ ·ï¼Œ<code>func</code> ä¿å­˜çš„ä¹Ÿæ˜¯ä¸€ä¸ªåœ°å€ï¼Œåªä¸è¿‡å®ƒä¿å­˜çš„æ˜¯å‡½æ•°åœ°å€ã€‚<strong>æœ‰å‡½æ•°åœ°å€å°±å¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œæ­¤æ—¶å¯å°†å‡½æ•°å‹å…¥æ ˆ</strong>ï¼ˆ3.8èŠ‚è¯¦è¿°ï¼‰ã€‚</p>
<p>åƒæŒ‡é’ˆä¸€æ ·ï¼Ÿé‚£ä¹ˆå¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œä½¿ç”¨<code>int*</code>æŒ‡é’ˆä¿å­˜å‡½æ•°æŒ‡é’ˆå—ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* p_func = func;</span><br><span class="line"><span class="built_in">p_func</span>(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>å¾ˆä¸å¹¸æŠ¥é”™äº†ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220104223733205.png" alt="image-20220104223733205"></p>
<p>ä¸»è¦åŸå› æ˜¯å› ä¸ºï¼šè™½ç„¶<code>func</code> å’Œ<code>p_func</code>éƒ½æ˜¯æŒ‡é’ˆï¼Œä½†å®ƒä»¬ç±»å‹æ˜¯ä¸ä¸€æ ·çš„ã€‚å‡½æ•°<code>func</code> ç±»å‹æ˜¯<code>int(*)()</code> ,è€Œæˆ‘ä»¬ç»™å‡ºçš„æŒ‡é’ˆ<code>p_func</code>ç±»å‹æ˜¯<code>int*</code> ï¼Œæ— æ³•èµ‹å€¼ã€‚å°±åƒä½ ä¸èƒ½å°†<code>string*</code> ç±»å‹æŒ‡é’ˆèµ‹å€¼ç»™<code>int*</code> ç±»å‹æŒ‡é’ˆã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è‡³å°‘è¿˜å¾—è®©ä»–ä»¬å‚æ•°ç±»å‹ä¸€è‡´ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">int</span></span> (*p_func)() = func;</span><br><span class="line"><span class="built_in">p_func</span>(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>ä¾æ—§æŠ¥é”™äº†ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220104224700403.png" alt="image-20220104224700403"></p>
<p>è¿™æ˜¯å› ä¸º<u>å‡½æ•°æŒ‡é’ˆ<code>p_func</code>çš„ç±»å‹å‚æ•°å’Œå‡½æ•°<code>func</code>ä¸ä¸€è‡´</u>ï¼Œç¼–è¯‘å™¨ç±»å‹æ£€æŸ¥æ—¶å‡ºé”™ã€‚</p>
<blockquote>
<p>é¢˜å¤–è¯ï¼šä¸ºä»€ä¹ˆæ˜¯åœ¨è¿è¡Œæ—¶æŠ¥é”™ï¼Œè€Œä¸åœ¨ç¼–è¯‘ä»£ç æ—¶æŠ¥é”™ï¼Ÿ</p>
<p>å› ä¸ºå‡½æ•°æŒ‡é’ˆæ˜¯åœ¨è¿è¡Œæ—¶æ‰ä¼šè¿›è¡Œè§£æã€‚</p>
</blockquote>
<p>æˆ‘ä»¬è¿˜åº”è¯¥æŒ‡å®šå…¶å‚æ•°ç±»å‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">int</span></span> (*p_func)(<span class="keyword">int</span>) = func;</span><br><span class="line"><span class="built_in">p_func</span>(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸€åˆ‡åˆ°æ­¤å°±å¥½èµ·æ¥äº†ã€‚<code>p_func</code>æ­¤æ—¶è·å¾—äº†å‡½æ•°çš„åœ°å€ï¼Œå°±å¯ä»¥åƒ<code>func</code>ä¸€æ ·ä½¿ç”¨äº†ã€‚</p>
<p>ç‰¹åˆ«çš„ä¸‹é¢è¿™ç§æ–¹å¼ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">int</span></span> (*p_func)(<span class="keyword">int</span>) = &amp;func; <span class="comment">// å‡½æ•°åå¤šäº†ä¸ª&amp;ï¼Œfuncå’Œ&amp;funcæ‰“å°å‡ºæ¥å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å‡½æ•°åœ°å€</span></span><br><span class="line"><span class="built_in">p_func</span>(<span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<h4 id="3-7-2-ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°æŒ‡é’ˆï¼šå›è°ƒå‡½æ•°">3.7.2 ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°æŒ‡é’ˆï¼šå›è°ƒå‡½æ•°</h4>
<p>è™½ç„¶ï¼Œå‰é¢æˆ‘ä»¬äº†è§£äº†æ€ä¹ˆå®šä¹‰å’Œä½¿ç”¨å‡½æ•°æŒ‡é’ˆã€‚ä½†ä¸ç¦è¿˜æ˜¯æœ‰ç–‘æƒ‘ï¼š<strong>ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ<code>p_func</code> è°ƒç”¨å‡½æ•°<code>func</code>ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Ÿç›´æ¥ä½¿ç”¨<code>func</code>ä¸å°±å¥½äº†</strong>ï¼Ÿ</p>
<p>æƒ³è±¡è¿™ä¹ˆä¸€ç§æƒ…å†µï¼š</p>
<ul>
<li>ä½ æœ‰ä¸€ä¸ªå‡½æ•°å‡å®šä¸º<code>funcA</code> , ä½†ä½ çš„åŠŸèƒ½éœ€è¦å¤–éƒ¨è‡ªå®šä¹‰ä¸€äº›è§„åˆ™ï¼Œè¿™äº›è§„åˆ™ç”¨æˆ·è‡ªå®šä¹‰çš„ï¼›</li>
<li>æ‰€ä»¥ä½ éœ€è¦ä¸€ä¸ªâ€œå‚æ•°â€æ¥ä¿å­˜è¿™äº›ç‰¹å®šçš„è§„åˆ™ï¼Œè€Œè¿™ä¸ªè§„åˆ™æ˜¾ç„¶æ˜¯ä¸€ä¸ªé€»è¾‘é›†åˆâ€”â€”æ¢å¥è¯ï¼Œå®ƒåº”è¯¥æ˜¯ä¸ªå‡½æ•°ã€‚</li>
</ul>
<p>é‚£ä¹ˆè¿™ä¸ªâ€œå‚æ•°â€æ˜¯ä¸æ˜¯åº”è¯¥æ˜¯å‡½æ•°ç±»å‹ï¼ŸæŸä¸ªå‡½æ•°å¦‚æœä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ˜¯<strong>å›è°ƒå‡½æ•°</strong>ã€‚</p>
<p>æˆ‘ä»¬ä¸¾ä¸€ä¸ªæ›´å…·ä½“çš„ä¾‹å­ï¼š</p>
<ul>
<li>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ’åºå‡½æ•°ï¼Œå°†æ•°å­—è¿›è¡Œæ’åºï¼šä½†æ’åºçš„è§„åˆ™ç”±ç”¨æˆ·è‡ªå®šä¹‰ï¼Œå®ƒå¯èƒ½æ˜¯ä»å¤§åˆ°å°æ’åˆ—ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»å°åˆ°å¤§æˆ–è€…å…¶å®ƒâ€”â€”æ€»ä¹‹å®ƒå–å†³äºç”¨æˆ·æ€ä¹ˆå®šä¹‰â€œè§„åˆ™â€ã€‚</li>
</ul>
<p>æˆ‘ä»¬ç»™å®šä¸€ä¸ªæ’åºå‡½æ•°å¦‚ä¸‹ï¼Œå®ƒæœ‰ä¸€ä¸ªå‚æ•°<code>bool (*comparisonFcn)(int, int)</code>ç”¨æ¥å®šä¹‰æ’åºè§„åˆ™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº¤æ¢æ•°ç»„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* arr,<span class="keyword">int</span> idx_i,<span class="keyword">int</span> idx_j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = arr[idx_i];</span><br><span class="line">    arr[idx_i] = arr[idx_j];</span><br><span class="line">    arr[idx_j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰æ’åºè§„åˆ™</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">myCompare</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†’æ³¡æ’åº</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> len, <span class="keyword">bool</span> (*compare)(<span class="keyword">int</span>,<span class="keyword">int</span>))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)   <span class="comment">// å¤–è½®=n-1</span></span><br><span class="line">        <span class="comment">// * j=0,æ¯æ¬¡éƒ½æ˜¯ä»å¤´å¼€å§‹æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt; len-i<span class="number">-1</span>; j++ ) <span class="comment">// å†…è½®=ä½™ä¸‹ä¹±åºæ•°-1</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">compare</span>(arr[j],arr[j+<span class="number">1</span>]))</span><br><span class="line">                <span class="built_in">swap</span>(arr,j,j+<span class="number">1</span>); </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> array[] = &#123;<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>&#125;;</span><br><span class="line">   <span class="keyword">int</span> len = <span class="built_in"><span class="keyword">sizeof</span></span>(array)/<span class="built_in"><span class="keyword">sizeof</span></span>(array[<span class="number">0</span>]);</span><br><span class="line">   <span class="built_in">bubbleSort</span>(array,len,myCompare);</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len  ;i++)</span><br><span class="line">       cout&lt;&lt;array[i]&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">4</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç„¶è¿™ç§æ–¹å¼ï¼Œä¼˜é›…ä¸”çµæ´»ï¼Œ<u>é™¤äº†å®šä¹‰çš„å‡½æ•°æŒ‡é’ˆå®åœ¨è¿‡äºä¸‘é™‹</u>ã€‚å½“ç„¶åœ¨ä¸Šè¿°<code>myCompare</code> å‡½æ•°ä¸­ï¼Œä½ ç”šè‡³å¯ä»¥å®šä¹‰ä¸€äº›å¥‡æ€ªçš„è§„åˆ™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">myCompare2</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">if</span> ((a % <span class="number">2</span> == <span class="number">0</span>) &amp;&amp; !(b % <span class="number">2</span> == <span class="number">0</span>))</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥å°è¯•è¾“å‡ºè¯•ä¸€è¯•ã€‚</p>
<h4 id="3-7-3-æ›´ä¼˜é›…åœ°ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ">3.7.3 æ›´ä¼˜é›…åœ°ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ</h4>
<p>å‰é¢æˆ‘ä»¬æåˆ°ï¼Œå‡½æ•°æŒ‡é’ˆçš„å£°æ˜å®åœ¨è¿‡äºä¸‘é™‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">bool</span></span> (*compare)(<span class="keyword">int</span>,<span class="keyword">int</span>);</span><br><span class="line"><span class="built_in"><span class="keyword">bool</span></span> (*)(<span class="keyword">int</span>,<span class="keyword">int</span>) compare;</span><br></pre></td></tr></table></figure>
<p>å¥½æ¶ˆæ¯ä½ ç°åœ¨æœ‰ä¸¤ç§æ–¹å¼è®©å®ƒçœ‹èµ·æ¥é¡ºçœ¼å¾ˆå¤šï¼š</p>
<h5 id="1-ç±»å‹åˆ«å">1. ç±»å‹åˆ«å</h5>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»å‹åˆ«å</span></span><br><span class="line"><span class="keyword">using</span>  bool_compare = <span class="built_in"><span class="keyword">bool</span></span>(*)(<span class="keyword">int</span>,<span class="keyword">int</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°ä¸­ä½¿ç”¨ï¼šå°±è¡Œä½¿ç”¨æ™®é€šçš„ç±»å‹ä¸€æ ·</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> len, bool_compare compare)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-function">2. function</h5>
<p>std::functionæ˜¯æ ‡å‡†åº“ <code>&lt;functional&gt;</code> å¤´æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†ä¹‹å‰çš„æ’åºå‡½æ•°ï¼Œé‡æ–°å®šä¹‰ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> len, std::function&lt;<span class="keyword">bool</span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt;)</span></span></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸»å‡½æ•°ä¸­ï¼Œå¦‚æ­¤è°ƒç”¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å…¶ä½™å‡½æ•°ä»£ç åŒå‰ï¼Œç•¥</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> array[] = &#123;<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>&#125;;</span><br><span class="line">   <span class="keyword">int</span> len = <span class="built_in"><span class="keyword">sizeof</span></span>(array)/<span class="built_in"><span class="keyword">sizeof</span></span>(array[<span class="number">0</span>]);</span><br><span class="line">   std::function&lt;<span class="built_in"><span class="keyword">bool</span></span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; compare = myCompare;</span><br><span class="line">   <span class="built_in">bubbleSort</span>(array,len,compare);</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len  ;i++)</span><br><span class="line">       cout&lt;&lt;array[i]&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">4</span><br><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h5 id="3-functionæ˜¯ä»€ä¹ˆï¼Ÿ">3. functionæ˜¯ä»€ä¹ˆï¼Ÿ</h5>
<p>æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„äº‹æƒ…ï¼Œå‡½æ•°å®šä¹‰å¿…é¡»è¦å’Œä¸»å‡½æ•°ä¸­ä¼ é€’çš„å‚æ•°ç±»å‹ä¸€è‡´ï¼ˆéƒ½æ˜¯<code>std::function</code>ï¼‰ï¼Œä¸èƒ½å®šä¹‰ä¸ºæŒ‡é’ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> len, <span class="keyword">bool</span>(*)(<span class="keyword">int</span>,<span class="keyword">int</span>) compare)</span></span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ è¿™ä¸ªæ—¶å€™è¿™æ ·è°ƒç”¨å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åœ¨mainä¸­</span></span><br><span class="line">std::function&lt;<span class="built_in"><span class="keyword">bool</span></span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; compare = myCompare;</span><br><span class="line"><span class="built_in">bubbleSort</span>(array,len,compare);</span><br></pre></td></tr></table></figure>
<p>ä¼šæŠ¥é”™ï¼š<code>error: cannot convert â€˜std::function&lt;bool(int, int)&gt;â€™ to â€˜bool (*)(int, int)â€™</code>ã€‚</p>
<p>å› ä¸º<code>std::function</code>æœ¬è´¨æ˜¯ä¸€ç§<strong>ç±»æ¨¡æ¿ï¼Œä¸æ˜¯å‡½æ•°</strong>ï¼Œæ˜¯å¯¹é€šç”¨ã€å¤šæ€çš„å‡½æ•°å°è£…ã€‚</p>
<ul>
<li>é€šè¿‡<code>std::function</code>å¯¹C++ä¸­å„ç§å¯è°ƒç”¨å®ä½“ï¼ˆæ™®é€šå‡½æ•°ã€Lambdaè¡¨è¾¾å¼ã€å‡½æ•°æŒ‡é’ˆã€ä»¥åŠå…¶å®ƒå‡½æ•°å¯¹è±¡ç­‰ï¼‰çš„å°è£…ï¼Œå½¢æˆä¸€ä¸ªstd::functionå¯¹è±¡ã€‚è®©æˆ‘ä»¬ä¸å†çº ç»“é‚£ä¹ˆå¤šçš„å¯è°ƒç”¨å®ä½“ï¼Œä¸€åˆ‡å˜çš„ç®€å•ç²—æš´ã€‚</li>
<li>æ¢å¥è¯è¯´ï¼Œ<code>std::function</code><strong>å°±æ˜¯å‡½æ•°çš„å®¹å™¨ï¼Œå®ƒè‡ªå·±æ˜¯ä¸ªç±»å¯¹è±¡</strong>ã€‚å½“æˆ‘ä»¬æœ‰äº†å‡½æ•°çš„å®¹å™¨ä¹‹åä¾¿èƒ½å¤Ÿ<strong>æ›´åŠ æ–¹ä¾¿çš„å°†å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆä½œä¸ºå¯¹è±¡è¿›è¡Œå¤„ç†</strong>ã€‚</li>
</ul>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„åŸå‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="class"><span class="keyword">class</span> <span class="title">R</span>, <span class="title">class</span>... <span class="title">Args</span> &gt;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">function</span>&lt;</span><span class="built_in">R</span>(Args...)&gt;</span><br></pre></td></tr></table></figure>
<p>ç±»ä¸ºfunctionï¼ŒRæ˜¯è¿”å›å€¼ç±»å‹ï¼ŒArgsæ˜¯å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚å†å›æƒ³æˆ‘ä»¬ä¹‹å‰çš„è°ƒç”¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::function&lt;<span class="built_in"><span class="keyword">bool</span></span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; compare = myCompare;</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œ<strong>æ­¤æ—¶<code>compare</code> æœ¬è´¨æ˜¯ä¸€ä¸ªfunctionç±»å¯¹è±¡ï¼Œåªä¸è¿‡é‡è½½äº†å…¶å‡½æ•°è°ƒç”¨æ“ä½œç¬¦()ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥åƒå‡½æ•°ä¸€æ ·è°ƒç”¨</strong>ã€‚</p>
<p>ç‰¹åˆ«çš„ï¼Œ<strong>functionç±»è¿˜é‡è½½äº†èµ‹å€¼æ“ä½œç¬¦=ï¼Œè¿™æ ·å¯ä»¥å°†å¯è°ƒç”¨çš„å‡½æ•°å®ä½“èµ‹å€¼ç»™å®ƒ</strong>ã€‚å…¶å‡½æ•°è°ƒç”¨æ“ä½œç¬¦é‡è½½å‡½æ•°é‡Œé—´æ¥çš„è°ƒç”¨èµ‹å€¼æ—¶ä¼ è¿›æ¥çš„è°ƒç”¨å®ä½“ã€‚</p>
<h5 id="4-ä½¿ç”¨auto">4. ä½¿ç”¨auto</h5>
<p>ä½¿ç”¨autoå…³é”®å­—è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¯æ›´ç®€ä¾¿åœ°ä½¿ç”¨å‡½æ•°æŒ‡é’ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> compare = myCompare;</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™<code>compare</code>éšè—äº†ç±»å‹å…·ä½“å®šä¹‰ï¼Œå¦‚æœå¸Œæœ›è¯»è€…æ›´äº†è§£è¿™æ®µä»£ç æ„ä¹‰ï¼Œä½¿ç”¨<code>typedef</code> åº”è¯¥æ˜¯ä¸ªæ›´å¥½çš„åšæ³•ã€‚</p>
<h4 id="3-7-4-CPUçœ¼ä¸­çš„å‡½æ•°æŒ‡é’ˆï¼šå˜é‡">3.7.4  CPUçœ¼ä¸­çš„å‡½æ•°æŒ‡é’ˆï¼šå˜é‡</h4>
<p>å»ç¹å½’çœŸï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹CPUçœ¼ä¸­çš„å‡½æ•°æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>ç­”æ¡ˆå¯èƒ½ä¼šè®©ä½ æƒŠå¥‡ï¼šå®ƒåœ¨CPUçœ¼ä¸­ä¸è¿‡æ˜¯ä¸€ä¸ªè¿‡åº¦åŒ…è£…çš„å˜é‡è€Œå·²ï¼Œå°±åƒæŒ‡é’ˆä¸€æ ·ä¹Ÿåªæ˜¯å˜é‡ã€‚</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.zhihu.com/zvideo/1433792635044048898">CPUçœ¼é‡Œçš„â€œå‡½æ•°æŒ‡é’ˆâ€ï¼šè¿‡åº¦åŒ…è£…çš„â€œå˜é‡â€ - é˜¿å¸ƒçš„è§†é¢‘ - çŸ¥ä¹ </a></p>
<h4 id="3-7-5-å°ç»“">3.7.5 å°ç»“</h4>
<ul>
<li>
<p><strong>ä»€ä¹ˆæ˜¯å‡½æ•°æŒ‡é’ˆ</strong>ï¼Ÿ</p>
<p>å‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘ç‰¹æ®Šçš„æ•°æ®ç±»å‹ï¼ˆå³å‡½æ•°ï¼‰çš„æŒ‡é’ˆå˜é‡ã€‚</p>
<ul>
<li>å‡½æ•°çš„åå­—ä¹Ÿå¯è§†ä¸ºæ˜¯å‡½æ•°çš„æŒ‡é’ˆï¼›</li>
<li>ä½¿ç”¨é‡è½½åçš„<code>()</code> å³<code>å‡½æ•°å()</code> ä¾¿æ˜¯è°ƒç”¨ä¸€ä¸ªå‡½æ•°ã€‚</li>
</ul>
<p>å®ƒåœ¨CPUçœ¼ä¸­ä¸è¿‡æ˜¯è¿‡åº¦åŒ…è£…çš„â€œå˜é‡â€ã€‚</p>
</li>
<li>
<p><strong>å‡½æ•°æŒ‡é’ˆçš„å£°æ˜&amp;èµ‹å€¼æ–¹å¼</strong>ï¼Ÿ</p>
<p>ä»¥ä¸‹ä¸ºä¾‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">int</span></span> (*p_func)(<span class="keyword">int</span>) = func </span><br><span class="line"><span class="built_in"><span class="keyword">int</span></span> (*p_func)(<span class="keyword">int</span>) = &amp;func</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>å‡½æ•°æŒ‡é’ˆçš„ç”¨é€”</strong>ï¼Ÿ</p>
<p>å‡½æ•°æŒ‡é’ˆè¿˜å…è®¸å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–å‡½æ•°ï¼Œå³å›è°ƒå‡½æ•°ã€‚</p>
</li>
</ul>
<h3 id="3-8-æ ˆå’Œå †ğŸŒŸ">3.8 æ ˆå’Œå †ğŸŒŸ</h3>
<p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ¥äº†è§£ç¨‹åºè¿è¡Œæ—¶ï¼Œå‡½æ•°è°ƒç”¨æ›´åº•å±‚çš„è¿‡ç¨‹ã€‚ä¸è¿‡åœ¨è¿™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹å†…å­˜å¸ƒå±€ã€‚</p>
<h4 id="3-8-1-å†…å­˜å¸ƒå±€">3.8.1 å†…å­˜å¸ƒå±€</h4>
<blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn></mrow><annotation encoding="application/x-tex">32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">32</span></span></span></span>ä½ç³»ç»Ÿ4GBï¼ˆ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>32</mn></msup><mo>=</mo><mn>4</mn><mi>G</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">2^{32}=4GB</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">32</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span></span></span></span>ï¼‰ã€‚</p>
</blockquote>
<p>ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªè™šæ‹Ÿè¿›ç¨‹ï¼ˆç¨‹åºï¼‰å†…å­˜ç©ºé—´<u>è¿è¡Œæ—¶</u>åˆ†å¸ƒå¸ƒå±€ï¼Œæ³¨æ„åˆ°æ­¤æ—¶è¿˜<u>å¤šäº†å †&amp;æ ˆç”¨æ¥ç»™ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œç©ºé—´åˆ†é…</u>ã€‚</p>
<ul>
<li>
<p><strong>ä¸€ä¸ªç¨‹åºï¼ˆæ¯”å¦‚hello.outï¼‰æœ¬è´¨æ˜¯ç”±æ•°æ®æ®µã€ä»£ç æ®µã€.bssæ®µï¼ˆå›¾ä¸­å’Œæ•°æ®æ®µåˆå¹¶äº†ï¼‰ä¸‰ä¸ªç»„æˆçš„ã€‚</strong></p>
</li>
<li>
<p>å¦å¤–ï¼Œé«˜åœ°å€çš„1GBï¼ˆWindowsé»˜è®¤2GBï¼‰ç©ºé—´åˆ†é…ç»™å†…æ ¸ï¼Œä¹Ÿç§°ä¸º<strong>å†…æ ¸ç©ºé—´</strong>ï¼›å‰©ä¸‹çš„3GBåˆ†ç»™ç”¨æˆ·ï¼Œä¹Ÿç§°<strong>ç”¨æˆ·ç©ºé—´</strong>ï¼ˆç¨‹åºä½¿ç”¨çš„ï¼‰ã€‚</p>
</li>
</ul>
<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/5e8d39d19a216fd03392d36081e70b7e.jpg" alt="ä½ ç¡®å®šä½ ç†è§£å†…å­˜åˆ†é…å—ï¼Ÿ" style="zoom:80%;" />
<p>ä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘ä»¬æ›´å…³æ³¨çš„æ˜¯ç”¨æˆ·ç©ºé—´ä¸­çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯ï¼š</p>
<ul>
<li>
<p><strong>æ ˆï¼ˆStack</strong>ï¼‰ï¼šå­˜å‚¨ä»£ç ä¸­è°ƒç”¨å‡½æ•°ã€å®šä¹‰<u><strong>å±€éƒ¨</strong>å˜é‡</u>(ä½†ä¸åŒ…å«staticä¿®é¥°çš„å˜é‡)ã€ä¿å­˜çš„ä¸Šä¸‹æ–‡ç­‰ï¼›</p>
<ul>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šå­˜æ”¾çš„æ•°æ®ä»<strong>æ ˆé¡¶ï¼ˆä½åœ°å€</strong>ï¼‰å‹å…¥ï¼Œä¹Ÿæ˜¯ä»<strong>æ ˆé¡¶ï¼ˆä½åœ°å€</strong>ï¼‰å¼¹å‡ºï¼Œæ‰€ä»¥æœ‰äººè¯´æ ˆæ˜¯<strong>å‘ä¸‹ç”Ÿé•¿</strong>çš„ã€‚å‡½æ•°é€€å‡ºæ—¶ï¼Œæ‰€æœ‰æ•°æ®ä¼šè‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼ˆå‡ºæ ˆï¼‰ã€‚</p>
<img src="https://pic1.zhimg.com/v2-4a47248b485bc764430e802f87ee950c_b.webp" alt="img" style="zoom:67%;" />
</li>
</ul>
</li>
<li>
<p><strong>æ–‡ä»¶æ˜ å°„åŒºåŸŸ ï¼š</strong> æ ˆå’Œå †ä¸­é—´é‚£ä¸ªç©ºç™½åŒºåŸŸã€‚åŠ¨æ€åº“ã€å…±äº«å†…å­˜ç­‰æ˜ å°„ç‰©ç†ç©ºé—´çš„å†…å­˜ï¼Œä¸€èˆ¬æ˜¯ <code>mmap</code> å‡½æ•°æ‰€åˆ†é…çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚</p>
</li>
<li>
<p><strong>å †ï¼ˆHeap</strong>ï¼‰ï¼šå­˜å‚¨é‚£äº›ç”Ÿå­˜æœŸ<u>ä¸å‡½æ•°è°ƒç”¨æ— å…³çš„æ•°æ®</u>ï¼Œå¦‚åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚å †ï¼ˆåŠ¨æ€ï¼‰åˆ†é…çš„æ¥å£é€šå¸¸æœ‰malloc()ã€calloc()ã€realloc()ã€newç­‰ã€‚</p>
<ul>
<li><strong>ç‰¹ç‚¹</strong>ï¼šç›¸å¯¹äºæ ˆï¼Œå †æ˜¯<strong>å‘ä¸Šç”Ÿé•¿</strong>çš„ï¼›å †ç©ºé—´éœ€è¦ä¸»åŠ¨é‡Šæ”¾ï¼Œå¦åˆ™ä¼šä¾ç„¶å­˜åœ¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>.bssæ®µ</strong>ï¼šå…¨ç§°Block Started by Symbolï¼Œä¹Ÿå°±æ˜¯æœªè¢«åˆå§‹åŒ–çš„<strong>å…¨å±€</strong>å˜é‡ã€<strong>é™æ€</strong>å˜é‡çš„å†…å®¹çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span>  <span class="keyword">int</span> a;  <span class="comment">// ä¿å­˜.bssæ®µ</span></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">2</span>;     <span class="comment">// å…¨å±€å˜é‡ï¼Œä¿å­˜åœ¨.bssæ®µ</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>æ•°æ®æ®µï¼ˆ.data</strong>ï¼‰ï¼šä¿å­˜<strong>å…¨å±€</strong>å˜é‡ã€<strong>å¸¸é‡</strong>ã€é™æ€å˜é‡çš„å†…å®¹çš„ä¸€å—å†…å­˜åŒºåŸŸï¼ŒåŒºåˆ«.bssæ®µåœ¨äºå˜é‡å·²ç»è¢«åˆå§‹åŒ–ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span>  <span class="keyword">int</span> a = <span class="number">1</span>;  <span class="comment">// ä¿å­˜åœ¨.dataæ®µä¸­é™æ€åŒº</span></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">2</span>;  <span class="comment">// ä¿å­˜åœ¨.dataæ®µä¸­å…¨å±€åŒº</span></span><br><span class="line"><span class="keyword">char</span>* str =  <span class="string">&quot;royhuang&quot;</span>; <span class="comment">// &quot;royhuang&quot;æ˜¯æ–‡å­—å¸¸é‡ï¼Œä¿å­˜åœ¨å¸¸é‡åŒº</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> c = <span class="number">3</span>;   <span class="comment">// åŒä¸Š</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>ä»£ç æ®µï¼ˆ.text &amp; .init</strong>ï¼‰ï¼š <code>.text</code> ç”¨äºå­˜æ”¾æ•´ä¸ªç¨‹åºä¸­çš„ä»£ç ï¼› <code>.init</code> ç”¨äºå­˜æ”¾ç³»ç»Ÿä¸­ç”¨æ¥åˆå§‹åŒ–å¯åŠ¨ä½ çš„ç¨‹åºçš„ä¸€æ®µä»£ç  ã€‚</p>
</li>
</ul>
<p><strong>ä¸€ä¸ªç¨‹åºæœ¬è´¨å…¶å®éƒ½æ˜¯ç”±.bssæ®µã€æ•°æ®æ®µã€ä»£ç æ®µä¸‰ä¸ªç»„æˆçš„ã€‚</strong></p>
<h4 id="3-8-2-å‡½æ•°è°ƒç”¨è¿‡ç¨‹">3.8.2 å‡½æ•°è°ƒç”¨è¿‡ç¨‹</h4>
<p>åœ¨è¿™ä¸€å°èŠ‚æˆ‘ä»¬æ¥æ·±å…¥æ¢è®¨ä¸‹å‡½æ•°è°ƒç”¨æ—¶çš„åŸç†å’Œè¿‡ç¨‹ã€‚</p>
<h5 id="æ ˆå¸§">æ ˆå¸§</h5>
<p>å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼Œæ ˆæ˜¯ä½äºè¿›ç¨‹çš„é«˜åœ°å€ä½ç½®ï¼Œä¸”æ ˆé¡¶æ˜¯å‘ä¸‹å¢é•¿çš„ã€‚åœ¨<u>å‡½æ•°è°ƒç”¨</u>æ—¶ï¼Œ<strong>æ ˆä¼šä¸“é—¨ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æ ˆå¸§ä¿å­˜å‡½æ•°è°ƒç”¨éœ€è¦çš„æ‰€æœ‰ä¿¡æ¯</strong>ã€‚è¿™å¯¹åé¢ç†è§£å‡½æ•°æ‰§è¡Œè¿‡ç¨‹å¾ˆå…³é”®ã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„æ ˆå¸§å¦‚ä¸‹ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/stack1.png" alt="img"></p>
<ul>
<li><strong>æ ˆå¸§ä¿å­˜çš„å†…å®¹</strong>ï¼šæ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éœ€è¦çš„å‡½æ•°è¿”å›åœ°å€ã€å‚æ•°ã€ä¸´æ—¶å˜é‡ã€ä¿å­˜çš„ä¸Šä¸‹æ–‡ç­‰ï¼›</li>
<li><strong><code>esp</code>å’Œ<code>ebp</code></strong> ï¼šéå¸¸é‡è¦çš„ä¸¤ä¸ªå¯„å­˜å™¨ï¼Œè®°å½•äº†å½“å‰<strong>æ ˆå¸§</strong>çš„<strong>æ ˆé¡¶ä½ç½®å’Œæ ˆåº•ä½ç½®</strong>ï¼ˆå¯¹äº<code>X86-64</code>å¹³å°ä¸Šæ¥è¯´ï¼Œå¯¹åº”çš„å¯„å­˜å™¨åˆ™ä¸º<code>rsp</code>åŠ<code>rbp</code>ï¼‰ ã€‚
<ul>
<li>å¯ä»¥çœ‹åˆ°åœ¨ä¸Šå›¾å‹æ ˆï¼ˆpushï¼‰ä¼šä½¿å¾—espå‘ä¸‹ç§»åŠ¨ï¼ˆåœ°å€å˜å°ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h5 id="æ±‡ç¼–åˆ†æ">æ±‡ç¼–åˆ†æ</h5>
<p>æˆ‘ä»¬å‡†å¤‡çš„éªŒè¯ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">foo</span><span class="params">(<span class="keyword">int</span> sp1, <span class="keyword">int</span> sp2)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> res = sp1 + sp2;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> res =  <span class="built_in">foo</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åæ±‡ç¼–çš„ä»£ç åŠåˆ†æå¦‚ä¸‹ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220109134057556.png" alt="image-20220109134057556"></p>
<ul>
<li>
<p>mainå‡½æ•°æ±‡ç¼–ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">main:</span><br><span class="line">        pushq   %rbp   # å¯„å­˜å™¨rbpä¿å­˜ä¸Šä¸€ä¸ªæ ˆå¸§æ ˆåº•ä½ç½® </span><br><span class="line">        movq    %rsp, %rbp # å¯„å­˜å™¨rspæŒ‡å‘æ ˆé¡¶ä½ç½®ï¼Œç”¨rspå†…å®¹åˆå§‹åŒ–å¯„å­˜å™¨rbq</span><br><span class="line">        subq    $16, %rsp</span><br><span class="line">        movl    $2, %esi # ç«‹å³æ•°å¯»å€ï¼Œå°†fooç¬¬äºŒä¸ªå‚æ•°å­˜å…¥å¯„å­˜å™¨esiä¸­</span><br><span class="line">        movl    $1, %edi # å°†fooçš„ç¬¬ä¸€ä¸ªå‚æ•°å­˜å…¥å¯„å­˜å™¨ediä¸­</span><br><span class="line">        call    _Z3fooii # è°ƒç”¨fooï¼Œè½¬åˆ°åˆ†æfooå‡½æ•°æ±‡ç¼–ä»£ç ï¼Œæ­¤æ—¶callè¿˜å°†ä¸‹ä¸€æ¡æŒ‡ä»¤å½“åšè¿”å›åœ°å€å‹å…¥åˆ°æ ˆä¸­</span><br><span class="line">        movl    %eax, -4(%rbp) # è¿”å›å‡½æ•°ç»“æœç»™resï¼Œå®ƒçš„åœ°å€æ˜¯-4(%rbp)</span><br><span class="line">        movl    $0, %eax # eaxè¢«ç½®ä¸º0ï¼Œä¸»å‡½æ•°é€€å‡º</span><br><span class="line">        leave</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>fooå‡½æ•°æ±‡ç¼–ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_Z3fooii:</span><br><span class="line">        pushq   %rbp  # ä¿å­˜mainçš„æ ˆåº•åœ°å€rbpï¼Œç”¨äºè¿”å›</span><br><span class="line">        movq    %rsp, %rbp # é‡ç½®fooå‡½æ•°çš„æ ˆå¸§</span><br><span class="line">        movl    %edi, -20(%rbp) # å‚æ•°1å…¥æ ˆ</span><br><span class="line">        movl    %esi, -24(%rbp) # å‚æ•°2å…¥æ ˆ</span><br><span class="line">        movl    -20(%rbp), %edx # å‚æ•°1å­˜å…¥edx</span><br><span class="line">        movl    -24(%rbp), %eax # å‚æ•°2å­˜å…¥eax</span><br><span class="line">        addl    %edx, %eax      # åŠ æ³•è¿ç®—ï¼Œç»“æœä¿å­˜åœ¨eaxä¸­</span><br><span class="line">        movl    %eax, -4(%rbp)  # å°†è¿ç®—ç»“æœèµ‹å€¼ç»™result,å®ƒçš„ä½ç½®ä¸ºrbp-4 </span><br><span class="line">        movl    -4(%rbp), %eax  # å°†resultèµ‹å€¼ç»™eaxï¼Œeaxä¸ºå‡½æ•°è¿”å›å€¼</span><br><span class="line">        popq    %rbp # è·³è½¬åˆ°mainå‡½æ•°ï¼ˆæ ˆåº•ï¼‰ï¼Œç„¶åè¿˜éœ€è¦è·³åˆ°è¿”å›åœ°å€</span><br><span class="line">        ret</span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p><strong>æ ˆå‹å…¥é¡ºåº</strong>ï¼šå½“å‰æ ˆå¸§çŠ¶æ€ä¿¡æ¯ï¼ˆå¦‚rbpï¼‰â€”&gt; å½“å‰å‡½æ•°çš„å‚æ•°ï¼ˆé€†åºï¼‰â€”&gt;å½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡ç­‰â€”&gt;â€¦â€”&gt;é€€å‡ºã€‚</p>
</blockquote>
<ul>
<li><strong>åœ¨è°ƒç”¨å‡½æ•°ï¼ˆmainï¼‰å‡½æ•°ä¸­</strong>
<ol>
<li><strong>ä¿å­˜ä¸Šä¸€ä¸ªæ ˆå¸§çš„rbpï¼Œé‡ç½®mainæ ˆå¸§çš„rbp</strong>ï¼›</li>
<li>æŒ‰ç…§ä¸è¢«è°ƒå‡½æ•°fooçš„<strong>å½¢å‚é¡ºåºç›¸åçš„é¡ºåº</strong>å‹å…¥æ ˆä¸­ï¼ˆåœ¨æœ¬ä¾‹æ˜¯ç›´æ¥å­˜å…¥å¯„å­˜å™¨ä¸­ï¼Œå› ä¸ºç›´æ¥ä¼ å…¥å¸¸é‡foo(1,2)ï¼‰ï¼›</li>
<li><strong>callæŒ‡ä»¤è°ƒç”¨</strong>ï¼š è°ƒç”¨è€…å‡½æ•°ï¼ˆmainï¼‰ä½¿ç”¨callæŒ‡ä»¤è°ƒç”¨è¢«è°ƒå‡½æ•°ï¼ˆfooï¼‰ï¼Œä¸ºfooå‡½æ•°åˆ†é…æ ˆå¸§ç©ºé—´ï¼Œ<strong>å¹¶æŠŠcallæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å½“æˆè¿”å›åœ°å€</strong>å‹å…¥æ ˆä¸­ï¼ˆè¿™ä¸ªå‹æ ˆæ“ä½œæ˜¯éšå«çš„ï¼‰</li>
</ol>
</li>
<li><strong>åœ¨è¢«è°ƒç”¨å‡½æ•°ï¼ˆfooï¼‰å‡½æ•°ä¸­</strong>
<ol>
<li>ä¿å­˜mainæ ˆå¸§çš„rbpï¼Œé‡ç½®fooæ ˆå¸§çš„rbpï¼›</li>
<li>è¢«è°ƒå‚æ•°sp1ã€sp2å‹å…¥æ ˆä¸­ï¼›</li>
<li>æ‰§è¡Œfooå‡½æ•°ä½“ä¸­ä»£ç ï¼Œè¿”å›å€¼reså…¥æ ˆï¼Œ<strong>ç„¶åä¿å­˜åœ¨å¯„å­˜å™¨eaxä¸­</strong> ï¼›</li>
<li>æ‰§è¡Œå®Œæ¯•ï¼Œæ ˆå¸§æ‰€æœ‰æ•°æ®å‡ºæ ˆï¼›</li>
<li><code> popq %rbp å’Œ ret</code> è·³è½¬mainä¸­callæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ç»§ç»­æ‰§è¡Œã€‚</li>
</ol>
</li>
<li><strong>å›åˆ°è°ƒç”¨å‡½æ•°ï¼ˆmainï¼‰å‡½æ•°ä¸­</strong>
<ol>
<li>è¿”å›å€¼resï¼ˆå¯„å­˜å™¨eaxä¸­å†…å®¹ï¼‰å‹å…¥æ ˆï¼›</li>
<li>ç»§ç»­mainå‡½æ•°ä¸­åç»­ä»£ç æ‰§è¡Œï¼›</li>
<li>mainå‡½æ•°é€€å‡ºã€‚</li>
</ol>
</li>
</ul>
<h4 id="3-8-3-malloc-free-åŸç†">3.8.3 malloc/free åŸç†</h4>
<h5 id="ä»é™æ€åˆ†é…è¯´èµ·">ä»é™æ€åˆ†é…è¯´èµ·</h5>
<p>æˆ‘ä»¬ä¹‹å‰æ¥è§¦æ•°æ®é€šå¸¸ä¿å­˜åœ¨ï¼š</p>
<ol>
<li><strong>æ ˆ</strong>ï¼Œæ¯”å¦‚å‡½æ•°å†…éƒ¨å±€éƒ¨å˜é‡ï¼›</li>
<li><strong>æ•°æ®æ®µ</strong>ï¼Œé™æ€åŒºã€å…¨å±€åŒºã€å¸¸é‡åŒºï¼›</li>
<li><strong>.bssæ®µ</strong>ï¼Œæœªåˆå§‹åŒ–çš„æ•°æ®ã€‚</li>
</ol>
<p>ä¸Šé¢çš„æ•°æ®æœ‰ä¸¤ä¸ªå…±åŒç‚¹ï¼š</p>
<ul>
<li><strong>å˜é‡/æ•°ç»„çš„å¤§å°å¿…é¡»åœ¨ç¼–è¯‘æ—¶çŸ¥é“</strong>ã€‚</li>
<li><strong>å†…å­˜åˆ†é…å’Œé‡Šæ”¾è‡ªåŠ¨å‘ç”Ÿï¼ˆå½“å˜é‡è¢«å®ä¾‹åŒ–/é”€æ¯æ—¶</strong>ï¼‰ã€‚</li>
</ul>
<p>å¤§å¤šæ•°æ—¶å€™ï¼Œè¿™å¾ˆå¥½ã€‚é‚£ä»€ä¹ˆæ—¶å€™åœ¨<strong>å †</strong>ä¸Šåˆ†é…å†…å­˜ï¼Ÿ</p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦<u>åœ¨å †ä¸ŠåŠ¨æ€ç”³è¯·/é‡Šæ”¾å†…å­˜</u>ã€‚</p>
<ol>
<li><strong>ä¸çŸ¥é“åˆ†é…å¯¹è±¡çš„å¤§å°</strong>ã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³åˆ›å»ºå£°æ˜ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯äº‹å…ˆå¹¶ä¸çŸ¥é“æ•°ç»„çš„å¤§å°ï¼ˆç¨åæ‰èƒ½çŸ¥é“ï¼‰ã€‚è¿™ä¸ªæ—¶å€™<u>æ— æ³•ä½¿ç”¨é™æ€æ•°ç»„åˆ†é…</u>ï¼Œå› ä¸ºå®ƒå¿…é¡»æŒ‡å®šæ•°ç»„çš„å¤§å°ï¼›</li>
<li><strong>åˆ†é…çš„å¯¹è±¡å¤ªå¤§</strong>ã€‚æ ˆç­‰ç©ºé—´ä¸å¤Ÿã€‚</li>
</ol>
<p>åœ¨Cä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨malloc/freeåœ¨å †ä¸Šåˆ†é…å’Œé‡Šæ”¾å†…å­˜ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ†é…ï¼šå¤§å°ä¸º4çš„intæ•°ç»„</span></span><br><span class="line"><span class="keyword">int</span>* <span class="built_in">array</span> ;</span><br><span class="line"><span class="built_in">array</span> = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">4</span>*<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</span><br><span class="line"><span class="comment">// é‡Šæ”¾</span></span><br><span class="line"><span class="built_in">free</span>(<span class="built_in">array</span>);</span><br></pre></td></tr></table></figure>
<p><strong>mallocå’Œfreeå‡½æ•°åº•å±‚æ˜¯å¦‚ä½•å»å®ç°çš„ï¼Œå¦‚ä½•åœ¨å †ä¸Šåˆ†é…å†…å­˜çš„</strong>ï¼Ÿ</p>
<h5 id="ä»å †å—è¯´èµ·">ä»å †å—è¯´èµ·</h5>
<blockquote>
<p>ä¸»è¦å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/57863097">malloc çš„å®ç°åŸç† å†…å­˜æ±  mmap sbrk é“¾è¡¨</a></p>
</blockquote>
<p><strong>ä»€ä¹ˆæ˜¯å †</strong>ï¼Ÿ</p>
<p>C++ä½¿ç”¨åŠ¨æ€å†…å­˜åˆ†é…å™¨ï¼ˆä¸‹ç®€ç§°åˆ†é…å™¨ï¼‰è¿›è¡ŒåŠ¨æ€å†…å­˜åˆ†é…ï¼Œå®ƒç»´æŠ¤ä¸€ä¸ª<u>è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜åŒºåŸŸ</u>ï¼Œä¹Ÿå°±æ˜¯å †ã€‚</p>
<p><strong>åˆ†é…å™¨çœ¼é‡Œçš„å †æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è¿›è¡Œç®¡ç†</strong>ï¼Ÿ</p>
<p>åˆ†é…å™¨å°†å †è§†ä¸º<strong>ä¸€ç»„ä¸åŒå¤§å°çš„å—ï¼ˆblockï¼‰<strong>çš„é›†åˆæ¥ç»´æŠ¤ã€‚æ¯ä¸ªå—å°±æ˜¯</strong>ä¸€ä¸ªè¿ç»­çš„è™šæ‹Ÿå†…å­˜ç‰‡ï¼ˆchunkï¼‰</strong>,è¦ä¹ˆæ˜¯å·²åˆ†é…çš„ï¼Œè¦ä¹ˆæ˜¯ç©ºé—²çš„ã€‚</p>
<p>chunkç»“æ„å›¾ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/10681867-ce8d3eeabf100d45.png" alt="img"></p>
<ul>
<li>æ­£åœ¨ä½¿ç”¨çš„chunkæ ‡è¯†æ„ä¹‰
<ul>
<li><code>prev_size</code>ï¼š è¡¨ç¤ºå‰ä¸€ä¸ª chunk çš„ size,ç¨‹åºå¯ä»¥ä½¿ç”¨è¿™ä¸ªå€¼æ¥æ‰¾åˆ°å‰ä¸€ä¸ª chunk çš„å¼€å§‹åœ°å€ï¼ˆ<code>P=0</code>æ‰æœ‰æ•ˆï¼‰ï¼›</li>
<li><code>size</code>ï¼š è¡¨ç¤ºå½“å‰chunkçš„sizeå¤§å°ï¼›</li>
<li><code>A</code>ï¼šä¸º1è¡¨ç¤ºå±äºä¸»åˆ†é…åŒºï¼ˆå·²åˆ†é…ï¼‰ï¼Œå¦åˆ™å±äºéä¸»åˆ†é…åŒºï¼ˆæœªåˆ†é…ï¼‰ï¼›</li>
<li><code>M</code>ï¼šä¸º 1 è¡¨ç¤ºè¯¥ chunk æ˜¯ä» mmap æ˜ å°„åŒºåŸŸåˆ†é…çš„ï¼Œå¦åˆ™æ˜¯ä» heap åŒºåŸŸåˆ†é…çš„ï¼›</li>
<li><code>P</code>ï¼šä¸º1è¡¨ç¤ºå‰ä¸€ä¸ªchunkåœ¨ä½¿ç”¨ä¸­ï¼Œä¸º0è¡¨ç¤ºç©ºé—²ã€‚</li>
</ul>
</li>
<li>ç©ºé—²chunkæ ‡è¯†æ„ä¹‰
<ul>
<li><code>fdã€bk</code> ï¼šåˆ†åˆ«æŒ‡å‘å‰ã€åçš„ç©ºé—²chunkï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°†å°†å¤§å°ç›¸è¿‘çš„chunkè¿æˆä¸€ä¸ªåŒå‘é“¾è¡¨ï¼›</li>
</ul>
</li>
</ul>
<p>å…·ä½“æ¥è¯´ï¼Œ<strong>åˆ†é…å™¨é€šè¿‡bins+ç©ºé—²é“¾è¡¨ï¼ˆéå¸¸ç±»ä¼¼å“ˆå¸Œè¡¨ï¼‰ï¼Œå¯¹å †å—è¿›è¡Œç®¡ç†</strong>ã€‚</p>
<p>ä¸€ä¸ªå…¸å‹çš„å †æ•´ä½“ç»“æ„ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/10681867-9c09c94096413f83.png" alt="img"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå†…å­˜åˆ†æˆäº†å¤§å°ä¸åŒçš„chunkï¼Œç„¶åé€šè¿‡<strong>bins</strong>æ¥ç»„ç»‡èµ·æ¥ï¼›ç›¸ä¼¼å¤§å°çš„chunkç”¨<strong>åŒå‘é“¾è¡¨</strong>é“¾æ¥èµ·æ¥ï¼Œä¸€ä¸ªé“¾è¡¨è¢«ç§°ä¸º<strong>bin</strong>ã€‚</p>
<ul>
<li><strong>unsorted bin</strong>ï¼šå³bin[1]ï¼ˆbin[0]æ²¡æœ‰è¢«ä½¿ç”¨ï¼‰ï¼Œç”¨äº<u>ç»´æŠ¤freeé‡Šæ”¾çš„chunk</u>ï¼›</li>
<li><strong>small_bins</strong>ï¼šå³bins[2,63)ï¼Œç”¨äºç»´æŠ¤ï¼œ512å­—èŠ‚çš„å†…å­˜å—ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ å¯¹åº”çš„é“¾è¡¨ä¸­çš„chunkå¤§å°ç›¸åŒï¼Œå‡ä¸º<code>index*8</code>ï¼›</li>
<li><strong>large_bins</strong>ï¼šå³bins[64,127)ï¼Œç”¨äºç»´æŠ¤&gt;512å­—èŠ‚çš„å†…å­˜å—ï¼Œæ¯ä¸ªå…ƒç´ å¯¹åº”çš„é“¾è¡¨ä¸­çš„chunkå¤§å°ä¸åŒï¼Œindexè¶Šå¤§ï¼Œé“¾è¡¨ä¸­chunkçš„å†…å­˜å¤§å°ç›¸å·®è¶Šå¤§ï¼›</li>
</ul>
<p>åœ¨å †ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„top chunkã€‚</p>
<ul>
<li><strong>äº§ç”Ÿæ—¶æœº</strong>ï¼šç¨‹åºç¬¬ä¸€æ¬¡è¿›è¡Œ malloc çš„æ—¶å€™ï¼Œheap ä¼šè¢«åˆ†ä¸ºä¸¤å—ï¼Œä¸€å—ç»™ç”¨æˆ·ï¼Œå‰©ä¸‹çš„é‚£å—å°±æ˜¯ top chunkï¼Œæ‰€ä»¥å®ƒä¸å±äºä»»ä½•ä¸€ä¸ª binï¼›</li>
<li><strong>ä½œç”¨</strong>ï¼šåœ¨äºå½“æ‰€æœ‰çš„ bin éƒ½æ— æ³•æ»¡è¶³ç”¨æˆ·è¯·æ±‚çš„å¤§å°æ—¶ï¼Œå°±ä½¿ç”¨top chunkè¿›è¡Œåˆ†é…ï¼Œå¹¶å°†å‰©ä¸‹çš„éƒ¨åˆ†ä½œä¸ºæ–°çš„ top chunkã€‚å †é¡¶æŒ‡é’ˆbrkä½äºtop chunkçš„é¡¶éƒ¨ï¼Œç§»åŠ¨brkæŒ‡é’ˆï¼Œå³å¯æ‰©å……top chunkçš„å¤§å°ã€‚</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å†æ¥æ¢è®¨mallocåˆ†é…çš„è¿‡ç¨‹ã€‚</p>
<h5 id="mallocåŸç†">mallocåŸç†</h5>
<p>glibcåœ¨å†…å­˜æ± ä¸­æŸ¥æ‰¾åˆé€‚çš„chunkæ—¶ï¼Œé‡‡ç”¨äº†<strong>æœ€ä½³é€‚åº”</strong>çš„ä¼™ä¼´ç®—æ³•ã€‚</p>
<p><strong>ç¬¬ä¸€æ¬¡åˆ†é…å†…å­˜æ—¶ä¼šè¿›è¡Œå †åˆå§‹åŒ–</strong>ï¼š</p>
<ol>
<li>ä¸€å¼€å§‹æ—¶ï¼Œbrkå’Œstart_brkæ˜¯ç›¸ç­‰çš„ï¼Œè¿™æ—¶å®é™…heapå¤§å°ä¸º0ï¼›</li>
<li>å¦‚æœç¬¬ä¸€æ¬¡ç”¨æˆ·è¯·æ±‚çš„å†…å­˜å¤§å°&lt; <strong>mmapåˆ†é…é˜ˆå€¼</strong>ï¼Œåˆ™ï¼ˆ<strong>é€šè¿‡ç§»åŠ¨brkæŒ‡é’ˆæ‰©å±•å †å¤§å°</strong>ï¼‰mallocä¼šç”³è¯·(chunk_size+128kb) align 4kbå¤§å°çš„ç©ºé—´ä½œä¸ºåˆå§‹çš„heapã€‚</li>
</ol>
<p><strong>å¾€åä¼šæŒ‰ç…§é¡ºåºï¼šbinsæŸ¥æ‰¾åˆ†é…â€“&gt;brkæ‰©å±•å †åˆ†é…â€”&gt;mmapåˆ†é…</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¦‚æœåˆ†é…å†…å­˜&lt;max_fast=é»˜è®¤64B</strong>ï¼Œåœ¨fast bins ä¸­æŸ¥æ‰¾ç›¸åº”çš„ç©ºé—²å—ï¼›</p>
</li>
<li>
<p><strong>å¦‚æœåˆ†é…å†…å­˜&lt;512å­—èŠ‚</strong>ï¼Œåˆ™é€šè¿‡å†…å­˜å¤§å°å®šä½åˆ°smallbinså¯¹åº”çš„indexä¸Šï¼š</p>
<ul>
<li>å¦‚æœsmallbins[index]ä¸ºç©ºï¼Œè¿›å…¥æ­¥éª¤3ï¼›</li>
<li>å¦‚æœsmallbins[index]éç©ºï¼Œç›´æ¥è¿”å›ç¬¬ä¸€ä¸ªchunkã€‚</li>
</ul>
</li>
<li>
<p><strong>å¦‚æœåˆ†é…å†…å­˜&gt;512å­—èŠ‚</strong>ï¼Œå®šä½åˆ°largebinså¯¹åº”çš„indexä¸Šï¼š</p>
<ul>
<li>å¦‚æœlargebins[index]ä¸ºç©ºï¼Œè¿›å…¥æ­¥éª¤3ï¼›</li>
<li>å¦‚æœlargebins[index]éç©ºï¼Œæ‰«æé“¾è¡¨ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§å°æœ€åˆé€‚çš„chunkï¼Œå¦‚size=12.5Kï¼Œåˆ™ä½¿ç”¨chunk Bï¼Œ<u>å‰©ä¸‹çš„0.5ké‡Šæ”¾å¹¶æ”¾å…¥unsorted_listä¸­</u>ã€‚</li>
</ul>
</li>
<li>
<p><strong>éå†unsorted_list</strong>ï¼š</p>
<ul>
<li>æŸ¥æ‰¾åˆé€‚sizeçš„chunkï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ï¼›</li>
<li>å¦åˆ™ï¼Œå°†è¿™äº›chunkéƒ½å½’ç±»æ”¾åˆ°smallbinså’Œlargebinsé‡Œé¢ã€‚</li>
</ul>
</li>
<li>
<p><strong>åœ¨binæ›´å¤§çš„é“¾è¡¨å¯»æ‰¾</strong>ï¼šä»index++æ›´å¤§çš„é“¾è¡¨ç»§ç»­å¯»æ‰¾ï¼š</p>
<ul>
<li>æŸ¥æ‰¾åˆé€‚sizeçš„chunkï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ï¼Œ<u>åŒæ—¶è¿˜ä¼šå°†chunkæ‹†åˆ†</u>ï¼Œå¹¶å°†<u>å‰©ä½™çš„åŠ å…¥åˆ°unsorted_listä¸­</u>ã€‚</li>
<li>æ‰¾ä¸åˆ°åˆ™é€šè¿‡top chunkã€‚</li>
</ul>
</li>
<li>
<p><strong>é€šè¿‡top chunkåˆ†é…</strong>ï¼šé»˜è®¤top chunkåˆ†é…çš„æœ€å¤§å¤§å°ä¸º128Kï¼ˆä¹Ÿæ˜¯mmapåˆ†é…çš„é˜ˆå€¼ï¼‰ï¼š</p>
<ul>
<li>
<p>top chunkå¤§å°&gt;åˆ†é…çš„å†…å­˜ï¼Œåˆ™è¿”å›åˆé€‚å¤§å°chunkï¼Œå‰©ä½™çš„ä½œä¸ºæ–°çš„ top chunkï¼›</p>
</li>
<li>
<p>top chunkå¤§å°&lt;åˆ†é…çš„å†…å­˜&lt;128Kï¼Œ<u>ç§»åŠ¨brkæŒ‡é’ˆ</u>æ‰©å±•top chunkå¤§å°ï¼Œæ»¡è¶³åˆ†é…ï¼›</p>
</li>
<li>
<p>åˆ†é…çš„å†…å­˜&gt;128Kï¼Œé€šè¿‡mmapåˆ†é…å†…å­˜ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>é€šè¿‡mmapåˆ†é…</strong>ã€‚åœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´çš„æ–‡ä»¶æ˜ å°„åŒºåŸŸï¼‰æ‰¾ä¸€å—ç©ºé—²çš„è™šæ‹Ÿå†…å­˜è¿”å›åœ°å€ã€‚</p>
</li>
</ol>
<p>æ€»ç»“ä»¥ä¸Šï¼Œå†…å­˜åˆ†é…ï¼ˆmallocï¼‰ä¸»è¦ç”±ä¸¤ç§ç³»ç»Ÿè°ƒç”¨å®Œæˆï¼šbrkå’Œmmapï¼ˆä¸è€ƒè™‘å…±äº«å†…å­˜ï¼‰ã€‚</p>
<ul>
<li><strong>brk</strong>ï¼šåˆ†é…å†…å­˜ &lt; DEFAULT_MMAP_THRESHOLDï¼Œèµ°<code>__brk</code>ï¼Œå°†æ•°æ®æ®µ(.data)çš„æœ€é«˜åœ°å€æŒ‡é’ˆ<code>_edata</code>ï¼Œå¾€é«˜åœ°å€æ¨ï¼›</li>
<li><strong>mmap</strong>ï¼šåˆ†é…å†…å­˜ &gt; DEFAULT_MMAP_THRESHOLDï¼Œèµ°<code>__mmap</code>ï¼Œç›´æ¥è°ƒç”¨mmapç³»ç»Ÿè°ƒç”¨ã€‚åœ¨è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­ï¼ˆå †å’Œæ ˆä¸­é—´çš„æ–‡ä»¶æ˜ å°„åŒºåŸŸï¼‰æ‰¾ä¸€å—ç©ºé—²çš„è™šæ‹Ÿå†…å­˜ã€‚</li>
</ul>
<p>å…¶ä¸­ï¼ŒDEFAULT_MMAP_THRESHOLDæ˜¯mmapåˆ†é…é˜ˆå€¼ï¼Œé»˜è®¤ä¸º128Kã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹å¼åˆ†é…çš„<strong>éƒ½æ˜¯è™šæ‹Ÿå†…å­˜</strong>ï¼Œæ²¡æœ‰åˆ†é…ç‰©ç†å†…å­˜ã€‚åªæœ‰å®é™…è°ƒç”¨å‘ç”Ÿç¼ºé¡µä¸­æ–­æ—¶ï¼Œæ‰ä¼šå»ºç«‹è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p>
<blockquote>
<p>ä¸è¿‡è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ï¼Œ<strong>æ—¢ç„¶<code>brkã€mmap</code>æä¾›äº†å†…å­˜åˆ†é…çš„åŠŸèƒ½ï¼Œç›´æ¥ä½¿ç”¨<code>brkã€mmap</code>è¿›è¡Œå†…å­˜ç®¡ç†ä¸æ˜¯æ›´ç®€å•å—ï¼Œä¸ºä»€ä¹ˆéœ€è¦glibcå‘¢</strong>ï¼Ÿ</p>
</blockquote>
<p>å› ä¸ºç³»ç»Ÿè°ƒç”¨æœ¬èº«ä¼šäº§ç”Ÿè½¯ä¸­æ–­ï¼Œå¯¼è‡´ç¨‹åºä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ï¼Œæ¯”è¾ƒæ¶ˆè€—èµ„æºã€‚è¯•æƒ³ï¼Œ<strong>å¦‚æœé¢‘ç¹åˆ†é…å›æ”¶å°å—å†…å­˜åŒºï¼Œé‚£ä¹ˆå°†æœ‰å¾ˆå¤§çš„æ€§èƒ½è€—è´¹åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­</strong>ã€‚</p>
<p>å› æ­¤ï¼Œä¸ºäº†å‡å°‘ç³»ç»Ÿè°ƒç”¨å¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œglibcé‡‡ç”¨äº†å†…å­˜æ± çš„è®¾è®¡ï¼Œå¢åŠ äº†ä¸€ä¸ªä»£ç†å±‚ï¼Œæ¯æ¬¡å†…å­˜åˆ†é…ï¼Œéƒ½ä¼˜å…ˆä»å†…å­˜æ± ä¸­å¯»æ‰¾ï¼Œå¦‚æœå†…å­˜æ± ä¸­æ— æ³•æä¾›ï¼Œå†å‘æ“ä½œç³»ç»Ÿç”³è¯·ã€‚</p>
<h5 id="freeåŸç†">freeåŸç†</h5>
<p>å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼ŒC++å°†å¯¹è§†ä¸ºå †è§†ä¸ºä¸€ä¸ªä¸ªchunkï¼ˆblockï¼‰çš„é›†åˆï¼Œæ¯ä¸ªchunkçš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/10681867-ce8d3eeabf100d45.png" alt="img"></p>
<p>mallocåˆ†é…å¥½å†…å­˜ï¼Œè¿”å›çš„æ˜¯<strong>User dataçš„èµ·å§‹åœ°å€</strong>ï¼Œ<strong>header</strong>åˆ™ä¿å­˜äº†å½“å‰chunkçš„ä¸€äº›ä¿¡æ¯ã€‚</p>
<p>ä½†freeå¹¶éçœŸçš„ç›´æ¥å°†ç›¸åº”å†…å­˜åŒºåŸŸè¿”å›æ“ä½œç³»ç»Ÿï¼š</p>
<ul>
<li>
<p><strong>å¦‚æœ<code>free</code> é‡Šæ”¾<code>mmap</code> åˆ†é…å†…å­˜</strong>ï¼Œ<code>free</code>å¯ä»¥å¾ˆé¡ºåˆ©å°±é‡Šæ”¾æ‰å…¶ç›¸å…³çš„è™šæ‹Ÿå’Œç‰©ç†å†…å­˜ï¼Œè¿”å›æ“ä½œç³»ç»Ÿï¼›</p>
</li>
<li>
<p><strong>å¦‚æœ<code>free</code> é‡Šæ”¾ <code>brk</code>åˆ†é…çš„å†…å­˜</strong>ï¼Œ<strong><code>free</code>åªæ˜¯æ ‡è®°chunkå¯è¢«é‡æ–°åˆ†é…å¹¶åŠ å…¥ç©ºé—²é“¾è¡¨ï¼ˆA=0ï¼‰ï¼Œä½†æ²¡æœ‰çœŸçš„åˆ é™¤ä»»ä½•æ•°æ®</strong>ï¼</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* a  = <span class="keyword">new</span> <span class="built_in"><span class="keyword">int</span></span>(<span class="number">1</span>);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a = &quot;</span>&lt;&lt;*a&lt;&lt;endl; <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">free</span>(a);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a = &quot;</span>&lt;&lt;*a&lt;&lt;endl; <span class="comment">// 0ï¼Œæ•°æ®è¢«æ¸…é™¤ï¼Œä½†æ²¡è¢«æ“ä½œç³»ç»Ÿå›æ”¶</span></span><br><span class="line">*a=<span class="number">2</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;a = &quot;</span>&lt;&lt;*a&lt;&lt;endl; <span class="comment">// 2ï¼Œä¾æ®å¯ä»¥è¢«ä½¿ç”¨ï¼Œè™½ç„¶è¿™å¾ˆå±é™©</span></span><br></pre></td></tr></table></figure>
<p>å…·ä½“åŠ å…¥åˆ°ç©ºé—²é“¾è¡¨ä½•å¤„ï¼Œä¹Ÿåˆ†ä¸‰ç§æƒ…å†µè€ƒè™‘ï¼š</p>
<ul>
<li>å¦‚æœè¯¥chunk<u>å’Œtop chunkç›¸é‚»ï¼Œåˆ™å°†å…¶å’Œtop chunkåˆå¹¶</u>ï¼›
<ul>
<li>ç‰¹åˆ«çš„ï¼Œå¦‚æœtop chunk&gt;128Kï¼Œä¼šæ‰§è¡Œå†…å­˜ç´§ç¼©ï¼ˆtrimï¼‰æ“ä½œç§»åŠ¨brkæŒ‡é’ˆã€‚</li>
</ul>
</li>
<li>å¦‚æœfreeçš„chunkçš„å¤§å°åœ¨0x20~0x80ä¹‹é—´ï¼ˆfastbinçš„èŒƒå›´ï¼‰ï¼Œ<u>é‚£ä¹ˆè¯¥chunkç›´æ¥æ”¾åˆ°fast binä¸Š</u>ï¼›</li>
<li>å¦‚æœfreeçš„chunkçš„å¤§å°å¤§äº0x80ï¼ˆå¤§äºfast binçš„èŒƒå›´ï¼‰ï¼Œæ­¤æ—¶ä¸ä¼šç›´æ¥æ”¾åˆ°small binæˆ–è€…large binä¸Šé¢ï¼Œ<u>è€Œæ˜¯æ”¾åˆ°unsorted binä¸Šé¢</u>ï¼›</li>
</ul>
</li>
<li>
<p><strong>æœ€ä½³å®è·µï¼šåˆ é™¤ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œè¯·å°†æŒ‡é’ˆè®¾ç½®ä¸º nullptr</strong>ã€‚</p>
<p>å¦åˆ™çš„è¯ï¼Œä½¿ç”¨ä¸€ä¸ªæŒ‡å‘çš„å†…å­˜å·²ç»è¢«é‡Šæ”¾çš„ä¸€ç§æŒ‡é’ˆï¼Œæ˜¯ä½¿ç”¨<strong>æ‚¬ç©ºæŒ‡é’ˆ</strong>ã€‚</p>
<p>ï¼ˆåŒºåˆ†é‡æŒ‡é’ˆæ˜¯æŒ‡ä½¿ç”¨æ—¶è¿˜æ²¡è¢«åˆå§‹åŒ–ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cout&lt;&lt;*a&lt;&lt;endl; <span class="comment">// å±ï¼Œæ­¤æ—¶aæ˜¯æ‚¬ç©ºæŒ‡é’ˆï¼Œå·²ç»è¢«free(a)</span></span><br><span class="line">a = <span class="literal">nullptr</span>;    <span class="comment">// æœ€ä½³å®è·µï¼šå°†å·²ç»é‡Šæ”¾çš„æŒ‡é’ˆç½®ç©º</span></span><br><span class="line">cout&lt;&lt;*a&lt;&lt;endl; <span class="comment">// æ­¤æ—¶ç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œok</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœfreeçš„chunkæ²¡æœ‰å’Œtop chunkç›¸é‚»è¢«åˆå¹¶ï¼Œå…¶åˆå¤ªå°çš„è¯ï¼Œå¯èƒ½æ°¸è¿œä¸ä¼šè¢«ä½¿ç”¨</strong>â€”â€”è¿™å°±æ˜¯äº§ç”Ÿäº†å†…å­˜ç¢ç‰‡ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/10681867-4b414b22810c9e9d.png" alt="img"></p>
<p>free(A)åï¼Œç”±äºchunk Aæ— æ³•å’Œtop chunkåˆå¹¶ï¼Œåœ¨å †ä¸­ä¾¿äº§ç”Ÿäº†å†…å­˜ç©ºæ´ï¼Œä¹Ÿå°±æ˜¯å†…å­˜ç¢ç‰‡ã€‚å¹¸è¿çš„æ˜¯ï¼Œå®ƒè¿˜è¶³å¤Ÿå¤§ï¼ˆ40Kï¼‰ï¼Œæœ‰å¾ˆå¤§æ¦‚ç‡å…¶ç©ºé—´æ˜¯èƒ½å¤Ÿè¢«åˆ©ç”¨çš„ã€‚</p>
<p><strong>å°ç»†èŠ‚ï¼šfreeå¦‚ä½•çŸ¥é“é‡Šæ”¾å¤šå¤§ç©ºé—´</strong>ï¼Ÿ</p>
<p>åœ¨å‰é¢åœ°å€ä¼ é€’æˆ‘ä»¬çŸ¥é“ï¼š<strong>å‘ä¸€ä¸ªå‡½æ•°ä¼ é€’æŒ‡é’ˆçš„æ—¶å€™ï¼Œå®ƒçš„é•¿åº¦ä¿¡æ¯å¾€å¾€ä¼šè¢«æˆªæ–­ï¼ˆå¦‚æœæ˜¯æ•°ç»„åï¼‰ï¼Œæ— æ³•æ ‡ç¤ºæ•°ç»„çš„é•¿åº¦</strong>ã€‚å› æ­¤ï¼Œåœ¨å‡½æ•°ä¸­æˆ‘ä»¬ä¹Ÿæ— æ³•è·å–å®ƒçš„é•¿åº¦ä¿¡æ¯ï¼Œé™¤éæ˜¾ç¤ºä¼ é€’ä¸€ä¸ªé•¿åº¦å‚æ•°ã€‚</p>
<p>é‚£freeå¦‚ä½•çŸ¥é“é‡Šæ”¾å¤šå¤§çš„ç©ºé—´ï¼Ÿ</p>
<p>åŸå› å¾ˆç®€å•ï¼Œfreeæ ¹æœ¬ä¸ç”¨å…³ç³»chunkå¤§å°ï¼Œmallocåˆ†é…çš„æ—¶å€™å°±æ˜¯åˆ†é…ä¸€ä¸ªåˆé€‚å¤§å°chunkã€‚chunkåŒ…å«headerå’Œuser dataã€‚<strong>freeåªæ˜¯å°†headerä¸­çš„ç›¸å…³æ ‡è®°ä¸ºå¯ç”¨ï¼ŒåŠ å…¥ç©ºé—²é“¾è¡¨ä¸­å³å¯</strong>ã€‚</p>
<h4 id="3-8-4-new-delete-åŸç†">3.8.4 new /delete åŸç†</h4>
<p>åœ¨3.8.3èŠ‚ä»‹ç»äº†Cè¯­è¨€ä¸­çš„åŠ¨æ€å†…å­˜åˆ†é…æ–¹å¼ï¼šmallocï¼Œmallocå‡½æ•°åˆ†é…å¤±è´¥è¿”å›æŒ‡é’ˆç©ºå€¼ï¼ŒæˆåŠŸè¿”å›é¦–åœ°å€ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥è®¤è¯†ä¸€ä¸‹C++ä¸­çš„åŠ¨æ€å†…å­˜ç®¡ç†æ–¹å¼ï¼šnewå’Œdeleteã€‚</p>
<p>å‡†å¤‡å¥½ä¸€ä¸ªå…¬å…±ç±»<code>Stu</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span>                           </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stu</span>                                          </span></span><br><span class="line"><span class="class">&#123;</span>                   </span><br><span class="line">  <span class="keyword">public</span>:    </span><br><span class="line">    <span class="built_in">Stu</span>()           </span><br><span class="line">    &#123;                         </span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;;                     </span><br><span class="line">    <span class="built_in">Stu</span>(<span class="keyword">int</span> num, string name):_num(num), _name(name)</span><br><span class="line">    &#123;                         </span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è‡ªå®šä¹‰æ„é€ å‡½æ•°åˆå§‹åŒ–&quot;</span> &lt;&lt; endl;   </span><br><span class="line">    &#125;                      </span><br><span class="line">    ~<span class="built_in">Stu</span>()              </span><br><span class="line">    &#123;                       </span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;ææ„é”€æ¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;                         </span><br><span class="line">  <span class="keyword">private</span>:   </span><br><span class="line">    <span class="keyword">int</span> _num;               </span><br><span class="line">    string _name;</span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>
<h5 id="newåŸç†">newåŸç†</h5>
<p>æ— è®ºæ˜¯newè¿˜æ˜¯deleteï¼Œå®ƒä»¬åœ¨<u>å†…ç½®ç±»å‹/è‡ªå®šä¹‰ç±»å‹</u>ä¸Šä½¿ç”¨æœ‰äº›ä¸åŒã€‚</p>
<ul>
<li>
<p><strong>newåº•å±‚å®ç°ï¼ˆå†…ç½®ç±»å‹</strong>ï¼‰</p>
<p>å¯¹äºå†…ç½®ç±»å‹æ¥è¯´ï¼Œnewå’ŒmallocåŠŸèƒ½åŸºæœ¬ä¸€è‡´ï¼Œä¸è¿‡newè¿˜å¯ä»¥è¿›è¡Œ<strong>åˆå§‹åŒ–</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆå§‹åŒ–å•ä¸ªï¼šç­‰åŒäºint* a = (int*)malloc(sizeof(int));</span></span><br><span class="line"><span class="keyword">int</span>* a = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å•ä¸ªï¼šåŒæ—¶è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line"><span class="keyword">int</span>* c = <span class="keyword">new</span> <span class="built_in"><span class="keyword">int</span></span>(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<p>newåœ¨C++ä¸­è¢«å®šä¹‰ä¸ºä¸€ä¸ª<strong>è¿ç®—ç¬¦</strong>ï¼Œå®ƒä¼šåœ¨åº•å±‚è°ƒç”¨å…¨å±€å‡½æ•°operator newã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹<code>int* array = new int;</code> å¯¹åº”æ±‡ç¼–æºç éªŒè¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># é¦–å…ˆåœ¨å¯„å­˜å™¨ediä¸­å­˜å…¥æ•°ç»„å¤§å°ï¼ˆ4ï¼Œä¸€ä¸ªintå¤§å°ï¼‰</span><br><span class="line">movl    $4, %edi</span><br><span class="line"># è°ƒç”¨operator newåˆ†é…ç©ºé—´</span><br><span class="line">call    operator new(unsigned long)</span><br><span class="line"># å¯„å­˜å™¨raxä¿å­˜newè¿”å›çš„é¦–åœ°å€ç»™aï¼ˆå¯¹åº”åœ°å€ -16(%rbp)ï¼‰</span><br><span class="line">movq    %rax, -16(%rbp)</span><br></pre></td></tr></table></figure>
<p>operator newåªæ˜¯mallocçš„ä¸€å±‚å°è£…ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span>* __CRTDECL <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="keyword">size_t</span> <span class="keyword">const</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (;;)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// malloc</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">void</span>* <span class="keyword">const</span> block = <span class="built_in">malloc</span>(size))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> block;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_callnewh(size) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (size == SIZE_MAX)</span><br><span class="line">            &#123;</span><br><span class="line">                __scrt_throw_std_bad_array_new_length();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                __scrt_throw_std_bad_alloc();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// The new handler was successful; try to allocate again...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>æ‰§è¡Œæµç¨‹ï¼š</p>
<ol>
<li>
<p>å½“mallocç”³è¯·ç©ºé—´æˆåŠŸæ—¶ç›´æ¥è¿”å›<code>return (p)</code>ï¼›</p>
</li>
<li>
<p>ç”³è¯·ç©ºé—´å¤±è´¥ï¼Œå°è¯•æ‰§è¡Œç©ºé—´ä¸è¶³åº”å¯¹æªæ–½ï¼ˆ<strong>mallocä¸­å¤±è´¥ç›´æ¥è¿”å›ç©ºæŒ‡é’ˆ</strong>ï¼‰ï¼›</p>
</li>
<li>
<p>å¦‚æœæ”¹åº”å¯¹æªæ–½ç”¨æˆ·è®¾ç½®äº†ï¼Œåˆ™ç»§ç»­ç”³è¯·ï¼Œå¦åˆ™æŠ›å¼‚å¸¸ã€‚</p>
</li>
</ol>
</li>
<li>
<p>ä»æºç ä¸­èƒ½çœ‹å‡ºçš„æ˜¯<strong>operator new</strong>åœ¨åº•å±‚æ˜¯åˆ©ç”¨mallocåˆ†é…å†…å­˜ï¼Œå› æ­¤å¯ä»¥è¯´<strong>newå…¶å®åªæ˜¯mallocä¸€å±‚å°è£…</strong>ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>newåº•å±‚å®ç°ï¼ˆè‡ªå®šä¹‰ç±»å‹</strong>ï¼‰</p>
<p>ä½†å¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œnewè¿˜ä¼šè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–ï¼š</p>
<ol>
<li>è°ƒç”¨operator newä¸ºå¯¹è±¡åˆ†é…ç©ºé—´ï¼ˆå†…ç½®ç±»å‹ï¼‰ï¼›</li>
<li><strong>è°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°</strong>å¯¹å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚</li>
</ol>
<p>æˆ‘ä»¬ä¸¾ä¸€ä¸ªå…·ä½“çš„ä¾‹å­åˆ†æï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">  <span class="comment">// mallocåˆ†é…å¯¹è±¡  </span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;malloc:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* a = (Stu*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(Stu));</span><br><span class="line">  <span class="comment">// newåˆ†é…å¯¹è±¡</span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;new:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* b = <span class="keyword">new</span> <span class="built_in">Stu</span>(<span class="number">1</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>);             </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">malloc:</span><br><span class="line">new:</span><br><span class="line">è‡ªå®šä¹‰æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°mallocåˆ†é…çš„æ–¹å¼ä¸ä¼šè°ƒç”¨æ„é€ å‡½æ•°ï¼Œä½†æ˜¯newè¿˜ä¼šè°ƒç”¨æ„é€ å‡½æ•°ã€‚</p>
<p>å› æ­¤ä¹Ÿå¯ä»¥ç†è§£ä¸º<strong>mallocåˆ†é…å‡ºæ¥çš„åªä¸è¿‡æ˜¯ä¸€ä¸ªå’Œç±»ä¸€æ ·å¤§å°çš„ç©ºé—´ï¼ˆåœ¨å‰é¢æˆ‘ä»¬ç§°ä¸ºchunkï¼‰ï¼Œå¹¶ä¸èƒ½ç§°ä½œæ˜¯ä¸€ä¸ªå¯¹è±¡</strong>ï¼Œè€Œnewå’Œdeleteåˆ†é…å‡ºæ¥çš„æ‰èƒ½è¢«æˆä¸ºå¯¹è±¡ã€‚</p>
</li>
<li>
<p><strong>newä¸new[]</strong></p>
<p>new[]å’Œnewæœ‰äº›ç»†å¾®åŒºåˆ«ï¼š</p>
<ul>
<li>
<p>new[]æ˜¯è°ƒç”¨operator new[]å¯¹å¤šä¸ªå¯¹è±¡è¿›è¡Œåˆ†é…ï¼Œ<strong>operator new[]æœ¬è´¨è¿˜æ˜¯å¤šæ¬¡è°ƒç”¨operator new</strong>ï¼›</p>
<p>ä½†operator new[]è¿˜ä¼šå¤šç”³è¯·4ä¸ªå­—èŠ‚çš„ç©ºé—´ä¿å­˜æ­¤æ¬¡å¯¹è±¡ä¸ªæ•°ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220110001617014.png" alt="image-20220110001617014"></p>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåš</strong>ï¼Ÿ</p>
<p>ä½¿ç”¨delete[] é‡Šæ”¾ç©ºé—´æ—¶å¯ä»¥çŸ¥é“è¢«é‡Šæ”¾çš„å¯¹è±¡ä¸ªæ•°ã€‚</p>
</li>
<li>
<p>å½“ç„¶ï¼Œ<strong>å¯¹äºè‡ªå®šä¹‰ç±»å‹</strong>ï¼Œç±»ä¼¼newï¼Œè¿˜ä¼šè°ƒç”¨Næ¬¡æ„é€ å‡½æ•°å¯¹Nä¸ªå¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<blockquote>
<p>ä¸¾ä¾‹è¯´æ˜ã€‚</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mallocåˆ†é…å¯¹è±¡  </span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;malloc:&quot;</span> &lt;&lt; endl;</span><br><span class="line">Stu* a = (Stu*)<span class="built_in">malloc</span>(<span class="number">3</span>*<span class="built_in"><span class="keyword">sizeof</span></span>(Stu));</span><br><span class="line"><span class="comment">// newåˆ†é…å¯¹è±¡</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;new:&quot;</span> &lt;&lt; endl;</span><br><span class="line">Stu* b = <span class="keyword">new</span> Stu[<span class="number">3</span>];  </span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">malloc:</span><br><span class="line">new:</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h5 id="deleteåŸç†">deleteåŸç†</h5>
<p>deleteä¹Ÿåˆ†ä¸¤ç§æƒ…å†µè®¨è®ºï¼š</p>
<ul>
<li>å¯¹äºå†…ç½®ç±»å‹ï¼šåº•å±‚è°ƒç”¨freeå®ç°ï¼Œå’Œfreeæ— å¤šå¤§åŒºåˆ«ï¼ˆä¹Ÿæ²¡æœ‰å¼‚å¸¸å¤„ç†ï¼‰ï¼›</li>
<li>å¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼šé™¤äº†è°ƒç”¨freeé‡Šæ”¾å¯¹è±¡ç©ºé—´ï¼Œåœ¨æ­¤ä¹‹å‰è¿˜ä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢æˆ‘ä»¬é€šè¿‡å…·ä½“ä¾‹å­æ¥çœ‹çœ‹ã€‚</p>
<ul>
<li>
<p><strong>deleteåº•å±‚å®ç°ï¼ˆå†…ç½®ç±»å‹</strong>ï¼‰</p>
<p>å…ˆçœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* a = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line"><span class="keyword">delete</span> a;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å¯¹åº”çš„æ±‡ç¼–æºç ï¼Œæ ¸å¿ƒæ˜¯è°ƒç”¨operator deleteï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/*int* a = new int;*/</span><br><span class="line"># é¦–å…ˆåœ¨å¯„å­˜å™¨ediä¸­å­˜å…¥æ•°ç»„å¤§å°ï¼ˆ4ï¼Œä¸€ä¸ªintå¤§å°ï¼‰</span><br><span class="line">movl    $4, %edi</span><br><span class="line"># è°ƒç”¨operator newåˆ†é…ç©ºé—´</span><br><span class="line">call    operator new(unsigned long)</span><br><span class="line"># å¯„å­˜å™¨raxä¿å­˜newè¿”å›çš„é¦–åœ°å€ç»™aï¼ˆå¯¹åº”åœ°å€ -16(%rbp)ï¼‰</span><br><span class="line">movq    %rax, -16(%rbp)</span><br><span class="line"></span><br><span class="line">/*delete a*/</span><br><span class="line">movq    -16(%rbp), %rax</span><br><span class="line">testq   %rax, %rax</span><br><span class="line">je      .L2</span><br><span class="line">movl    $4, %esi</span><br><span class="line">movq    %rax, %rdi</span><br><span class="line"># æ ¸å¿ƒæ˜¯è°ƒç”¨operator delete</span><br><span class="line"># å‰é¢åœ¨å¹²ä»€ä¹ˆï¼Ÿæš‚ä¸æ¸…æ¥šã€‚</span><br><span class="line">call    operator delete(void*, unsigned long)</span><br></pre></td></tr></table></figure>
<p>operator deleteä¹Ÿåªæ˜¯freeçš„ä¸€å±‚å°è£…ï¼ˆæ²¡æœ‰å¼‚å¸¸å¤„ç†ï¼‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> __CRTDECL <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="keyword">void</span>* <span class="keyword">const</span> block)</span> <span class="keyword">noexcept</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> _DEBUG</span></span><br><span class="line">    _free_dbg(block, _UNKNOWN_BLOCK);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line">    <span class="built_in">free</span>(block);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>deleteåº•å±‚å®ç°ï¼ˆè‡ªå®šä¹‰ç±»å‹</strong>ï¼‰</p>
<p>ä½†å¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œdeleteè¿˜ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼š</p>
<ol>
<li><strong>è°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°</strong>æ¸…ç†å¯¹è±¡ï¼›</li>
<li>è°ƒç”¨operator deleteæ¸…ç†å†…å­˜ï¼›</li>
</ol>
<p>ä¸€ä¸ªå°ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">  <span class="comment">// mallocåˆ†é…å¯¹è±¡  </span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;malloc:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* a = (Stu*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(Stu));</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;free:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  <span class="built_in">free</span>(a);</span><br><span class="line">  <span class="comment">// newåˆ†é…å¯¹è±¡</span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;new:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* b = <span class="keyword">new</span> Stu;  </span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;delete:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  <span class="keyword">delete</span> b;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;           </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">malloc:</span><br><span class="line">free:</span><br><span class="line">new:</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">delete:</span><br><span class="line">ææ„é”€æ¯</span><br></pre></td></tr></table></figure>
<p>å¯è§freeä¸ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼Œä½†deleteä¼šã€‚</p>
</li>
<li>
<p><strong>deleteä¸delte[]</strong></p>
<p>delete[]ç”¨æ¥åˆ é™¤å¤šä¸ªå¯¹è±¡ï¼ˆå’Œnew[]æˆå¯¹å‡ºç°ï¼‰ï¼Œæœ¬è´¨æ˜¯å¯¹æ¯ä¸ªå¯¹è±¡è°ƒç”¨deleteæ¸…ç†ã€‚</p>
<p>å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p>é¦–å…ˆæ ¹æ®å¯¹è±¡æ•°ç»„å‰4ä¸ªå­—èŠ‚ï¼Œè·å–å¯¹è±¡ä¸ªæ•°Nï¼›</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220110001617014.png" alt="image-20220110001617014"></p>
</li>
<li>
<p>å¯¹åç»­æ¯ä¸ªå¯¹è±¡ä½¿ç”¨deleteåˆ é™¤ã€‚</p>
</li>
</ol>
<p>åŒæ ·çš„ï¼Œå¯¹äºè‡ªå®šä¹‰ç±»å‹è¿˜ä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">  <span class="comment">// mallocåˆ†é…å¤šä¸ªå¯¹è±¡  </span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;malloc:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* a = (Stu*)<span class="built_in">malloc</span>(<span class="number">3</span>*<span class="built_in"><span class="keyword">sizeof</span></span>(Stu));</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;free:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  <span class="comment">// freeé‡Šæ”¾å†…å­˜</span></span><br><span class="line">  <span class="built_in">free</span>(a);</span><br><span class="line">  <span class="comment">// new[]åˆ†é…å¯¹è±¡</span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;new:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  Stu* b = <span class="keyword">new</span> Stu[<span class="number">3</span>];  </span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;delete:&quot;</span> &lt;&lt; endl;</span><br><span class="line">  <span class="comment">// delete[] é‡Šæ”¾å†…å­˜</span></span><br><span class="line">  <span class="keyword">delete</span>[] b;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;           </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">malloc:</span><br><span class="line">free:</span><br><span class="line">new:</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">é»˜è®¤æ„é€ å‡½æ•°åˆå§‹åŒ–</span><br><span class="line">delete:</span><br><span class="line">ææ„é”€æ¯</span><br><span class="line">ææ„é”€æ¯</span><br><span class="line">ææ„é”€æ¯</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸¤ä¸ªæœ‰æ„æ€çš„å°ç»†èŠ‚ï¼š</p>
<ul>
<li>
<p><code>malloc</code>å‡ºçš„å¯¹è±¡ä¸ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼›</p>
</li>
<li>
<p>æˆ‘ä»¬åªç”¨äº†ä¸€æ¬¡<code>free(a)</code> é‡Šæ”¾äº†åˆ†é…å¯¹è±¡æ•°ç»„<code>a</code> ï¼Œè€Œå¯¹è±¡æ•°ç»„<code>b</code>å®é™…é€šè¿‡<code>delete[]</code> è°ƒç”¨äº†å¤šæ¬¡<code>delete</code>ã€‚</p>
</li>
</ul>
<p>è¿™ä¸ªç»†èŠ‚ä¹ŸéªŒè¯äº†æˆ‘ä»¬ä¹‹å‰ç»“è®ºï¼š</p>
<ul>
<li><code>malloc</code>åˆ†é…å‡ºæ¥çš„åªä¸è¿‡æ˜¯ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„å¤§å°ï¼ˆè¿™é‡Œæ˜¯3ä¸ª<code>stu</code>ï¼‰çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¹¶æ²¡æœ‰çœŸçš„åˆ†é…äº†3ä¸ª<code>stu</code>å¯¹è±¡ï¼Œæ‰€ä»¥<code>free</code>ä¸€æ¬¡å°±å¯ä»¥é‡Šæ”¾è¿™å—å†…å­˜ã€‚</li>
<li>ä½†<code>new[]</code>æ˜¯çœŸæ­£åˆ†é…äº†3ä¸ª<code>stu</code>å¯¹è±¡å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥è¦<code>delete</code>å¤šæ¬¡ä¸”ä¼šæ‰§è¡Œææ„å‡½æ•°ã€‚</li>
</ul>
</li>
</ul>
<h5 id="plain-nothrow-placement-new">plain/nothrow/placement new</h5>
<p>åœ¨C++ä¸­ï¼Œnewæœ‰ä¸‰ç§å…¸å‹çš„ä½¿ç”¨æ–¹æ³•ï¼šplain newï¼Œnothrow newå’Œplacement newã€‚</p>
<p><strong>plain new</strong></p>
<p>è¨€ä¸‹ä¹‹æ„å°±æ˜¯æ™®é€šçš„newï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„newï¼Œåœ¨C++ä¸­å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// plain newåŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(std::<span class="keyword">size_t</span>)</span> <span class="title">throw</span><span class="params">(std::bad_alloc)</span></span>;</span><br><span class="line"><span class="comment">// plain newå¯¹åº”delete</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="keyword">void</span> *)</span> <span class="title">throw</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>å¯è§<code>plain new</code>åœ¨ç©ºé—´åˆ†é…å¤±è´¥çš„æƒ…å†µä¸‹ï¼ŒæŠ›å‡ºå¼‚å¸¸<code>std::bad_alloc</code>è€Œä¸æ˜¯è¿”å›NULLã€‚</p>
<p>å› æ­¤é€šè¿‡åˆ¤æ–­è¿”å›å€¼æ˜¯å¦ä¸ºNULLæ˜¯å¾’åŠ³çš„ï¼Œè¯·ä½¿ç”¨<code>try-catch</code>æ•è·å¼‚å¸¸ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> *p = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">10e11</span>];</span><br><span class="line">        <span class="keyword">delete</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in"><span class="keyword">catch</span></span> (<span class="keyword">const</span> std::bad_alloc &amp;ex)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; ex.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bad allocation</span><br></pre></td></tr></table></figure>
<p><strong>nothrow new</strong></p>
<p>nothrow newåœ¨ç©ºé—´åˆ†é…å¤±è´¥çš„æƒ…å†µä¸‹ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯è¿”å›NULLï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nothrow newåŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> * <span class="keyword">operator</span> <span class="title">new</span><span class="params">(std::<span class="keyword">size_t</span>,<span class="keyword">const</span> std::<span class="keyword">nothrow_t</span>&amp;)</span> <span class="title">throw</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// å¯¹åº”deleteåŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="keyword">void</span>*)</span> <span class="title">throw</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *p = <span class="built_in"><span class="keyword">new</span></span>(nothrow) <span class="keyword">char</span>[<span class="number">10e11</span>];</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;alloc failed&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alloc failed</span><br></pre></td></tr></table></figure>
<p><strong>placement new</strong></p>
<p><code>placement new</code>å…è®¸åœ¨ä¸€å—<u>å·²ç»åˆ†é…æˆåŠŸçš„å†…å­˜</u>ä¸Šé‡æ–°æ„é€ å¯¹è±¡æˆ–å¯¹è±¡æ•°ç»„ã€‚</p>
<p><code>placement new</code>ä¸ç”¨æ‹…å¿ƒå†…å­˜åˆ†é…å¤±è´¥ï¼Œå› ä¸ºå®ƒæ ¹æœ¬ä¸åˆ†é…å†…å­˜ï¼Œå®ƒåšçš„å”¯ä¸€ä¸€ä»¶äº‹æƒ…å°±æ˜¯è°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// placement newåŸå‹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="keyword">size_t</span>,<span class="keyword">void</span>*)</span></span>;</span><br><span class="line"><span class="comment">// å¯¹åº”delete</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="keyword">operator</span> <span class="title">delete</span><span class="params">(<span class="keyword">void</span>*,<span class="keyword">void</span>*)</span></span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ä¸»è¦ç”¨é€”</strong>ï¼šåå¤ä½¿ç”¨ä¸€å—è¾ƒå¤§çš„åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œæ¥æ„é€ ä¸åŒç±»å‹çš„å¯¹è±¡æˆ–è€…ä»–ä»¬çš„æ•°ç»„ï¼›</li>
<li><strong>ä½¿ç”¨ææ„å‡½æ•°åˆ é™¤è€Œä¸æ˜¯delete</strong>ï¼šplacement newæ„é€ èµ·æ¥çš„å¯¹è±¡æ•°ç»„ï¼Œè¦æ˜¾å¼çš„è°ƒç”¨ä»–ä»¬çš„ææ„å‡½æ•°æ¥é”€æ¯ï¼ˆææ„å‡½æ•°å¹¶ä¸é‡Šæ”¾å¯¹è±¡çš„å†…å­˜ï¼‰ã€‚è¿™æ˜¯å› ä¸ºplacement newæ„é€ èµ·æ¥çš„å¯¹è±¡æˆ–æ•°ç»„å¤§å°å¹¶ä¸ä¸€å®šç­‰äºåŸæ¥åˆ†é…çš„å†…å­˜å¤§å°ï¼Œä½¿ç”¨deleteä¼šé€ æˆå†…å­˜æ³„æ¼æˆ–è€…ä¹‹åé‡Šæ”¾å†…å­˜æ—¶å‡ºç°è¿è¡Œæ—¶é”™è¯¯ã€‚</li>
</ul>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ADT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ADT</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        i = <span class="number">10</span>;</span><br><span class="line">        j = <span class="number">100</span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ADT construct i=&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;,j=&quot;</span>&lt;&lt;j &lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="built_in">ADT</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;ADT destruct&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *p = <span class="built_in"><span class="keyword">new</span></span>(nothrow) <span class="keyword">char</span>[<span class="keyword">sizeof</span> ADT + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;alloc failed&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨æŒ‡é’ˆpç”³è¯·çš„å†…å­˜æ¥æ„å»ºç±»ADTå¯¹è±¡adt</span></span><br><span class="line">    <span class="comment">// placement newï¼šä¸å¿…æ‹…å¿ƒå¤±è´¥ï¼Œåªè¦pæ‰€æŒ‡å¯¹è±¡çš„çš„ç©ºé—´è¶³å¤ŸADTåˆ›å»ºå³å¯</span></span><br><span class="line">    ADT *adt = <span class="built_in"><span class="keyword">new</span></span>(p) ADT;  </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    delete adt; // errorï¼Œä¸èƒ½åœ¨æ­¤å¤„è°ƒç”¨delete</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="comment">// è°ƒç”¨ææ„å‡½æ•°åˆ é™¤adt</span></span><br><span class="line">    adt-&gt;ADT::~<span class="built_in">ADT</span>(); </span><br><span class="line">    <span class="comment">// deleteåˆ é™¤p</span></span><br><span class="line">    <span class="keyword">delete</span>[] p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ADT construct i=10,j=100</span><br><span class="line">ADT destruct</span><br></pre></td></tr></table></figure>
<h5 id="å°ç»“">å°ç»“</h5>
<ol>
<li>newå’Œdeleteåˆ†åˆ«æ˜¯mallocå’Œfreeçš„ä¸€å±‚å°è£…ï¼Œå¯¹äºè‡ªå®šä¹‰ç±»å‹è¿˜ä¼šåˆ†åˆ«è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–/ææ„å‡½æ•°æ¸…ç†å†…å­˜ã€‚<strong>ä¸è¿‡newç›¸æ¯”mallocè¿˜ä¼šæœ‰ä¸€å±‚ç”³è¯·ç©ºé—´å¤±è´¥åº”å¯¹æªæ–½ï¼Œä»¥åŠå¯ä»¥åˆå§‹åŒ–</strong>ã€‚</li>
<li>new[]/delete[]ï¼Œæ˜¯åˆ†åˆ«ç”¨æ¥åˆ†é…å¯¹è±¡æ•°ç»„/æ¸…ç†å¯¹è±¡æ•°ç»„çš„ï¼Œæœ¬è´¨æ˜¯å¤šæ¬¡è°ƒç”¨äº†new/freeã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>new[]åˆ†é…çš„å¯¹è±¡æ•°ç»„ï¼Œè¿˜ä¼šå¤šåˆ†é…4ä¸ªå­—èŠ‚æ ‡è¯†å¯¹è±¡çš„ä¸ªæ•°</strong>ã€‚</li>
<li>åœ¨C++ä¸­æœ‰plain newï¼Œnothrow newå’Œplacement newã€‚plain newå°±æ˜¯æœ€æ™®é€šçš„newï¼Œåˆ†é…é”™è¯¯è¿”å›bad allocå¼‚å¸¸ï¼›nothrow newåˆ†é…å¤±è´¥è¿”å›NULLå¼‚å¸¸ï¼›placement newä¸åˆ†é…å†…å­˜ï¼Œè¯·åªè°ƒç”¨ææ„å‡½æ•°è¿›è¡Œé‡Šæ”¾ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´double freeã€‚</li>
</ol>
<h4 id="3-8-5-é—®ç­”æµ‹éªŒ">3.8.5 é—®ç­”æµ‹éªŒ</h4>
<p>æœ¬èŠ‚æ˜¯å…«è‚¡é‡ç¾åŒºï¼Œå› ä¸ºç‰¹åœ°å‡†å¤‡ä¸€äº›å¸¸è§é¢è¯•é—®é¢˜æ¥å·©å›ºæ‰€å­¦ã€‚</p>
<ol>
<li>
<p><strong>å †æ ˆçš„åŒºåˆ«</strong>ï¼Ÿ</p>
<p>ä¸»è¦çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>ç”³è¯·æ–¹å¼</strong>ï¼š<strong>æ ˆç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…</strong>ï¼Œæ¯”å¦‚å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡<code>int a</code> ï¼Œè°ƒç”¨å‡½æ•°æ—¶ä¼šè‡ªåŠ¨ä¸º<code>a</code>å¼€è¾Ÿç©ºé—´ï¼›<strong>å †æ˜¯ç¨‹åºå‘˜ç”³è¯·å¹¶è´Ÿè´£é‡Šæ”¾</strong>ï¼Œå¹¶æŒ‡æ˜å¤§å°ï¼Œä¾‹å¦‚ <code>int* array= new int[LEN]&#123;1,2,3&#125;;</code> ï¼Œä½†æŒ‡é’ˆ<code>array</code>æœ¬èº«æ˜¯å­˜äºæ ˆä¸­ã€‚</p>
</li>
<li>
<p><strong>å­˜å‚¨å†…å®¹</strong>ï¼šæ ˆå­˜æ”¾å’Œå‡½æ•°ç›¸å…³çš„æ•°æ®ï¼Œå¦‚å®šä¹‰<u><strong>å±€éƒ¨</strong>å˜é‡</u>(ä½†ä¸åŒ…å«staticä¿®é¥°çš„å˜é‡)ã€ä¿å­˜çš„ä¸Šä¸‹æ–‡ç­‰ï¼›å †å­˜æ”¾å‡½æ•°æ— å…³çš„æ•°æ®ï¼Œå¦‚åŠ¨æ€åˆ†é…çš„å†…å­˜ã€‚</p>
</li>
<li>
<p><strong>å¤§å°é™åˆ¶</strong>ï¼šæ ˆç©ºé—´é»˜è®¤æ˜¯4Mï¼Œè¿ç»­çš„ ï¼›å †æ˜¯ä¸è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œä¸€èˆ¬æ˜¯ 1G - 4Gï¼Œå¤§å°å—é™äºè®¡ç®—æœºç³»ç»Ÿä¸­æœ‰æ•ˆçš„è™šæ‹Ÿå†…å­˜ã€‚</p>
</li>
<li>
<p><strong>ç”³è¯·æ•ˆç‡</strong>ï¼šæ ˆç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…ï¼Œè®¡ç®—æœºåœ¨åº•å±‚å¯¹æ ˆæä¾›æ”¯æŒï¼Œé€Ÿåº¦å¿«ï¼›å †æ˜¯ç”±ç¨‹åºå‘˜newåˆ†é…çš„å†…å­˜ï¼Œä¸€èˆ¬é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä½†æ›´çµæ´»ã€‚</p>
</li>
<li>
<p><strong>å­˜å‚¨æ•ˆç‡</strong>ï¼šæ ˆçš„å­˜å–æ•ˆç‡æ›´é«˜ã€‚è¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> arr1[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span>* arr2 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">3</span>]&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> a = arr1[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">int</span> b = arr2[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è½¬æˆæ±‡ç¼–è¯­è¨€åˆ†æï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220108202348644.png" alt="image-20220108202348644"></p>
</li>
</ul>
</li>
<li>
<p><strong>new / malloc çš„å¼‚åŒ</strong>ï¼Ÿ</p>
<p>éƒ½å¯ç”¨äºå†…å­˜çš„åŠ¨æ€ç”³è¯·ï¼Œè¿”å›ç”¨æˆ·åˆ†é…ä½¿ç”¨ç©ºé—´çš„é¦–åœ°å€ã€‚</p>
<ul>
<li>
<p><strong>æœ¬è´¨</strong>ï¼šnewæ˜¯å…³é”®å­—ï¼Œmallocæ˜¯å‡½æ•°ï¼Œæ‰€ä»¥mallocè¿˜éœ€è¦å¼•å…¥åº“æ–‡ä»¶ï¼Œnewä¸ç”¨ï¼›</p>
</li>
<li>
<p><strong>è¿”å›å€¼ç±»å‹</strong>ï¼šmallocè¿”å›çš„æ˜¯voidç±»å‹æŒ‡é’ˆï¼ˆå¿…é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼‰ï¼Œnewè¿”å›çš„æ˜¯å…·ä½“ç±»å‹æŒ‡é’ˆï¼›</p>
</li>
<li>
<p><strong>ç©ºé—´è®¡ç®—</strong>ï¼šnewä¼šè‡ªåŠ¨åˆ†é…ç©ºé—´å¤§å°ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ï¼Œmallocéœ€è¦æ‰‹å·¥è®¡ç®—ï¼›</p>
</li>
<li>
<p><strong>ç±»å‹å®‰å…¨</strong>ï¼šnewæ˜¯ç±»å‹å®‰å…¨çš„ï¼Œmallocä¸æ˜¯ï¼›</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> *p = <span class="keyword">new</span> <span class="keyword">float</span>[<span class="number">2</span>]; <span class="comment">// ç¼–è¯‘é”™è¯¯</span></span><br><span class="line"><span class="keyword">int</span> *p = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="number">2</span> * <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">double</span>));<span class="comment">// ç¼–è¯‘æ— é”™è¯¯</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>æ„é€ å‡½æ•°</strong>ï¼š newè°ƒç”¨åä¸º<strong>operator new</strong>çš„æ ‡å‡†åº“å‡½æ•°åˆ†é…è¶³å¤Ÿç©ºé—´ï¼Œå¦‚æœæ˜¯è‡ªå®šä¹‰ç±»å‹è¿˜ä¼šè°ƒç”¨ç›¸å…³å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œmallocåˆ™ä¸ä¼šï¼›</p>
</li>
<li>
<p><strong>åˆ†é…å¤±è´¥æªæ–½</strong>ï¼šnewæ˜¯mallocçš„ä¸€å±‚å°è£…ï¼Œå¦‚æœåˆ†é…å¤±è´¥è¿˜ä¼šæœ‰ç›¸åº”æªæ–½æ‰§è¡Œï¼ŒæŠ›å‡ºbac_allocå¼‚å¸¸ï¼›mallocè¿”å›nullã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>free / delete çš„å¼‚åŒ</strong>ï¼Ÿ</p>
<p>éƒ½å¯ç”¨äºå†…å­˜çš„åŠ¨æ€é‡Šæ”¾ã€‚</p>
<ul>
<li><strong>æœ¬è´¨</strong>ï¼šdelete æ˜¯å…³é”®å­—ï¼Œfree æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥free è¿˜éœ€è¦å¼•å…¥åº“æ–‡ä»¶ï¼Œdelete ä¸ç”¨ï¼›</li>
<li><strong>è¿”å›å€¼ç±»å‹</strong>ï¼šfreeè¿”å›çš„æ˜¯voidç±»å‹æŒ‡é’ˆï¼ˆå¿…é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼‰ï¼Œdelete è¿”å›çš„æ˜¯å…·ä½“ç±»å‹æŒ‡é’ˆï¼›</li>
<li><strong>ææ„å‡½æ•°</strong>ï¼š delete è°ƒç”¨åä¸º<strong>operator delete</strong>çš„æ ‡å‡†åº“å‡½æ•°åˆ†é…è¶³å¤Ÿç©ºé—´ï¼Œå¦‚æœæ˜¯è‡ªå®šä¹‰ç±»å‹è¿˜ä¼šè°ƒç”¨ç›¸å…³å¯¹è±¡çš„ææ„å‡½æ•°ï¼Œfree åˆ™ä¸ä¼šã€‚</li>
</ul>
</li>
<li>
<p><strong>newå®ç°åŸç†ï¼Ÿdeleteå®ç°åŸç†</strong>ï¼Ÿ</p>
<ul>
<li><strong>newåŸç†</strong>ï¼šoperator newåˆ†é…å†…å­˜ ï¼ˆåº•å±‚æ˜¯mallocå®ç°ï¼‰â€”&gt; ï¼ˆè‡ªå®šä¹‰ç±»å‹ï¼‰åˆ†é…çš„å†…å­˜ä¸Šè°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–â€”&gt;è¿”å›æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆï¼›</li>
<li><strong>deleteåŸç†</strong>ï¼šoperator deleteæ¸…ç†å†…å­˜ ï¼ˆåº•å±‚æ˜¯freeå®ç°ï¼‰â€”&gt; ï¼ˆè‡ªå®šä¹‰ç±»å‹ï¼‰åˆ é™¤å†…å­˜å‰è¿˜ä¼šè°ƒç”¨ææ„å‡½æ•°ï¼›</li>
</ul>
</li>
<li>
<p><strong>malloc/freeåº•å±‚åŸç†</strong>ï¼Ÿ</p>
<p>å‚è€ƒå‰æ–‡ã€‚è¿™é‡Œåªç®€ç•¥è¯´æ˜ï¼š</p>
<ul>
<li>mallocï¼šbrkåˆå§‹åŒ–åˆ†é…â€“&gt;åç»­åˆ†é…é€šè¿‡å†…å­˜æ± ï¼šbins+åŒå‘é“¾è¡¨å®ç°â€”&gt;å¤ªå¤§åˆ™top chunk å’Œmmapåˆ†é…ï¼›</li>
<li>freeï¼šå°†chunkæ ‡è®°å¯ä½¿ç”¨ï¼Œå¹¶åŠ å…¥ç©ºé—²é“¾è¡¨ã€‚åœ¨ä¸Šä¸€ä¸ªæ­¥éª¤freeçš„æ—¶å€™ï¼Œå‘ç°æœ€é«˜åœ°å€ç©ºé—²å†…å­˜è¶…è¿‡128Kï¼Œè¿˜ä¼šå†…å­˜ç´§ç¼©ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¢«freeå›æ”¶çš„å†…å­˜æ˜¯ç«‹å³è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿå—</strong>ï¼Ÿ</p>
<p>å¦‚å‰ï¼Œfreeå›æ”¶åªæ˜¯æ ‡è¯†è¿™å—å†…å­˜ç©ºé—²ï¼ŒåŒæ—¶ä¼šåŠ å…¥ç©ºé—²é“¾è¡¨ä¸­ç­‰å¾…ä¸‹ä¸€æ¬¡åˆ†é…ã€‚</p>
</li>
<li>
<p><strong>deleteå’Œfreeå¯ä»¥æ··ç”¨å—</strong>?</p>
<p>æˆ‘ä»¬çŸ¥é“deleteä¹Ÿåªæ˜¯freeä¸€ç§å°è£…ï¼Œåªæœ‰è‡ªå®šä¹‰ç±»å‹æ—¶deleteä¼šè°ƒç”¨ææ„å‡½æ•°ã€‚newå’ŒmallocåŒç†ã€‚</p>
<p>æ‰€ä»¥åœ¨ä»¥ä¸‹æƒ…å†µæ˜¯<strong>å¯ä»¥free/deleteæ··ç”¨</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¯¹è±¡æ˜¯åŸºæœ¬ç±»å‹æ—¶</strong>ã€‚</p>
<p>freeæ‰newç”³è¯·çš„å†…å­˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* a  = <span class="keyword">new</span> <span class="built_in"><span class="keyword">int</span></span>(<span class="number">1</span>);</span><br><span class="line"><span class="comment">// delete a;</span></span><br><span class="line"><span class="built_in">free</span>(a); </span><br></pre></td></tr></table></figure>
<p>deleteæ‰mallocç”³è¯·çš„å†…å­˜ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">int</span>* a  = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br><span class="line"><span class="keyword">delete</span> a;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¹Ÿé€‚ç”¨äºnew/mallocæ··ç”¨ã€‚</p>
</li>
<li>
<p><strong>è‡ªå®šä¹‰çš„ç±»å‹ï¼Œä½†æ²¡æœ‰æ˜¾ç¤ºå®šä¹‰ææ„å‡½æ•°</strong>ã€‚</p>
<p>deleteå’Œfreeæ··ç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span>  </span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">test</span>()&#123;a = <span class="number">0</span>;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>     </span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">    test* t1 = (test*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(test));</span><br><span class="line">  <span class="built_in"><span class="keyword">delete</span></span>(t1);</span><br><span class="line">    </span><br><span class="line">  test* t2 = <span class="keyword">new</span> <span class="built_in">test</span>();</span><br><span class="line">  <span class="built_in">free</span>(t2);       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>å¦‚æœæ˜¯è‡ªå®šä¹‰ç±»å‹ï¼Œ<strong>mallocæ··ç”¨newéœ€è¦æ˜¾ç¤ºè°ƒç”¨æ„é€ å‡½æ•°çš„é€»è¾‘å®ç°ï¼ˆæˆ–è€…è¯¥ç±»ä¸ä¼šæœ‰æ„é€ å‡½æ•°ä½œç”¨ï¼‰</strong>ã€‚</p>
</li>
<li>
<p><strong>mallocã€reallocã€callocçš„åŒºåˆ«</strong>ï¼Ÿ</p>
<ul>
<li>
<p>malloc</p>
<p>mallocç”³è¯·20ä¸ªintç±»å‹çš„ç©ºé—´ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// void* malloc(unsigned int num_size);</span></span><br><span class="line"><span class="keyword">int</span> *p = <span class="built_in">malloc</span>(<span class="number">20</span>*<span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>realloc</p>
<p>mallocç”³è¯·çš„ç©ºé—´çš„å€¼æ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œcallocç”³è¯·çš„ç©ºé—´çš„å€¼æ˜¯åˆå§‹åŒ–ä¸º0çš„ï¼›</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// void* calloc(size_t n,size_t size);</span></span><br><span class="line"><span class="keyword">int</span> *p = <span class="built_in">calloc</span>(<span class="number">20</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(<span class="keyword">int</span>));</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>realloc</p>
</li>
</ul>
<p>ç»™åŠ¨æ€åˆ†é…çš„ç©ºé—´åˆ†é…é¢å¤–çš„ç©ºé—´ï¼Œç”¨äºæ‰©å……å®¹é‡ã€‚</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// void realloc(void *p, size_t new_size);</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆC++æ²¡æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿè¿™ç‚¹è·ŸJavaä¸å¤ªä¸€æ ·</strong>ã€‚</p>
<ul>
<li><strong>èµ„æºæ¶ˆè€—</strong>ã€‚å®ç°ä¸€ä¸ªåƒåœ¾å›æ”¶å™¨ä¼šå¸¦æ¥é¢å¤–çš„ç©ºé—´å’Œæ—¶é—´å¼€é”€ï¼›
<ul>
<li>ä½ éœ€è¦å¼€è¾Ÿä¸€å®šçš„ç©ºé—´ä¿å­˜æŒ‡é’ˆçš„å¼•ç”¨è®¡æ•°å’Œå¯¹ä»–ä»¬è¿›è¡Œæ ‡è®°markï¼›</li>
<li>ç„¶åéœ€è¦å•ç‹¬å¼€è¾Ÿä¸€ä¸ªçº¿ç¨‹åœ¨ç©ºé—²çš„æ—¶å€™è¿›è¡Œfreeæ“ä½œã€‚</li>
</ul>
</li>
<li><strong>C++æœ¬èº«åŸå› </strong>ã€‚åƒåœ¾å›æ”¶ä¼šä½¿å¾—C++ä¸é€‚åˆè¿›è¡Œå¾ˆå¤šåº•å±‚çš„æ“ä½œã€‚</li>
</ul>
</li>
</ol>
<h3 id="3-9-Lambdaè¡¨è¾¾å¼">3.9 Lambdaè¡¨è¾¾å¼</h3>
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸¸å¸¸éœ€è¦å®šä¹‰ä¸€ä¸ª<strong>ç®€å•ã€ç”šè‡³åªè¢«ä½¿ç”¨ä¸€æ¬¡</strong>çš„å‡½æ•°ï¼Œé¢å¤–åœ°å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¢æµªè´¹äº†ç©ºé—´ï¼Œç”šè‡³æœªå¿…æœ‰<strong>ç®€åŒ–æˆä¸€è¡Œä»£ç </strong>å¥½ç†è§£ã€‚</p>
<p>å¦å¤–ï¼Œå‰é¢çš„å­¦ä¹ æˆ‘ä»¬äº†è§£åˆ°C++æ˜¯ä¸å…è®¸å‡½æ•°åµŒå¥—çš„ï¼Œä½†lambdaå¯ä»¥è¢«å‡½æ•°åµŒå¥—ï¼ˆlambdaå¹¶ä¸æ˜¯å‡½æ•°ï¼Œä¸‹æ–‡ç»†è¯´ï¼‰ã€‚</p>
<p>lambdaè¡¨è¾¾å¼å°±ä¸ºæˆ‘ä»¬åšäº†è¿™ä¹ˆä¸€ä»¶äº‹ï¼š<strong>å°†ä¸€ä¸ªç®€å•å‡½æ•°ç®€åŒ–ä¸ºä¸€è¡Œï¼Œè¿˜å…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°è¿›è¡ŒåµŒå¥—lambda</strong>ã€‚</p>
<h4 id="3-9-1-lambdaåˆè¯†">3.9.1 lambdaåˆè¯†</h4>
<h5 id="ç¬¬ä¸€ä¸ªlambda">ç¬¬ä¸€ä¸ªlambda</h5>
<p>C++ä¸­lambdaè¡¨è¾¾å¼æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ captureClause ] ( parameters ) -&gt; returnType</span><br><span class="line">&#123;</span><br><span class="line">    Statement;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>captureClause</code>ï¼šå…è®¸æˆ‘ä»¬ä½¿ç”¨lambdaå¤–éƒ¨çš„å˜é‡ï¼Œè¿™ä¸€ç‚¹åœ¨3.9.5ä¸­è¯¦è¿°ï¼Œè¿™é‡Œå…ˆç•¥è¿‡ï¼›</li>
<li><code>parameters</code>ï¼šä¼ é€’çš„å‚æ•°ï¼Œå¯ç©ºï¼›</li>
<li><code>returnType</code>ï¼šè¿”å›ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­ï¼Œå¯ç©ºï¼›</li>
<li><code>Statement</code>ï¼šä»£ç ä½“ï¼Œä¸€èˆ¬å°±ä¸€è¡Œï¼Œå½“ç„¶å¤šè¡Œä¹Ÿè¡Œã€‚</li>
</ul>
<p>ä¸€ä¸ªæœ€ç®€å•çš„lambdaè¡¨è¾¾å¼å¯å®šä¹‰ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[]()&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨ä¸¾ä¾‹è¯´æ˜ç”¨æ³•ã€‚</p>
<p>æˆ‘ä»¬ä¹‹å‰å†™è¿‡ä¸€ä¸ªå†’æ³¡å‡½æ•°<code>bubbleSort</code>ï¼šå®ƒæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå…è®¸æˆ‘ä»¬ä¼ é€’å®šä¹‰æ’åºè§„åˆ™ï¼Œå³<code>myCompare</code>å‡½æ•°æ¥å®ç°æ’åºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// äº¤æ¢æ•°ç»„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* arr,<span class="keyword">int</span> idx_i,<span class="keyword">int</span> idx_j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = arr[idx_i];</span><br><span class="line">    arr[idx_i] = arr[idx_j];</span><br><span class="line">    arr[idx_j] = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªå®šä¹‰æ’åºè§„åˆ™</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">myCompare</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†’æ³¡æ’åº</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>* arr, <span class="keyword">int</span> len, <span class="keyword">bool</span> (*compare)(<span class="keyword">int</span>,<span class="keyword">int</span>))</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)   <span class="comment">// å¤–è½®=n-1</span></span><br><span class="line">        <span class="comment">// * j=0,æ¯æ¬¡éƒ½æ˜¯ä»å¤´å¼€å§‹æ¯”è¾ƒ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt; len-i<span class="number">-1</span>; j++ ) <span class="comment">// å†…è½®=ä½™ä¸‹ä¹±åºæ•°-1</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">compare</span>(arr[j],arr[j+<span class="number">1</span>]))</span><br><span class="line">                <span class="built_in">swap</span>(arr,j,j+<span class="number">1</span>); </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> array[] = &#123;<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>&#125;;</span><br><span class="line">   <span class="keyword">int</span> len = <span class="built_in"><span class="keyword">sizeof</span></span>(array)/<span class="built_in"><span class="keyword">sizeof</span></span>(array[<span class="number">0</span>]);</span><br><span class="line">   <span class="built_in">bubbleSort</span>(array,len,myCompare);</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len  ;i++)</span><br><span class="line">       cout&lt;&lt;array[i]&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†è¿™ä¸ª<code>myCompare</code>å‡½æ•°æ”¹ä¸ºæ›´ç®€æ´<code>lambda</code>è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">myCompare</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ”¹ä¸ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[](<span class="keyword">int</span> a, <span class="keyword">int</span> b)&#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬å¦‚æ­¤è°ƒç”¨bubbleSortå‡½æ•°ï¼šä»£ç æ›´åŠ çš„ç´§å‡‘ï¼Œä¸Šä¸‹æ–‡æ›´æ¸…æ™°ï¼Œä¸€çœ¼æ˜ç™½æˆ‘ä»¬æ’åºçš„è§„åˆ™ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bubbleSort(array,len,myCompare);</span></span><br><span class="line"><span class="built_in">bubbleSort</span>(array,len,[](<span class="keyword">int</span> a, <span class="keyword">int</span> b)&#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;);</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure>
<h5 id="lambdaæœ¬è´¨æ¢è®¨ğŸŒŸ">lambdaæœ¬è´¨æ¢è®¨ğŸŒŸ</h5>
<p>è™½ç„¶3.9.2èŠ‚ï¼ˆä¸‹èŠ‚ï¼‰çš„åå­—å«åšâ€œlambdaä¸å‡½æ•°æŒ‡é’ˆâ€ï¼Œä½†å€¼å¾—æå‰å£°æ˜çš„ä¸€ç‚¹æ˜¯ï¼š<strong>lambdaå¹¶ä¸æ˜¯å‡½æ•°ï¼Œå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ï¼Œç§°ä¸ºå‡½æ•°å¯¹è±¡ï¼ˆä¹Ÿç§°ä¸ºå‡½æ•°å­ï¼‰ã€‚å‡½æ•°ä¸èƒ½åµŒå¥—ï¼Œä½†lambdaå¯ä»¥</strong>ã€‚</p>
<p><strong>æ€ä¹ˆç†è§£å‡½æ•°å¯¹è±¡</strong>ï¼Ÿ</p>
<p><strong>C++å‡½æ•°å¯¹è±¡å®è´¨ä¸Šæ˜¯å®ç°äº†å¯¹()æ“ä½œç¬¦çš„é‡è½½</strong>ã€‚C++å‡½æ•°å¯¹è±¡ä¸æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œä½†å®ƒçš„è°ƒç”¨æ–¹å¼ä¸å‡½æ•°æŒ‡é’ˆä¸€æ ·ï¼Œåé¢åŠ ä¸ªæ‹¬å·å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Add</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> a,<span class="keyword">const</span> <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// addFunctionçš„Addç±»å¯¹è±¡ï¼Œæ­¤ä¹Ÿæ˜¯å‡½æ•°å¯¹è±¡</span></span><br><span class="line">    Add addFunction;</span><br><span class="line">    <span class="comment">// åƒå‡½æ•°ï¼ˆæŒ‡é’ˆï¼‰ä¸€æ ·è°ƒç”¨</span></span><br><span class="line">    cout&lt;&lt;<span class="built_in">addFunction</span>(<span class="number">2</span>,<span class="number">3</span>)&lt;&lt;endl;  <span class="comment">// 5</span></span><br><span class="line">    cout&lt;&lt;addFunction.<span class="built_in"><span class="keyword">operator</span></span>()(<span class="number">2</span>,<span class="number">3</span>)&lt;&lt;endl;    <span class="comment">// 5</span></span><br><span class="line">    cout&lt;&lt;<span class="built_in">Add</span>()(<span class="number">2</span>,<span class="number">3</span>)&lt;&lt;endl;   <span class="comment">// 5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å‡½æ•°å¯¹è±¡ç›¸æ¯”æ™®é€šå‡½æ•°æœ‰ä»€ä¹ˆå¥½å¤„å—</strong>ï¼Ÿ</p>
<ul>
<li>
<p><strong>å‡½æ•°å¯¹è±¡å¸¦æœ‰çŠ¶æ€</strong>ï¼šå‡½æ•°å¯¹è±¡ç›¸å¯¹äºæ™®é€šå‡½æ•°æ˜¯â€œæ™ºèƒ½å‡½æ•°â€ï¼Œè¿™å°±å¦‚åŒæ™ºèƒ½æŒ‡é’ˆç›¸è¾ƒäºä¼ ç»ŸæŒ‡é’ˆã€‚å› ä¸ºå‡½æ•°å¯¹è±¡é™¤äº†æä¾›å‡½æ•°è°ƒç”¨ç¬¦æ–¹æ³•ï¼Œè¿˜å¯ä»¥æ‹¥æœ‰å…¶ä»–æ–¹æ³•å’Œæ•°æ®æˆå‘˜ã€‚æ‰€ä»¥å‡½æ•°å¯¹è±¡æœ‰çŠ¶æ€ã€‚å³ä½¿åŒä¸€ä¸ªç±»å®ä¾‹åŒ–çš„ä¸åŒçš„å‡½æ•°å¯¹è±¡å…¶çŠ¶æ€ä¹Ÿä¸ç›¸åŒï¼Œè¿™æ˜¯æ™®é€šå‡½æ•°æ‰€æ— æ³•åšåˆ°çš„ã€‚è€Œä¸”å‡½æ•°å¯¹è±¡æ˜¯å¯ä»¥åœ¨è¿è¡Œæ—¶åˆ›å»ºã€‚</p>
</li>
<li>
<p><strong>æ¯ä¸ªå‡½æ•°å¯¹è±¡æœ‰è‡ªå·±çš„ç±»å‹</strong>ï¼šå¯¹äºæ™®é€šå‡½æ•°æ¥è¯´ï¼Œåªè¦ç­¾åä¸€è‡´ï¼Œå…¶ç±»å‹å°±æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯è¿™å¹¶ä¸é€‚ç”¨äºå‡½æ•°å¯¹è±¡ï¼Œå› ä¸ºå‡½æ•°å¯¹è±¡çš„ç±»å‹æ˜¯å…¶ç±»çš„ç±»å‹ã€‚è¿™æ ·ï¼Œå‡½æ•°å¯¹è±¡æœ‰è‡ªå·±çš„ç±»å‹ï¼Œè¿™æ„å‘³ç€å‡½æ•°å¯¹è±¡å¯ä»¥ç”¨äºæ¨¡æ¿å‚æ•°ï¼Œè¿™å¯¹æ³›å‹ç¼–ç¨‹æœ‰å¾ˆå¤§æå‡ã€‚</p>
</li>
<li>
<p><strong>å‡½æ•°å¯¹è±¡ä¸€èˆ¬å¿«äºæ™®é€šå‡½æ•°</strong>ï¼šå› ä¸ºå‡½æ•°å¯¹è±¡ä¸€èˆ¬ç”¨äºæ¨¡æ¿å‚æ•°ï¼Œæ¨¡æ¿ä¸€èˆ¬ä¼šåœ¨ç¼–è¯‘æ—¶ä¼šåšä¸€äº›ä¼˜åŒ–ã€‚</p>
</li>
</ul>
<p>å›åˆ°lambdaè¡¨è¾¾å¼ã€‚</p>
<p><strong>æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ªlambdaè¡¨è¾¾å¼æ˜¯å¦‚ä½•è¢«è½¬æ¢æˆå‡½æ•°å¯¹è±¡</strong>ã€‚</p>
<p>å‡†å¤‡ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> add = [](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="built_in">add</span>(<span class="number">2</span>, <span class="number">3</span>);         <span class="comment">// 5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¾æ—§æ˜¯https://cppinsights.io/ï¼Œè§‚å¯Ÿç¼–è¯‘è¿‡ç¨‹å˜åŒ–ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220112200056709.png" alt="image-20220112200056709"></p>
<p>ç¼–è¯‘å™¨å¦‚ä½•å°†æˆ‘ä»¬å†™çš„lambdaè¡¨è¾¾å¼è½¬æ¢ä¸ºå‡½æ•°å¯¹è±¡ä¾¿ä¸€ç›®äº†ç„¶ï¼š</p>
<ol>
<li>é¦–å…ˆä¸ºæˆ‘ä»¬ç”Ÿæˆç±»<code>__lambda_3_16</code> ï¼ˆâ‘ å¤„ï¼‰ï¼Œå®ƒæœ‰ä¸€ä¸ªå†…è”å‡½æ•°ï¼ˆâ‘¡å¤„ï¼‰ï¼Œé‡è½½äº†ç¬¦å·<code>()</code>ï¼›</li>
<li>ä»£ç 30è¡Œå¤„ï¼Œä¸ºæˆ‘ä»¬ç”Ÿæˆäº†lambdaå‡½æ•°å¯¹è±¡<code>add</code>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„lambdaè¡¨è¾¾å¼åï¼›</li>
<li>éšåè°ƒç”¨äº†å‡½æ•°å¯¹è±¡<code>add</code> ï¼ˆâ‘¢å¤„ï¼‰ï¼Œå®Œæˆæ•´ä¸ªè½¬æ¢è¿‡ç¨‹ã€‚</li>
</ol>
<h5 id="å­˜å‚¨lambda">å­˜å‚¨lambda</h5>
<p>è™½ç„¶ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¸éœ€è¦åƒå‡½æ•°ä¸€æ ·ç»™lambdaè¡¨è¾¾å¼ä¸€ä¸ªåå­—ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¹Ÿéœ€è¦èƒ½å°†lambdaè¡¨è¾¾å¼ï¼ˆä½œä¸ºå³å€¼ï¼‰å­˜å‚¨èµ·æ¥ï¼Œä¾›ä»¥åä½¿ç”¨ã€‚</p>
<p>åœ¨C++ä¸­æä¾›ä¸‰ç§æ–¹å¼ï¼š</p>
<ol>
<li><strong>ä½¿ç”¨å‡½æ•°æŒ‡é’ˆæ–¹å¼å­˜å‚¨</strong>ï¼šåªæœ‰åœ¨<code>capture clause</code>ä¸ºç©ºæ—¶ï¼›</li>
<li><strong>ä½¿ç”¨functionæ–¹å¼å­˜å‚¨</strong>ï¼š<code>capture clause</code>ä¸ä¸ºç©ºæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ï¼›</li>
</ol>
<p>å…ˆæ¥çœ‹çœ‹å‡½æ•°æŒ‡é’ˆæ–¹å¼ã€‚</p>
<p>å‡½æ•°æŒ‡é’ˆæŒ‡å‘ä¸ä»…é™äºå‡½æ•°ï¼Œåªè¦æ˜¯å‡½æ•°å¯¹è±¡éƒ½å¯ä»¥æŒ‡å‘ã€‚lambdaä½œä¸ºå‡½æ•°å¯¹è±¡ï¼Œè‡ªç„¶æ˜¯å¯ä»¥è¢«å…¶å­˜å‚¨çš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">bool</span></span> (*myCompare)(<span class="keyword">int</span>, <span class="keyword">int</span>) = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
<p>ç”¨ <code>auto</code> å…³é”®å­—å¯ç®€åŒ–å‡½æ•°æŒ‡é’ˆç±»å‹ä¹¦å†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> myCompare = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
<p>å†æ¥å…³æ³¨ä¸‹<code>std::function</code>æ–¹å¼ã€‚</p>
<p>å‰é¢æˆ‘ä»¬æåˆ°è¿‡ï¼š<code>std::function</code>æœ¬è´¨å°±æ˜¯ç±»æ¨¡æ¿ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°å®¹å™¨ï¼Œå¯ä»¥å°†<strong>å‡½æ•°æŒ‡é’ˆ/å‡½æ•°è½¬æ¢æˆï¼ˆå‡½æ•°ï¼‰å¯¹è±¡</strong>è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function&lt;<span class="built_in"><span class="keyword">bool</span></span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; myCompare = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="lambdaå‚æ•°">lambdaå‚æ•°</h5>
<p>Lambdaè¡¨è¾¾å¼çš„å‚æ•°å’Œæ™®é€šå‡½æ•°çš„å‚æ•°ç›¸æ¯”æœ‰äº›é™åˆ¶ï¼ˆC++11ï¼‰ï¼š</p>
<ol>
<li>
<p>å‚æ•°åˆ—è¡¨ä¸­ä¸èƒ½æœ‰é»˜è®¤å‚æ•°ï¼›</p>
</li>
<li>
<p>ä¸æ”¯æŒå¯å˜å‚æ•°ï¼ˆæ¯”å¦‚ä½¿ç”¨autoå…³é”®å­—ï¼‰ï¼›</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// C++11:ç¼–è¯‘å‡ºé”™ï¼Œå‚æ•°ç±»å‹æ— æ³•ä½¿ç”¨auto</span></span><br><span class="line"><span class="keyword">auto</span> myCompare = [](<span class="keyword">auto</span> a, <span class="keyword">auto</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ‰€æœ‰å‚æ•°å¿…é¡»æœ‰å‚æ•°åã€‚</p>
</li>
</ol>
<p>å…³äºç¬¬2ç‚¹ï¼Œä»<code>C++14</code>å¼€å§‹ï¼Œ<code>lambda</code>è¡¨è¾¾å¼æ”¯æŒæ³›å‹ï¼šå…¶å‚æ•°å¯ä»¥ä½¿ç”¨è‡ªåŠ¨æ¨æ–­ç±»å‹çš„åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦æ˜¾ç¤ºåœ°å£°æ˜å…·ä½“ç±»å‹ã€‚</p>
<p>å…·ä½“ä»‹ç»å‚è€ƒ3.9.2èŠ‚ã€‚</p>
<h4 id="3-9-2-æ³›å‹lambdaï¼ˆC-14ï¼‰">3.9.2 æ³›å‹lambdaï¼ˆC++14ï¼‰</h4>
<h5 id="ä»€ä¹ˆæ˜¯æ³›å‹lambdaï¼Ÿ">ä»€ä¹ˆæ˜¯æ³›å‹lambdaï¼Ÿ</h5>
<p>ä» C++14 å¼€å§‹ï¼Œæˆ‘ä»¬è¢«å…è®¸<code>auto</code>ç”¨äºå‚æ•°ã€‚å½“ lambda å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª<code>auto</code>å‚æ•°æ—¶ï¼Œç¼–è¯‘å™¨å°†ä»å¯¹ lambda çš„è°ƒç”¨ä¸­æ¨æ–­å‡ºéœ€è¦å“ªäº›å‚æ•°ç±»å‹ã€‚</p>
<p>è¿™ä½¿å¾—<strong>å…·æœ‰ä¸€ä¸ªæˆ–å¤šä¸ª<code>auto</code>å‚æ•°çš„lambdaå¯é€‚ç”¨äºå¤šç§ç±»å‹ï¼Œ<strong>å®ƒä»¬ä¹Ÿè¢«ç§°ä¸º</strong>æ³›å‹ lambda</strong>ã€‚</p>
<p>çœ‹ä¸€ä¸ªå°ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> add = [](<span class="keyword">auto</span> x, <span class="keyword">auto</span> y) &#123; <span class="keyword">return</span> x + y; &#125;;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="built_in">add</span>(<span class="number">2</span>, <span class="number">3</span>);         <span class="comment">// 5</span></span><br><span class="line">    <span class="keyword">double</span> y = <span class="built_in">add</span>(<span class="number">2.5</span>, <span class="number">3.4</span>);  <span class="comment">// 5.9</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ˜¯ä¸æ˜¯éå¸¸åƒæ¨¡æ¿å‡½æ•°ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">add</span><span class="params">(T x, T y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="built_in">add</span>(<span class="number">2</span>, <span class="number">3</span>);         <span class="comment">// 5</span></span><br><span class="line">    <span class="keyword">double</span> y = <span class="built_in">add</span>(<span class="number">2.5</span>, <span class="number">3.4</span>);  <span class="comment">// 5.9</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>add(2, 3)</code> ã€<code>add(2.5, 3.4)</code> åˆ†åˆ«è®©å‡½æ•°æ¨¡æ¿ç”Ÿæˆäº†å‡½æ•°å®ä¾‹<code> add(int, int)</code>ã€<code> add(double, double)ã€‚</code></p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220112193845733.png" alt="image-20220112193845733"></p>
<p><strong>autoå…³é”®å­—è‡ªåŠ¨æ¨æ–­lambdaå‚æ•°ç±»å‹</strong>ï¼Œè®©lambdaè¡¨è¾¾å¼èµ·åˆ°äº†å’Œæ¨¡æ¿å‡½æ•°ç›¸åŒçš„æ•ˆæœã€‚å‰é¢æˆ‘ä»¬è¯´åˆ°ï¼Œ<strong>æ¨¡æ¿å‡½æ•°ä¼šä¸ºæ¯ç§ä¸åŒç±»å‹ç”Ÿæˆå®ä¾‹å‡½æ•°ï¼šé‚£æ³›å‹lambdaä¹Ÿä¼šä¸ºä¸åŒç±»å‹ç”Ÿæˆä¸€ä¸ªlambdaè¡¨è¾¾å¼å—</strong>ï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220112194112575.png" alt="image-20220112194112575"></p>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    </span><br><span class="line">  <span class="class"><span class="keyword">class</span> __<span class="title">lambda_3_16</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">    <span class="keyword">public</span>: </span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">type_parameter_0_0</span>, <span class="keyword">class</span> <span class="title">type_parameter_0_1</span>&gt;</span></span><br><span class="line">    <span class="keyword">inline</span> <span class="comment">/*constexpr */</span> <span class="function"><span class="keyword">auto</span> <span class="title">operator</span><span class="params">()</span><span class="params">(type_parameter_0_0 x, type_parameter_0_1 y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> INSIGHTS_USE_TEMPLATE</span></span><br><span class="line">    <span class="keyword">template</span>&lt;&gt;</span><br><span class="line">    <span class="keyword">inline</span> <span class="comment">/*constexpr */</span> <span class="function"><span class="keyword">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> INSIGHTS_USE_TEMPLATE</span></span><br><span class="line">    <span class="keyword">template</span>&lt;&gt;</span><br><span class="line">    <span class="keyword">inline</span> <span class="comment">/*constexpr */</span> <span class="function"><span class="keyword">double</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span>: </span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">type_parameter_0_0</span>, <span class="keyword">class</span> <span class="title">type_parameter_0_1</span>&gt;</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">auto</span> __invoke(type_parameter_0_0 x, type_parameter_0_1 y)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  __lambda_3_16 add = __lambda_3_16&#123;&#125;;</span><br><span class="line">  <span class="keyword">int</span> x = add.<span class="built_in"><span class="keyword">operator</span></span>()(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">  <span class="keyword">double</span> y = add.<span class="built_in"><span class="keyword">operator</span></span>()(<span class="number">2.5</span>, <span class="number">3.3999999999999999</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šé¢ä»£ç ä¸­ï¼š</p>
<ol>
<li>
<p>ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆäº†lambdaç±»<code>__lambda_3_16</code></p>
</li>
<li>
<p>ç±»<code>__lambda_3_16</code> ï¼Œæ ¹æ®40ã€41è¡Œå‡½æ•°è°ƒç”¨çš„ä¸åŒå‚æ•°ç±»å‹ï¼Œåˆ†åˆ«ç”Ÿæˆäº†ä¸¤ä¸ªæˆå‘˜å‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;&gt;</span><br><span class="line">    <span class="keyword">inline</span> <span class="comment">/*constexpr */</span> <span class="function"><span class="keyword">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">inline</span> <span class="comment">/*constexpr */</span> <span class="keyword">double</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span> <span class="keyword">const</span></span></span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°ï¼Œä¸¤ä¸ªå‡½æ•°éƒ½é‡è½½äº†æ“ä½œç¬¦<code>()</code> ã€‚</p>
</li>
<li>
<p>ä»£ç 39è¡Œï¼Œç”Ÿæˆäº†ç±»<code>__lambda_3_16</code> å¯¹è±¡<code>add</code>ï¼Œ<code>add</code>å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„æ³›å‹lambdaåï¼Œæ˜¾ç„¶æ­¤æ—¶<code>add</code>ä¹Ÿæ˜¯å‡½æ•°å¯¹è±¡ï¼Œå¯ä»¥ç”¨<code>åå­—()</code>æ–¹å¼è°ƒç”¨ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__lambda_3_16 add = __lambda_3_16&#123;&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>ä»£ç 40ã€41è¡Œè°ƒç”¨äº†ä¸åŒçš„ç±»<code>__lambda_3_16</code> ä¸åŒé‡è½½å‡½æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x = add.<span class="built_in"><span class="keyword">operator</span></span>()(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">double</span> y = add.<span class="built_in"><span class="keyword">operator</span></span>()(<span class="number">2.5</span>, <span class="number">3.3999999999999999</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="æ›´å¥½åœ°ç†è§£æ³›å‹é—­åŒ…è¡Œä¸ºğŸŒŸ">æ›´å¥½åœ°ç†è§£æ³›å‹é—­åŒ…è¡Œä¸ºğŸŒŸ</h5>
<p>å‰é¢å·²ç»è¯´åˆ°ï¼Œæ³›å‹lambdaä¼šä¸ºæ¯ç§ä¸åŒç±»å‹ç”Ÿæˆæˆå‘˜å‡½æ•° ã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿäº†è§£å±€éƒ¨é™æ€å˜é‡åŒæ ·å…·æœ‰å…¨å±€çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸‹é¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†è¿™ç§ç‰¹æ€§ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">myCount</span><span class="params">(<span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;the type of your input:&quot;</span>&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(value).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> count++; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">0</span>)&lt;&lt;endl;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">0</span>)&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">the type of your input:i</span><br><span class="line">1</span><br><span class="line">the type of your input:d</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p><code>count</code> è™½ç„¶æ˜¯å±€éƒ¨å˜é‡ï¼Œä½†æ˜¯ç”±äºæ˜¯é™æ€å˜é‡å‡½æ•°å­˜å‚¨åœ¨å…¨å±€æ•°æ®æ®µï¼Œå’Œå †æ ˆæ— å…³ï¼Œé€€å‡ºä¹Ÿä¸ä¼šé”€æ¯ã€‚<strong>æ‰€ä»¥è¢«myCountå‡½æ•°å…±äº«ï¼Œå¯è¿›è¡Œè®¡æ•°</strong>ã€‚</p>
<p><strong>ä½†æ˜¯å¦‚æœæˆ‘ä»¬<code>myCount</code>æ›¿æ¢æˆæ³›å‹å‡½æ•°ï¼Œå³å…è®¸å‚æ•°ç±»å‹ä¸ºautoï¼Œä¸€åˆ‡å¼€å§‹å˜å¾—ä¸ä¸€æ ·äº†</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// C++20æ”¯æŒå‚æ•°ç±»å‹ä¸ºauto</span></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">myCount</span><span class="params">(<span class="keyword">auto</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;the type of your input:&quot;</span>&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(value).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> count++; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">1</span>)&lt;&lt;endl;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">1.2</span>)&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">the type of your input:i</span><br><span class="line">1</span><br><span class="line">the type of your input:d</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶é™æ€å˜é‡<code>count</code>æ²¡æœ‰è¢«<code>myCount</code>å‡½æ•°å…±äº«ï¼Ÿè¿™æ˜¯å› ä¸ºæ­¤æ—¶<code>myCount</code>å‡½æ•°å·²ç»æ˜¯æ³›å‹å‡½æ•°ã€‚</p>
<ul>
<li>æ‰§è¡Œä»£ç ç¬¬13è¡Œï¼Œæ¨æ–­å‡º<code>value</code>ä¸º<code>int</code>ç±»å‹ï¼Œç¼–è¯‘å™¨ç”Ÿæˆå‡½æ•°<code>int myCount&lt;int&gt;(int value)</code>ï¼Œå®ƒæ‹¥æœ‰è‡ªå·±ä½œç”¨èŒƒå›´çš„é™æ€å˜é‡<code>count</code>ï¼›</li>
<li>æ‰§è¡Œä»£ç ç¬¬14è¡Œï¼Œç±»ä¼¼çš„ï¼Œ<strong>æ— æ³•åŒ¹é…ä¸Šä¸€æ¬¡ç”Ÿæˆå‡½æ•°<code>int myCount&lt;int&gt;(int value)</code></strong>ã€‚æ‰€ä»¥ç¼–è¯‘å™¨è¿˜éœ€ç”Ÿæˆå‡½æ•°<code>int myCount&lt;double&gt;(double value)</code>ï¼Œå®ƒä¹Ÿæ‹¥æœ‰è‡ªå·±ä½œç”¨èŒƒå›´çš„é™æ€å˜é‡<code>count</code>ã€‚</li>
</ul>
<p>ä¸¤ä¸ª<code>myCount</code> æ˜¯é‡è½½å‡½æ•°ï¼Œä½†å®ƒä»¬å¹¶ä¸ä¸€æ ·ï¼Œè‡ªç„¶æ— æ³•å…±äº«å„è‡ªçš„å±€éƒ¨é™æ€å˜é‡<code>count</code>ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220113000047727.png" alt="image-20220113000047727"></p>
<p><strong>ç±»ä¼¼çš„ç»“æœä¹Ÿå‡ºç°åœ¨æ³›å‹lambdaã€å‡½æ•°æ¨¡æ¿ä¸­</strong>ã€‚</p>
<p>ä¸‹é¢ä»¥æ³›å‹lambdaä¸ºä¾‹è¿›è¡Œå±•ç¤ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> myCount</span><br><span class="line">&#123;</span><br><span class="line">   [](<span class="keyword">auto</span> value)</span><br><span class="line">   &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;the type of your input:&quot;</span>&lt;&lt;<span class="built_in"><span class="keyword">typeid</span></span>(value).<span class="built_in">name</span>()&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> count++; </span><br><span class="line">   &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">1</span>)&lt;&lt;endl;</span><br><span class="line">   cout&lt;&lt;<span class="built_in">myCount</span>(<span class="number">1.2</span>)&lt;&lt;endl;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">the type of your input:i</span><br><span class="line">1</span><br><span class="line">the type of your input:d</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç¼–è¯‘è½¬æ¢åçš„ä»£ç éªŒè¯ï¼š</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220113000753408.png" alt="image-20220113000753408"></p>
<h4 id="3-9-3-ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°">3.9.3 ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°</h4>
<p>å’Œarrayé…åˆæ—¶ï¼Œlambdaè¡¨è¾¾å¼ä¼šæ¥å—æ•°ç»„ä¸¤ä¸ªå…ƒç´ ï¼Œå®šä¹‰å®ƒä»¬çš„æ¯”è¾ƒè§„åˆ™</p>
<p>lambdaè¡¨è¾¾å¼å¸¸é…åˆæ ‡å‡†åº“å‡½æ•°ä½¿ç”¨ï¼Œç®€æ´ä¼˜é›…ã€‚</p>
<p>ä¸‹é¢å±•ç¤ºäº†å‡ ä¸ªæ’åºç”¨ä¾‹ã€‚</p>
<ul>
<li>
<p><strong>ä¾‹1ï¼š<code>std::sort</code>å’Œlambdaé…åˆç”¨åœ¨<code>std::array</code>ä¸Š</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span> <span class="comment">// for std::greater</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  std::array&lt;<span class="keyword">int</span>,6&gt; arr = &#123; <span class="number">13</span>, <span class="number">90</span>, <span class="number">99</span>, <span class="number">5</span>, <span class="number">40</span>, <span class="number">80</span> &#125;;</span><br><span class="line">  <span class="comment">// æ­¤æ—¶lambdaå‚æ•°æ¥å—æ•°ç»„ä¸¤ä¸ªå…ƒç´ ï¼Œè¿”å›å®ƒä»¬çš„æ¯”è¾ƒè§„åˆ™ï¼ˆboolç±»å‹ï¼‰</span></span><br><span class="line">  <span class="comment">// å¯ä»¥ç»“åˆä¹‹å‰æˆ‘ä»¬å†™çš„å†’æ³¡æ’åºè‡ªå®šä¹‰è§„åˆ™ç†è§£ï¼Œæ­¤æ—¶æ˜¯åœ¨åŒé‡forå¾ªç¯ä¸­æ¥å—æ•°ç»„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">  std::<span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), [](<span class="keyword">int</span> a,<span class="keyword">int</span> b )&#123;<span class="keyword">return</span> a&gt;b;&#125;); </span><br><span class="line">    </span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i : arr)</span><br><span class="line">  &#123;</span><br><span class="line">     std::cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">99 90 80 40 13 5</span><br></pre></td></tr></table></figure>
<p>å¯¹äºå¸¸è§çš„æ“ä½œï¼ˆä¾‹å¦‚åŠ æ³•ã€æ±‚åæˆ–æ¯”è¾ƒï¼‰ï¼Œæ ‡å‡†åº“é™„å¸¦äº†è®¸å¤šå¯ç›´æ¥ä½¿ç”¨çš„å‡½æ•°å¯¹è±¡ã€‚</p>
<p>æ¯”å¦‚è¿™ä¸ªä¾‹å­å¯ç”¨<code>std::greater</code>æ›¿ä»£æˆ‘ä»¬å†™çš„lambdaè¡¨è¾¾å¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(), arr.<span class="built_in">end</span>(), std::greater);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>ä¾‹2ï¼šæ’åºå¯¹è±¡æ˜¯ç»“æ„æ•°ç»„ã€ç±»æ•°ç»„ã€RDDç­‰</strong></p>
<p><code>struct Student</code>ç”¨æ¥å­˜å‚¨å­¦ç”Ÿå§“åå’Œåˆ†æ•°çš„ï¼Œå°†ä¸‹é¢<code>Student</code>æ•°ç»„æŒ‰æˆç»©è¿›è¡Œæ’åºã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;array&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    std::string name&#123;&#125;;</span><br><span class="line">    <span class="keyword">int</span> points&#123;&#125;;</span><br><span class="line">    <span class="comment">// éœ€è¦åˆå§‹åŒ–å‡½æ•°</span></span><br><span class="line">    <span class="built_in">Student</span>(<span class="keyword">const</span> <span class="keyword">char</span> my_name[],<span class="keyword">const</span> <span class="keyword">int</span> my_points)  </span><br><span class="line">    &#123;</span><br><span class="line">         name = std::<span class="built_in">string</span>(my_name);</span><br><span class="line">         points = my_points;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">std::array&lt;Student, 8&gt; arr</span><br><span class="line">&#123;</span><br><span class="line">    &#123; </span><br><span class="line">        &#123; <span class="string">&quot;Albert&quot;</span>, <span class="number">3</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Ben&quot;</span>, <span class="number">5</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Christine&quot;</span>, <span class="number">2</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Dan&quot;</span>, <span class="number">8</span> &#125;, </span><br><span class="line">        &#123; <span class="string">&quot;Enchilada&quot;</span>, <span class="number">4</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Francis&quot;</span>, <span class="number">1</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Greg&quot;</span>, <span class="number">3</span> &#125;,</span><br><span class="line">        &#123; <span class="string">&quot;Hagrid&quot;</span>, <span class="number">5</span> &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å®ç°æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ˜ç¡®lambdaæ¥å—çš„å‚æ•°æ˜¯æ•°ç»„ä¸¤ä¸ªå…ƒç´ ï¼Œè¿™é‡Œå…ƒç´ æ˜¯ç»“æ„ä½“<code>Student</code>å¯¹è±¡ï¼›</li>
<li>å‡è®¾ä¸¤ä¸ª<code>Student</code>å¯¹è±¡åˆ†åˆ«æ˜¯stu1ã€stu2ï¼Œå®ƒä»¬æ¯”è¾ƒçš„è§„åˆ™åº”è¯¥æ˜¯ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>t</mi><mi>u</mi><mn>1.</mn><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>&gt;</mo><mi>s</mi><mi>t</mi><mi>u</mi><mn>2.</mn><mi>p</mi><mi>o</mi><mi>i</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">stu1.points&gt;stu2.points</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord">1.</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord">2.</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal">in</span><span class="mord mathnormal">t</span><span class="mord mathnormal">s</span></span></span></span> ã€‚</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// æ’åº</span></span><br><span class="line">    std::<span class="built_in">sort</span>(arr.<span class="built_in">begin</span>(),arr.<span class="built_in">end</span>(),[](Student s1,Student s2)&#123;<span class="keyword">return</span> s1.points&gt;s2.points;&#125;);</span><br><span class="line">    <span class="comment">// è¾“å‡º</span></span><br><span class="line">    std::for_each(arr.<span class="built_in">begin</span>(),arr.<span class="built_in">end</span>(),[](Student s)&#123;std::cout&lt;&lt;s.name&lt;&lt;std::endl;&#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="3-9-4-æ•è·">3.9.4 æ•è·</h4>
<h5 id="ä¸ºä»€ä¹ˆéœ€è¦æ•è·">ä¸ºä»€ä¹ˆéœ€è¦æ•è·</h5>
<p>å‰é¢æˆ‘ä»¬è¯´è¿‡lambdaè¡¨è¾¾å¼åŸç†ï¼š</p>
<ol>
<li>æ¯å®šä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œä¼šç”Ÿæˆä¸€ä¸ªåŒ¿åç±»ï¼Œè¿™ä¸ªç±»é‡è½½äº†<code>()</code>è¿ç®—ç¬¦ï¼›</li>
<li>ä½¿ç”¨lambdaè¡¨è¾¾å¼ï¼Œå…¶å®å°±æ˜¯è¿”å›ä¸€ä¸ªé—­åŒ…ç±»å®ä¾‹ã€‚</li>
</ol>
<p>æ—¢ç„¶æ˜¯é—­åŒ…ï¼Œå½“ç„¶æ— æ³•ä½¿ç”¨å¤–éƒ¨çš„å˜é‡ï¼Œè¯·çœ‹ä¸‹ä¾‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    []()</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a&lt;&lt;endl;  <span class="comment">// æ— æ³•ä½¿ç”¨å¤–éƒ¨å˜é‡a</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡æ•è·å¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨å¤–éƒ¨å˜é‡<code>a</code>ã€‚</p>
<h5 id="æŒ‰å€¼æ•è·">æŒ‰å€¼æ•è·</h5>
<p>ä¸‹é¢å±•ç¤ºäº†æŒ‰å€¼æ•è·æ–¹å¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    [a]()</span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a&lt;&lt;endl;  </span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŒ‰å€¼æ•è·åªæ˜¯å°†å˜é‡<code>a</code> å¤åˆ¶ä¸€ä»½ï¼Œè€Œä¸”ç”±äºlambdaåŒ¿åç”Ÿæˆäº†é‡è½½å‡½æ•°<code>()</code> è¢«<code>const</code>ä¿®é¥°ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨lambdaè¡¨è¾¾å¼å†…éƒ¨ä¿®æ”¹æ•°æ®æˆå‘˜<code>a</code>çš„å€¼ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220113145733566.png" alt="image-20220113145733566"></p>
<p>è¦æƒ³ä¿®æ”¹<code>a</code>çš„å€¼ï¼Œéœ€è¦å£°æ˜ä¸º<code>mutable</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[a]()<span class="keyword">mutable</span></span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;a++&lt;&lt;endl;  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶é‡è½½å‡½æ•°çš„<code>const</code>å…³é”®å­—ä¸ä¼šè¢«å£°æ˜ã€‚</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20220113150219048.png" alt="image-20220113150219048"></p>
<p>ä½†<code>mutable</code>è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¾æ—§æ— æ³•ä¿®æ”¹lambdaå¤–éƒ¨å˜é‡<code>a</code>çš„å€¼ï¼Œæ¯•ç«Ÿlambdaå†…éƒ¨å˜é‡<code>a</code>åªæ˜¯å€¼å¤åˆ¶äº†ä¸€ä»½ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> print = [a]() <span class="keyword">mutable</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a++&lt;&lt;endl;  </span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>();</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p>è¦æƒ³èƒ½ä¿®æ”¹lambdaå¤–éƒ¨çš„å˜é‡ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>
<p>å£°æ˜å¤–éƒ¨å˜é‡ä¸º<code>a</code>ä¸ºstaticï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> print = []() </span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a++&lt;&lt;endl;  </span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>();  <span class="comment">// 1</span></span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl; <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°æ­¤æ—¶ï¼Œä¸ç”¨mutableä¹Ÿå¯ä»¥æ•è·å¤–éƒ¨é™æ€å˜é‡<code>a</code>ï¼Œå› ä¸ºæ­¤æ—¶<code>a</code>å…·æœ‰å…¨å±€ç”Ÿå‘½å‘¨æœŸï¼Œå¯è¢«<strong>éšå¼æ•è·</strong>ï¼ˆä¸‹ä¸ªå°èŠ‚è¯¦ç»†åˆ—å‡ºï¼‰ã€‚</p>
</li>
<li>
<p>ç”¨å¼•ç”¨æ•è·çš„æ–¹å¼ã€‚</p>
</li>
</ol>
<h5 id="æŒ‰å¼•ç”¨æ•è·">æŒ‰å¼•ç”¨æ•è·</h5>
<p>å¼•ç”¨æ•è·æ–¹å¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> print = [&amp;a]() <span class="comment">// å¼•ç”¨æ•è·</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout&lt;&lt;a++&lt;&lt;endl;  </span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>();</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>åŸå› å¾ˆç®€å•ï¼Œä¿®æ”¹å¼•ç”¨æ—¶ä¼šé€šè¿‡é—´æ¥å¯»å€åˆ°æœ¬ä½“å¤–éƒ¨çš„å˜é‡<code>a</code>ï¼Œç„¶åè¿›è¡Œä¿®æ”¹çš„ã€‚</p>
<h5 id="æ··åˆæ•è·">æ··åˆæ•è·</h5>
<p>ä¸Šé¢çš„ä¾‹å­ï¼Œè¦ä¹ˆæ˜¯å€¼æ•è·ï¼Œè¦ä¹ˆæ˜¯å¼•ç”¨æ•è·ï¼ŒLambdaè¡¨è¾¾å¼è¿˜æ”¯æŒæ··åˆçš„æ–¹å¼æ•è·å¤–éƒ¨å˜é‡ï¼Œè¿™ç§æ–¹å¼ä¸»è¦æ˜¯ä»¥ä¸Šå‡ ç§æ•è·æ–¹å¼çš„ç»„åˆä½¿ç”¨ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ•è·å½¢å¼</th>
<th style="text-align:center">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">[]</td>
<td style="text-align:center">ä¸æ•è·ä»»ä½•å¤–éƒ¨å˜é‡</td>
</tr>
<tr>
<td style="text-align:center"><strong>[å˜é‡å, â€¦]</strong></td>
<td style="text-align:center">é»˜è®¤ä»¥å€¼å¾—å½¢å¼æ•è·æŒ‡å®šçš„å¤šä¸ªå¤–éƒ¨å˜é‡ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼Œå¦‚æœå¼•ç”¨æ•è·ï¼Œéœ€è¦æ˜¾ç¤ºå£°æ˜ï¼ˆä½¿ç”¨&amp;è¯´æ˜ç¬¦ï¼‰</td>
</tr>
<tr>
<td style="text-align:center">[this]</td>
<td style="text-align:center">ä»¥å€¼çš„å½¢å¼æ•è·thisæŒ‡é’ˆ</td>
</tr>
<tr>
<td style="text-align:center">[=]</td>
<td style="text-align:center">ä»¥å€¼çš„å½¢å¼æ•è·<strong>æ‰€æœ‰</strong>å¤–éƒ¨å˜é‡</td>
</tr>
<tr>
<td style="text-align:center">[&amp;]</td>
<td style="text-align:center">ä»¥å¼•ç”¨å½¢å¼æ•è·<strong>æ‰€æœ‰</strong>å¤–éƒ¨å˜é‡</td>
</tr>
<tr>
<td style="text-align:center">[=, &amp;x]</td>
<td style="text-align:center">å˜é‡xä»¥å¼•ç”¨å½¢å¼æ•è·ï¼Œå…¶ä½™å˜é‡ä»¥ä¼ å€¼å½¢å¼æ•è·</td>
</tr>
<tr>
<td style="text-align:center">[&amp;, x]</td>
<td style="text-align:center">å˜é‡xä»¥å€¼çš„å½¢å¼æ•è·ï¼Œå…¶ä½™å˜é‡ä»¥å¼•ç”¨å½¢å¼æ•è·</td>
</tr>
</tbody>
</table>
<h5 id="éšå¼æ•è·">éšå¼æ•è·</h5>
<p>å‰é¢ä»‹ç»çš„éƒ½æ˜¯æ˜¾ç¤ºæ•è·ï¼Œåœ¨C++ä¸­ï¼Œå¦‚æœå˜é‡è¢«å£°æ˜ä¸ºstaticæˆ–è€…constï¼Œå…¶å®æ˜¯å¯ä»¥éšå¼æ•è·ä½¿ç”¨çš„ã€‚</p>
<p>è¯·å›ç­”ï¼šä¸‹é¢å˜é‡å“ªäº›å¯ä»¥åœ¨<code>main</code>ä¸æ˜¾å¼æ•è·å®ƒä»¬çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i&#123;&#125;;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span> j&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a&#123;&#125;;</span><br><span class="line">  <span class="keyword">constexpr</span> <span class="keyword">int</span> b&#123;&#125;;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">int</span> c&#123;&#125;;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">int</span> d&#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> e&#123;&#125;;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span> f&#123; <span class="built_in">getValue</span>() &#125;;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> g&#123;&#125;;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> h&#123; <span class="built_in">getValue</span>() &#125;;</span><br><span class="line"></span><br><span class="line">  []()</span><br><span class="line">  &#123;</span><br><span class="line">    a;</span><br><span class="line">    b;</span><br><span class="line">    c;</span><br><span class="line">    d;</span><br><span class="line">    e;</span><br><span class="line">    f;</span><br><span class="line">    g;</span><br><span class="line">    h;</span><br><span class="line">    i;</span><br><span class="line">    j;</span><br><span class="line">  &#125;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é™¤äº†aã€fï¼Œå…¶ä½™éƒ½æ˜¯è¢«staticæˆ–è€…constä¿®é¥°ï¼Œå¯ä»¥éšå¼è¢«lambdaæ•è·ã€‚</p>
<h3 id="3-X-å†è°ˆ-auto">3.X å†è°ˆ auto</h3>
<p>å‰é¢æˆ‘ä»¬æˆ–å¤šæˆ–å°‘äº†ä½¿ç”¨äº†autoå…³é”®å­—ï¼Œå®ƒçš„ä½œç”¨ä¹Ÿå¾ˆæ˜æ˜¾ï¼š<strong>è‡ªåŠ¨ç±»å‹æ¨æ–­</strong>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="built_in"><span class="keyword">typeid</span></span>(a).<span class="built_in">name</span>() <span class="comment">// i</span></span><br></pre></td></tr></table></figure>
<p>ä½†åƒè¿™ç§<strong>ç®€å•ç±»å‹å˜é‡å£°æ˜ä¸å»ºè®®ä½¿ç”¨autoå…³é”®å­—</strong>ï¼Œç›´æ¥å†™å‡ºå˜é‡çš„ç±»å‹æ›´åŠ æ¸…æ™°æ˜“æ‡‚ã€‚</p>
<p>ç°åœ¨è¿›è¡Œå¸¸è§åœºæ™¯ä¸‹autoæ€»ç»“&amp;ä½¿ç”¨ã€‚</p>
<h4 id="autoç”¨æ³•æ€»ç»“">autoç”¨æ³•æ€»ç»“</h4>
<ol>
<li>
<p><strong>ä»£æ›¿å†—é•¿å¤æ‚ã€å˜é‡ä½¿ç”¨èŒƒå›´ä¸“ä¸€çš„å˜é‡å£°æ˜</strong></p>
<p>æ¯”å¦‚ï¼šå­˜å‚¨å‡½æ•°æŒ‡é’ˆæˆ–lambdaè¡¨è¾¾å¼ã€æ¨¡æ¿å¯¹è±¡å£°æ˜ç­‰ã€‚</p>
<blockquote>
<p>STLæ ‡å‡†åº“å°†åœ¨åç»­è¿›è¡Œæ€»ç»“ã€‚</p>
</blockquote>
<p>æƒ³è±¡ä¸€ä¸‹åœ¨æ²¡æœ‰autoçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ“ä½œæ ‡å‡†åº“æ—¶ç»å¸¸éœ€è¦è¿™æ ·ï¼ˆéš¾å—å•Šå…„å¼Ÿï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; vs;</span><br><span class="line">    <span class="keyword">for</span> (std::vector&lt;std::string&gt;::iterator i = vs.<span class="built_in">begin</span>(); i != vs.<span class="built_in">end</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨autoèƒ½ç®€åŒ–ä»£ç ï¼ˆèˆ’æœäº†ï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; vs;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = vs.<span class="built_in">begin</span>(); i != vs.<span class="built_in">end</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//..</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆå¦‚å‡½æ•°æŒ‡é’ˆå£°æ˜æ¯”è¾ƒå¤æ‚ï¼Œå­˜å‚¨æ—¶ä¸å¥½ä¹¦å†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cout&lt;&lt;a&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in"><span class="keyword">int</span></span> (*p_func)(<span class="keyword">int</span>,<span class="keyword">int</span>) = func;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰lambdaè¡¨è¾¾å¼ï¼Œç±»ä¼¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">bool</span></span> (*myCompare)(<span class="keyword">int</span>, <span class="keyword">int</span>) = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
<p>autoä¼˜åŒ–åï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">auto</span></span> (*myCompare)(<span class="keyword">int</span>, <span class="keyword">int</span>) = [](<span class="keyword">int</span> a, <span class="keyword">int</span> b) &#123;<span class="keyword">return</span> a &gt; b? <span class="literal">false</span>: <span class="literal">true</span>;&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>åœ¨å®šä¹‰æ¨¡æ¿å‡½æ•°æ—¶ï¼Œç”¨äºå£°æ˜ä¾èµ–æ¨¡æ¿å‚æ•°çš„å˜é‡ç±»å‹</strong></p>
<p>è‹¥ä¸ä½¿ç”¨autoå˜é‡æ¥å£°æ˜<code>v</code>ï¼Œåˆ™æ— æ³•è¿›è¡Œå®šä¹‰ï¼Œå› ä¸ºå…¶ç±»å‹æ— æ³•ç¡®å®šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tx,<span class="keyword">typename</span> _Ty&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Multiply</span><span class="params">(_Tx x, _Ty y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> v = x*y;</span><br><span class="line">    std::cout &lt;&lt; v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨C++11ä¸­å¦‚æœ<code>v</code>ä½œä¸ºè¿”å›å€¼ï¼Œè¿˜éœ€è¦åœ¨å°¾éƒ¨æŒ‡å®šè¿”å›ç±»å‹ï¼ˆå¦åˆ™ä¼šå‘å‡ºè­¦å‘Šï¼‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> _Tx, <span class="keyword">typename</span> _Ty&gt;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">multiply</span><span class="params">(_Tx x, _Ty y)</span>-&gt;<span class="title">decltype</span><span class="params">(x*y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x*y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>decltypeç”¨äºè®¡ç®—å‡ºè¡¨è¾¾å¼<code>x*y</code>çš„ç±»å‹ã€‚</p>
</li>
</ol>
<h4 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h4>
<ol>
<li>
<p><strong>autoå…³é”®å­—å¿…é¡»åˆå§‹åŒ–</strong></p>
<p>éœ€è¦åœ¨å£°æ˜æ—¶autoå°±å¯ä»¥æ¨æ–­å‡ºå˜é‡ç±»å‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> a = <span class="number">10</span>; <span class="comment">// ok</span></span><br><span class="line"><span class="keyword">auto</span> b;  <span class="comment">// error</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>autoä¼šè‡ªåŠ¨å»é™¤å³å€¼çš„å¼•ç”¨ã€constè¯­ä¹‰ï¼Œéœ€è¦æ˜¾ç¤ºå£°æ˜</strong></p>
<p>å³å€¼å¼•ç”¨è¯­ä¹‰è¢«å»é™¤ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span>&amp; b = a;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> c = b; <span class="comment">// æ­¤æ—¶cçš„ç±»å‹æ˜¯intä¸æ˜¯int&amp;</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ˜¾ç¤ºå£°æ˜ä¸ºå¼•ç”¨ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span>&amp; c = b; <span class="comment">// æ­¤æ—¶cçš„ç±»å‹æ‰æ˜¯int&amp;</span></span><br></pre></td></tr></table></figure>
<p>autoè¿˜ä¼šå»é™¤constè¯­ä¹‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> b = a; <span class="comment">// æ­¤æ—¶bä¸ºintç±»å‹ï¼Œè€Œä¸æ˜¯const int</span></span><br><span class="line">b = <span class="number">100</span>;  <span class="comment">// bå¯ä»¥è¢«ä¿®æ”¹</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ˜¾ç¤ºå£°æ˜ä¸ºconstå¸¸é‡ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">auto</span> b = a;</span><br><span class="line">b = <span class="number">100</span>; <span class="comment">// éæ³•ï¼Œæ— æ³•è¢«ä¿®æ”¹</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æœ‰ä¸ªæœ‰æ„æ€çš„é—®é¢˜ï¼šå¦‚æœauto&amp; è¿˜ä¼šå»é™¤constè¯­ä¹‰å—ï¼Ÿç†è®ºä¸Šæ¥è¯´ï¼Œæ­¤æ—¶å¼•ç”¨æ˜¯æŸç§æ„ä¹‰ä¸Šç­‰ä»·æœ¬ä½“çš„ï¼Œè‡ªç„¶ç±»å‹ä¹Ÿåº”è¯¥æ˜¯ä¸€è‡´çš„ã€‚</p>
</blockquote>
<p>ç­”æ¡ˆæ˜¯ä¸ä¼šçš„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span>&amp; b = a; <span class="comment">// æ­¤æ—¶bä¸ºconst intï¼Œconstè¯­ä¹‰æœªè¢«å»é™¤</span></span><br><span class="line">b = <span class="number">100</span>;     <span class="comment">// éæ³•</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>autoå…³é”®å­—ä¸å»é™¤æŒ‡é’ˆçš„è¯­ä¹‰</strong></p>
<p>è¯·çœ‹ä¸‹ä¾‹ï¼Œautoæ­£ç¡®æ¨å¯¼é™¤äº†å˜é‡çš„ç±»å‹ä¸ºæŒ‡é’ˆï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">auto</span> b = &amp;a;  <span class="comment">// bæ˜¯int*ç±»å‹</span></span><br><span class="line">    </span><br><span class="line">    cout&lt;&lt;*b&lt;&lt;endl; <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>autoä¸èƒ½ä½œä¸ºå‡½æ•°å½¢å‚</strong></p>
<p>è¿™æ ·åšçš„è¯ï¼Œå£°æ˜çš„å‡½æ•°å®é™…ä¸Šå°±æ˜¯ä¸ªå‡½æ•°æ¨¡æ¿äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">func</span><span class="params">(<span class="keyword">auto</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½†è¿™ç§åšæ³•åœ¨C++20ä¸­å·²è¢«æ”¯æŒã€‚</p>
</li>
</ol>
<h2 id="æ›´æ–°è®°å½•">æ›´æ–°è®°å½•</h2>
<div class="timeline">
<div class="timenode"><div class="meta"><p><p>2021-01-16 ï¼šæ›´æ–°ç¬”è®°</p>
</p></div><div class="body"><ol><li>ç¬¬ä¸€æ¬¡æ›´æ–°</li></ol></div></div>
</div>
<h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2>
<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">C++ä¸­å¼•ç”¨ä¼ é€’ä¸æŒ‡é’ˆä¼ é€’çš„åŒºåˆ«ï¼šhttps://blog.csdn.net/u013130743/article/details/80806179<a href="#fnref:1" rev="footnote"> â†©</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">C/C++ ç¨‹åºçš„å†…å­˜å¸ƒå±€ï¼šhttps://blog.csdn.net/m0_45047300/article/details/118389444<a href="#fnref:2" rev="footnote"> â†©</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å†…å­˜åˆ†é…çš„åŸç†--molloc/brk/mmapï¼šhttp://abcdxyzk.github.io/blog/2015/08/05/kernel-mm-malloc/<a href="#fnref:3" rev="footnote"> â†©</a></span></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">C++ lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¯¹è±¡ï¼šhttps://www.jianshu.com/p/d686ad9de817<a href="#fnref:4" rev="footnote"> â†©</a></span></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">5.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">C++ auto å…³é”®å­—çš„ä½¿ç”¨ï¼šhttps://cloud.tencent.com/developer/article/1660750<a href="#fnref:5" rev="footnote"> â†©</a></span></li></ol></div></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Wanghui Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://hwh.zone/p/51595/">https://hwh.zone/p/51595/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://hwh.zone" target="_blank">royhuang's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">æ•™ç¨‹</a><a class="post-meta__tags" href="/tags/C-%E5%9F%BA%E7%A1%80/">C++åŸºç¡€</a><a class="post-meta__tags" href="/tags/%E5%87%BD%E6%95%B0/">å‡½æ•°</a></div><div class="post_share"><div class="social-share" data-image="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/wechatPay.png" target="_blank"><img class="post-qr-code-img" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/wechatPay.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/alipay.png" target="_blank"><img class="post-qr-code-img" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/alipay.png" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/18652/"><img class="prev-cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211211214212828.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸Šï¼‰VSCodeè¿œç¨‹å¼€å‘</div></div></a></div><div class="next-post pull-right"><a href="/p/24237/"><img class="next-cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸­ï¼‰æŒ‡é’ˆå’Œå¼•ç”¨</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/p/18652/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸Šï¼‰VSCodeè¿œç¨‹å¼€å‘"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211211214212828.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-05</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸Šï¼‰VSCodeè¿œç¨‹å¼€å‘</div></div></a></div><div><a href="/p/2834/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸‹ï¼‰g++/Makefile/CMakeå¿«é€Ÿå…¥é—¨"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/image-20211211215040434.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-12-05</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸‹ï¼‰g++/Makefile/CMakeå¿«é€Ÿå…¥é—¨</div></div></a></div><div><a href="/p/43924/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-27</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½</div></div></a></div><div><a href="/p/26224/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-16</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨</div></div></a></div><div><a href="/p/6587/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-16</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢</div></div></a></div><div><a href="/p/24237/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸­ï¼‰æŒ‡é’ˆå’Œå¼•ç”¨"><img class="cover" src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-14</div><div class="title">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸­ï¼‰æŒ‡é’ˆå’Œå¼•ç”¨</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wanghui Huang</div><div class="author-info__description">tech & life</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">36</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wanghui-Huang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wanghui-Huang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:hwh199601@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">royhuang's studio</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%87%BD%E6%95%B0"><span class="toc-text">ä¸‰ã€å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">3.1 åŸºæœ¬æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%89%8D%E5%90%91%E5%A3%B0%E6%98%8E%F0%9F%8C%9F"><span class="toc-text">3.1.1 å‰å‘å£°æ˜ğŸŒŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E5%90%91%E5%A3%B0%E6%98%8E%E5%88%9D%E8%AF%86"><span class="toc-text">å‰å‘å£°æ˜åˆè¯†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8"><span class="toc-text">å¾ªç¯å¼•ç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#extern%E5%92%8C%E5%89%8D%E5%90%91%E5%A3%B0%E6%98%8E"><span class="toc-text">externå’Œå‰å‘å£°æ˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%EF%BC%9Aextern-%E5%89%8D%E5%90%91%E5%A3%B0%E6%98%8E-include"><span class="toc-text">æœ€ä½³å®è·µï¼šextern&#x2F;å‰å‘å£°æ˜&#x2F;include</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%EF%BC%9A%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-text">3.1.2 æœ€ä½³å®è·µï¼šä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-text">3.2 å‡½æ•°é‡è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%EF%BC%9F"><span class="toc-text">3.2.1 ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°é‡è½½ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E4%BA%8C%E4%B9%89%E6%80%A7%E5%8C%B9%E9%85%8D"><span class="toc-text">3.2.2 äºŒä¹‰æ€§åŒ¹é…</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF"><span class="toc-text">3.3 å‡½æ•°æ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0%E6%98%AF%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="toc-text">3.3.1 æ¨¡æ¿å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-%E5%A4%9A%E4%B8%AA%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E7%B1%BB%E5%9E%8B"><span class="toc-text">3.3.2 å¤šä¸ªå‡½æ•°æ¨¡æ¿ç±»å‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%F0%9F%8C%9F"><span class="toc-text">3.4 å‡½æ•°å‚æ•°ğŸŒŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-%E6%8C%89%E5%80%BC%E4%BC%A0%E9%80%92"><span class="toc-text">3.4.1 æŒ‰å€¼ä¼ é€’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-%E6%8C%89%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92"><span class="toc-text">3.4.2 æŒ‰å¼•ç”¨ä¼ é€’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-3-%E6%8C%89%E6%8C%87%E9%92%88%E4%BC%A0%E9%80%92"><span class="toc-text">3.4.3 æŒ‰æŒ‡é’ˆä¼ é€’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-4-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">3.4.4 æœ€ä½³å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%A0%E5%BC%95%E7%94%A8%E5%BF%AB%E8%BF%98%E6%98%AF%E4%BC%A0%E6%8C%87%E9%92%88%E5%BF%AB%EF%BC%9F"><span class="toc-text">ä¼ å¼•ç”¨å¿«è¿˜æ˜¯ä¼ æŒ‡é’ˆå¿«ï¼Ÿ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E9%80%89%E6%8B%A9%E8%A7%84%E5%88%99"><span class="toc-text">å‚æ•°ä¼ é€’é€‰æ‹©è§„åˆ™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8%E5%BC%95%E7%94%A8%E4%BC%A0%E5%8F%82%EF%BC%9F"><span class="toc-text">æ•°ç»„æ€ä¹ˆä½¿ç”¨å¼•ç”¨ä¼ å‚ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-5-%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E6%80%BB%E7%BB%93"><span class="toc-text">3.4.5 å‚æ•°ä¼ é€’æ€»ç»“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-6-%E7%89%B9%E6%AE%8A%E5%8F%82%E6%95%B0"><span class="toc-text">3.4.6 ç‰¹æ®Šå‚æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-text">3.5 å‡½æ•°è¿”å›å€¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-%E6%8C%89%E5%80%BC%E8%BF%94%E5%9B%9E"><span class="toc-text">3.5.1 æŒ‰å€¼è¿”å›</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-%E6%8C%89%E6%8C%87%E9%92%88%E8%BF%94%E5%9B%9E"><span class="toc-text">3.5.2 æŒ‰æŒ‡é’ˆè¿”å›</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-3-%E6%8C%89%E5%BC%95%E7%94%A8%E8%BF%94%E5%9B%9E"><span class="toc-text">3.5.3 æŒ‰å¼•ç”¨è¿”å›</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-4-%E5%B0%8F%E7%BB%93"><span class="toc-text">3.5.4 å°ç»“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-5-%E8%BF%94%E5%9B%9E%E5%A4%9A%E4%B8%AA%E5%80%BC"><span class="toc-text">3.5.5 è¿”å›å¤šä¸ªå€¼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0"><span class="toc-text">3.6 å†…è”å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-1-%E9%82%A3%E5%87%BD%E6%95%B0%E6%9C%89%E4%BB%80%E4%B9%88%E7%BC%BA%E7%82%B9%E5%90%97%EF%BC%9F"><span class="toc-text">3.6.1 é‚£å‡½æ•°æœ‰ä»€ä¹ˆç¼ºç‚¹å—ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-2-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E8%A2%AB%E6%9B%BF%E6%8D%A2%EF%BC%9F"><span class="toc-text">3.6.2 å†…è”å‡½æ•°ä»€ä¹ˆæ—¶å€™è¢«æ›¿æ¢ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-3-%E5%86%85%E8%81%94%E5%87%BD%E6%95%B0%E5%92%8C%E5%AE%8F%E5%AF%B9%E6%AF%94"><span class="toc-text">3.6.3 å†…è”å‡½æ•°å’Œå®å¯¹æ¯”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="toc-text">3.7 å‡½æ•°æŒ‡é’ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-1-%E5%87%BD%E6%95%B0%E5%92%8C%E6%8C%87%E9%92%88"><span class="toc-text">3.7.1 å‡½æ•°å’ŒæŒ‡é’ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%EF%BC%9A%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-text">3.7.2 ä¸ºä»€ä¹ˆéœ€è¦å‡½æ•°æŒ‡é’ˆï¼šå›è°ƒå‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-3-%E6%9B%B4%E4%BC%98%E9%9B%85%E5%9C%B0%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="toc-text">3.7.3 æ›´ä¼˜é›…åœ°ä½¿ç”¨å‡½æ•°æŒ‡é’ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D"><span class="toc-text">1. ç±»å‹åˆ«å</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-function"><span class="toc-text">2. function</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-function%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">3. functionæ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-%E4%BD%BF%E7%94%A8auto"><span class="toc-text">4. ä½¿ç”¨auto</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-4-CPU%E7%9C%BC%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%EF%BC%9A%E5%8F%98%E9%87%8F"><span class="toc-text">3.7.4  CPUçœ¼ä¸­çš„å‡½æ•°æŒ‡é’ˆï¼šå˜é‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-5-%E5%B0%8F%E7%BB%93"><span class="toc-text">3.7.5 å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-%E6%A0%88%E5%92%8C%E5%A0%86%F0%9F%8C%9F"><span class="toc-text">3.8 æ ˆå’Œå †ğŸŒŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-1-%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80"><span class="toc-text">3.8.1 å†…å­˜å¸ƒå±€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-2-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">3.8.2 å‡½æ•°è°ƒç”¨è¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%88%E5%B8%A7"><span class="toc-text">æ ˆå¸§</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B1%87%E7%BC%96%E5%88%86%E6%9E%90"><span class="toc-text">æ±‡ç¼–åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-3-malloc-free-%E5%8E%9F%E7%90%86"><span class="toc-text">3.8.3 malloc&#x2F;free åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E9%9D%99%E6%80%81%E5%88%86%E9%85%8D%E8%AF%B4%E8%B5%B7"><span class="toc-text">ä»é™æ€åˆ†é…è¯´èµ·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E5%A0%86%E5%9D%97%E8%AF%B4%E8%B5%B7"><span class="toc-text">ä»å †å—è¯´èµ·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#malloc%E5%8E%9F%E7%90%86"><span class="toc-text">mallocåŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#free%E5%8E%9F%E7%90%86"><span class="toc-text">freeåŸç†</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-4-new-delete-%E5%8E%9F%E7%90%86"><span class="toc-text">3.8.4 new &#x2F;delete åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#new%E5%8E%9F%E7%90%86"><span class="toc-text">newåŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#delete%E5%8E%9F%E7%90%86"><span class="toc-text">deleteåŸç†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#plain-nothrow-placement-new"><span class="toc-text">plain&#x2F;nothrow&#x2F;placement new</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-text">å°ç»“</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-5-%E9%97%AE%E7%AD%94%E6%B5%8B%E9%AA%8C"><span class="toc-text">3.8.5 é—®ç­”æµ‹éªŒ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-text">3.9 Lambdaè¡¨è¾¾å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-1-lambda%E5%88%9D%E8%AF%86"><span class="toc-text">3.9.1 lambdaåˆè¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAlambda"><span class="toc-text">ç¬¬ä¸€ä¸ªlambda</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#lambda%E6%9C%AC%E8%B4%A8%E6%8E%A2%E8%AE%A8%F0%9F%8C%9F"><span class="toc-text">lambdaæœ¬è´¨æ¢è®¨ğŸŒŸ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%98%E5%82%A8lambda"><span class="toc-text">å­˜å‚¨lambda</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#lambda%E5%8F%82%E6%95%B0"><span class="toc-text">lambdaå‚æ•°</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-2-%E6%B3%9B%E5%9E%8Blambda%EF%BC%88C-14%EF%BC%89"><span class="toc-text">3.9.2 æ³›å‹lambdaï¼ˆC++14ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%B3%9B%E5%9E%8Blambda%EF%BC%9F"><span class="toc-text">ä»€ä¹ˆæ˜¯æ³›å‹lambdaï¼Ÿ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E5%A5%BD%E5%9C%B0%E7%90%86%E8%A7%A3%E6%B3%9B%E5%9E%8B%E9%97%AD%E5%8C%85%E8%A1%8C%E4%B8%BA%F0%9F%8C%9F"><span class="toc-text">æ›´å¥½åœ°ç†è§£æ³›å‹é—­åŒ…è¡Œä¸ºğŸŒŸ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-3-%E4%BD%BF%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93%E5%87%BD%E6%95%B0"><span class="toc-text">3.9.3 ä½¿ç”¨æ ‡å‡†åº“å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-9-4-%E6%8D%95%E8%8E%B7"><span class="toc-text">3.9.4 æ•è·</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E6%8D%95%E8%8E%B7"><span class="toc-text">ä¸ºä»€ä¹ˆéœ€è¦æ•è·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E5%80%BC%E6%8D%95%E8%8E%B7"><span class="toc-text">æŒ‰å€¼æ•è·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E5%BC%95%E7%94%A8%E6%8D%95%E8%8E%B7"><span class="toc-text">æŒ‰å¼•ç”¨æ•è·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E6%8D%95%E8%8E%B7"><span class="toc-text">æ··åˆæ•è·</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9A%90%E5%BC%8F%E6%8D%95%E8%8E%B7"><span class="toc-text">éšå¼æ•è·</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-X-%E5%86%8D%E8%B0%88-auto"><span class="toc-text">3.X å†è°ˆ auto</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#auto%E7%94%A8%E6%B3%95%E6%80%BB%E7%BB%93"><span class="toc-text">autoç”¨æ³•æ€»ç»“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-text">æ³¨æ„äº‹é¡¹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%AE%B0%E5%BD%95"><span class="toc-text">æ›´æ–°è®°å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/43924/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½">C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½</a><time datetime="2022-01-27T06:47:34.826Z" title="å‘è¡¨äº 2022-01-27 14:47:34">2022-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/17506/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨">C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨</a><time datetime="2022-01-24T07:37:07.955Z" title="å‘è¡¨äº 2022-01-24 15:37:07">2022-01-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/6587/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢</a><time datetime="2022-01-16T13:04:18.006Z" title="å‘è¡¨äº 2022-01-16 21:04:18">2022-01-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/26224/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨">C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨</a><time datetime="2022-01-16T12:56:08.897Z" title="å‘è¡¨äº 2022-01-16 20:56:08">2022-01-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Wanghui Huang</div><div class="footer_custom_text">Support By <a target="_blank" rel="noopener" href="https://cloud.tencent.com/" style="text-decoration:underline; color:#476679;"> Tencent Cloud </a> |  <a target="_blank" rel="noopener" href="https://hexo.io/" style="text-decoration:underline; color:#476679;">Hexo</a> | <a target="_blank" rel="noopener" href="https://butterfly.js.org/" style="text-decoration:underline; color:#476679;">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><div class="search-dialog__title" id="algolia-search-title">Algolia</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai'
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.2/js/index.js"></script><div id="widget-tree">
      <h1 id="tree-toc-title" style="text-align:center;margin:0;line-hight:1.5"> <a href="https://hwh.zone/categories/">ç›® å½• </a> </h1>
      <h5 id="tree-toc-subtitle" style="text-align:center;margin:0;line-hight:1.5"> <a href="https://hwh.zone/">royhuang's blog</a> </h5>
      <ul>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/">
          C++
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/">
          ä»é›¶å¼€å§‹
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E8%BF%9B%E9%98%B6/">
          C++è¿›é˜¶
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/17506/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E5%9F%BA%E7%A1%80/">
          C++åŸºç¡€
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/18652/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸Šï¼‰VSCodeè¿œç¨‹å¼€å‘"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸Šï¼‰VSCodeè¿œç¨‹å¼€å‘</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/2834/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸‹ï¼‰g++/Makefile/CMakeå¿«é€Ÿå…¥é—¨"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆä¸€ï¼‰ï¼šç¯å¢ƒæ­å»ºï¼ˆä¸‹ï¼‰g++/Makefile/CMakeå¿«é€Ÿå…¥é—¨</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/43924/" title="C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆä¸‰ï¼‰ï¼šé¢å¯¹å¯¹è±¡ï¼ˆä¸­ï¼‰è¿ç®—ç¬¦é‡è½½</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/26224/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸Šï¼‰å¿«é€Ÿå…¥é—¨</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/6587/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å¤åˆç±»å‹åŠè½¬æ¢</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/51595/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸‹ï¼‰å‡½æ•°</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/24237/" title="C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸­ï¼‰æŒ‡é’ˆå’Œå¼•ç”¨"><i class="post-icon gg-file-document"></i>C++ä»é›¶å¼€å§‹ï¼ˆäºŒï¼‰ï¼šåŠ¡å®åŸºç¡€ï¼ˆä¸­ï¼‰æŒ‡é’ˆå’Œå¼•ç”¨</a></li></ul></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E5%BB%BA%E7%AB%99/">
          å»ºç«™
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/56326/" title="Hexo+Github Pageså¿«é€Ÿæ‰“é€ å±äºè‡ªå·±çš„ç½‘ç«™"><i class="post-icon gg-file-document"></i>Hexo+Github Pageså¿«é€Ÿæ‰“é€ å±äºè‡ªå·±çš„ç½‘ç«™</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Git/">
          Git
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/43848/" title="GitåŸºç¡€ç¬”è®°ï¼ˆåˆæ­¥æ•´ç†ï¼‰"><i class="post-icon gg-file-document"></i>GitåŸºç¡€ç¬”è®°ï¼ˆåˆæ­¥æ•´ç†ï¼‰</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/">
          æ ¡æ‹›ç¬”è®°
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/JAVA/">
          JAVA
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/42516/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_JVM"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_JVM</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/51787/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_Javaå…¥é—¨"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_Javaå…¥é—¨</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/8959/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_å¤šçº¿ç¨‹"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_å¤šçº¿ç¨‹</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/45493/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é”"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é”</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/7257/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é¢å¯¹å¯¹è±¡"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é¢å¯¹å¯¹è±¡</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/21069/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é›†åˆ"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸€ï¼‰_Java_é›†åˆ</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">
          è®¡ç®—æœºåŸºç¡€
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/61434/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸ƒï¼‰_è®¡ç®—æœºåŸºç¡€_æ•°æ®ç»“æ„"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸ƒï¼‰_è®¡ç®—æœºåŸºç¡€_æ•°æ®ç»“æ„</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/5582/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¹ï¼‰_è®¡ç®—æœºåŸºç¡€_ç›¸å…³è¡¥å……"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¹ï¼‰_è®¡ç®—æœºåŸºç¡€_ç›¸å…³è¡¥å……</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/44980/" title="æ ¡æ‹›ç¬”è®°ï¼ˆäºŒï¼‰_è®¡ç®—æœºåŸºç¡€_Linux&Git"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆäºŒï¼‰_è®¡ç®—æœºåŸºç¡€_Linux&Git</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/31667/" title="æ ¡æ‹›ç¬”è®°ï¼ˆå…«ï¼‰_è®¡ç®—æœºåŸºç¡€_åœºæ™¯&æ™ºåŠ›é¢˜"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆå…«ï¼‰_è®¡ç®—æœºåŸºç¡€_åœºæ™¯&æ™ºåŠ›é¢˜</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/46361/" title="æ ¡æ‹›ç¬”è®°ï¼ˆä¸‰ï¼‰_è®¡ç®—æœºåŸºç¡€_è®¡ç®—æœºç½‘ç»œ"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆä¸‰ï¼‰_è®¡ç®—æœºåŸºç¡€_è®¡ç®—æœºç½‘ç»œ</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/31215/" title="æ ¡æ‹›ç¬”è®°ï¼ˆå…­ï¼‰_è®¡ç®—æœºåŸºç¡€_Redis"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆå…­ï¼‰_è®¡ç®—æœºåŸºç¡€_Redis</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/56848/" title="æ ¡æ‹›ç¬”è®°ï¼ˆäº”ï¼‰_è®¡ç®—æœºåŸºç¡€_MySQL"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆäº”ï¼‰_è®¡ç®—æœºåŸºç¡€_MySQL</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/15646/" title="æ ¡æ‹›ç¬”è®°ï¼ˆå››ï¼‰_è®¡ç®—æœºåŸºç¡€_æ“ä½œç³»ç»Ÿ"><i class="post-icon gg-file-document"></i>æ ¡æ‹›ç¬”è®°ï¼ˆå››ï¼‰_è®¡ç®—æœºåŸºç¡€_æ“ä½œç³»ç»Ÿ</a></li></ul></li></ul></li></ul>
        <div id="widget-tree-button">
          <i class="gg-chevron-right"></i>
        </div>
      </div><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>