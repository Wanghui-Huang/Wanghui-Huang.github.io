<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>前端基础（一）JavaScript基础笔记（下） | royhuang's blog</title><meta name="keywords" content="JavaScript"><meta name="author" content="Wanghui Huang"><meta name="copyright" content="Wanghui Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第五章：浏览器 5.1 浏览器常用对象 window window 对象不但充当全局作用域，而且表示 浏览器窗口，常用属性如下：    属性名 作用     innerWidth 内宽度，不包含菜单栏、工具栏等占位元素   innerHeight 内高度，不包含菜单栏、工具栏等占位元素    screen screen 对象表示 屏幕 的信息，常用属性有：    属性名 作用     width">
<meta property="og:type" content="article">
<meta property="og:title" content="前端基础（一）JavaScript基础笔记（下）">
<meta property="og:url" content="https://hwh.zone/p/11812/index.html">
<meta property="og:site_name" content="royhuang&#39;s blog">
<meta property="og:description" content="第五章：浏览器 5.1 浏览器常用对象 window window 对象不但充当全局作用域，而且表示 浏览器窗口，常用属性如下：    属性名 作用     innerWidth 内宽度，不包含菜单栏、工具栏等占位元素   innerHeight 内高度，不包含菜单栏、工具栏等占位元素    screen screen 对象表示 屏幕 的信息，常用属性有：    属性名 作用     width">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hwh.zone/img/about-bg.jpg">
<meta property="article:published_time" content="2021-11-25T10:44:17.432Z">
<meta property="article:modified_time" content="2021-12-03T03:41:02.901Z">
<meta property="article:author" content="Wanghui Huang">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hwh.zone/img/about-bg.jpg"><link rel="shortcut icon" href="/img/cat.jpg"><link rel="canonical" href="https://hwh.zone/p/11812/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?<script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?13a4aefcbad9616a1f5859538d0d882e"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})(); </script>";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":"true# copy button","highlightLang":false,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":100,"languages":{"author":"作者: Wanghui Huang","link":"链接: ","source":"来源: royhuang's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '前端基础（一）JavaScript基础笔记（下）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-03 11:41:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="google-site-verification" content="uO6C17u7YuZfMWvThEQ9nOGQS4GIN2zAM6hC4tH-RiM" /><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">royhuang's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">前端基础（一）JavaScript基础笔记（下）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-25T10:44:17.432Z" title="发表于 2021-11-25 18:44:17">2021-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-03T03:41:02.901Z" title="更新于 2021-12-03 11:41:02">2021-12-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/">JavaScript</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>62分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="前端基础（一）JavaScript基础笔记（下）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"></span></span></div></div></div><article class="post-content" id="article-container"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1>第五章：浏览器</h1>
<h2 id="5-1-浏览器常用对象">5.1 浏览器常用对象</h2>
<h3 id="window"><em>window</em></h3>
<p><em>window</em> 对象不但充当全局作用域，而且表示 <u>浏览器窗口</u>，常用属性如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>innerWidth</em></td>
<td style="text-align:center">内宽度，不包含菜单栏、工具栏等占位元素</td>
</tr>
<tr>
<td style="text-align:center"><em>innerHeight</em></td>
<td style="text-align:center">内高度，不包含菜单栏、工具栏等占位元素</td>
</tr>
</tbody>
</table>
<h3 id="screen"><em>screen</em></h3>
<p><em>screen</em> 对象表示 <u>屏幕</u> 的信息，常用属性有：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>width</em></td>
<td style="text-align:center">屏幕宽度，以像素为单位</td>
</tr>
<tr>
<td style="text-align:center"><em>height</em></td>
<td style="text-align:center">屏幕高度，以像素为单位</td>
</tr>
<tr>
<td style="text-align:center"><em>colorDepth</em></td>
<td style="text-align:center">颜色位数，如16</td>
</tr>
</tbody>
</table>
<h3 id="navigator"><em>navigator</em></h3>
<p><em>navigator</em> 对象表示 <u>浏览器</u> 信息，常用属性有：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>appName</em></td>
<td style="text-align:center">浏览器名称</td>
</tr>
<tr>
<td style="text-align:center"><em>appVersion</em></td>
<td style="text-align:center">浏览器版本</td>
</tr>
<tr>
<td style="text-align:center"><em>language</em></td>
<td style="text-align:center">浏览器语言</td>
</tr>
<tr>
<td style="text-align:center"><em>platform</em></td>
<td style="text-align:center">操作系统类型</td>
</tr>
<tr>
<td style="text-align:center"><em>userAgent</em></td>
<td style="text-align:center">浏览器设定的 <em>user-Agent</em> 字符串</td>
</tr>
</tbody>
</table>
<h3 id="location"><em>location</em></h3>
<p><em>location</em> 对象表示 <u>当前页面<em>URL</em></u> 信息，常用属性有：</p>
<blockquote>
<p>以 <em><a target="_blank" rel="noopener" href="http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP">http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</a></em> 为例。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>href</em></td>
<td style="text-align:center">完整地址：上面全部蓝字域名</td>
</tr>
<tr>
<td style="text-align:center"><em>protocol</em></td>
<td style="text-align:center">协议名： http</td>
</tr>
<tr>
<td style="text-align:center"><em>host</em></td>
<td style="text-align:center">域名： <a target="_blank" rel="noopener" href="http://www.example.com">www.example.com</a></td>
</tr>
<tr>
<td style="text-align:center"><em>port</em></td>
<td style="text-align:center">端口： 8080</td>
</tr>
<tr>
<td style="text-align:center"><em>pathname</em></td>
<td style="text-align:center">路径名： /path/index.html</td>
</tr>
<tr>
<td style="text-align:center"><em>search</em></td>
<td style="text-align:center">查询？：?a=1&amp;b=2</td>
</tr>
<tr>
<td style="text-align:center"><em>hash</em></td>
<td style="text-align:center">哈希？：TOP</td>
</tr>
</tbody>
</table>
<p>还可以利用对象方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>reload()</em></td>
<td style="text-align:center"><em>location.reload();</em>  // 重新加载当前界面</td>
</tr>
<tr>
<td style="text-align:center"><em>assign()</em></td>
<td style="text-align:center"><em>location.assign(‘<a target="_blank" rel="noopener" href="https://www.baidu.com">https://www.baidu.com</a>’);</em>  // 当前界面打开百度，必须带有协议类型！</td>
</tr>
</tbody>
</table>
<h3 id="history"><em>history</em></h3>
<p>已不推荐使用，简单介绍常用方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>back()</em></td>
<td style="text-align:center"><em>history.back()</em>     // 相当点击浏览器后退按钮</td>
</tr>
<tr>
<td style="text-align:center"><em>forward()</em></td>
<td style="text-align:center"><em>history.forward()</em>   // 相当点击浏览器前进按钮</td>
</tr>
</tbody>
</table>
<blockquote>
<p>不推荐使用的一个实例场景。</p>
</blockquote>
<p>如果我们在登陆成功调用 <em>history.back()</em> 试图回到登陆前界面，又要重新登陆了！</p>
<h3 id="document"><em>document</em></h3>
<p><em>document</em> 对象是浏览器中 <u>DOM树根节点</u> ，可利用它进行操作DOM、获取cookie等，常用属性如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>cookie</em></td>
<td style="text-align:center"><em>document.cookie()</em>  // 获取 <em>cookie</em></td>
</tr>
</tbody>
</table>
<p>更多操作DOM，详见下节分解。</p>
<h2 id="5-2-操作DOM">5.2 操作DOM</h2>
<h3 id="1-获取节点">1.获取节点</h3>
<h4 id="getElementBy…-获取节点"><em>getElementBy…()</em> 获取节点</h4>
<p>注：标签也可称为元素、节点。</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>getElementById()</em></td>
<td style="text-align:center">根据 <u>标签ID属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByName()</em></td>
<td style="text-align:center">根据 <u>name属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByClassName()</em></td>
<td style="text-align:center">根据 <u>标签class属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByTagName()</em></td>
<td style="text-align:center">根据 <u>标签名</u> 来获取节点，如div、img</td>
</tr>
</tbody>
</table>
<blockquote>
<p>一些简单操作实例。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回ID为&#x27;test&#x27;的节点：</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下的所有直属[子节点]:</span></span><br><span class="line"><span class="keyword">var</span> cs = test.children;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下第一个、最后一个[子节点]：</span></span><br><span class="line"><span class="keyword">var</span> first = test.firstElementChild;</span><br><span class="line"><span class="keyword">var</span> last = test.lastElementChild;</span><br></pre></td></tr></table></figure>
<h4 id="CSS选择器获取节点"><em>CSS</em>选择器获取节点</h4>
<p>我们也可以利用 <u>CSS选择器 <em>selector</em> 语法</u>来获取节点：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>querySelector(selector)</em></td>
<td style="text-align:center">获取满足条件的第一个节点</td>
</tr>
<tr>
<td style="text-align:center"><em>querySelectorAll(selector)</em></td>
<td style="text-align:center">获取满足条件的所有节点</td>
</tr>
</tbody>
</table>
<p>基本选择器用法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">选择器类型</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">标签选择器：<code>标签名</code></td>
<td style="text-align:center"><em>document.querySelector(“div”)</em> //  获取第一个div标签节点</td>
</tr>
<tr>
<td style="text-align:center">类选择器：<code>.类名</code></td>
<td style="text-align:center"><em>document.querySelector(“.key”)</em> // 获取第一个class = key节点</td>
</tr>
<tr>
<td style="text-align:center">ID选择器：<code>#ID名</code></td>
<td style="text-align:center"><em>document.querySelector(“#uid”)</em> // 获取第一个ID = uid 节点</td>
</tr>
<tr>
<td style="text-align:center">属性选择器：<code>[属性=属性名]</code></td>
<td style="text-align:center"><em>document.querySelector(“[type=text]”)</em> // 获取第一个name =&quot; text&quot; 节点</td>
</tr>
</tbody>
</table>
<h5 id="层级选择器">层级选择器</h5>
<p>我们还可以进行选择器组合筛选指定元素后代：</p>
<table>
<thead>
<tr>
<th style="text-align:center">关系选择器组合</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>A B</code></td>
<td style="text-align:center">匹配A元素中的子元素B，B可以是A <u>任意级别后代</u></td>
</tr>
<tr>
<td style="text-align:center"><code>A &gt; B</code></td>
<td style="text-align:center">匹配A元素中的下级子元素B，只能是 <u>直系后代</u></td>
</tr>
<tr>
<td style="text-align:center"><code>A + B</code></td>
<td style="text-align:center">匹配A元素中的任一下一个兄弟元素B（同级）</td>
</tr>
<tr>
<td style="text-align:center"><code>B ~ E</code></td>
<td style="text-align:center">匹配B元素后面的拥有共同父元素的兄弟元素E</td>
</tr>
</tbody>
</table>
<h5 id="过滤器">过滤器</h5>
<p>过滤器一般不单独使用，附加到选择器上更精确定位元素 ：<code>&lt;选择器&gt;：&lt;元素状态关键字&gt;</code></p>
<p>⚠️ 在<em>jQuery</em> 中冒号<code>： </code>和选择器前一定要有空格！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(&#x27;#test-form:radio&#x27;);    // 错误写法：无法选择表单中单选框</span><br><span class="line">$(&#x27;#test-form :radio&#x27;);   // 正确写法，要有空格！</span><br></pre></td></tr></table></figure>
<blockquote>
<p>指定选定元素处于何种状态时的CSS样式 。</p>
</blockquote>
<ul>
<li>
<p>指定a标签处于各种状态的样式</p>
<blockquote>
<p>以 在CSS中修改不同状态<em>a</em> 标签颜色为例。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// link-匹配当前元素连接</span></span><br><span class="line"><span class="attr">a</span> :link &#123;<span class="attr">color</span>: slategray;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// visited-匹配已访问过的连接</span></span><br><span class="line"><span class="attr">a</span> :link &#123;<span class="attr">color</span>: #4b2f89;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// active-匹配元素当中激活状态（鼠标悬停）的链接</span></span><br><span class="line"><span class="attr">a</span> :active &#123;<span class="attr">color</span>: blue;&#125;</span><br><span class="line">             </span><br><span class="line"><span class="comment">// hover-匹配元素当中未激活状态的链接</span></span><br><span class="line"><span class="attr">a</span> :hover &#123;<span class="attr">color</span>: blue;&#125;             </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>匹配一组兄弟元素某元素</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:first-child</em></td>
<td style="text-align:center">匹配一组p标签第一个p标签：<em>p:first-child</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:nth-child()</em></td>
<td style="text-align:center">匹配一组p标签第一个p标签：<em>p:nth-child(1)</em></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">匹配表格中的奇数行：<em>tr:nth-child(2n+1)</em></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">匹配表格中的偶数行：<em>tr:nth-child(2n)</em></td>
</tr>
</tbody>
</table>
<p>更多：<em>:nth-last-child(an + b)、:nth-of-type(an+b)、:last-of-type</em> …</p>
</li>
<li>
<p>表单相关</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:input</em></td>
<td style="text-align:center">选择 <u>表单</u> 以下标签：<code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>，<code>&lt;select&gt;</code>和<code>&lt;button&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>:enabled</em></td>
<td style="text-align:center">选择 <u>表单</u> 可以正常输入的<code>&lt;input&gt;</code>、<code>&lt;select&gt;</code> ：<em>$(‘#test-form :enabled’)</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:disabled</em></td>
<td style="text-align:center">选择 <u>表单</u> 那些不能输入的 <code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>：<em>$(‘#test-form :disabled’)</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:file</em></td>
<td style="text-align:center">选择文件： <em>input : file   === input[type=file]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:checkbox</em></td>
<td style="text-align:center">选择复选框：<em>input : checkbox=== input[type=checkbox]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:radio</em></td>
<td style="text-align:center">选择单选框：<em>input : radio   === input[type=radio]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:focus</em></td>
<td style="text-align:center">选择当前输入焦点：例如把光标放到一个<code>&lt;input&gt;</code>上，<em>$(‘input:focus’)</em> 便可选中</td>
</tr>
<tr>
<td style="text-align:center"><em>:checked</em></td>
<td style="text-align:center">选择当前勾上的单选框和复选框：<em>$(‘input[type=radio]:checked’)</em></td>
</tr>
</tbody>
</table>
<blockquote>
<p>选择表单<em>id = test-form</em> 下所有 <code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>，<code>&lt;select&gt;</code>和<code>&lt;button&gt;</code> 节点。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无法用：document.querySelectorALL(&#x27;#test-form :input&#x27;) ？？</span></span><br><span class="line">$(<span class="string">&#x27;#test-form :input&#x27;</span>);   </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>其它更多</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:empty</em></td>
<td style="text-align:center">匹配没有子元素的元素</td>
</tr>
<tr>
<td style="text-align:center"><em>:target</em></td>
<td style="text-align:center">用于匹配URI中的ID标识（即：锚点）部分</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="获取节点基本信息">获取节点基本信息</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以获取基本属性等信息，不存在的属性字符串类型返回空字符串 <code>“”</code> ，布尔类型默认返回 <code>false</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> u = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取存在的属性</span></span><br><span class="line">u.type;    <span class="comment">// &quot;text&quot;</span></span><br><span class="line">u.id;      <span class="comment">// &quot;user&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取不存在的属性</span></span><br><span class="line">u.name;    <span class="comment">// &quot;&quot;</span></span><br><span class="line">u.checked; <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文本框值</span></span><br><span class="line">u.value ;  <span class="comment">// &quot;hwh&quot;，已经在文本框中输入hwh</span></span><br></pre></td></tr></table></figure>
<h3 id="2-更新DOM">2.更新DOM</h3>
<h4 id="更新DOM节点文本">更新DOM节点文本</h4>
<p>我们常用以下属性对DOM节点文本内容进行修改：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>innerHTML</em></td>
<td style="text-align:center">可以插入HTML标签 &amp; 字符串</td>
</tr>
<tr>
<td style="text-align:center"><em>innerText</em></td>
<td style="text-align:center">只能插入字符串，插入HTML标签会解析成字符串</td>
</tr>
<tr>
<td style="text-align:center"><em>textContent</em></td>
<td style="text-align:center">同上，但会返回所有文本包括隐藏文本</td>
</tr>
</tbody>
</table>
<blockquote>
<p>更新标签、字符串实例。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span> test <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;content&#x27;</span>);</span><br><span class="line">c.innerText; <span class="comment">// 输出：&quot;test&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.插入HTML</span></span><br><span class="line">c.innerHTML = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;      <span class="comment">// 打开浏览器div标签内输出：hello test!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.插入字符串</span></span><br><span class="line">c.innerText = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;      <span class="comment">// 打开浏览器div标签内输出：&lt;p&gt; hello test!&lt;/p&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.插入字符串</span></span><br><span class="line">c.textContent = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;    <span class="comment">// 打开浏览器div标签内输出：&lt;p&gt; hello test!&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="更新CSS样式">更新CSS样式</h4>
<p>获取节点后，利用 <em>style</em> 属性进行样式设置。</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>style</em></td>
<td style="text-align:center">DOM节点 <em>style</em> 属性对应所有的CSS，可直接获取OR设置。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>进行简单CSS样式设置。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;content&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置CSS</span></span><br><span class="line">c.style.color = <span class="string">&#x27;#ff0000&#x27;</span>;</span><br><span class="line">c.style.fontSize = <span class="string">&#x27;1200px&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>⚠️ 注意 <u><em>fontSize</em></u> 等在<em>javaScript</em> 中是驼峰命名，而在CSS中是 <u><em>font-size</em></u>  ！</p>
<h3 id="3-插入DOM">3.插入DOM</h3>
<p>在前我们利用：<code>c.innerHTML = '&lt;p&gt; hello test!&lt;/p&gt;';</code>  可以在<code>&lt;div&gt; ... &lt;/div&gt;</code>插入HTML标签，但是会替换掉里面所有DOM节点内容。</p>
<p>为此我们可以利用以下方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>appendChild(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>最后一个子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>insertBefore(newElem，ref)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>另一个子节点<em>ref</em>前</u></td>
</tr>
</tbody>
</table>
<p>下面为预设好的HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建一个新节点：<code>&lt;li id=&quot;javascript&quot;&gt;javascript&lt;/li&gt;</code> 插入到列表末尾。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新节点</span></span><br><span class="line"><span class="keyword">var</span> li_js =  <span class="built_in">document</span>.createElement(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">li_js.id = <span class="string">&#x27;python&#x27;</span>;</span><br><span class="line">li_js.innerText = <span class="string">&#x27;javaScript&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入到末尾</span></span><br><span class="line">ul_pl.appendChild(li_js);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建一个新节点：<code>&lt;li id=&quot;C++&quot;&gt;C++&lt;/li&gt;</code> 插入到列 <code>python</code> 前。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> li_py = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;python&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新节点</span></span><br><span class="line"><span class="keyword">var</span> li_cpp =  <span class="built_in">document</span>.createElement(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">li_cpp.id = <span class="string">&#x27;C++&#x27;</span>;</span><br><span class="line">li_cpp.innerText = <span class="string">&#x27;C++&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入到末尾</span></span><br><span class="line">ul_pl.insertBefore(li_cpp,li_py);</span><br></pre></td></tr></table></figure>
<h3 id="4-删除DOM">4. 删除DOM</h3>
<p>要删除一个节点，首先要获得该节点本身以及它的父节点，然后调用父节点的<code>removeChild()</code>把自己删掉：</p>
<blockquote>
<p>删除指定列表第三个节点。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取列表第三个子节点</span></span><br><span class="line"><span class="keyword">var</span> li3 = ul_pl.children[<span class="number">2</span>];</span><br><span class="line"><span class="comment">// 调用该付节点删除该子节点</span></span><br><span class="line">ul_pl.removeChild(li3);</span><br></pre></td></tr></table></figure>
<p>⚠️ 注意：</p>
<ul>
<li>DOM树中节点虽然被删除，但是还在内存中，可以随时被添加到别的位置</li>
<li><code>children</code>属性 <u>实时变化</u>，删除后<code>父节点.chidren</code>返回的列表会对应减少</li>
</ul>
<h2 id="5-3-操作表单">5.3 操作表单</h2>
<h3 id="常用表单元素">常用表单元素</h3>
<p>&lt;form&gt; 元素定义 HTML 表单，收集用户输入 ：<code>&lt;form&gt;... 表单元素...&lt;/form&gt;</code> 。以下是常用表单元素：</p>
<center>常用表单元素</center>
<table>
<thead>
<tr>
<th style="text-align:center">表单元素</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&lt;input&gt;</td>
<td style="text-align:center">最重要的表单元素，含有<u>不同类型的 input 元素</u> 、复选框、单选按钮、提交按钮等。</td>
</tr>
<tr>
<td style="text-align:center">&lt;select&gt;</td>
<td style="text-align:center">定义下拉列表：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230361276.png" alt="1565230361276"></td>
</tr>
<tr>
<td style="text-align:center">&lt;textarea&gt;</td>
<td style="text-align:center">定义多行输入文本域：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230342229.png" alt="1565230342229"></td>
</tr>
<tr>
<td style="text-align:center">&lt;button&gt;</td>
<td style="text-align:center">按钮：点击后出发onclick事件代码，输出Hello World!<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230477491.png" alt="1565230477491"></td>
</tr>
</tbody>
</table>
<p><u>不同类型的 input 元素</u> ：有复选框、单选按钮、提交按钮等：</p>
<center>常用input类型</center>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>text</em></td>
<td style="text-align:center">文本输入：<code>&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>password</em></td>
<td style="text-align:center">密码输入：<code>&lt;input type=&quot;password&quot; name=&quot;psw&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>submit</em></td>
<td style="text-align:center">提交表单按钮：<code>&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>radio</em></td>
<td style="text-align:center">单选按钮： ○<em>Male</em>  ○<em>Female</em> （多个单选按钮组合成 <u>多选一</u> ，name要相同）  <img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231160124.png" alt="1565231160124"></td>
</tr>
<tr>
<td style="text-align:center"><em>checkbox</em></td>
<td style="text-align:center">复选框：□ <em>I have a bike</em>  □ <em>I have a car</em><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231125219.png" alt="1565231125219"></td>
</tr>
<tr>
<td style="text-align:center"><em>button</em></td>
<td style="text-align:center">和前表单元素button类似，但没有后面&lt;/button&gt;：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231341774.png" alt="1565231341774"></td>
</tr>
<tr>
<td style="text-align:center"><em>number</em></td>
<td style="text-align:center">输入数值，并可对其作出限制：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231462510.png" alt="1565231462510"></td>
</tr>
<tr>
<td style="text-align:center"><em>date</em></td>
<td style="text-align:center">包含日期的输入字段：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565232828624.png" alt="1565232828624"></td>
</tr>
<tr>
<td style="text-align:center"><em>color</em></td>
<td style="text-align:center">颜色选择器会出现输入字段：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231606516.png" alt="1565231606516"></td>
</tr>
</tbody>
</table>
<p>更多输入类型：time（时间选择器）、datetime &amp; datetime-local（日期选择器）、search（搜索字段类似文本字段）、tel &amp; url &amp; email （可自动验证是否是电话、网址、邮箱地址）</p>
<h3 id="操作表单">操作表单</h3>
<h4 id="操作值">操作值</h4>
<p>对于 <code>text</code>、<code>password</code>、<code>hidden</code>以及<code>select</code> 等直接<em>value</em> 获取、设置值即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;input type=&quot;text&quot; name = &quot;username&quot;&gt;</span></span><br><span class="line"><span class="keyword">var</span> input = <span class="built_in">document</span>.getElementsByName(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line"></span><br><span class="line">input.value; <span class="comment">// 用户输入值</span></span><br><span class="line">input.value = <span class="string">&quot;hello!&quot;</span>;  <span class="comment">// 设置值</span></span><br></pre></td></tr></table></figure>
<p>对于 <code>radio</code> 、<code>checkbox</code>，如果获取 <em>value</em> 始终是预设值，不能获取用户输入选择值。</p>
<p>应该用节点 <code>checked</code>属性判断用户选中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&lt;form&gt;</span></span><br><span class="line"><span class="comment">&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; id=&quot;b&quot; value=&quot;Bike&quot;&gt;I have a bike</span></span><br><span class="line"><span class="comment">&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; id=&quot;c&quot; value=&quot;Car&quot;&gt;I have a car </span></span><br><span class="line"><span class="comment">&lt;/form&gt; </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> bike = <span class="built_in">document</span>.getElementsById(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(bike.checked)</span><br><span class="line">&#123;</span><br><span class="line">     <span class="comment">// do something</span></span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">bike.checked = <span class="literal">false</span>; <span class="comment">// 设置按钮未被选中</span></span><br></pre></td></tr></table></figure>
<h4 id="提交表单">提交表单</h4>
<p>HTML 表单用于收集用户输入，比如下例收集用户输入的账号、密码验证登陆：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565691221197.png" alt="1565691221197"></p>
<p>提交表单一般有如下三种方法：</p>
<ul>
<li>通过 <em><input type="submit"></em> 按钮提交</li>
<li>通过 <em>form</em> 对象 <em>submit()</em> 方法提交</li>
<li><em>ajax</em> 方式提交</li>
</ul>
<h5 id="type-“submit”-表单提交"><em>type=“submit”</em> 表单提交</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;demo_form.asp&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><em>action</em> 属性：定义提交表单执行的动作，如果省略则会被置为当前页面。在这里提交的表单值会交给脚本代码 <em>demo_form.asp</em> 处理。</li>
<li><em>method</em> 属性：定义提交方式为<em>GET</em> 或者 <em>POST</em></li>
</ul>
<p>点击 <em>立即登陆</em> 按钮后，会自动把表单值提交给脚本文件 <em>demo_form.asp</em> 处理 。</p>
<p>服务器接收到的提交内容为（<em>GET</em> 方式提交）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=hwh&amp;pwd=123456</span><br></pre></td></tr></table></figure>
<p>⚠️ 只有设置 <em>name</em> 属性的表单值才会被提交，提交的值构造方式为：<em>name1:value1&amp;name2:value2…</em></p>
<h5 id="submit-方法提交"><em>submit()</em> 方法提交</h5>
<p>可以通过：<em><u>点击button</u></em>、<em><u>点击链接</u></em> 等方式触发事件，<em>js</em> 调用<em>form</em> DOM对象<em>submit()</em> 方法提交表单数据。</p>
<p>⚠️ 不推荐这种方式，扰乱了原有浏览器提交表单。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;demo_form.asp&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;btn&#x27;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;submitForm()&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>和前面 <u><em>type=“submit”</em> 表单提交方式</u>  对比，<em>type=“submit”</em> 被修改为 —&gt; <em>type=“button”</em></li>
<li><em>button</em>  按钮设置了属性 <em>onclick</em> ，绑定<em>click</em> 事件执行 <em>submitForm()</em> 函数。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&quot;demo_form&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     form.submit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可用 <em>jQuery</em> 实现 ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = $(<span class="string">&quot;#demo_form&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> button = $(<span class="string">&quot;#btn&quot;</span>);</span><br><span class="line">button.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       form.submit();</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>服务器接收到的提交内容为（<em>GET</em> 方式提交）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=hwh&amp;pwd=123456</span><br></pre></td></tr></table></figure>
<h5 id="ajax-提交"><em>ajax</em> 提交</h5>
<p><em>ajax</em> 方式提交需要先理解 <u>5.5 <em>AJAX</em></u> 一节。</p>
<p><em>html</em> 代码部分：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;btn&#x27;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;submitForm()&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>点击登陆按钮，发送 <em>ajax</em> 请求</li>
</ul>
<p><em>js</em> 代码部分：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">            alert(xmlhttp.responseText)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/demo_form.asp&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>🙂 也可用 <em>jQuery</em> 实现 <em>ajax</em> 请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">var</span> userName = $(<span class="string">&#x27;#user&#x27;</span>).val();</span><br><span class="line">     <span class="keyword">var</span> password = $(<span class="string">&#x27;#pwd&#x27;</span>).val();</span><br><span class="line">     $.ajax</span><br><span class="line">     (</span><br><span class="line">     &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;Get&quot;</span>,</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&quot;/demo_form.asp&quot;</span>,</span><br><span class="line">      <span class="attr">username</span>: userName,</span><br><span class="line">      <span class="attr">password</span>:password,</span><br><span class="line">      <span class="attr">dataType</span> : <span class="string">&quot;json&quot;</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">respMsg</span>)</span>&#123;&#125;</span><br><span class="line">     &#125;</span><br><span class="line">     );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="更多提交方式">更多提交方式</h5>
<p>更多提交方式，参考：<a target="_blank" rel="noopener" href="http://www.anyrt.com/blog/list/submit.html">六种提交 <em>form</em> 表单方式</a></p>
<h2 id="5-4-操作文件">5.4 操作文件</h2>
<p>用到再提。</p>
<h2 id="5-5-AJAX">5.5 <em>AJAX</em></h2>
<h3 id="什么是-AJAX">什么是 <em>AJAX</em> ?</h3>
<p>传统的网页（不使用 <em>AJAX</em>）如果需要更新内容，必需重载整个网页面。</p>
<blockquote>
<p>如何不重新加载界面更新内容？</p>
</blockquote>
<p><em>AJAX = 异步 JavaScript 和 XML</em>，可以实现网页异步更新，这意味着不重新加载网页而进行更新。</p>
<h3 id="AJAX-应用实例"><em>AJAX</em> 应用实例</h3>
<p>当我们使用百度搜索，在输入框输入搜索内容时，通过<em>AJAX</em>和服务器进行请求返回一列推荐搜索结果。在这个过程中，并没有重新加载界面。</p>
<blockquote>
<p>那么在前端和服务器后台都是具体怎么实现沟通呢？这里以一个推荐姓名实例demo为例。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565667374702.png" alt="1565667374702"></p>
<h4 id="PART1-：-前端html"><em>PART1</em> ： 前端<em>html</em></h4>
<p>前端 <em>html</em> 实现见下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"> <span class="comment">// ajax部分...</span></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>请在下面的输入框中键入字母（A - Z）：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span> </span><br><span class="line">姓氏：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;txt1&quot;</span> <span class="attr">onkeyup</span>=<span class="string">&quot;showHint(this.value)&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>建议：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;txtHint&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="PART2-：前端-js-实现-AJAX"><em>PART2</em> ：前端 <em>js</em>  实现 <em>AJAX</em></h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax部分...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">res</span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">res</span>)    </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             success(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             fail(xmlhttp.responseText); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下细分<em>ajax</em> 执行过程：</p>
<ol>
<li>
<p>创建对象</p>
<p>现代浏览器使用 <em>XMLHttpRequest</em> 对象  用于在后台与服务器交换数据：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
<p>对于IE5、6不得不使用 <em>ActiveXObject</em>  对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>发送请求</p>
<p>如需将请求发送到服务器，我们使用 <em>XMLHttpRequest</em> 对象的 <em>open() &amp; send()</em> 方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>open(method,url,async)</em></td>
<td style="text-align:center">规定：<em>请求的类型</em>、<em>URL处理脚本文件</em>  、<em>是否异步处理请求</em></td>
</tr>
<tr>
<td style="text-align:center"><em>send(string)</em></td>
<td style="text-align:center">将请求发送到服务器：<em>string</em> 参数仅用于 <em>POST</em> 请求</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">xmlhttp.send();</span><br></pre></td></tr></table></figure>
<ul>
<li>请求方法为<em>GET</em> 类型，在以下情况推荐使用 <em>POST</em> 请求：
<ul>
<li>无法使用缓存文件（更新服务器上的文件或数据库）</li>
<li>向服务器发送大量数据（POST 没有数据量限制）</li>
<li>发送包含未知字符的用户输入时，POST 比 GET 更稳定也更可靠</li>
</ul>
</li>
<li><em>url = /ajax/gethint.asp?q= str</em> ：<em>/ajax/gethint.asp</em> 是处理脚本通常为 <em>ASP/PHP</em> 文件 ；<em>?q=str</em>  是请求的参数，<em>GET</em> 方式必须向<em>URL</em> 添加信息。</li>
<li><em>true</em> ：表示开启异步，<em>XMLHttpRequest</em> 对象如果要用于 <em>AJAX</em> 的话必须设置为 <em>true</em> 。</li>
</ul>
</li>
<li>
<p>服务器响应</p>
<p>如需获得来自服务器的响应，使用 <em>XMLHttpRequest</em> 对象的 <em>responseText</em> 、 <em>responseXML</em> 属性：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>responseText</em></td>
<td style="text-align:center">获得字符串形式的响应数据</td>
</tr>
<tr>
<td style="text-align:center"><em>responseXML</em></td>
<td style="text-align:center">获得 <em>XML</em> 形式的响应数据</td>
</tr>
</tbody>
</table>
<p>同时，通过脚本和服务器交互过程，我们需要根据连接状态来触发执行操作。我们可以使用<em>XMLHttpRequest</em> 对象的 <em>onreadystatechange</em> 事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>onreadystatechange</em></td>
<td style="text-align:center">存储函数（或函数名），每当 <em>readyState</em> 属性改变时，就会调用该函数。</td>
</tr>
</tbody>
</table>
<p><em>readyState</em> 同前 <em>responseText</em> 、 <em>responseXML</em> 也是<em>XMLHttpRequest</em> 对象属性：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>readyState</em></td>
<td style="text-align:center">存有 <em>XMLHttpRequest</em> 的状态：从 0 --&gt;  4 发生变化</td>
</tr>
<tr>
<td style="text-align:center"><em>status</em></td>
<td style="text-align:center">200: “OK”     404: 未找到页面</td>
</tr>
</tbody>
</table>
<p>对应实际代码为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">      &#123;</span><br><span class="line">           success(xmlhttp.responseText);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">           fail(xmlhttp.responseText); </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="PART3-：服务器端-ASP-脚本"><em>PART3</em> ：服务器端*.ASP* 脚本</h4>
<p>以下为 <em>gethint.asp</em> 文件，根据用户输入字母返回推荐的名字：</p>
<blockquote>
<p>🙂 当然你也可以用 <em>PHP</em>  实现，这里从略。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">response.expires=-1</span><br><span class="line">dim a(30)</span><br><span class="line">&#x27;用名字来填充数组</span><br><span class="line">a(1)=&quot;Anna&quot;</span><br><span class="line">a(2)=&quot;Brittany&quot;</span><br><span class="line">a(3)=&quot;Cinderella&quot;</span><br><span class="line">a(4)=&quot;Diana&quot;</span><br><span class="line">a(5)=&quot;Eva&quot;</span><br><span class="line">a(6)=&quot;Fiona&quot;</span><br><span class="line">a(7)=&quot;Gunda&quot;</span><br><span class="line">a(8)=&quot;Hege&quot;</span><br><span class="line">a(9)=&quot;Inga&quot;</span><br><span class="line">a(10)=&quot;Johanna&quot;</span><br><span class="line">a(11)=&quot;Kitty&quot;</span><br><span class="line">a(12)=&quot;Linda&quot;</span><br><span class="line">a(13)=&quot;Nina&quot;</span><br><span class="line">a(14)=&quot;Ophelia&quot;</span><br><span class="line">a(15)=&quot;Petunia&quot;</span><br><span class="line">a(16)=&quot;Amanda&quot;</span><br><span class="line">a(17)=&quot;Raquel&quot;</span><br><span class="line">a(18)=&quot;Cindy&quot;</span><br><span class="line">a(19)=&quot;Doris&quot;</span><br><span class="line">a(20)=&quot;Eve&quot;</span><br><span class="line">a(21)=&quot;Evita&quot;</span><br><span class="line">a(22)=&quot;Sunniva&quot;</span><br><span class="line">a(23)=&quot;Tove&quot;</span><br><span class="line">a(24)=&quot;Unni&quot;</span><br><span class="line">a(25)=&quot;Violet&quot;</span><br><span class="line">a(26)=&quot;Liza&quot;</span><br><span class="line">a(27)=&quot;Elizabeth&quot;</span><br><span class="line">a(28)=&quot;Ellen&quot;</span><br><span class="line">a(29)=&quot;Wenche&quot;</span><br><span class="line">a(30)=&quot;Vicky&quot;</span><br><span class="line"></span><br><span class="line">&#x27;获得来自 URL 的 q 参数</span><br><span class="line">q=ucase(request.querystring(&quot;q&quot;))</span><br><span class="line"></span><br><span class="line">&#x27;如果 q 大于 0，则查找数组中的所有提示</span><br><span class="line">if len(q)&gt;0 then</span><br><span class="line">  hint=&quot;&quot;</span><br><span class="line">  for i=1 to 30</span><br><span class="line">    if q=ucase(mid(a(i),1,len(q))) then</span><br><span class="line">      if hint=&quot;&quot; then</span><br><span class="line">        hint=a(i)</span><br><span class="line">      else</span><br><span class="line">        hint=hint &amp; &quot; , &quot; &amp; a(i)</span><br><span class="line">      end if</span><br><span class="line">    end if</span><br><span class="line">  next</span><br><span class="line">end if</span><br><span class="line"></span><br><span class="line">&#x27;如果未找到提示，则输出 &quot;no suggestion&quot;</span><br><span class="line">&#x27;否则输出正确的值</span><br><span class="line">if hint=&quot;&quot; then</span><br><span class="line">  response.write(&quot;no suggestion&quot;)</span><br><span class="line">else</span><br><span class="line">  response.write(hint)</span><br><span class="line">end if</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="jQuery-ajax"><em>jQuery</em> &amp; <em>ajax</em></h3>
<p><em>jQuery</em> 提供了对<em>JavaScript</em> <em>ajax</em> 高度的封装<em>API</em> ，常用方法如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>$.ajax({name:val, name:val,…})</em></td>
<td style="text-align:center"><strong>常用于其他<em>jQuery Ajax</em>方法不能完成的请求</strong></td>
</tr>
<tr>
<td style="text-align:center"><em>$.post(url, data, func, dataType)</em></td>
<td style="text-align:center"><em>POST</em>方式执行<em>Ajax</em>请求，从服务器加载数据。</td>
</tr>
<tr>
<td style="text-align:center"><em>$.get(url, data, func, dataType)</em></td>
<td style="text-align:center"><em>GET</em>方式执行<em>Ajax</em>请求，从服务器加载数据。</td>
</tr>
<tr>
<td style="text-align:center"><em>$.getJSON(url, data, func)</em></td>
<td style="text-align:center"><em>GET</em>方式从服务器加载<em>JSON</em>格式数据。相较于$.get()不必再指定<em>dataType</em></td>
</tr>
<tr>
<td style="text-align:center"><em>$.load(url, data, func)</em></td>
<td style="text-align:center"><em>POST</em>方式将服务器加载的数据插入指定DOM中，<u><em>data</em>不存在则以<em>GET</em>方式</u></td>
</tr>
<tr>
<td style="text-align:center"><em>$.getScript(url, func)</em></td>
<td style="text-align:center"><em>GET</em>方式执行<em>Ajax</em>请求，从服务器加载并执行回传的<em>JavaScript</em>。</td>
</tr>
</tbody>
</table>
<p>注：上述方法 <em>func</em> 都是指在方法完成后执行的回调（<em>callback</em>）函数 。</p>
<ul>
<li>格式：<em>func(data, status, xhr)</em></li>
<li>参数：<em>data</em> — 服务器返回数据；<em>status</em> — 响应状态 ；<em>xhr</em> – <em>XMLHttpRequest</em>对象。一般关注 <em>data</em> 即可。</li>
</ul>
<h4 id="ajax"><em>$.ajax()</em></h4>
<p><em><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">.</mi><mi>a</mi><mi>j</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>∗</mo><mtext>完整参数形式为：</mtext><mo>∗</mo></mrow><annotation encoding="application/x-tex">.ajax()* 完整参数形式为：*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord mathnormal">aja</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">完整参数形式为：</span><span class="mord">∗</span></span></span></span>.ajax({name:val, name:val,…})</em> ，其参数为一个对象 <strong>{}</strong> ，可选字段为：</p>
<ul>
<li><em><strong>url</strong></em>：链接地址，字符串表示</li>
<li><em><strong>data</strong></em>：需发送到服务器的数据，<em>GET、POST</em>都可以，格式为 <em>{A: ‘…’, B: ‘…’}</em></li>
<li><em><strong>type</strong></em>：指定请求类型为：“POST” 或 “GET”</li>
<li><em>timeout</em>：请求超时时间 / 毫秒</li>
<li><em>cache</em>：是否缓存请求结果，<em>bool</em>表示</li>
<li><em>contentType</em>：内容类型，默认为 <em>“application/x-www-form-urlencoded”</em></li>
<li><em><strong>dataType</strong></em>：<u>服务器响应的数据类型</u>，<u>字符串表示</u></li>
<li><em>success</em>：请求成功后，服务器回调的函数</li>
<li><em>error</em>：请求失败后，服务器回调的函数</li>
<li><em>complete</em>：请求完成后调用的函数，无论请求是成功还是失败，都会调用该函数；<u>如果设置了success与error</u>函数，则该函数在它们之后被调用</li>
<li><em><strong>async</strong></em>：是否异步处理，bool表示，默认为true；设置该值为false后，JS不会向下执行，而是原地等待服务器返回数据，并完成相应的回调函数后，再向下执行</li>
<li><em><strong>username</strong></em>：访问认证请求中携带的用户名，字符串表示</li>
<li><em><strong>password</strong></em>：返回认证请求中携带的密码，字符串表示</li>
</ul>
<blockquote>
<p>下面通过 <em>$.ajax()</em> 方法请求服务器加载一个txt文本。</p>
</blockquote>
<p>html代码部分：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>通过 AJAX 改变文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;b01&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>点我加载txt<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// ajax实现部分...</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565842814777.png" alt="1565842814777"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span></span><br><span class="line">   &#125;);</span><br><span class="line">   $(<span class="string">&quot;#myDiv&quot;</span>).html(htmlobj.responseText);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565843001023.png" alt="1565843001023"></p>
<h5 id="回调函数">回调函数</h5>
<p>也可使用回调函数，如果成功就显示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span>,</span><br><span class="line">      <span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(data); &#125;</span><br><span class="line">   &#125;);  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>回调函数<em>success</em>有参数 <em>data</em> ，接收服务器返回数据，这里接收的是文本：<em>test1.txt</em> 。</p>
</li>
<li>
<p>也可以使用链式调用回调函数，类似前面 <em>Promise</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span></span><br><span class="line">   &#125;)</span><br><span class="line">  .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(data); &#125;)</span><br><span class="line">  .fail(<span class="function"><span class="keyword">function</span> (<span class="params">xhr,status</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(<span class="string">&#x27;失败:&#x27;</span>+xhr.status+<span class="string">&#x27;原因:&#x27;</span>+  status);&#125;)</span><br><span class="line">  .always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="string">&#x27;请求完成: 无论成功或失败都会调用&#x27;</span>);&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="get"><em>$.get()</em></h4>
<p>简单的 <em>GET</em> 请求功能以*<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">.</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>∗</mo><mtext>取代复杂</mtext><mo>∗</mo></mrow><annotation encoding="application/x-tex">.get()* 取代复杂 *</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">取代复杂</span><span class="mord">∗</span></span></span></span>.ajax()* ，请求成功时可调用回调函数。</p>
<p>其格式为：<em>$.get(url, data, func, dataType)</em></p>
<ul>
<li><em>url</em>：链接地址，字符串表示</li>
<li><em>data</em>：需要发生到服务器的数据，以键值对形式</li>
<li><em>func(data, status, xhr)</em>：回调函数，<em>data</em> — 服务器返回数据；<em>status</em> — 响应状态 ；<em>xhr</em> – <em>XMLHttpRequest</em>对象。一般关注 <em>data</em> 即可。</li>
<li><em>dataType</em>：服务器返回数据的格式</li>
</ul>
<blockquote>
<p>以*$.get()* 实现上述点击按钮加载指定文本。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   htmlobj=$.get(<span class="string">&quot;/jquery/test1.txt&quot;</span></span><br><span class="line">   ,<span class="function"><span class="keyword">function</span>(<span class="params">data,status</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $(<span class="string">&quot;#myDiv&quot;</span>).html(data);</span><br><span class="line">   &#125;);   </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>回调函数<em>function(data,status)</em> 参数<em>data、status</em> 分别接收服务器返回的数据、状态。</li>
</ul>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565843001023.png" alt="1565843001023"></p>
<p>⚠️ 经过测试，似乎只能在回调函数里接收数据，像*$.ajax()* 一样用<em>responseText</em> 获取返回数据不成功：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   htmlobj=$.get(<span class="string">&quot;/jquery/test1.txt&quot;</span>);</span><br><span class="line">   $(<span class="string">&quot;#myDiv&quot;</span>).html(htmlobj.responseText); <span class="comment">// 点击按钮加载数据不成功？？！</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="post"><em>$.post()</em></h4>
<p>和  <em>$.get()</em> 类似，接收参数一致，除了请求方式变为了 <em>post</em> 方式。</p>
<p>其格式为：<em>$.post(url, data, func, dataType)</em></p>
<blockquote>
<p>向指定界面发送 <em>HTTP POST</em> 请求，并获得返回的结果 。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565858154265.png" alt="1565858154265"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 城市：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;city&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>发送 POST 请求，获取返回结果 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript"></span>&#123;</span></span><br><span class="line"><span class="javascript">      $.post(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span></span><br><span class="line"><span class="javascript">      &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span></span><br><span class="line"><span class="javascript">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span>(<span class="params">data,status</span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript">      </span>&#123;</span></span><br><span class="line"><span class="javascript">          $(<span class="string">&#x27;#myDiv&#x27;</span>).html(<span class="string">&quot;数据：&quot;</span> + data + <span class="string">&quot;&lt;br&gt;状态：&quot;</span> + status);</span></span><br><span class="line"><span class="javascript">      &#125;);</span></span><br><span class="line"><span class="javascript">&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="load"><em>$.load()</em></h4>
<p><em>$.load()</em> 如果数据存在则以 <em>POST</em> 方式（不存在则以 <em>GET</em> 方式）加载服务器返回的数据到 <u>指定 DOM 节点</u>中 。</p>
<p>其格式为：<em>$(selector).load(URL,data,func)</em>。</p>
<h5 id="举个例子">举个例子</h5>
<blockquote>
<p>依旧以上 <em>$.post()</em> 所举实例为例，加载服务器返回的结果到指定节点中。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859062033.png" alt="1565859062033"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 城市：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;city&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>发送 POST 请求，获取返回结果 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript"></span>&#123;</span></span><br><span class="line"><span class="javascript">   </span></span><br><span class="line"><span class="javascript">      $(<span class="string">&#x27;#myDiv&#x27;</span>).load(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span></span><br><span class="line"><span class="javascript">      &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span></span><br><span class="line"><span class="javascript">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">      );</span></span><br><span class="line"><span class="javascript">&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面会将返回的结果自动加载到指定节点 <em><u>#myDiv</u></em> 中，当然你也可以使用回调函数来自定义加载：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   </span><br><span class="line">      $(<span class="string">&#x27;#myDiv&#x27;</span>).load(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span><br><span class="line">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">data,status,xhr</span>)</span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         $(<span class="string">&#x27;#myDiv&#x27;</span>).html(<span class="string">&quot;数据：&quot;</span> + data + <span class="string">&quot;&lt;br&gt;状态：&quot;</span> + status);</span><br><span class="line">      &#125;</span><br><span class="line">      );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>回调函数参数意义同前，显示结果为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859613517.png" alt="1565859613517"></p>
<h5 id="再举个例子">再举个例子</h5>
<p>也可直接加载<em>url</em> 指定资源，不用传递其它参数。</p>
<blockquote>
<p>点击按钮后，指定节点直接加载 <em>demo_test.txt</em> 文件内容。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565860429522.png" alt="1565860429522"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span>请点击下面的按钮，通过 jQuery AJAX 改变这段文本。<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>获得外部的内容<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">  $(<span class="string">&quot;#btn1&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript">  </span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">&#x27;#test&#x27;</span>).load(<span class="string">&#x27;/example/jquery/demo_test.txt&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  &#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859858855.png" alt="1565859858855"></p>
<h2 id="5-6-Promise">5.6 <em>Promise</em></h2>
<h3 id="初识-Promise">初识 <em>Promise</em></h3>
<p>先不理会那些复杂的概念，我们来直观了解下 <em>Promise</em> 是什么：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565770221805.png" alt="1565770221805"></p>
<p>很容易得知，<em>Promise</em> 原来是一个构造函数：</p>
<ul>
<li>在自己身上有 <em>all()、reject()、resolve()</em> 等方法</li>
<li>在原型上有 <em>then()、catch()</em> 等方法，<em>then()</em> 返回一个 <em>Promise</em> 对象。</li>
</ul>
<p>那么 <em>new Promise()</em> 出来的对象自然也拥有以上方法。</p>
<h3 id="举个栗子">举个栗子</h3>
<h4 id="原生-JavaScript-执行异步">原生 <em>JavaScript</em> 执行异步</h4>
<p>在 <em>JavaScript</em> 世界里，所有代码都是单线程执行。因此 <em>JavaScript</em> 所有网络操作、浏览器事件都必须异步执行。</p>
<p>也就是说，在某个时间点，会执行某个函数。然后根据函数状态执行不同的处理函数，也就是常说的回调函数。</p>
<blockquote>
<p>如，生成一个0-2之间的随机数，如果小于1，则等待1s后返回成功，否则返回失败。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">str</span>)</span>&#123;  <span class="built_in">console</span>.log(str); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">str</span>)   </span>&#123;  <span class="built_in">console</span>.log(str); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeOut = <span class="built_in">Math</span>.random() * <span class="number">2</span>;</span><br><span class="line">    log(<span class="string">&#x27;set timeout to: &#x27;</span> + timeOut + <span class="string">&#x27; seconds.&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeOut &lt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            success(<span class="string">&#x27;成功：生成随机数小于1&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            fail(<span class="string">&#x27;失败：生成随机数大于1&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<ul>
<li>本文中所有异步操作均以 <em>setTimeout</em>为例子，而不使用 <em>ajax</em> 。</li>
</ul>
<p>可以看到，执行<em>test()</em> —&gt; 延迟1s后执行匿名判断函数 —&gt; 根据判断结果执行回调函数：<em>success()</em> 、<em>fail()</em> 。</p>
<h4 id="Promise-执行异步"><em>Promise</em>  执行异步</h4>
<p>如果我们用 <em>Promise</em> 对象来执行可以达到相同效果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeOut = <span class="built_in">Math</span>.random() * <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeOut &lt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="string">&#x27;生成随机数小于1&#x27;</span>;</span><br><span class="line">            resolve(date);  <span class="comment">// 传递参数date给Promise对象.then方法内部匿名函数参数</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="string">&#x27;生成随机数大于1&#x27;</span>;</span><br><span class="line">            reject(date);  <span class="comment">// 传递参数date给Promise对象.catch方法内部匿名函数参数</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(test);</span><br><span class="line"><span class="keyword">var</span> p2 = p1.then</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); <span class="comment">// 如果执行成功输出：&#x27;成功：生成随机数小于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> p3 = p2.catch</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); <span class="comment">// 如果执行失败输出：&#x27;失败：生成随机数大于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>咋看之下首先方法 <em>function test(…)</em> 和之前没什么区别，只不过多了两个函数参数 <em>resolve, reject</em> ，替换了之前回调函数 <em>success、fail</em> 在接下来代码中位置，整体逻辑没有变化。</p>
<ul>
<li><em>resolve, reject</em> 可以分别将 <em>Promise</em> 状态置为：<em>fullfiled、 rejected</em></li>
<li><em>resolve, reject</em> 还可将自身的接收的参数（本例为<em>date</em>） ，分别传给<em>then、catch</em> 方法（见下）</li>
</ul>
<p>只不过在下面多了一层对 <em>test()</em> 的封装：创建一个 <em>Promise</em> 对象，传递一个函数作为参数，承诺一定执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(test);</span><br></pre></td></tr></table></figure>
<p>紧接着根据此时 <em>Promise</em> 状态是<em>fullfiled、 rejected</em>  执行 <em>then()</em> 还是 <em>catch()</em> 方法。</p>
<p>比如，随机数&lt;1 —&gt; 执行<em>resolve()</em> —&gt; <em>Promise</em> 状态为<em>fullfiled</em>  ----&gt; 执行 <em>then()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p2 = p1.then</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); <span class="comment">// 如果执行成功输出：&#x27;成功：生成随机数小于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><em>then(func)</em> 参数为一个函数，同时它也拿到了<em>resolve(date)</em>  的参数<em>date</em> ，赋值给了<em>result</em> （我是这么理解的的）。</p>
<p>所以如果执行会打印出：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565772961295.png" alt="1565772961295"></p>
<p>同理，随机数&gt;1 —&gt; 执行<em>reject()</em> —&gt; <em>Promise</em> 状态为 <em>rejected</em>   ----&gt; 执行 <em>catch()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p3 = p2.catch</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); <span class="comment">// 如果执行失败输出：&#x27;失败：生成随机数大于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><em>Promise</em> 对象可以串联起来，所以上述代码可以简化为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(test).then (<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); &#125;</span><br><span class="line">                 .catch(<span class="function"><span class="keyword">function</span> (<span class="params">reason</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); &#125;</span><br></pre></td></tr></table></figure>
<h4 id="这就完了？">这就完了？</h4>
<p>看到这儿你可能不屑一顾，这么传的神乎其神的 <em>Promise</em> 就这点能耐？把原来好好的 <em>test()</em> 方法，整两个参数然后用 <em>Promise</em> 封装一下就没了？</p>
<p>当然，看到这你也可能发现了 <em>Promise</em> 其中一个优点：<em>执行代码和处理结果的代码清晰地分离</em> 。</p>
<p>比如上面：执行代码 <em>test()</em> 只负责整体逻辑传递数据，而处理代码接收数据进行处理由<em>then()</em> 、 <em>catch()</em> 完成。</p>
<p>更大优点，是用 <em>Promise</em> 处理多个异步操作，请看下节。</p>
<h3 id="更正确的使用Promise姿势：处理多异步">更正确的使用<em>Promise</em>姿势：处理多异步</h3>
<p>试想有多个异步任务函数，<em>job1、job2、job3</em>…：</p>
<blockquote>
<p>执行<em>job1</em>，<em>job1</em>执行成功 —&gt; 执行<em>job2</em>，<em>job2</em>执行成功 —&gt; 执行<em>job3</em>，<em>job3</em>执行成功 —&gt; …</p>
</blockquote>
<p>显然<em>job1</em>成了一个多层回调函数，<em>job2</em>执行完成后也有相应回调函数<em>job3</em>执行，<em>job3</em>有回调函数<em>job4</em>…</p>
<p>如果不使用 <em>Promise</em> 意味着我们要层层嵌套 <em>job1、job2、job3…</em>。这既不易读，也不灵活，而我们使用 <em>Promise</em> 后</p>
<p>可以将代码简写为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.then(job1).then(job2).then(job3).then...;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>分别实现异步函数<em>job1_add1、job2_mul2、job3_div3</em> 依次对数字0进行 *<em>+1、<em>2、/3</em></em>：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建一个Promise对象</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    resolve(<span class="number">0</span>); <span class="comment">// 传递数据：数字0</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// job1任务：将传过来的数字加1,这里传过来的数字是0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job1_add1</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">       为什么返回 Promise 对象？</span></span><br><span class="line"><span class="comment">       首先我们要知道，setTimeout共有四个参数，后面两个参数会传入回调函数（这里是resolve）</span></span><br><span class="line"><span class="comment">       我们知道，resolve参数可以被then方法拿到，这样在接下来的then方法可以获取到传递的参数:</span></span><br><span class="line"><span class="comment">            p.then(job1_add1).then(job2_mul2).then(job3_div3)</span></span><br><span class="line"><span class="comment">       你也可以直接传递数据而非Promise对象，后面then也可以接收到：</span></span><br><span class="line"><span class="comment">       return num+1;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; + 1&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">600</span>, num + <span class="number">1</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// job2任务：将传过来的数字×2，这里传过来的是0+1 = 1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job2_mul2</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; * 2&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">500</span>, num * <span class="number">2</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// job2任务：将传过来的数字÷3，这里传过来的是 (0+1)*2 = 2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job3_div3</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; / 3&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">400</span>, num / <span class="number">3</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行多异步任务</span></span><br><span class="line">p.then(job1_add1).then(job2_mul2).then(job3_div3);</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565779644046.png" alt="1565779644046"></p>
<h3 id="更多有关-Promise">更多有关 <em>Promise</em></h3>
<p>除了前面提到 <em>then、catch</em> 方法，<em>Promise</em> 还提供了<u>静态</u> 方法 <em>all、race</em> 等。</p>
<h4 id="all-方法"><em>all()</em> 方法</h4>
<p><em>Promise</em> 的<em>all(PromiesArr)</em> 方法提供了并行执行异步操作的能力，并且在所有异步操作执行完后才执行回调。</p>
<p>由于可以在一个回调中处理所有返回数据，这样比如在打开网页，预先加载需要用到的所有资源如图片等，等全部加载完在执行回调。</p>
<p>依旧以上面异步函数<em>job1_add1、job2_mul2、job3_div3</em> 为例：</p>
<blockquote>
<p>异步执行三个异步函数，分别将各自传递的参数值进行：+1、*2、/3。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Promise.all([job1_add1(1),job2_mul2(2),job3_div3(3)])</span><br><span class="line">       .then(function(results)</span><br><span class="line">        &#123;</span><br><span class="line">           console.log(results);      </span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>三个异步操作都执行完毕后，<em>all(PromiesArr)</em> 会把它们返回的数据组成数组传给 <em>then()</em>，也就是上面<em>results</em>。</p>
</li>
<li>
<p>注意是传递 <em>Promise</em> 对象数组，而非函数，下面这种写法错误：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([job1_add1,job2_mul2,job3_div3])</span><br></pre></td></tr></table></figure>
<p>这是传递的参数是函数数组，而非<em>Promise</em>对象 数组。只有函数都执行后才是<em>Promise</em>对象数组（<em>job1_add1、job2_mul2、job3_div3</em> 返回<em>Promise</em>对象）。</p>
<p>所以，<em>all()</em> 不能实现前面三个异步操作结果交互依次进行：+1、*2、/3，因为传递的参数值被写死了，它们不存在嵌套关系，更何况论传值了。</p>
</li>
</ul>
<p>最后执行的结果为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565783438113.png" alt="1565783438113"></p>
<h4 id="race-方法"><em>race()</em> 方法</h4>
<p>有些时候，多个异步任务是为了容错。比如，同时向两个URL读取用户的个人信息，只需要获得先返回的结果即可。这种情况下，用<code>Promise.race()</code>实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">500</span>, <span class="string">&#x27;P1&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">600</span>, <span class="string">&#x27;P2&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.race([p1, p2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">// &#x27;P1&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="练习：将AJAX-异步执行函数转为-Promise-对象">练习：将<em>AJAX</em> 异步执行函数转为 <em>Promise</em> 对象</h3>
<p>在前我们举个<em>ajax</em>应用实例：根据用户输入字母，触发<em>showHint</em> 方法<em>ajax</em> 方式请求服务器返回推荐姓名。</p>
<p>其中 <em>ajax</em> 实现部分见下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax部分...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">res</span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">res</span>)    </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             success(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             fail(xmlhttp.status); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>现要求：将<em>ajax</em> 异步执行函数*showHint()*转换为 <em>Promise</em> 对象简化异步处理。</p>
</blockquote>
<p>最开始，我用<em>Promise</em> 对象直接封装 <em>showHint</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)  // 参数不对，应该为 <span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">resolve, reject</span>)</span></span></span><br><span class="line"><span class="function"><span class="function"></span>&#123;</span></span><br><span class="line"><span class="function">   // 创建对象</span></span><br><span class="line"><span class="function">   <span class="title">var</span> <span class="title">xmlhttp</span> = <span class="title">new</span> <span class="title">XMLHttpRequest</span>(<span class="params"></span>)</span>;</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             resolve(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             reject(xmlhttp.status); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(showHint);</span><br><span class="line">p.then (<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res);&#125;)</span><br><span class="line"> .catch(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;);</span><br></pre></td></tr></table></figure>
<p>但是这样有一个问题：<em>function showHint(str){…}</em> 参数不对，应该为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function showHint(resolve, reject)</span><br><span class="line">&#123;</span><br><span class="line">     ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>否则无法在后面使用 <em>resolve、reject</em> 函数！但是这样又无法使用函数自带 <em>str</em> 参数，所以解决办法为：把函数<em>showHint</em> 内部需要判断执行不同回调函数的部分，包装成 <em>Promise</em>对象返回：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)  // 参数不对，应该为 <span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">resolve, reject</span>)</span></span></span><br><span class="line"><span class="function"><span class="function"></span>&#123;</span></span><br><span class="line"><span class="function">   // 创建对象</span></span><br><span class="line"><span class="function">   <span class="title">var</span> <span class="title">xmlhttp</span> = <span class="title">new</span> <span class="title">XMLHttpRequest</span>(<span class="params"></span>)</span>;</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   p = <span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">             <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">             &#123;</span><br><span class="line">                 resolve(xmlhttp.responseText);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">else</span></span><br><span class="line">             &#123;</span><br><span class="line">                 reject(xmlhttp.responseText); </span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以使用<em>resolve、reject</em> 函数了，然后再让返回的<em>Promise</em>对象执行 <em>then</em> 、<em>catch</em> ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p.then (function(res)&#123; console.log(&quot;拿到服务器成功响应结果：&quot; + res);&#125;)</span><br><span class="line"> .catch(function(res)&#123; console.log(&quot;拿到服务器失败响应结果：&quot; + res);&#125;);</span><br></pre></td></tr></table></figure>
<h1>第六章：<em>jQuery</em></h1>
<h2 id="6-1-选择器">6.1 选择器</h2>
<p>在前 <u>5.2节</u> 介绍了：</p>
<ul>
<li>获取<em>DOM</em> 节点：<em>getElementby…()</em> 方法 <u>OR</u>  <em>CSS</em> 层级选择器</li>
<li>操作<em>DOM</em> 节点
<ul>
<li>通过 <em>innerText、innerHtml</em> 属性修改节点文本</li>
<li>通过 <em>style</em> 属性修改<em>CSS</em> 样式</li>
<li>通过 <em>appendChild()</em> 、<em>insertBefore()</em> 、*removeChild()*方法插入、删除节点</li>
</ul>
</li>
</ul>
<p><em>jQuery</em> 提供获取<em>DOM</em> 节点方法 本质是 <u><em>CSS</em> 层级选择器</u> 语法，不再赘述。但是还特别提供 <em>find()、filter()、map()</em> 方法进行查找和过滤，详见下。</p>
<h3 id="查找和过滤">查找和过滤</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="find-、next-、prev-、parent"><em>find()</em>、<em>next()</em>、<em>prev()</em>、<em>parent()</em></h4>
<p>在前面我们知道怎么获取一个节点，但是如果获取一个节点后，还想获取它的子、兄弟、父节点呢？</p>
<p><em>jQuery</em> 为我们提供了 <em>find()</em>、<em>next()</em>、<em>prev()</em> 方法来做到这一点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// find()</span></span><br><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#programLanguage&#x27;</span>).find(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.text();  <span class="comment">// 输出: C</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// parent()</span></span><br><span class="line"><span class="keyword">var</span> pl = C.parent(); </span><br><span class="line">pl;        <span class="comment">// 节点：ul#programLanguage</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// next()、prev()</span></span><br><span class="line">C.next();  <span class="comment">// 节点：li#python</span></span><br><span class="line"></span><br><span class="line">C.prev();  <span class="comment">// 节点：li#C#</span></span><br></pre></td></tr></table></figure>
<h4 id="first-、last"><em>first()、last()</em></h4>
<p>如果我们获取到一个节点数组，对节点数组的操作和普通数组操作有什么不同吗？</p>
<p>普通数组可以使用的API方法和<em>jQuery</em> 对象提供的API多有不同，不可混为一谈，以下是常用一些方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"></span><br><span class="line">lis.first();     <span class="comment">// 获取第一个节点，等价于：#programLanguage li:first-child</span></span><br><span class="line">lis.last();      <span class="comment">// 获取最后一个节点，等价于：#programLanguage li:last-child</span></span><br><span class="line">lis.slice(<span class="number">0</span>, <span class="number">2</span>); <span class="comment">// 输出：[C#,C], 数组的slice()方法一致</span></span><br></pre></td></tr></table></figure>
<p>更多方法以后用到再提。</p>
<h4 id="filter-、map"><em>filter()、map()</em></h4>
<p><em>filter()、map()</em> 和我们前介绍的高阶函数类似。</p>
<blockquote>
<p>通过 <em>filter()</em>  过滤出 ’C‘ 开头编程语言。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filter()过滤符合条件的原对象数组元素</span></span><br><span class="line"><span class="comment">// 返回：数组 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> firstIsC = lis.filter</span><br><span class="line">(</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">      过滤条件；首字母为C</span></span><br><span class="line"><span class="comment">      注意：此时是DOM节点对象不是jQuery对象</span></span><br><span class="line"><span class="comment">      why? 直接箭头函数this绑定window</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">// () =&gt; this.innerHTML.indexOf(&#x27;C&#x27;) === 0</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">return</span>  <span class="built_in">this</span>.innerHTML.indexOf(<span class="string">&#x27;C&#x27;</span>) === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出测试</span></span><br><span class="line">firstIsC ;    <span class="comment">// jQuery.fn.init(2) [li#C#, li#C, prevObject: jQuery.fn.init(4)]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过 <em>map()</em>  遍历返回所有对象节点文本。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map()</span></span><br><span class="line"><span class="comment">// 遍历所有对象元素返回一个数组</span></span><br><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> texts = lis.map</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.innerHTML;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出测试</span></span><br><span class="line">texts;  <span class="comment">//  [&quot;C#&quot;, &quot;C&quot;, &quot;python&quot;, &quot;java&quot;]</span></span><br></pre></td></tr></table></figure>
<h4 id="综合练习">综合练习</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;test-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;#0&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return false;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Email: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Gender: </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;m&quot;</span> <span class="attr">checked</span>&gt;</span> Male<span class="tag">&lt;/<span class="name">label</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;f&quot;</span>&gt;</span> Female<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>City: </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;BJ&quot;</span> <span class="attr">selected</span>&gt;</span>Beijing<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;SH&quot;</span>&gt;</span>Shanghai<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;CD&quot;</span>&gt;</span>Chengdu<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;XM&quot;</span>&gt;</span>Xiamen<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>输入值后，用 <em>jQuery</em> 获取表单的 <em>JSON</em> 字符串，如：<code>&#123;&quot;name&quot;:&quot;Michael&quot;,&quot;email&quot;:...&#125;</code>。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 限定状态:input 可获取：&lt;input&gt;，&lt;textarea&gt;，&lt;select&gt;和&lt;button&gt; 元素</span></span><br><span class="line">$(<span class="string">&#x27;#test-form :input&#x27;</span>).filter</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="comment">// 过滤节点数组中：未选中的radio单选框节点和submit按钮节点</span></span><br><span class="line">      <span class="comment">// this是DOM对象，获取节点属性type、checked等</span></span><br><span class="line">       <span class="keyword">var</span> isNotChecked  = <span class="built_in">this</span>.type === <span class="string">&#x27;radio&#x27;</span> &amp;&amp; !<span class="built_in">this</span>.checked;</span><br><span class="line">       <span class="keyword">if</span>( isNotChecked  || <span class="built_in">this</span>.type === <span class="string">&#x27;submit&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">).map</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="comment">// select元素可直接获取name属性和选中的值</span></span><br><span class="line">       <span class="keyword">return</span> obj[<span class="built_in">this</span>.name] = <span class="built_in">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">json = <span class="built_in">JSON</span>.stringify(obj,<span class="literal">null</span>,<span class="string">&#x27;  &#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="6-2-jQuery-操作-DOM">6.2 <em>jQuery</em> 操作 <em>DOM</em></h2>
<h3 id="修改-Text-HTML">修改 <em>Text</em> &amp; <em>HTML</em></h3>
<p><em>jQuery</em> 对象提供了 <em>text()、html()</em> 方法来获取节点文本和HTML文本，例如以下HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>分别获取文本和HTML：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).html();    <span class="comment">// C</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).text();    <span class="comment">// C</span></span><br></pre></td></tr></table></figure>
<p>设置文本 &amp; HTML，只需给<em>text()、html()</em> 方法传递参数即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).text(<span class="string">&#x27;我是西语言&#x27;</span>);    <span class="comment">// 我是西语言</span></span><br></pre></td></tr></table></figure>
<p>特别巧妙的是，<em>jQuery</em> 可以给选中多个节点设置文本、CSS、属性等，具有 <u>批量操作</u> 特点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// docment对象不具有 批量操作 特点</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">&#x27;li&#x27;</span>).innerText = <span class="string">&#x27;test&#x27;</span>;   <span class="comment">// 设置不成功，节点内容未被改变</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;li&#x27;</span>).innerText = <span class="string">&#x27;test&#x27;</span>;       <span class="comment">// 设置不成功，节点内容未被改变</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery对象具有 批量操作 特点</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).text(<span class="string">&#x27;test&#x27;</span>);        <span class="comment">// 设置成功，所有li节点文本被设置 &#x27;test&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="修改CSS">修改<em>CSS</em></h3>
<p>同前，也可用 CSS() 方法获取、修改CSS样式，也具有 <u>批量操作</u> 特点，关于该特点以下不再赘述。</p>
<p>获取CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>);        <span class="comment">// &quot;rgb(0, 0, 0)&quot;</span></span><br></pre></td></tr></table></figure>
<p>设置CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);  <span class="comment">// 文本全变为红色</span></span><br></pre></td></tr></table></figure>
<p>清除CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;&#x27;</span>);    <span class="comment">// 等价把该属性设置为空即可</span></span><br></pre></td></tr></table></figure>
<h3 id="显示和隐藏DOM">显示和隐藏DOM</h3>
<p>隐藏DOM节点，注意DOM树结构没有被改变：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).hide();   <span class="comment">// 对应CSS设置：display = none;</span></span><br></pre></td></tr></table></figure>
<p>显示DOM节点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).show();   <span class="comment">// 对应CSS设置：display = inline; 或者 display = block;</span></span><br></pre></td></tr></table></figure>
<h3 id="修改DOM信息">修改DOM信息</h3>
<h4 id="节点宽高：width-、heigth">节点宽高：<em>width()、heigth()</em></h4>
<p>获取宽高：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).width();   <span class="comment">// 1860</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).heigth();  <span class="comment">// 21.5126</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 经过测试，多个标签显示的是其中一个标签宽高？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).width();   <span class="comment">// 1860</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).heigth();  <span class="comment">// 21.5126</span></span><br></pre></td></tr></table></figure>
<p>设置宽高：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).width(<span class="number">400</span>);   </span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).heigth(<span class="number">1800</span>);  </span><br></pre></td></tr></table></figure>
<h4 id="节点属性：attr-、removeAttr">节点属性：<em>attr() 、removeAttr()</em></h4>
<p>获取属性，不存在返回 <em>undefined</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;id&#x27;</span>);    <span class="comment">// C</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).attr(<span class="string">&#x27;id&#x27;</span>);    <span class="comment">// C#，多个节点返回第一个节点指定属性值</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;name&#x27;</span>);  <span class="comment">// undefined，不存在返回undefined</span></span><br></pre></td></tr></table></figure>
<p>设置属性，类似<em>CSS()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;iamC&#x27;</span>);  <span class="comment">//  &lt;li id=&quot;C&quot; name=&#x27;iamC&#x27;&gt;C&lt;/li&gt;</span></span><br></pre></td></tr></table></figure>
<p>删除属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).removeAttr(<span class="string">&#x27;name&#x27;</span>); </span><br></pre></td></tr></table></figure>
<blockquote>
<p>特别的，关于一些属性只有出现和没出现两种情况判断，如： <em>checked</em>、<em>selected</em> 。</p>
</blockquote>
<p>对于以下HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;test-radio&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果使用<em>attr()</em> 获取 <em>checked</em> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-radio&#x27;</span>).attr(<span class="string">&#x27;checked&#x27;</span>); <span class="comment">// &#x27;checked&#x27;</span></span><br></pre></td></tr></table></figure>
<p>虽然正确返回了属性值，但是 <em>checked</em> 属性只有[被选中]、[未被选中]两种情况，用 <em>true、false</em>返回更好：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-radio&#x27;</span>).is(<span class="string">&#x27;:checked&#x27;</span>); <span class="comment">// true,用is()方法判断更好</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 不知道为什么有时候 <em>attr</em> 设置选中无效，建议使用 <em>prop</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test_checkbox&#x27;</span>).attr(<span class="string">&#x27;checked&#x27;</span>,<span class="string">&#x27;checked&#x27;</span>); <span class="comment">// 选中无效？</span></span><br><span class="line">$(<span class="string">&#x27;#test_checkbox&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>);      <span class="comment">// 可选中</span></span><br></pre></td></tr></table></figure>
<p><em>selected</em> 等同理不再赘述。</p>
<h3 id="修改DOM结构">修改DOM结构</h3>
<h4 id="添加节点">添加节点</h4>
<p>如果我们要在以下 <em>ul</em>  节点添加子节点 <code>&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><em>jQuery</em> 虽然提供了<em>html()</em> 方法，但是会修改 <em>ul</em> 节点所有节点。</p>
<p>为此我们可以利用以下方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>append(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>最后一个子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>prepend(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>第一个子节点</u></td>
</tr>
</tbody>
</table>
<p>如果是同级节点对象，还可以用：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>after(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前节点对象 <u>下一个兄弟子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>before(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前节点对象 <u>前一个兄弟子节点</u></td>
</tr>
</tbody>
</table>
<blockquote>
<p>将 <em>python</em> 新节点添加为<em>ul</em> 列表最后一个新节点。</p>
</blockquote>
<p>父节点对象方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pl = $(<span class="string">&#x27;#programLanguage&#x27;</span>);</span><br><span class="line">pl.append(<span class="string">&#x27;&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>同级节点对象方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> last = $(<span class="string">&#x27;#programLanguage li:last-child&#x27;</span>);</span><br><span class="line">last.after(<span class="string">&#x27;&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="删除节点">删除节点</h4>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>remove()</em></td>
<td style="text-align:center">删除当前节点对象，可作用于多个节点对象。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>删除所有列表项。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).remove();   <span class="comment">// 所有&lt;li&gt;被删除</span></span><br></pre></td></tr></table></figure>
<h4 id="综合测试">综合测试</h4>
<blockquote>
<p>对于以下<em>html</em> 结构：除了列出语言外，请再添加 <em>Pascal、Lua 、Ruby</em>，然后按字母顺序排序节点。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test-div&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Swift<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> language = [<span class="string">&#x27;Pascal&#x27;</span>,<span class="string">&#x27;Lua&#x27;</span>,<span class="string">&#x27;Ruby&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> ul = $(<span class="string">&#x27;#test-div ul&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; language.length; i++ )</span><br><span class="line">&#123;</span><br><span class="line">    ul.append(<span class="string">&#x27;&lt;li&gt;&lt;span&gt;&#x27;</span> + language[i] + <span class="string">&#x27;&lt;/span&gt;&lt;/li&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取所有li标签排序</span></span><br><span class="line"><span class="keyword">var</span> lis = ul.find(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">lis.sort</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 不是jQuery对象，而是DOM对象？不能用x.text() &gt; y.text()</span></span><br><span class="line">        <span class="keyword">if</span>(x.innerText &gt; y.innerText)  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>                           <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加已排序好的li标签</span></span><br><span class="line">ul.html(lis);</span><br></pre></td></tr></table></figure>
<h3 id="表单输入框值">表单输入框值</h3>
<p>对于表单元素，<em>jQuery</em> 统一用<em>val()</em> 方法获取 <em>DOM</em> 对象 <em>value</em> 属性，统一输入框取值和赋值问题：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>val()</em></td>
<td style="text-align:center">无参数获取文本框值；有参数设置文本框值。</td>
</tr>
</tbody>
</table>
<p>对于以下 <em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>尝试对以上不同 <em>input</em> 类型输入框值操作。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取输入框值</span></span><br><span class="line">$(<span class="string">&#x27;#test-input&#x27;</span>).val();      <span class="comment">// &#x27;test&#x27;</span></span><br><span class="line">$(<span class="string">&#x27;#test-select&#x27;</span>).val();     <span class="comment">// &#x27;BJ&#x27;</span></span><br><span class="line">$(<span class="string">&#x27;#test-textarea&#x27;</span>).val();   <span class="comment">// &#x27;Hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置输入框值</span></span><br><span class="line">$(<span class="string">&#x27;#test-input&#x27;</span>).val(<span class="string">&#x27;abc@example.com&#x27;</span>);   <span class="comment">// 文本框的内容已变为abc@example.com</span></span><br><span class="line">$(<span class="string">&#x27;#test-select&#x27;</span>).val(<span class="string">&#x27;SH&#x27;</span>);               <span class="comment">// 选择框已变为Shanghai</span></span><br><span class="line">$(<span class="string">&#x27;#test-textarea&#x27;</span>).val(<span class="string">&#x27;Hi&#x27;</span>);             <span class="comment">// 本区域已更新为&#x27;Hi&#x27;</span></span><br></pre></td></tr></table></figure>
<p>对应<em>docment</em> 对象 <em>value</em> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;#test-input&#x27;</span>).value = <span class="string">&#x27;abc@example.com&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="不要尝试用-attr-方法">不要尝试用 <em>attr()</em> 方法</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p><em>attr()</em> 方法是用来获取、设置属性，用于文本框会导致意想不到的错误：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#user&#x27;</span>).attr(<span class="string">&#x27;value&#x27;</span>,<span class="string">&#x27;hwh&#x27;</span>);    <span class="comment">// 成功设置文本框值为:&#x27;hwh&#x27;</span></span><br></pre></td></tr></table></figure>
<p>但是当我们重新修改文本框值为：‘lt’，再去尝试获取文本框值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#user&#x27;</span>).attr(<span class="string">&#x27;value&#x27;</span>);          <span class="comment">// &#x27;hwh&#x27;</span></span><br></pre></td></tr></table></figure>
<p>读取结果还是hwh！这是因为实际html结构已经是：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;hwh&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>每次读取都是value值， <u>修改文本框内容不会改变value属性</u> 。</p>
<h2 id="6-3-事件">6.3 事件</h2>
<p>类似C#事件，常用有鼠标事件、键盘事件、其他事件等。</p>
<h3 id="鼠标事件">鼠标事件</h3>
<p>常用鼠标事件，参数为函数用于处理事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>click(func)</em></td>
<td style="text-align:center">鼠标单击时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>dblclick(func)</em></td>
<td style="text-align:center">鼠标双击时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mouseenter(func)</em></td>
<td style="text-align:center">鼠标进入时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mouseleave(func)</em></td>
<td style="text-align:center">鼠标离开时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mousemove(func)</em></td>
<td style="text-align:center">鼠标内部移动时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>hover(func)</em></td>
<td style="text-align:center">鼠标进入和退出时触发，相当于 <em>mouseenter()</em>+ <em>mouseleave()</em> 。</td>
</tr>
</tbody>
</table>
<p>存在以下html结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>绑定 <em>click</em> 事件，点击 <code>&lt;li#C&gt;</code> 时触发。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;hello C!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>有时候还会用到一种 <em>on()</em> 方法绑定事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>on(evet,func)</em></td>
<td style="text-align:center"><em>on()</em> 绑定事件，传入事件名称 &amp; 事件处理函数</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.on</span><br><span class="line">(<span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;hello C!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="事件参数">事件参数</h4>
<p>所有时间 都会传入<em>Event</em> 对象作为参数，可以获取更多信息。</p>
<blockquote>
<p>绑定 <em>mousemove</em> 事件，当鼠标在 <code>&lt;div#testMouseMoveDiv&gt;</code> 区域移动可以获取到鼠标位置。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#testMouseMoveDiv&#x27;</span>).mousemove</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $(<span class="string">&#x27;#testMouseMoveSpan&#x27;</span>).text(<span class="string">&#x27;pageX = &#x27;</span> + e.pageX + <span class="string">&#x27;, pageY = &#x27;</span> + e.pageY);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="键盘事件">键盘事件</h3>
<p>键盘事件仅作用在当前焦点的DOM上，通常是<code>&lt;input&gt;</code>和<code>&lt;textarea&gt;</code>：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>keydown(func)</em></td>
<td style="text-align:center">键盘按下时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>keyup(func)</em></td>
<td style="text-align:center">键盘松开时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>keypress(func)</em></td>
<td style="text-align:center">按一次键后触发</td>
</tr>
</tbody>
</table>
<p>有以下<em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">label</span> <span class="attr">id</span>=<span class="string">&quot;check&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p>当用户在 <em>&lt;input#user&gt;</em> 输入完毕，右侧 <em>&lt;lable#check&gt;</em> 显示是否已存在用户名。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = $(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line">user.change</span><br><span class="line">(      </span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value === <span class="string">&#x27;hwh&#x27;</span>)</span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;用户存在！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;可以使用！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="其他事件">其他事件</h3>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>change(func)</em></td>
<td style="text-align:center">当<code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>或<code>&lt;textarea&gt;</code>的内容改变时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>focus(func)</em></td>
<td style="text-align:center">当 <em>DOM</em> 获得焦点时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>blur(func)</em></td>
<td style="text-align:center">当 <em>DOM</em> 失去焦点时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>submit(func)</em></td>
<td style="text-align:center">当<code>&lt;form&gt;</code>提交时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>ready(func)</em></td>
<td style="text-align:center">当页面被载入并且 <em>DOM</em> 树完成初始化后触发</td>
</tr>
</tbody>
</table>
<p>有以下<em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">label</span> <span class="attr">id</span>=<span class="string">&quot;check&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>change(func)</em> 事件：当用户在 <em>&lt;input#user&gt;</em> 输入完毕，右侧 <em>&lt;lable#check&gt;</em> 显示是否已存在用户名。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = $(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line">user.change</span><br><span class="line">(      </span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value === <span class="string">&#x27;hwh&#x27;</span>)</span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;用户存在！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;可以使用！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><em>change</em> 事件当输入框失去焦点才会触发（移到别处了不再输入了）</p>
</li>
<li>
<p>最好把函数直接写在<em>change</em> 里面，否则不知道为什么触发不了？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.change(changeUserName());  <span class="comment">// 封装好的函数写入不成？</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p><em>ready</em> 事件作用于<em>docment</em>对象，当<em>DOM</em>节点都载入浏览器触发：试分析以下错误？</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">        // 代码有误:</span><br><span class="line">        $(&#x27;#testForm).on(&#x27;submit&#x27;, function () </span><br><span class="line">        &#123;</span><br><span class="line">            alert(&#x27;submit!&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;testForm&quot;</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<script> 标签内js代码在<body>前，DOM 节点还没加载完毕就操作 <form> 节点所以出错。我们可以：

- 把<script> 标签在<body>后

- 或者，<u>用 *docment* 对象 *read* 事件函数</u> 保证DOM节点都加载完毕 <u>再绑定*submit*事件</u>

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     $(<span class="string">&#x27;#testForm).on(&#x27;</span>submit<span class="string">&#x27;, function () </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            alert(&#x27;</span>submit!<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

  也可以像前一般简化不用on方法：

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $(<span class="built_in">document</span>).on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     $(<span class="string">&#x27;#testForm).submit(function () </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            alert(&#x27;</span>submit!<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

  甚至*read* 事件还可以再简化： *$(document).on('ready', function ()...*   ---> *$(function ()..* 

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;init A...&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



### 事件触发条件

事件的触发总是由用户操作引发的，但是，比如用JavaScript代码去改动文本框的值，不会触发`change`事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> input = $(<span class="string">&#x27;#test-input&#x27;</span>);</span><br><span class="line">input.val(<span class="string">&#x27;change it!&#x27;</span>); <span class="comment">// 无法触发change事件</span></span><br></pre></td></tr></table></figure>

我们可以通过直接调用无参数 *change()* 方法手动触发事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> input = $(<span class="string">&#x27;#test-input&#x27;</span>);</span><br><span class="line">input.val(<span class="string">&#x27;change it!&#x27;</span>);</span><br><span class="line">input.change(); <span class="comment">// 触发change事件</span></span><br></pre></td></tr></table></figure>

#### 浏览器安全限制

在浏览器中，有些 *JavaScript* 代码只有在用户触发下才能执行。例如，`window.open()`函数：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无法弹出新窗口，将被浏览器屏蔽:</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.open(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

这些“敏感代码”只能由用户操作来触发。



### 综合测试

有以下 *Form* 表单：

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;test-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span>请选择想要学习的编程语言：<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;selectAll&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;selectAll&quot;</span>&gt;</span>全选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;deselectAll&quot;</span>&gt;</span>全不选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;python&quot;</span>&gt;</span> Python<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ruby&quot;</span>&gt;</span> Ruby<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;haskell&quot;</span>&gt;</span> Haskell<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span> Scheme<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

> 要求完成：
>
> - 当用户勾上“全选”时，自动选中所有语言，并把“全选”变成“全不选”
> - 当用户去掉“全不选”时，自动不选中所有语言，并把“全不选”变成“全选”

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">    form = $(<span class="string">&#x27;#test-form&#x27;</span>),</span><br><span class="line">    langs = form.find(<span class="string">&#x27;[name=lang]&#x27;</span>),</span><br><span class="line">    selectAll = form.find(<span class="string">&#x27;label.selectAll :checkbox&#x27;</span>),</span><br><span class="line">    selectAllLabel = form.find(<span class="string">&#x27;label.selectAll span.selectAll&#x27;</span>),</span><br><span class="line">    deselectAllLabel = form.find(<span class="string">&#x27;label.selectAll span.deselectAll&#x27;</span>),</span><br><span class="line">    invertSelect = form.find(<span class="string">&#x27;a.invertSelect&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重置初始化状态:</span></span><br><span class="line">form.find(<span class="string">&#x27;*&#x27;</span>).show().off();</span><br><span class="line">form.find(<span class="string">&#x27;:checkbox&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>, <span class="literal">false</span>).off();</span><br><span class="line">deselectAllLabel.hide();</span><br><span class="line"><span class="comment">// 拦截form提交事件:</span></span><br><span class="line">form.off().submit(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    alert(form.serialize());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

接上，绑定事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isAllSelected = <span class="literal">false</span>;</span><br><span class="line">selectAll.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!isAllSelected )</span><br><span class="line">        &#123;</span><br><span class="line">            langs.each</span><br><span class="line">            (</span><br><span class="line">                <span class="comment">/* </span></span><br><span class="line"><span class="comment">                不能用lambada表达式，应该下面this都未绑定正确？</span></span><br><span class="line"><span class="comment">                经过测试在function()&#123;...&#125; this绑定正确。</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="comment">// () =&gt; this.checked = &#x27;checked&#x27;     </span></span><br><span class="line">                <span class="comment">// () =&gt; $(this).prop(&#x27;checked&#x27;,true)</span></span><br><span class="line">   </span><br><span class="line">                <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">                </span>&#123;     </span><br><span class="line">                    <span class="comment">/* attr无法成功设置属性 ：不起作用？ */</span></span><br><span class="line">                    <span class="comment">// $(this).attr(&#x27;checked&#x27;,&#x27;checked&#x27;) ;  </span></span><br><span class="line"></span><br><span class="line">                    $(<span class="built_in">this</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>);        <span class="comment">// 测试成功</span></span><br><span class="line">                &#125;            </span><br><span class="line">           )</span><br><span class="line">           deselectAllLabel.show();</span><br><span class="line">           selectAllLabel.hide();</span><br><span class="line">           selectAll.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);</span><br><span class="line">           isAllSelected = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            langs.each</span><br><span class="line">            (</span><br><span class="line">                <span class="comment">/* </span></span><br><span class="line"><span class="comment">                不能用lambada表达式，应该下面this都未绑定正确？</span></span><br><span class="line"><span class="comment">                经过测试在function()&#123;...&#125; this绑定正确。</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="comment">// () =&gt; this.checked = &#x27;checked&#x27;     </span></span><br><span class="line">                <span class="comment">// () =&gt; $(this).prop(&#x27;checked&#x27;,true)</span></span><br><span class="line">   </span><br><span class="line">                <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">                </span>&#123;     </span><br><span class="line">                    <span class="comment">/* attr无法成功设置属性 ：不起作用？ */</span></span><br><span class="line">                    <span class="comment">// $(this).attr(&#x27;checked&#x27;,&#x27;checked&#x27;) ;  </span></span><br><span class="line"></span><br><span class="line">                    $(<span class="built_in">this</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);        <span class="comment">// 测试成功</span></span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">            deselectAllLabel.hide();</span><br><span class="line">            selectAllLabel.show();</span><br><span class="line">            isAllSelected = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

可以利用*jQuery* 批量操作特点，不用*each()*遍历:

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isAllSelected = <span class="literal">false</span>; <span class="comment">// 判断此时单选框是：全部勾选 OR 全不勾选</span></span><br><span class="line">selectAll.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!isAllSelected )  </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 全部勾选</span></span><br><span class="line">            langs.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>); </span><br><span class="line">            <span class="comment">// 全选隐藏、全不选显示</span></span><br><span class="line">            deselectAllLabel.show();</span><br><span class="line">            selectAllLabel.hide();</span><br><span class="line">            selectAll.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);</span><br><span class="line">            isAllSelected = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 全部取消勾选</span></span><br><span class="line">            langs.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>); </span><br><span class="line">            <span class="comment">// 全选显示，全不选隐藏</span></span><br><span class="line">            deselectAllLabel.hide();</span><br><span class="line">            selectAllLabel.show();</span><br><span class="line">            isAllSelected = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

## 6.4 动画

用 *JavaScript* 实现动画，比如实现淡出效果，让选中元素在1s内改变 *CSS*  *opacity（透明度）*  属性值至0。

本质都是通过修改CSS属性，*jQuery* 封装了函数让这一切变得更加简单。

### 逐渐显隐

无参数的 *show()、hide()* 方法直接显示、隐藏元素；有参数指定时间可以实现动画效果。

|            方法            |                             描述                             |
| :------------------------: | :----------------------------------------------------------: |
|  *show(timeSeconds,func)*  | 在指定 *timeSeconds* 显示全部，*func* 指定显示完成后指定的方法 |
|  *hide(timeSeconds,func)*  | 在指定 *timeSeconds* 隐藏全部，*func* 指定显示完成后指定的方法 |
| *toggle(timeSeconds,func)* |         根据当前状态，自动调用 *show()、hide()* 方法         |

- *timeSeconds* 以毫秒为单位，同时可以用 *‘slow’、‘fast’* 等特殊字符串作为参数值。

- 显示过程是从左上角 ---> 展开铺满整个平面 ；隐藏则是从右下角 --> 隐藏整个平面。

> :slightly_smiling_face: 简单实例 

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = $(<span class="string">&#x27;#test-show-hide&#x27;</span>);</span><br><span class="line"><span class="comment">// 在1秒钟内逐渐消失</span></span><br><span class="line">div.hide(<span class="number">1000</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 在0.6秒钟内逐渐显示</span></span><br><span class="line">div.show(<span class="string">&#x27;slow&#x27;</span>); </span><br></pre></td></tr></table></figure>

就像此前说过，上面显示是从左上展开，下面方法可以从垂直方法逐渐展开、收缩 ~ just like 拉窗帘。

|              方法               |       描述       |
| :-----------------------------: | :--------------: |
|   *slideUp(timeSeconds,func)*   |   拉窗帘般显示   |
|  *slideDown(timeSeconds,func)*  | 拉窗帘般收起隐藏 |
| *slideToggle(timeSeconds,func)* | 自动调用上面方法 |

### 淡入淡出

*fadeIn()  、fadeOut()* 可通过不断设置 *DOM* *CSS* *opacity* 属性来实现淡入淡出动画效果。

|              方法              |       描述       |
| :----------------------------: | :--------------: |
|   *fadeIn(timeSeconds,func)*   |     淡入显示     |
|  *fadeOut(timeSeconds,func)*   |     淡出隐藏     |
| *fadeToggle(timeSeconds,func)* | 自动调用上面方法 |

存在以下表格：

![1565600702619](https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565600702619.png)

> 试完成以下代码，使得每次删除表中第一项可以淡出显示。

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteFirstTR</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tr = $(<span class="string">&#x27;#test-table&gt;tbody&gt;tr:visible&#x27;</span>).first();</span><br><span class="line">    <span class="comment">// 在以下完成事件绑定...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">deleteFirstTR();</span><br></pre></td></tr></table></figure>

完成的代码如下：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tr.fadeOut(<span class="number">1000</span>,<span class="function">() =&gt;</span> tr.remove());</span><br></pre></td></tr></table></figure>

### 自定义动画

对上面提供的动画效果不满意？尝试自定义动画吧。

|                 方法                  |                             描述                             |
| :-----------------------------------: | :----------------------------------------------------------: |
| *animate(cssStyle，timeSeconds,func)* | 在指定*timeSeconds*  达到预设*cssStyle* 值，最后执行 *func* 函数 |

现在我们来试试自定义实现上面淡出删除表格效果吧。

> 淡出删除表格。

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteFirstTR</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tr = $(<span class="string">&#x27;#test-table&gt;tbody&gt;tr:visible&#x27;</span>).first();</span><br><span class="line">    <span class="comment">// 在以下完成事件绑定...</span></span><br><span class="line">    tr.animate(&#123; <span class="attr">opacity</span>:<span class="number">0</span> &#125;, <span class="number">1000</span>, <span class="function">() =&gt;</span> tr.remove())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">deleteFirstTR();</span><br></pre></td></tr></table></figure>

### 串行动画

如果有两个动画效果：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = $(<span class="string">&#x27;#test-animates&#x27;</span>);</span><br><span class="line"><span class="comment">// 放大</span></span><br><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br><span class="line"><span class="comment">// 缩小</span></span><br><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

希望实现放大 --> 缩小 连续动画效果，如果这样简单的连续执行两个动画：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>).animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

是无法实现的，因为：*动画需要执行一段时间，所以jQuery必须不断返回新的Promise对象才能后续执行操作* 。

所以我们需要借助 *delay()* 方法实现暂停，给予时间返回新的 *Promise* 对象执行后续操作：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>)</span><br><span class="line">   .delay(<span class="number">1000</span>)</span><br><span class="line">   .animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

### 动画没有效果？

*jQuery* 动画的原理是逐渐改变 *CSS* 值，而有些情况是无法改变成功的。例如：

- *slideUp()* 逐渐把*CSS*属性*height* --> 0，但是非*block* 属性值*DOM* 元素对它们设置 *height* 是不起作用的。
- *animate()* 设置 *background-color* 没有效果，因为 *jQuery* 没有实现。</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Wanghui Huang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hwh.zone/p/11812/">https://hwh.zone/p/11812/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hwh.zone" target="_blank">royhuang's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript</a></div><div class="post_share"><div class="social-share" data-image="/img/about-bg.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechatPay.png" target="_blank"><img class="post-qr-code-img" src="/img/wechatPay.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/7160/"><img class="prev-cover" src="/img/about-bg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Python 基础笔记</div></div></a></div><div class="next-post pull-right"><a href="/p/30504/"><img class="next-cover" src="/img/about-bg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">前端基础（二）CSS基础笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/p/20680/" title="前端基础（一）JavaScript基础笔记(中)"><img class="cover" src="/img/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-25</div><div class="title">前端基础（一）JavaScript基础笔记(中)</div></div></a></div><div><a href="/p/41171/" title="前端基础（一）JavaScript基础笔记(上)"><img class="cover" src="/img/about-bg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-25</div><div class="title">前端基础（一）JavaScript基础笔记(上)</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wanghui Huang</div><div class="author-info__description">tech & life</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">30</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">18</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wanghui-Huang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wanghui-Huang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:hwh199601@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">royHuang's studio</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">第五章：浏览器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B8%B8%E7%94%A8%E5%AF%B9%E8%B1%A1"><span class="toc-text">5.1 浏览器常用对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#window"><span class="toc-text">window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#screen"><span class="toc-text">screen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#navigator"><span class="toc-text">navigator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#location"><span class="toc-text">location</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#history"><span class="toc-text">history</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#document"><span class="toc-text">document</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E6%93%8D%E4%BD%9CDOM"><span class="toc-text">5.2 操作DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9"><span class="toc-text">1.获取节点</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#getElementBy%E2%80%A6-%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9"><span class="toc-text">getElementBy…() 获取节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSS%E9%80%89%E6%8B%A9%E5%99%A8%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9"><span class="toc-text">CSS选择器获取节点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%82%E7%BA%A7%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-text">层级选择器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-text">过滤器</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="toc-text">获取节点基本信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9B%B4%E6%96%B0DOM"><span class="toc-text">2.更新DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0DOM%E8%8A%82%E7%82%B9%E6%96%87%E6%9C%AC"><span class="toc-text">更新DOM节点文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0CSS%E6%A0%B7%E5%BC%8F"><span class="toc-text">更新CSS样式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8F%92%E5%85%A5DOM"><span class="toc-text">3.插入DOM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%A0%E9%99%A4DOM"><span class="toc-text">4. 删除DOM</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E6%93%8D%E4%BD%9C%E8%A1%A8%E5%8D%95"><span class="toc-text">5.3 操作表单</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E8%A1%A8%E5%8D%95%E5%85%83%E7%B4%A0"><span class="toc-text">常用表单元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E8%A1%A8%E5%8D%95"><span class="toc-text">操作表单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E5%80%BC"><span class="toc-text">操作值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E8%A1%A8%E5%8D%95"><span class="toc-text">提交表单</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#type-%E2%80%9Csubmit%E2%80%9D-%E8%A1%A8%E5%8D%95%E6%8F%90%E4%BA%A4"><span class="toc-text">type&#x3D;“submit” 表单提交</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#submit-%E6%96%B9%E6%B3%95%E6%8F%90%E4%BA%A4"><span class="toc-text">submit() 方法提交</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ajax-%E6%8F%90%E4%BA%A4"><span class="toc-text">ajax 提交</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E6%8F%90%E4%BA%A4%E6%96%B9%E5%BC%8F"><span class="toc-text">更多提交方式</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6"><span class="toc-text">5.4 操作文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-AJAX"><span class="toc-text">5.5 AJAX</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-AJAX"><span class="toc-text">什么是 AJAX ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AJAX-%E5%BA%94%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-text">AJAX 应用实例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PART1-%EF%BC%9A-%E5%89%8D%E7%AB%AFhtml"><span class="toc-text">PART1 ： 前端html</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PART2-%EF%BC%9A%E5%89%8D%E7%AB%AF-js-%E5%AE%9E%E7%8E%B0-AJAX"><span class="toc-text">PART2 ：前端 js  实现 AJAX</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PART3-%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF-ASP-%E8%84%9A%E6%9C%AC"><span class="toc-text">PART3 ：服务器端*.ASP* 脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jQuery-ajax"><span class="toc-text">jQuery &amp; ajax</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ajax"><span class="toc-text">$.ajax()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-text">回调函数</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#get"><span class="toc-text">$.get()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#post"><span class="toc-text">$.post()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#load"><span class="toc-text">$.load()</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="toc-text">举个例子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%8D%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="toc-text">再举个例子</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-Promise"><span class="toc-text">5.6 Promise</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E8%AF%86-Promise"><span class="toc-text">初识 Promise</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%B8%AA%E6%A0%97%E5%AD%90"><span class="toc-text">举个栗子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%94%9F-JavaScript-%E6%89%A7%E8%A1%8C%E5%BC%82%E6%AD%A5"><span class="toc-text">原生 JavaScript 执行异步</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Promise-%E6%89%A7%E8%A1%8C%E5%BC%82%E6%AD%A5"><span class="toc-text">Promise  执行异步</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%99%E5%B0%B1%E5%AE%8C%E4%BA%86%EF%BC%9F"><span class="toc-text">这就完了？</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%AD%A3%E7%A1%AE%E7%9A%84%E4%BD%BF%E7%94%A8Promise%E5%A7%BF%E5%8A%BF%EF%BC%9A%E5%A4%84%E7%90%86%E5%A4%9A%E5%BC%82%E6%AD%A5"><span class="toc-text">更正确的使用Promise姿势：处理多异步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E5%A4%9A%E6%9C%89%E5%85%B3-Promise"><span class="toc-text">更多有关 Promise</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#all-%E6%96%B9%E6%B3%95"><span class="toc-text">all() 方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#race-%E6%96%B9%E6%B3%95"><span class="toc-text">race() 方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A%E5%B0%86AJAX-%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E8%BD%AC%E4%B8%BA-Promise-%E5%AF%B9%E8%B1%A1"><span class="toc-text">练习：将AJAX 异步执行函数转为 Promise 对象</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">第六章：jQuery</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E9%80%89%E6%8B%A9%E5%99%A8"><span class="toc-text">6.1 选择器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%92%8C%E8%BF%87%E6%BB%A4"><span class="toc-text">查找和过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#find-%E3%80%81next-%E3%80%81prev-%E3%80%81parent"><span class="toc-text">find()、next()、prev()、parent()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#first-%E3%80%81last"><span class="toc-text">first()、last()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#filter-%E3%80%81map"><span class="toc-text">filter()、map()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E7%BB%83%E4%B9%A0"><span class="toc-text">综合练习</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-jQuery-%E6%93%8D%E4%BD%9C-DOM"><span class="toc-text">6.2 jQuery 操作 DOM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9-Text-HTML"><span class="toc-text">修改 Text &amp; HTML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9CSS"><span class="toc-text">修改CSS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E5%92%8C%E9%9A%90%E8%97%8FDOM"><span class="toc-text">显示和隐藏DOM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9DOM%E4%BF%A1%E6%81%AF"><span class="toc-text">修改DOM信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E5%AE%BD%E9%AB%98%EF%BC%9Awidth-%E3%80%81heigth"><span class="toc-text">节点宽高：width()、heigth()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7%EF%BC%9Aattr-%E3%80%81removeAttr"><span class="toc-text">节点属性：attr() 、removeAttr()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9DOM%E7%BB%93%E6%9E%84"><span class="toc-text">修改DOM结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%8A%82%E7%82%B9"><span class="toc-text">添加节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9"><span class="toc-text">删除节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%B5%8B%E8%AF%95"><span class="toc-text">综合测试</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E8%BE%93%E5%85%A5%E6%A1%86%E5%80%BC"><span class="toc-text">表单输入框值</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E8%A6%81%E5%B0%9D%E8%AF%95%E7%94%A8-attr-%E6%96%B9%E6%B3%95"><span class="toc-text">不要尝试用 attr() 方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E4%BA%8B%E4%BB%B6"><span class="toc-text">6.3 事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6"><span class="toc-text">鼠标事件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%8F%82%E6%95%B0"><span class="toc-text">事件参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%AE%E7%9B%98%E4%BA%8B%E4%BB%B6"><span class="toc-text">键盘事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%BA%8B%E4%BB%B6"><span class="toc-text">其他事件</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/56326/" title="Hexo快速打造属于自己的网站">Hexo快速打造属于自己的网站</a><time datetime="2021-11-29T12:10:54.202Z" title="发表于 2021-11-29 20:10:54">2021-11-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/31667/" title="校招笔记（八）_计算机基础_场景&amp;智力题">校招笔记（八）_计算机基础_场景&amp;智力题</a><time datetime="2021-11-26T13:37:19.761Z" title="发表于 2021-11-26 21:37:19">2021-11-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/61434/" title="校招笔记（七）_计算机基础_数据结构">校招笔记（七）_计算机基础_数据结构</a><time datetime="2021-11-26T13:20:04.945Z" title="发表于 2021-11-26 21:20:04">2021-11-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/31215/" title="校招笔记（六）_计算机基础_Redis">校招笔记（六）_计算机基础_Redis</a><time datetime="2021-11-26T13:16:21.848Z" title="发表于 2021-11-26 21:16:21">2021-11-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/56848/" title="校招笔记（五）_计算机基础_MySQL">校招笔记（五）_计算机基础_MySQL</a><time datetime="2021-11-26T12:57:42.047Z" title="发表于 2021-11-26 20:57:42">2021-11-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By Wanghui Huang</div><div class="footer_custom_text">Support By <a target="_blank" rel="noopener" href="https://cloud.tencent.com/" style="text-decoration:underline; color:#476679;"> Tencent Cloud </a> |  <a target="_blank" rel="noopener" href="https://hexo.io/" style="text-decoration:underline; color:#476679;">Hexo</a> | <a target="_blank" rel="noopener" href="https://butterfly.js.org/" style="text-decoration:underline; color:#476679;">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai'
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>