<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><!-- hexo injector head_begin start --><link href="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.2/css/index.css" rel="stylesheet"/><!-- hexo injector head_begin end --><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>前端基础（一）JavaScript基础笔记 | royhuang's blog</title><meta name="author" content="Wanghui Huang"><meta name="copyright" content="Wanghui Huang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第一章：快速入门 1.1 hello javaScript! 我们编写一个简单 test.js 文件，里面有一行代码输出 “hello javaScript!” ： 1alert(&quot;hello javaScript!&quot;); 然后在准备好的 .html 文件head 标签内引入test.js 文件： 123456789&lt;!DOCTYPE HTML&gt;&lt;html&amp;g">
<meta property="og:type" content="website">
<meta property="og:title" content="前端基础（一）JavaScript基础笔记">
<meta property="og:url" content="https://hwh.zone/NO_post/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88%E4%B8%80%EF%BC%89JavaScript%E7%AC%94%E8%AE%B0.html">
<meta property="og:site_name" content="royhuang&#39;s blog">
<meta property="og:description" content="第一章：快速入门 1.1 hello javaScript! 我们编写一个简单 test.js 文件，里面有一行代码输出 “hello javaScript!” ： 1alert(&quot;hello javaScript!&quot;); 然后在准备好的 .html 文件head 标签内引入test.js 文件： 123456789&lt;!DOCTYPE HTML&gt;&lt;html&amp;g">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg">
<meta property="article:published_time" content="2022-01-02T11:54:25.545Z">
<meta property="article:modified_time" content="2022-01-02T11:41:01.648Z">
<meta property="article:author" content="Wanghui Huang">
<meta property="article:tag" content="JavaScript">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/about-bg.jpg"><link rel="shortcut icon" href="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat-modified.png"><link rel="canonical" href="https://hwh.zone/NO_post/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%EF%BC%88%E4%B8%80%EF%BC%89JavaScript%E7%AC%94%E8%AE%B0"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":"true# copy button","highlightLang":false,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":80,"languages":{"author":"作者: Wanghui Huang","link":"链接: ","source":"来源: royhuang's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '前端基础（一）JavaScript基础笔记',
  isPost: false,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-01-02 19:41:01'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="google-site-verification" content="uO6C17u7YuZfMWvThEQ9nOGQS4GIN2zAM6hC4tH-RiM" /><meta name="baidu-site-verification" content="code-nRnoDyQJPT" /><script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?13a4aefcbad9616a1f5859538d0d882e"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa-fw fa-fw fas fa-comment-dots"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">royhuang's blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fa-fw fa-fw fas fa-comment-dots"></i><span> 说说</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 目录</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> aboutME</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="page"><div id="article-container"><h1 class="page-title">前端基础（一）JavaScript基础笔记</h1><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1>第一章：快速入门</h1>
<h2 id="1-1-hello-javaScript">1.1 <em>hello javaScript!</em></h2>
<p>我们编写一个简单 <em>test.js</em> 文件，里面有一行代码输出 <em>“hello javaScript!”</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">&quot;hello javaScript!&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>然后在准备好的 <em>.html</em> 文件<em>head</em> 标签内引入<em>test.js</em> 文件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--这里默认当前路径是index.html所在目录--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>  <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;test.js&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>注意区分引入 <em>.js</em>文件 和 <em>css</em>文件区别：</p>
<ul>
<li>
<p><em>.js</em>文件 用一对 <u><em>&lt;script&gt;&lt;/script&gt;</em></u> 标签包围引用 ；<em>.css</em> 文件用 <u><em><link></em></u> 标签指向：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span>  <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>  <span class="attr">href</span>=<span class="string">&quot;main.css&quot;</span> &gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><em>.js</em>文件 用 <em>src</em> 属性指向 ；<em>.css</em> 文件用 <em>href</em> 属性指向。</p>
</li>
</ul>
</li>
</ul>
<h4 id="引入-js-css文件不成功？">引入 js / css文件不成功？</h4>
<ol>
<li>
<p>没有保存文件</p>
<p>默认 <em>VSCode</em> 不会自动保存文件，如果不自己 <code>ctrl+s</code> ，打开浏览器 <em>F12</em>  --&gt; <em>Source</em> 发现 <em>mian.css</em>文件为空。</p>
<p>可以设置自动保存文件，或者自己手动保存解决。</p>
</li>
<li>
<p>错用 <em>href</em> 属性 引用 <em>js</em>文件</p>
<p>见前。</p>
</li>
</ol>
<h2 id="1-2-安装-codeRunner-插件">1.2 安装 <em>codeRunner</em> 插件</h2>
<p>我们肯定不希望，每次输出一些信息，都要打开浏览器去查看：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">&quot;我想输出一些信息&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>如果可以直接在 <em>VSCoder</em> 中就打印出信息多好啊！但是直接写在<em>js</em> 文件中，只能在浏览器控制台查看。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;我想输出一些信息&quot;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="如何直接打印信息？">如何直接打印信息？</h4>
<blockquote>
<p><em>JavaScript</em> 可以直接打印：<u>数组</u>、<u>对象</u>、字符串、数值类型等</p>
</blockquote>
<p>第一种方式只能在浏览器中查看，后来两种可以直接在VS中查看。</p>
<ul>
<li>
<p>在浏览器控制台中</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1563360135726.png" alt="1563360135726"></p>
</li>
<li>
<p>使用VS自带终端</p>
<p>我们可以用vs自带终端，如果已经安装好 <em>node.js</em> 便可以直接在VS中输出：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1563360509909.png" alt="1563360509909"></p>
<p>其实，这就实现相当于在 <em>cmd</em> 中执行这段代码。</p>
</li>
<li>
<p>利用 <em>CodeRunner</em> 插件</p>
<p>下载好 <em>CodeRunner</em> 插件，也可以直接运行 <em>js</em> 文件：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1563360768328.png" alt="1563360768328"></p>
</li>
</ul>
<h4 id="CodeRunner-运行乱码-报错"><em>CodeRunner</em> 运行乱码/报错</h4>
<ol>
<li><em>Node.js</em> 是否安装</li>
</ol>
<p><em>CodeRunner</em>  还是通过  <em>Node.js</em> 来运行 <em>js</em> 文件，如果没有安装自然出错。</p>
<p>特别的，安装 <em>Node.js</em> 会自动配置好环境变量，所以基本可以排除环境变量配置错误导致该问题。</p>
<ol start="2">
<li>
<p>终端是否能输出</p>
<p>首先在 <em>cmd</em> 尝试运行 <em>js</em>文件 ，如果能正确输出 ；但是在 <em>VS</em>终端中还是运行报错/乱码。可以排除是<em>Node.js</em> 相关配置问题。</p>
<p>如果<em>cmd</em> 中也无法运行，尝试重新配置 <em>node.js</em> 环境变量或者直接卸载重新安装。</p>
</li>
<li>
<p>尝试以管理员身份运行<em>VSCoder</em></p>
<blockquote>
<p>我出现的乱码/无法执行问题以管理员身份运行成功解决。</p>
</blockquote>
<p><strong>1、2</strong> 均无问题， 可以尝试以管理员身份运行 <em>VSCoder</em> 。也可以设置每次打开都是以管理员身份：</p>
<p>右键 <em>VSCoder</em> 图标 —&gt; 属性 --&gt; 兼容性 —&gt; 以管理员身份运行此程序 --&gt; 应用。</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1563361391550.png" alt="1563361391550"></p>
</li>
</ol>
<h2 id="1-3-基本语法">1.3 基本语法</h2>
<h3 id="1-变量和注释">1. 变量和注释</h3>
<p><em>javsScript</em> 注释有单行注释 &amp; 多行注释两种方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// alert(&quot;我不想被执行&quot;);   </span></span><br><span class="line"><span class="comment">/* alert(&quot;我不想被执行&quot;); */</span> </span><br></pre></td></tr></table></figure>
<p><em>javsScript</em> 是弱类型语言，所有变量都可用 <code>var &lt;变量名&gt;</code> 形式定义。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.javsScript不区分整数和浮点型，统称Number</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">3.5</span>; <span class="keyword">var</span> num1 = <span class="number">3</span>; <span class="keyword">var</span> num2 = <span class="number">1.234</span>*e3;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;我是单引号包围字符串&#x27;</span>; <span class="keyword">var</span> str1 = <span class="string">&#x27;&#x27;</span>我是双引号包围字符串<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.布尔类型</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.比较运算符</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="literal">false</span> == <span class="number">0</span>;  <span class="keyword">var</span> b2 = <span class="literal">false</span> === <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> b3 = <span class="number">2</span> &gt; <span class="number">4</span>? ; <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.常量</span></span><br><span class="line"><span class="keyword">const</span> PI = <span class="number">3.14</span>;  <span class="comment">// const&amp;let修饰都是块级作用域（见后）</span></span><br></pre></td></tr></table></figure>
<h4 id="小心！-、NaN、浮点数">小心！== 、NaN、浮点数</h4>
<ul>
<li>
<p>不推荐<code>==</code>比较运算符</p>
<p>不推荐使用 <code>==</code> 运算符，这是 <em>JavaScript</em> 语言设计缺陷，会出现难以意料的错误，推荐使用 <code>===</code>来替换。</p>
</li>
<li>
<p>判断浮点数相等</p>
<p>由于计算机不能精确表示浮点数，所以判断两个浮点数是否相等，比较它们差值是否小于某个足够小值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Math</span>.abs(<span class="number">1</span> / <span class="number">3</span> - (<span class="number">1</span> - <span class="number">2</span> / <span class="number">3</span>)) &lt; <span class="number">0.0000001</span>; <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>判断是否<em>NaN</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="literal">NaN</span>;</span><br><span class="line">alert(num === <span class="literal">NaN</span>); <span class="comment">// 输出false</span></span><br></pre></td></tr></table></figure>
<p>为什么输出 <em>false</em> ？这是因为 <em>NaN</em>和所有其它值都判断不相等，包括它自己，唯一判断方法是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">isNaN(NaN); // true</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>判断 <em>null</em> ： <code>变量 === null；</code></p>
</li>
<li>
<p>判断 <em>Array</em>：<code>Array.isArray(arr);</code></p>
</li>
<li>
<p><em>typeof</em> 可以判断出 <em>Number、Boolean、String、function &amp; undefined</em> 类型，例如：</p>
<ul>
<li>判断全局变量是否存在：<code>typeof window.myVar === 'undefined'</code></li>
<li>判断局部变量是否存在：<code>typeof myVar === 'undefined'</code> 。</li>
</ul>
</li>
</ul>
<h4 id="全局变量">全局变量</h4>
<p>我们知道，常规定义全局变量，把变量不定义在任何嵌套{}中即可。</p>
<p>事实上，变量定义可<u>不用 <em>var</em> 关键字</u>，此时定义的也是全局变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">num = <span class="number">3.5</span>; </span><br><span class="line">str = <span class="string">&#x27;我是字符串&#x27;</span>; </span><br><span class="line">b = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;num = &#x27;</span>+num + <span class="string">&#x27; , str = &#x27;</span>+ str + <span class="string">&#x27;, b = &#x27;</span>+b);</span><br></pre></td></tr></table></figure>
<p>如何理解此时定义的是全局变量？请看下例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 不用var关键字声明函数内部变量</span></span><br><span class="line">    a = <span class="number">1</span> ;   </span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span> ; i &lt; <span class="number">3</span> ; i++);</span><br><span class="line">&#125;</span><br><span class="line">f();</span><br><span class="line"><span class="built_in">console</span>.log(a);   <span class="comment">// 可访问，输出：1</span></span><br><span class="line"><span class="built_in">console</span>.log(i);   <span class="comment">// 可访问，输出：3</span></span><br></pre></td></tr></table></figure>
<p><em>a、i</em> 看似是函数内部局部变量，实际已是全局变量，可以访问。</p>
<h4 id="类型转换">类型转换</h4>
<p>由于 <em>JavaScript</em> 没有那么复杂类型，比如数值类型之间转换（<em>int --&gt; double</em> …）。</p>
<p>常用的有如 <em>Number 、 String 、Boolean、object</em>类型之间转换 ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类型转换</span></span><br><span class="line"><span class="comment">// 1.任何类型转换为String类型： String()转换 OR .toString</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">123.45</span> , b = <span class="literal">true</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">// toString()</span></span><br><span class="line"><span class="built_in">console</span>.log(num.toString());   <span class="comment">// 输出：123.45</span></span><br><span class="line"><span class="built_in">console</span>.log(b.toString());     <span class="comment">// 输出：true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String()</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>(num));      <span class="comment">// 输出：123.45</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">String</span>(b));        <span class="comment">// 输出：true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.任意类型转换成Number类型：用Number() OR parseInt()、parseFloat()</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&#x27;123.45&#x27;</span> , b = <span class="literal">true</span> ;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Number()</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>(str));   <span class="comment">// 输出：123.45</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Number</span>(b));     <span class="comment">// 输出：1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// parseInt()、parseFloat()</span></span><br><span class="line"><span class="comment">// 转换不了boolean类型！</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseFloat</span>(str)); <span class="comment">// 输出：123.45</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseFloat</span>(b));   <span class="comment">// 输出：NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.任意类型转换为Boolean类型：用Boolean()</span></span><br><span class="line"><span class="comment">// 注意：只有 0、&#x27;&#x27;转换为：false ；其余全部转换为ture</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下都转换为ture</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">&#x27;false&#x27;</span>));    <span class="comment">// 也是ture！只有数字0、&#x27;&#x27;会转换为false！！</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">&#x27;123.45&#x27;</span>)); </span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">123.45</span>)); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下都转换为false</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="string">&#x27;&#x27;</span>));   </span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Boolean</span>(<span class="number">0</span>)); </span><br></pre></td></tr></table></figure>
<blockquote>
<p>特别的，具体的值也可以调用 <em>.toString()</em> 方法，转换为 <em>Sting</em> 类型。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 注意1.toString()出错，两个.. OR (1).toString()</span></span><br><span class="line"><span class="number">1.</span>.toString();      <span class="comment">// 1</span></span><br><span class="line"><span class="literal">false</span>.toString();   <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<h3 id="2-字符串">2. 字符串</h3>
<h4 id="如何优雅表示字符串">如何优雅表示字符串</h4>
<p>除了前面介绍用 <code>’ ‘</code> 或者 <code>“ ”</code> 包围，还可以用最新ES6标准，反引号 <strong>``</strong> 包围多行字符串。</p>
<p>⚠️ 反引号是左上角 <kbd>ESC</kbd> 正下方对应键 <kbd>~</kbd> ，切换到英文状态下可以打出**`**</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">`我是</span></span><br><span class="line"><span class="string">多行字符串</span></span><br><span class="line"><span class="string">酷不酷`</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="string">`我是\n多行字符串\n酷不酷`</span>) <span class="comment">// 和上面写法等价</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串拼接">字符串拼接</h4>
<p>除了常见用 <code>+</code> 号进行拼接，还可以用ES6新增的模板字符串进行拼接。</p>
<p>⚠️ 模板字符一定要使用反引号 <strong>`</strong> ，否则${…}当字符串输出了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&#x27;hwh&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> age = <span class="number">20</span>;</span><br><span class="line"><span class="comment">// var message = &#x27;我是&#x27;+ name + &#x27;,今年&#x27;+ age+&#x27;岁啦！&#x27;;</span></span><br><span class="line"><span class="keyword">var</span> message = <span class="string">`我是<span class="subst">$&#123;name&#125;</span>,今年<span class="subst">$&#123;age&#125;</span>岁啦！`</span>; <span class="comment">// 一定要使用反引号 `,否则$&#123;..&#125;当字符串输出</span></span><br><span class="line">alert(message);</span><br></pre></td></tr></table></figure>
<h4 id="常用字符串操作">常用字符串操作</h4>
<ul>
<li>
<p>获取字符串指定位置字符</p>
<p>直接把字符串当做数组进行索引即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;hello world&#x27;</span>;</span><br><span class="line">alert(s[<span class="number">0</span>]);  <span class="comment">// 输出：h</span></span><br></pre></td></tr></table></figure>
<p>但是字符串是不可变的，不能对其某个字符索引赋值，不会有任何效果（但不报错）：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s[<span class="number">0</span>] = <span class="string">&#x27;l&#x27;</span>;</span><br><span class="line">alert(s); <span class="comment">// 还是输出：hello world</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>常用字符串方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.转换字符串大小写</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;Hello&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> upper = s.toUpperCase(); <span class="comment">// 返回&#x27;HELLO&#x27;</span></span><br><span class="line"><span class="keyword">var</span> lower = s.toLowerCase(); <span class="comment">// 返回&#x27;hello&#x27;并赋值给变量lower</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.返回字符在字符串中位置</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;hello javaScript!&quot;</span>;</span><br><span class="line">alert(str.indexOf(<span class="string">&#x27;java&#x27;</span>)); <span class="comment">// 输出6：j是第6个字符，从0计数。前面有6字符： hello + 空格 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.字符串截取</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;hello, world&#x27;</span></span><br><span class="line">s.substring(<span class="number">0</span>, <span class="number">5</span>); <span class="comment">// 从索引0开始到5（不包括5），返回&#x27;hello&#x27;</span></span><br><span class="line">s.substring(<span class="number">7</span>); <span class="comment">// 从索引7开始到结束，返回&#x27;world&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-数组">3. 数组</h3>
<p>定义一个简单数组，通常有 <u>直接定义</u> &amp; <em><u>new</u></em> 两种方式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = [];  </span><br><span class="line"><span class="comment">// var s = new Array();</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s1 = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"><span class="comment">// var s1 = new Array(1,2);</span></span><br></pre></td></tr></table></figure>
<h4 id="奇妙数组">奇妙数组</h4>
<p><em>JavaScript</em> 和其它语言数组有很多不同，这里一一说道。</p>
<ol>
<li>
<p>数组不限制类型</p>
<p>下面是一个长度 = 6，包含多种类型的数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.14</span>, <span class="string">&#x27;Hello&#x27;</span>, <span class="literal">null</span>, <span class="literal">true</span>]; </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>改变数组大小很简单</p>
<p>以往语言要扩展数组总是一件复杂的事，比如 <em>java</em> 用集合 <em>ArrayList</em> 来实现。</p>
<p><em>JavaScript</em> 直接改变数组 <em>length</em> 属性即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="comment">// 扩大数组</span></span><br><span class="line">arr.length = <span class="number">6</span>; <span class="comment">// arr数组变为：[1, 2, 3, undefined, undefined, undefined]</span></span><br><span class="line"><span class="comment">// 缩小数组</span></span><br><span class="line">arr.length = <span class="number">1</span>; <span class="comment">// arr数组变为：[1]</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可以越界赋值</p>
<p>很多编程语言是不允许越界赋值数组，但<em>JavaScript</em> 允许，它会自动扩大数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr[<span class="number">6</span>] = <span class="number">6</span>; <span class="comment">// arr数组变为：[1, 2, 3, undefined, undefined, 6]</span></span><br></pre></td></tr></table></figure>
<p>但是，这种做法不被推荐，尽量保证索引不会越界！</p>
</li>
</ol>
<h4 id="常用数组操作">常用数组操作</h4>
<p>以下是常用数组操作的方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span>  arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.数组转为字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="built_in">String</span>(arr);</span><br><span class="line"><span class="built_in">console</span>.log(str);  <span class="comment">// 输出：1,2,3,4,5,6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.indexOf：返回指定元素位置</span></span><br><span class="line"><span class="keyword">var</span> i = arr.indexOf(<span class="number">1</span>);</span><br><span class="line"><span class="built_in">console</span>.log(i);   <span class="comment">// 输出：0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.slice：左开右闭截取元素, 对应String的substring()方法</span></span><br><span class="line"><span class="comment">// 不指定第二个参数，会截取第一个参数位置以后所有元素</span></span><br><span class="line"><span class="keyword">var</span> sub03 = arr.slice(<span class="number">0</span>,<span class="number">3</span>) </span><br><span class="line"><span class="keyword">var</span> sub3 = arr.slice(<span class="number">0</span>)    </span><br><span class="line"><span class="built_in">console</span>.log(sub03);  <span class="comment">// 输出：[ 1, 2, 3 ]</span></span><br><span class="line"><span class="built_in">console</span>.log(sub3);   <span class="comment">// 输出：[ 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.push 和 pop 尾部增减元素</span></span><br><span class="line">arr.push(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;js&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">// 输出：[ 1, 2, 3, 4, 5, 6, &#x27;hello&#x27;, &#x27;js&#x27; ]</span></span><br><span class="line">arr.pop() ; arr.pop();</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">// 输出：[ 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.unshift 和 shift 头部增减元素</span></span><br><span class="line">arr.unshift(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ &#x27;A&#x27;, &#x27;B&#x27;, 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line">arr.shift(); arr.shift();</span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6.反转和排序</span></span><br><span class="line">arr.reverse();  </span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ 6, 5, 4, 3, 2, 1 ]</span></span><br><span class="line">arr.sort();       </span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ 1, 2, 3, 4, 5, 6 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 7.splice：从指定位置删除若干元素，再从该位置添加若干元素</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;c#&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;c++&quot;</span>,<span class="string">&quot;python&quot;</span>,<span class="string">&quot;java&quot;</span>,<span class="string">&quot;javascript&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除&amp;添加：从索引1开始删除2个元素，然后再从原索引位置添加两个元素</span></span><br><span class="line"><span class="keyword">var</span> delElem = arr.splice(<span class="number">1</span>,<span class="number">2</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>); <span class="comment">// 返回被删除的元素:[&quot;c&quot;,&quot;c++&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ &#x27;c#&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;python&#x27;, &#x27;java&#x27;, &#x27;javascript&#x27; ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 只删除：不设定2个参数以上就行</span></span><br><span class="line"><span class="keyword">var</span> delElem1 = arr.splice(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);    <span class="comment">// 输出：[ &#x27;c#&#x27;, &#x27;python&#x27;, &#x27;java&#x27;, &#x27;javascript&#x27; ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 只添加：设置第二个参数为0，即删除0个元素</span></span><br><span class="line"><span class="keyword">var</span> delElem2 = arr.splice(<span class="number">1</span>,<span class="number">0</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;c++&quot;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr);   <span class="comment">// 输出：[ &#x27;c#&#x27;, &#x27;c&#x27;, &#x27;c++&#x27;, &#x27;python&#x27;, &#x27;java&#x27;, &#x27;javascript&#x27; ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 8.concat：连接两个数组,但不改变原数组，只是返回一个新数组</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr1.concat(<span class="string">&quot;hwh&quot;</span>,[<span class="string">&quot;上&quot;</span>,<span class="string">&quot;山&quot;</span>,<span class="string">&quot;打&quot;</span>,<span class="string">&quot;老&quot;</span>,<span class="string">&quot;虎&quot;</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(arr2);  <span class="comment">// 输出：[ 1, 2, 3, 4, 5, &#x27;hwh&#x27;, &#x27;上&#x27;, &#x27;山&#x27;, &#x27;打&#x27;, &#x27;老&#x27;, &#x27;虎&#x27; ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 9.join：将数组转为字符串，可指定连接字符</span></span><br><span class="line"><span class="keyword">var</span> arr3 = arr1.join(<span class="string">&#x27;~&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(arr3);  <span class="comment">// 输出：1~2~3~4~5</span></span><br></pre></td></tr></table></figure>
<h4 id="多维数组">多维数组</h4>
<p>多维数组：如果某个元素是多维数组，那么就可以形成多维数组。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多维数组</span></span><br><span class="line"><span class="keyword">var</span> darr = [[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">400</span>, <span class="number">500</span>, <span class="number">600</span>], <span class="string">&#x27;-&#x27;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(darr[<span class="number">1</span>][<span class="number">1</span>]); <span class="comment">// 输出：500</span></span><br></pre></td></tr></table></figure>
<h3 id="4-对象">4. 对象</h3>
<blockquote>
<p>注意：在 <em>JavaScript</em> 中没有类这个概率，通过原型链来实现类作为模板概念，在后详述。下面都是具体对象！</p>
</blockquote>
<p>例如下面创建一个<em>hwh</em>对象，类似于 <em>python</em> 使用键值对定义 <em>map</em> 。</p>
<p>当然，还可以给对象增添方法（注意，此时不叫函数！），<u><em>详见 第二章：函数  2.3节</em></u></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;huangwanghui&quot;</span>,</span><br><span class="line">    <span class="attr">school</span>:<span class="string">&quot;chongqingU&quot;</span>,</span><br><span class="line">    <span class="string">&#x27;stu-num&#x27;</span>: <span class="number">123456</span>    <span class="comment">// 注意：最后一行代码不要加逗号，否则在低版本IE可能会报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="访问对象属性">访问对象属性</h4>
<p>访问对象属性有两种办法：</p>
<ol>
<li>
<p>通过<code>&lt;对象名.属性名&gt;</code> 形式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(hwh.name);     <span class="comment">// 输出：huangwanghui</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh.school);   <span class="comment">// 输出：chongqingU</span></span><br></pre></td></tr></table></figure>
<p>特别的，访问不存在属性不会报错，但是会返回 <em><u>undefined</u></em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(hwh.school);       <span class="comment">// 输出：undefined</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>通过<code>&lt;对象名['属性名']&gt;</code> 形式</p>
<p>理论上，所有访问对象属性都可通过该方式，特别以下两种情况只能使用<code>&lt;对象名['属性名']&gt;</code>这种方式。</p>
<ul>
<li>
<p>属性名不是标准变量名</p>
<p>如 <em><u>‘stu-num’</u></em> 含变量定义非法字符 <code>-</code> ，所以要用 <code>’‘</code> 包围，只能通过 <code>&lt;对象名['属性名']&gt;</code> 访问该属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(hwh.stu-num);     <span class="comment">// 输出：NaN</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh[<span class="string">&#x27;stu-num&#x27;</span>]);  <span class="comment">// 输出：123456</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>循环遍历属性时</p>
<blockquote>
<p>在下面遍历对象属性，为什么都是输出 <em>undefined</em>？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 遍历属性</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> hwh)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(a);       <span class="comment">// 输出：name  shcool   &#x27;stu-num&#x27;</span></span><br><span class="line">    <span class="built_in">console</span>.log(hwh.a);   <span class="comment">// 输出：undefined undefined undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为，此时 hwh.a 相当于访问的是hwh对象一个属性名为a的属性，这自然是不存在的。</p>
<p>正确做法使用<code>对象名['属性名']</code>便可正常输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> a <span class="keyword">in</span> hwh)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(hwh[a]);  <span class="comment">// 输出：huangwanghui chongqingU 123456</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h4 id="给对象增删属性">给对象增删属性</h4>
<p>给对象增减属性较为简单，增加属性类似于数组增加元素，删除属性要利用 <em>delete</em> 关键字。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 增删属性</span></span><br><span class="line">hwh.age = <span class="number">23</span>;</span><br><span class="line"><span class="built_in">console</span>.log(hwh.age);  <span class="comment">// 输出：23</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> hwh.age;</span><br><span class="line"><span class="built_in">console</span>.log(hwh.age);  <span class="comment">// 输出：undefined</span></span><br></pre></td></tr></table></figure>
<h4 id="判断对象是否拥有某属性">判断对象是否拥有某属性</h4>
<p>判断对象是否用于某属性也有两种办法。</p>
<ul>
<li>
<p>利用 <em>in</em> 判断一个属性是否存在</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;name&#x27;</span> <span class="keyword">in</span> hwh);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;age&#x27;</span> <span class="keyword">in</span> hwh);</span><br></pre></td></tr></table></figure>
<p>但是这种方法有一个问题，<em>in</em> 判断属性不一定属于 <em>hwh</em>，还可能是 <em>hwh</em> 继承得到的。</p>
<p>比如原型链中，<em>hwh</em> 肯定会指向所有属性都指向的 <em>Object</em>， <em>Object</em> 含有一个<em>toString</em> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;toString&#x27;</span> <span class="keyword">in</span> hwh); <span class="comment">// 输出：true</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>利用<code>hasOwnProperty()</code>方法</p>
<p>这种方法可以不会判断继承得到的属性属于对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;toString&#x27;</span> <span class="keyword">in</span> hwh); <span class="comment">// 输出：false</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-条件判断-循环">5. 条件判断 &amp; 循环</h3>
<h4 id="条件判断">条件判断</h4>
<p><em>JavaScript</em> 把<em>null、undefined、0、NaN</em>  &amp; 空字符串<code>''</code>视为<code>false</code>，其他值一概视为<code>true</code>，因此下面代码条件判断的结果是<code>true</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (s.length) <span class="comment">// 条件计算结果为3</span></span><br><span class="line">&#123; </span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="循环">循环</h4>
<p>在 <em>JavaScript</em> 循环和 <em>java</em> 等高级语言循环没有太大区别。</p>
<p>特别的，在 <em>JavaScript</em> 中数组也被看作是对象，它的索引则被视为一个属性。然而遍历数组时，如果使用 <em>for…in</em>循环时，如给数组增加一个属性，将导致一个难以意料的结果。</p>
<p>这个问题可以用 <em>for…of</em> 循环解决，它还可以专用于遍历集合类型，详见 <u>7. <em>iterable</em> 类型</u> 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="string">&quot;上山打老虎&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.普通for循环</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; num.length; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num[i]);  <span class="comment">// 输出： 1 2 3 4 5 上山打老虎</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.for..in 循环</span></span><br><span class="line"><span class="comment">// 除了前面用来遍历对象属性，遍历数组也类似</span></span><br><span class="line"><span class="comment">// for..in 循环的到时 String 而不是 Number，for循环呢？</span></span><br><span class="line"><span class="comment">// 直接输出i是数组序号：0 1 2 3 4 5  ，可理解为把数组当对象，序号是它“属性名”</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> num)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);     <span class="comment">// 输出： 0 1 2 3 4 5 </span></span><br><span class="line">    <span class="built_in">console</span>.log(num[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.while 循环</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(i&lt;<span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num[i]);</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.do...while 循环</span></span><br><span class="line"><span class="comment">// 注意：do...while 循环至少会执行一次！</span></span><br><span class="line"><span class="keyword">var</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num[j]);</span><br><span class="line">    j++;</span><br><span class="line">&#125;<span class="keyword">while</span>(j&lt;<span class="number">6</span>);</span><br></pre></td></tr></table></figure>
<h3 id="6-Map-Set">6. <em>Map &amp; Set</em></h3>
<p>在前面 <em>JavaScript</em> 中 <u>4.对象</u>  中<code>&#123;&#125;</code> 表达方式可以视作其它语言 <em>Map</em> 或 <em>Dictionary</em> 数据结构键值对表达方式。</p>
<p>BUT，<em>JavaScript</em> 中 <u>对象中键只能是字符串</u> ，而在本讲 <em>Map &amp; Set</em> 将不局限于这点，还可以是 <em>Number</em>等类型。</p>
<h4 id="MAP"><em>MAP</em></h4>
<p><em>MAP</em> 基本创建、增 == 改、删操作，和：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map</span></span><br><span class="line"><span class="comment">// 1.创建：注意是([[..],[..],[..]])形式外侧还有一个[]</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>,<span class="string">&quot;hwh&quot;</span>],[<span class="number">2</span>,<span class="string">&#x27;liuting&#x27;</span>],[<span class="number">3</span>,<span class="string">&#x27;xiaoming&#x27;</span>]]); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.增加(修改)键值对</span></span><br><span class="line">m.set(<span class="number">4</span>,<span class="string">&#x27;xiaobai&#x27;</span>);   <span class="comment">// 不存在该键4，则是创建新键值对</span></span><br><span class="line">m.set(<span class="number">4</span>,<span class="string">&#x27;xiaohei&#x27;</span>);   <span class="comment">// 存在键值4，那么是修改键4对应键值对</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.删除键值对</span></span><br><span class="line">m.delete(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.判断是否存在键值</span></span><br><span class="line"><span class="keyword">var</span> b = m.has(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.log(b);      <span class="comment">// 由于被删除所以是：false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.获取键值对</span></span><br><span class="line"><span class="keyword">var</span> a = m.get(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">console</span>.log(a);     <span class="comment">// 输出：liuting</span></span><br></pre></td></tr></table></figure>
<p>注意，当<em>map</em> 键是<em>String</em> 类型一定要加<u>引号</u>（对象如果变量名符合规范可以不加），而且访问也要加引号：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>],[<span class="string">&quot;b&quot;</span>,<span class="number">2</span>]]);  </span><br><span class="line"><span class="comment">// m.get(a); // 出错</span></span><br><span class="line">m.get(<span class="string">&#x27;a&#x27;</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>MAP</em> 和对象有什么区别？</p>
</blockquote>
<p><em>MAP</em> 和对象都是利用 <u>键值对</u> 形式构造，但是也有以下区别：</p>
<ol>
<li>删除、添加元素方式不同</li>
<li>访问形式不同：MAP通过<em>get()</em> 方法，对象通过 <u>对象.属性名</u> 或者 <u>对象[属性名]</u>形式</li>
<li>访问速度不同：MAP 拥有极快的访问速度</li>
<li>支持key类型不同：MAP支持多种类型作为key，对象只支持字符串<em>String</em> 类型</li>
</ol>
<h4 id="Set"><em>Set</em></h4>
<p><code>Set</code>和<code>Map</code>类似，也是一组key的集合，但不存储<em>value</em>。</p>
<p>由于<em>key</em>不能重复，所以，在<code>Set</code>中，没有重复的key。如，创建时出现重复<em>key</em>，只会保留一个。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Set</span></span><br><span class="line"><span class="comment">// 1.创建：出现重复键值被过滤</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>]);  <span class="comment">// 实际集合中数据：&#123;1, 2, 3&#125;</span></span><br><span class="line"><span class="comment">// 类似的：map也只会保存最后插入的重复键值</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>],[<span class="string">&#x27;a&#x27;</span>,<span class="number">2</span>],[<span class="string">&quot;b&quot;</span>,<span class="number">2</span>]]);  <span class="comment">// 实际集合中数据：&#123;[&#x27;a&#x27;,2],[&quot;b&quot;,2]&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.增加</span></span><br><span class="line">s.add(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.删除</span></span><br><span class="line">s.delete(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>Set</em> 和数组 <em>Array</em> 区别？</p>
</blockquote>
<ol>
<li>删除、添加元素方法不同</li>
<li><em>Set</em> 可以去重，而且可以 <u>快速查找</u> ，但无法实现按下标查找等操作</li>
</ol>
<h3 id="7-如何优雅遍历集合">7. 如何优雅遍历集合</h3>
<h4 id="for-…-in-遍历集合"><em>for … in</em> 遍历集合</h4>
<blockquote>
<p>遍历数组 <em>Array</em> 可以用下标循环，如何遍历集合类型如 <em>Map &amp; Set</em> 类型？能用 <em>for … in</em> 循环吗？</p>
</blockquote>
<p>我们尝试用 <em>for…in</em> 循环遍历集合：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>,<span class="string">&quot;hwh&quot;</span>],[<span class="number">2</span>,<span class="string">&#x27;liuting&#x27;</span>],[<span class="number">3</span>,<span class="string">&#x27;xiaoming&#x27;</span>]]); </span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]); </span><br><span class="line"></span><br><span class="line"><span class="comment">// for...in 遍历集合</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> s)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 什么都没输出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很不幸，什么都没输出。</p>
<p>事实上，<u><em>Array、Map &amp; Set</em> 都属于<em>iterable</em> 类型</u>。对于 <em>iterable</em> 类型可以用 <em>for…of</em> 循环输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// for...of 遍历集合</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">of</span> m)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 输出：[ 1, &#x27;hwh&#x27; ]   [ 2, &#x27;liuting&#x27; ]  [ 3, &#x27;xiaoming&#x27; ]</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">of</span> s)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 输出：1  2  3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="forEach-遍历集合"><em>forEach()</em> 遍历集合</h4>
<p>遍历集合更加优雅安全的方式是通过 <em>iterable</em>内置的<em>forEach()</em> 方法，<u>它接受一个函数，每次迭代自动回调该函数</u>。</p>
<blockquote>
<p><em>forEach()</em> 是一个高级方法，接收一个函数，用来遍历数组。详见 <u>2.4 高阶函数 – <em>forEach(</em>)</u></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// forEach() 遍历集合</span></span><br><span class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="number">1</span>,<span class="string">&quot;hwh&quot;</span>],[<span class="number">2</span>,<span class="string">&#x27;liuting&#x27;</span>],[<span class="number">3</span>,<span class="string">&#x27;xiaoming&#x27;</span>]]); </span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]); </span><br><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历Map</span></span><br><span class="line">m.forEach</span><br><span class="line">(</span><br><span class="line">   <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value);    <span class="comment">// 输出：hwh   liuting   xiaoming</span></span><br><span class="line">   &#125;</span><br><span class="line">); </span><br><span class="line"><span class="comment">// 遍历Set</span></span><br><span class="line">s.forEach</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(element);    <span class="comment">// 输出：1   2   3</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="comment">// 遍历Array</span></span><br><span class="line">arr.forEach</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">element</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(element);    <span class="comment">// 输出：A   B   C</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历对象：注意不能遍历对象！！</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="for-…-in-循环的弊端：数组长度不一致"><em>for … in</em> 循环的弊端：数组长度不一致</h4>
<p>我们已经知道 ，<em>Array</em> 都属于<em>iterable</em> 类型 ，但我们用 <em>for … in</em> 可以遍历输出<em>Array</em> 。</p>
<p>但是，我们在前也知道，数组也是对象，它的下标就是属性名。如果我们给一个数组增加属性名，然后遍历：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>];</span><br><span class="line"><span class="comment">// 类似对象一般，给数组增加属性</span></span><br><span class="line">arr.name = <span class="string">&#x27;alpha&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> arr)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);     <span class="comment">// 输出属性名：0  1  2  name</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>依次输出的是数组的属性名，好吧，这没什么不正常。</p>
<p>但是我们再尝试打印此时的数组大小：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(arr.length);  <span class="comment">// 输出：3</span></span><br></pre></td></tr></table></figure>
<p>噢…不忍直视，数组长度竟然是3，而不是4！</p>
<blockquote>
<p>为什么说<em>for… of</em> 循环可以避免这个问题呢？</p>
</blockquote>
<p>因为<em>for… of</em>  循环只会遍历，集合内的元素，这种不正当通过 <code>数组名.属性 </code> 赋值方式不会被输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">of</span> arr)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);       <span class="comment">// 输出元素而非属性名：A  B  C  </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(arr.length);  <span class="comment">// 输出：3</span></span><br></pre></td></tr></table></figure>
<p>这样循环遍历数组元素个数 === 数组长度，保证了一致性。</p>
<p>而且，你应该还注意到一个细节，此时<u>输出的是元素，而非是属性名</u>。</p>
<h1>第二章 ：函数</h1>
<h2 id="2-1-函数基本入门">2.1 函数基本入门</h2>
<h3 id="函数定义">函数定义</h3>
<p>在 <em>JavaScript</em> 中，定义函数有两种方式：一种类似于其它高级语言，但没有返回值类型；一种匿名函数方式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数定义</span></span><br><span class="line"><span class="comment">// 1.第一种类似其它高级语言定义函数，但没有返回值类型，js也不需要定义类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.第二种匿名函数，其实函数也是对象，把函数名max1视作指向该函数的变量</span></span><br><span class="line"><span class="keyword">var</span> max1 = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 <em>JavaScript</em> 中，这两种方式是完全等价的，自然调用方式也是一致的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调用函数</span></span><br><span class="line"><span class="built_in">console</span>.log(max(<span class="number">1</span>,<span class="number">2</span>));   <span class="comment">// 输出：2</span></span><br><span class="line"><span class="built_in">console</span>.log(max1(<span class="number">1</span>,<span class="number">2</span>));  <span class="comment">// 输出：2</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 不加()，直接调用函数不会报错，只会输出函数名：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(max);       <span class="comment">// [Function: max]</span></span><br></pre></td></tr></table></figure>
<p>但是可以把函数作为变量传递给另外一个变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> my_max = max;</span><br><span class="line">my_max(<span class="number">1</span>,<span class="number">2</span>);   <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<h4 id="小心你的-return-语句">小心你的 <em>return</em> 语句</h4>
<p><em>JavaScript</em> 引擎 <u>会在行末自动添加分号</u>，这可能会导致使用 <em>return</em> 产生意料之外的错误：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line">    a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用max</span></span><br><span class="line">max(<span class="number">1</span>,<span class="number">2</span>);    <span class="comment">// 输出：什么都没有输出</span></span><br></pre></td></tr></table></figure>
<p>你会惊喜的发现，什么都没有输出！这是因为，由于自动添加分号，函数实际已经变成：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>  ;  <span class="comment">// 这里被添加了分号，函数执行到这结束了</span></span><br><span class="line">    a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以，细心的你一定会避过这个坑吧？</p>
<h3 id="奇妙的函数参数">奇妙的函数参数</h3>
<h4 id="传递参数个数任意？">传递参数个数任意？</h4>
<p>如果是第一次接触 <em>JavaScript</em> ，在上面定义<em>max</em> 函数我们可以惊讶的发现，可以传递不止两个参数！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多个参数调用</span></span><br><span class="line"><span class="built_in">console</span>.log(max(<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>));   <span class="comment">// 输出：2</span></span><br></pre></td></tr></table></figure>
<p>而且它还计算出了正确结果！</p>
<p>事实上，<em>JavaScript</em> 允许传递任意个参数，如果函数内部不使用多余的参数自然也就不会影响到结果。</p>
<blockquote>
<p>那么传递参数比实际定义少呢？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(max(<span class="number">1</span>));            <span class="comment">// 输出：undefined</span></span><br></pre></td></tr></table></figure>
<h4 id="怎么处理所有参数？">怎么处理所有参数？</h4>
<blockquote>
<p>在上面虽然我们调用 <em>max()</em> 函数输入了多余参数，但是我还是想把多余参数给输出来，该如何处理？</p>
</blockquote>
<p>在函数内部利用 <em>arguments</em> ，可以获取所有参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// arguments</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">arguments</span>.length &gt; <span class="number">2</span>) <span class="comment">// 输出超过定义个数的参数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">2</span> ; i &lt; <span class="built_in">arguments</span>.length ; i++ )</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="built_in">arguments</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用max</span></span><br><span class="line">max(<span class="number">1</span>,<span class="number">2</span>,<span class="string">&quot;hhh不许笑！&quot;</span>);    <span class="comment">// 输出：hhh不许笑！</span></span><br></pre></td></tr></table></figure>
<p>一般常用的也就是：<em>arguments.length</em>  &amp; <em>arguments[i]</em>  用来获取参数长度和指定索引参数。</p>
<h4 id="优雅的处理多余参数">优雅的处理多余参数</h4>
<p>上面虽然用<em>arguments</em> 获取到所有参数，然后输出多余参数，但是总感觉很变扭。</p>
<blockquote>
<p>但是有没有一种方式，让我们直接处理多余参数 ，而不是要从索引 <strong>2</strong> 先排除前两个参数？</p>
</blockquote>
<p>可以使用 <em>rest</em> 来达到这个目的，<u>多余参数会以数组形式</u> 交给 <em>rest</em> 变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rest</span></span><br><span class="line"><span class="comment">// 函数定义的时候要以：...rest来标识[从哪里开始算是多余参数]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">max</span>(<span class="params">a,b,...rest</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(rest);  <span class="comment">// 会以[数组]形式输出</span></span><br><span class="line">    <span class="keyword">return</span> a &gt; b ? a : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用max</span></span><br><span class="line">max(<span class="number">1</span>,<span class="number">2</span>,<span class="string">&quot;hhh不许笑！&quot;</span>);    <span class="comment">// 输出：[ &#x27;hhh不许笑！&#x27; ]</span></span><br></pre></td></tr></table></figure>
<h2 id="2-2-变量作用域与解构赋值">2.2 变量作用域与解构赋值</h2>
<h3 id="1-快速了解变量作用域">1. 快速了解变量作用域</h3>
<p>变量作用域块{}知识基本和其它语言没有太大区别，但是有几个 <em>JavaScript</em> 所特有特性。</p>
<h4 id="变量提升">变量提升</h4>
<blockquote>
<p>执行下面函数会报错吗？如果不会，那么输出什么？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>; </span><br><span class="line">    <span class="built_in">console</span>.log( x + y);  </span><br><span class="line">    <span class="keyword">var</span> y = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">f();</span><br></pre></td></tr></table></figure>
<p>执行这段代码，我们发现：编译器没有报错，但是输出 <em>NaN</em> 。</p>
<p>这是因为<em>javascript</em> 有一个很奇怪的特性：它会自动提升 <u>变量的声明</u> 到<strong>函数</strong>顶端，但是又不会提升 <u>变量的赋值</u>。</p>
<p>在编译器眼里，它看到的代码是这样的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>; </span><br><span class="line">    <span class="keyword">var</span> y ; <span class="comment">// 提升了定义</span></span><br><span class="line">    <span class="built_in">console</span>.log( x + y);  <span class="comment">// 执行后也并没有报错    </span></span><br><span class="line">    y = <span class="number">2</span>;  <span class="comment">// 没有提升赋值</span></span><br><span class="line">&#125;</span><br><span class="line">f();</span><br></pre></td></tr></table></figure>
<p>所以虽然可以使用变量 <em>y</em> 但是又不能使用它的值，所以输出：<em>NaN</em> 。</p>
<h4 id="避免错误">避免错误</h4>
<blockquote>
<p>😋 对于这种怪异特性，我们最好提前用 <em>var</em> 声明所有要使用的变量。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>,</span><br><span class="line">        y = <span class="number">2</span>,</span><br><span class="line">        z;</span><br><span class="line">   <span class="comment">// do something  </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>😋 用 <em>let</em> 关键字来限定变量范围，申明一个块级作用域。</p>
</blockquote>
<p>由于这种变量提升特性，导致<u>变量实际作用域是函数内部</u>，会使得<em>for</em> 等循环语块无法定义具有局部作用域变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 不报错可以使用i，但是输出：undefined</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 可以使用i值，输出：3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f();</span><br></pre></td></tr></table></figure>
<p>我们可以通过 <em>let</em> 关键字来达到，限定 <em><strong>i</strong></em> 为局部变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(i);   <span class="comment">//  会报错，不能使用局部变量i</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; <span class="number">3</span> ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(i);  <span class="comment">// 会报错，不能使用局部变量i</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">f();</span><br></pre></td></tr></table></figure>
<h3 id="2-全局作用域">2. 全局作用域</h3>
<p>不在任何函数内定义的变量就具有全局作用域。</p>
<p>特别的，顶层函数也是全局变量。虽然乍看有点难以理解，但是回想它的匿名函数写法，便一目了然。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="comment">// 全局作用域</span></span><br><span class="line"><span class="keyword">var</span> author = <span class="string">&#x27;hwh&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f2 = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;顶层函数也是全局变量&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局变量任意嵌套块中都可以调用</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(author);</span><br><span class="line">    <span class="built_in">console</span>.log(f2());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="window-对象"><em>window</em> 对象</h4>
<p><em>window</em> 是<em>javascript</em>  <u>默认全局对象</u> ，<u>所有全局变量</u> 都被绑定到 <em>window</em> 上作为一个<u>属性</u>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// window</span></span><br><span class="line"><span class="comment">// 调用window对象：console.log 会报错，用alert打开网页可正常输出？</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//  console.log(window.author);  // 出错</span></span><br><span class="line">    alert(<span class="built_in">window</span>.author);        <span class="comment">// 打开网页输出：hwh</span></span><br><span class="line">    alert(<span class="built_in">window</span>.f2());          <span class="comment">// 打开网页输出：顶层函数也是全局变量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，全局变量可以作为它的属性一样被调用。事实上 <em>alert()</em> 也是一个全局变量。</p>
<blockquote>
<p>下面尝试给 <u>函数变量</u> <em>alert</em> 赋值一个新的函数，使得它不能执行 <em>alert()</em> 原本输出功能。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.alert(<span class="string">&#x27;调用window.alert()&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个变量保存函数（函数也是变量）</span></span><br><span class="line"><span class="keyword">var</span> old_alert = <span class="built_in">window</span>.alert;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 给alert赋一个新函数:</span></span><br><span class="line"><span class="built_in">window</span>.alert = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 尝试调用alert()</span></span><br><span class="line">alert(<span class="string">&#x27;我还能输出吗？&#x27;</span>); <span class="comment">// 打开网页发现这句话不会被输出</span></span><br></pre></td></tr></table></figure>
<h4 id="更好的定义全局变量">更好的定义全局变量</h4>
<p>全局变量会绑定到对象<em>window</em>上，不同的 <em>JavaScript</em> 文件如果使用了相同的全局变量，或者定义了相同名字的顶层函数，都会造成命名冲突，并且很难被发现。</p>
<p>减少冲突的一个方法是把自己的所有变量和函数全部绑定到一个全局变量中。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 唯一的全局变量<span class="doctag">NOTE:</span></span></span><br><span class="line"><span class="keyword">var</span> NOTE = &#123;&#125;;  <span class="comment">// 对象？</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他变量:</span></span><br><span class="line">NOTE.author = <span class="string">&#x27;hwh&#x27;</span>;</span><br><span class="line">NOTE.version = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 其他函数:</span></span><br><span class="line">NOTE.f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="3-解析构值">3. 解析构值</h3>
<p>什么是解析构值？简单来说，可以 <u>同时对一组变量进行赋值</u>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解析构值</span></span><br><span class="line"><span class="comment">// 注意：解析构值涉及多个变量赋值，两边都要用[]包围</span></span><br><span class="line"><span class="keyword">var</span> x,y,z,rest;</span><br><span class="line">[x,y,z] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];   </span><br></pre></td></tr></table></figure>
<p>还可以像前一样，用<code>...</code> 标识<em>rest</em> ，以数组形式接收指定位置之后所有赋值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.解析赋值：...rest</span></span><br><span class="line">[x,y,z,...rest] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(rest);      <span class="comment">// 输出：[ 4, 5]</span></span><br></pre></td></tr></table></figure>
<h4 id="解构数组">解构数组</h4>
<p>除了上述基本特点，解构数组还有以下特点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 解析数组  </span></span><br><span class="line"><span class="keyword">var</span> x,y,z,rest;</span><br></pre></td></tr></table></figure>
<ol>
<li>
<p>允许待赋值变量个数 ≠ 右侧变量数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 允许待赋值变量个数 ≠ 右侧变量数</span></span><br><span class="line"><span class="comment">// 待赋值变量 &gt; 右侧，剩余未赋值变量赋undefined </span></span><br><span class="line">[x,y,z] = [<span class="number">1</span>,<span class="number">2</span>];                       <span class="comment">// 等价于：[x,y,z] = [1,2,undefined];</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;x=&#x27;</span>+x+<span class="string">&#x27;,y=&#x27;</span>+y+<span class="string">&#x27;,z =&#x27;</span>+z);  <span class="comment">// 输出 ：x=1,y=2,z=undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 待赋值变量 &lt; 右侧，只会对应依次将待赋值变量赋值完毕</span></span><br><span class="line">[x,y,z] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];                  <span class="comment">// 等价于：[x,y,z] = [1,2,3]; </span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;x=&#x27;</span>+x+<span class="string">&#x27;,y=&#x27;</span>+y+<span class="string">&#x27;,z =&#x27;</span>+z);   <span class="comment">// 输出：x = 1,y = 2,z = 3</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>设置默认值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.可以设置默认值</span></span><br><span class="line">[x,y,z = <span class="number">666</span>] = [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;x=&#x27;</span>+x+<span class="string">&#x27;,y=&#x27;</span>+y+<span class="string">&#x27;,z =&#x27;</span>+z);    <span class="comment">// 输出：x=1,y=2,z=666</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>忽略某些值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3.忽略值</span></span><br><span class="line"><span class="keyword">var</span> a,b;</span><br><span class="line">[a, ,b ] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;a = &#x27;</span>+ a + <span class="string">&#x27;,b = &#x27;</span>+ b);     <span class="comment">// 输出：a = 1,b = 3</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="解构对象">解构对象</h4>
<p>前面都是解构数组，对象由一对对键值组成，和解构数组自然有些不同。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对象解构赋值</span></span><br><span class="line"><span class="keyword">var</span> o =  &#123;<span class="attr">x</span>:<span class="string">&#x27;one&#x27;</span> , <span class="attr">y</span>:<span class="string">&#x27;two&#x27;</span>,<span class="attr">z</span>:<span class="string">&#x27;three&#x27;</span>,<span class="attr">a</span>:<span class="string">&#x27;four&#x27;</span>,<span class="attr">b</span>:<span class="string">&#x27;five&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> &#123;x,y,z,a,b&#125; = o;</span><br></pre></td></tr></table></figure>
<p>特别的，如果不是对一个已存在对象解构，而是进行无声明赋值，赋值语句有所不同：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这种无声明赋值，要求赋值语句周围有 (...)</span></span><br><span class="line"><span class="keyword">var</span> x,y,z;</span><br><span class="line">( &#123;x,y,...rest&#125; = &#123;<span class="attr">x</span>:<span class="string">&#x27;one&#x27;</span> , <span class="attr">y</span>:<span class="string">&#x27;two&#x27;</span>,<span class="number">3</span>:<span class="string">&#x27;three&#x27;</span>,<span class="number">4</span>:<span class="string">&#x27;four&#x27;</span>,<span class="number">5</span>:<span class="string">&#x27;five&#x27;</span>&#125; );</span><br><span class="line"><span class="built_in">console</span>.log(x);        <span class="comment">// 输出：one</span></span><br><span class="line"><span class="built_in">console</span>.log(rest);     <span class="comment">// 输出：&#123; &#x27;3&#x27;: &#x27;three&#x27;, &#x27;4&#x27;: &#x27;four&#x27;, &#x27;5&#x27;: &#x27;five&#x27; &#125;</span></span><br></pre></td></tr></table></figure>
<p>对象解构还有以下一些基本特点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o =  &#123;<span class="attr">x</span>:<span class="string">&#x27;one&#x27;</span> , <span class="attr">y</span>:<span class="string">&#x27;two&#x27;</span>,<span class="attr">z</span>:<span class="string">&#x27;three&#x27;</span>,<span class="attr">a</span>:<span class="string">&#x27;four&#x27;</span>,<span class="attr">b</span>:<span class="string">&#x27;five&#x27;</span>&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li>
<p>允许待赋值变量个数 ≠ 右侧变量数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.待赋值变量 &lt; 右侧，按对应键值赋值完毕,[顺序不影响]</span></span><br><span class="line"><span class="keyword">var</span> &#123;x,b,a&#125; = o;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;x=&#x27;</span>+x+<span class="string">&#x27;,y=&#x27;</span>+y+<span class="string">&#x27;,z =&#x27;</span>+z);  <span class="comment">// 输出：x=one ,a=four ,b=five</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>左右两侧键值要对应</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.左右两侧键值要对应</span></span><br><span class="line"><span class="keyword">var</span> &#123;x,Y,z,a,b&#125; = o;   <span class="comment">// 左侧Y和右侧键值y，不对应</span></span><br><span class="line"><span class="built_in">console</span>.log(Y);        <span class="comment">// 无法解构成功，输出：undefined</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>给新变量提供默认值和参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3.给新变量提供默认值和参数</span></span><br><span class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>:xx = <span class="number">10</span>, <span class="attr">y</span>:yy = <span class="number">5</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">3</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(xx); <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">console</span>.log(yy); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="解构嵌套对象和数组">解构嵌套对象和数组</h4>
<p>解构嵌套对象和数组，具有的基本特点和上面是一致的。主要不同在于：</p>
<p>解构嵌套对象要保证层次一致；解构嵌套数组，不仅要保证层次一致还要保证位置一致。</p>
<h5 id="嵌套数组">嵌套数组</h5>
<p>数组本身有嵌套，解构赋值要保证嵌套位置和层次一致。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.数组嵌套</span></span><br><span class="line"><span class="keyword">let</span> [x,[y,z]] = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>]];</span><br><span class="line"><span class="keyword">let</span> [[y,z],x] = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>]];   <span class="comment">// 出错位置不一致</span></span><br></pre></td></tr></table></figure>
<h5 id="嵌套对象">嵌套对象</h5>
<p>对一个对象进行解构赋值时，同样可以直接对嵌套的对象属性进行赋值，保证层次一致。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;hwh&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">23</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">address</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">city</span>: <span class="string">&#x27;FUZHOU&#x27;</span>,</span><br><span class="line">        <span class="attr">street</span>: <span class="string">&#x27;No.1 Road&#x27;</span>,</span><br><span class="line">        <span class="attr">zipcode</span>: <span class="string">&#x27;341000&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只需保证层次一致：赋值时按键值赋值，顺序位置可以调换</span></span><br><span class="line"><span class="keyword">var</span> &#123;name, <span class="attr">address</span>: &#123;city, zipcode&#125;&#125; = person;</span><br></pre></td></tr></table></figure>
<p>注意，<em>address</em> 并不是变量名，尝试输出会报错。它只是为了<em>city、zipcode</em>获取对象属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试输出</span></span><br><span class="line"> <span class="built_in">console</span>.log(address); <span class="comment">// 报错，address不是变量</span></span><br><span class="line"> <span class="built_in">console</span>.log(person.address); <span class="comment">// 输出： &#123; city: &#x27;FUZHOU&#x27;, street: &#x27;No.1 Road&#x27;, zipcode: &#x27;341000&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出：name:hwh,city:FUZHOU ,zipcode:341000</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;name:&#x27;</span>+name+<span class="string">&#x27;,city:&#x27;</span>+ city,<span class="string">&#x27;,zipcode:&#x27;</span>+ zipcode);</span><br></pre></td></tr></table></figure>
<h4 id="使用场景">使用场景</h4>
<ol>
<li>
<p>交换两个变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.交换变量x y</span></span><br><span class="line"><span class="keyword">var</span> x=<span class="number">1</span>, y=<span class="number">2</span>;</span><br><span class="line">[x, y] = [y, x]</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>快速获取页面域名 &amp; 路径</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.快速获取页面域名和路径</span></span><br><span class="line"><span class="keyword">var</span> &#123;<span class="attr">hostname</span>:domain, <span class="attr">pathname</span>:path&#125; = location;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>减化函数参数定义</p>
<p>如下面可以方便快速创建一个对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myDate</span>(<span class="params">&#123;year, mon, day, hour=<span class="number">0</span>, min=<span class="number">0</span>, sec=<span class="number">0</span>&#125;</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>(year + <span class="string">&#x27;-&#x27;</span> + month + <span class="string">&#x27;-&#x27;</span> + day + <span class="string">&#x27; &#x27;</span> + hour + <span class="string">&#x27;:&#x27;</span> + minute + <span class="string">&#x27;:&#x27;</span> + second);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上面函数接收一个对象作为参数，而不是去定义6个参数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myDate</span>(<span class="params">year,mon,day,hour=<span class="number">0</span>,min=<span class="number">0</span>,sec=<span class="number">0</span></span>) </span></span><br></pre></td></tr></table></figure>
<p>在调用函数的时候，根据解析构值，<u>形参对象给实参对象赋值</u> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myDate(&#123;<span class="number">2019</span>,<span class="number">07</span>,<span class="number">19</span>&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="2-3-方法与this大坑">2.3 方法与<em>this</em>大坑</h2>
<p>在一个对象中绑定函数，称为这个对象的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法</span></span><br><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());   <span class="comment">// 输出：23</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age);     <span class="comment">// 输出：[Function: age]</span></span><br></pre></td></tr></table></figure>
<p>我们知道，<em>this</em> 关键字是用来指向当前对象。在<em>JavaScript</em> 没有类这个概念，<em>this</em> 在上述代码指向的是 <em>hwh</em> 这个对象。<em>this.birth</em> 因此可以拿到 <em>hwh</em> 的 <em>birth</em> 属性。</p>
<p>在这里，我们也看到 <em>JavaScript</em> 中 <em>this</em> 关键字和常用高级语言第一个不同点：</p>
<ul>
<li>即使是在对象内部，调用对象属性也要 <em>this.属性名</em> 进行调用，否则会出错。</li>
</ul>
<p>但是，由于<em>js</em>本身设计缺陷，<u><em>this</em> 在函数内部不一定指向当前对象，也可能指向全局对象 <em>window</em></u>  。</p>
<h3 id="1-小心使用你的-this">1. 小心使用你的 <em>this</em></h3>
<h4 id="新变量指向方法">新变量指向方法</h4>
<p>如果你尝试用一个新变量 <em>my_age</em> 指向函数内部方法 <em>age()</em> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新变量指向对象方法</span></span><br><span class="line"><span class="keyword">var</span> my_age = hwh.age;</span><br><span class="line"><span class="built_in">console</span>.log(my_age());    <span class="comment">// 输出： NaN</span></span><br></pre></td></tr></table></figure>
<p>why？？为什么突然报错？</p>
<p>这是因为，以 <u>对象名.方法名()</u> 调用 <em>this</em> 指向当前对象 ；但是 <u>单独调用函数</u> ，<em>this</em> 指向全局对象 <em>window</em> ！</p>
<h4 id="多层函数内部用-this">多层函数内部用 <em>this</em></h4>
<p>喜欢重构的你，又闲得蛋疼，突发奇想，在<em>age</em>方法内部再定义一个函数来返回值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">            <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getAge();    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());   <span class="comment">// 输出：NaN</span></span><br></pre></td></tr></table></figure>
<p>又出错了！虽然 <em>this</em> 关键字在 <u>对象<em>age</em>方法内部</u> 指向当前对象，但在 <u><em>age</em>方法内函数内</u> 指向全局对象 <em>window</em> ！</p>
<p>聪明的你也许会想，既然在 <em>age</em>方法内部还是指向当前对象，那我可以捕获此时<em>this</em> ，再在方法内部函数使用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 捕获this</span></span><br><span class="line">        <span class="keyword">var</span> that = <span class="built_in">this</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">            <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getAge();    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());   <span class="comment">// 输出：23</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>更优雅解决<em>this</em> 错误指向：改写为箭头函数，详见：<em><u>2.6 箭头函数</u></em> 。</p>
</blockquote>
<h4 id="提醒不要犯错：strict-模式">提醒不要犯错：<em>strict</em> 模式</h4>
<p>上述两种情况，还可以在 <em>strict</em> 模式下让函数的<em>this</em> 指向 <em>undefined</em> ，而不是<em>window</em> ，这样编译器会抛出错误。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 上面函数写法...</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh1.age());  <span class="comment">//抛出错误： Cannot read property &#x27;birth&#x27; of undefined</span></span><br></pre></td></tr></table></figure>
<h3 id="2-apply-方法">2. <em>apply</em> 方法</h3>
<p>在前面，我们可以用 <em>strict</em> 模式，使得<em>this</em> 指向 <em>undefined</em> 让编译器提醒我们不要让 <em>this</em> 错误指向。</p>
<p>但是，可以控制 <em>this</em> 正确指向我们所期望的吗？ 每个函数本身拥有的<em>apply()</em> 方法，可以做到这点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">    <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123; </span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:getAge</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 让getAge() 中this从指向 undefined (严格模式下不是window） --&gt; hwh</span></span><br><span class="line"><span class="comment">// 参数1：表示方法要指向的对象</span></span><br><span class="line"><span class="comment">// 参数2：表示方法需要的参数，用数组封装好。这里[]表示为空</span></span><br><span class="line"></span><br><span class="line">getAge.apply(hwh,[]);    </span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());  <span class="comment">// 输出23</span></span><br></pre></td></tr></table></figure>
<h4 id="call-方法"><em>call</em> 方法</h4>
<p><em>call</em> 方法和 <em>apply</em> 方法很类似，能达到相同效果，它们唯一区别是传递参数不同。</p>
<p>比如，调用 <code>Math.max(3, 5, 4)</code>，分别用 <em>apply()</em> 和 <em>call()</em> 实现如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>]); <span class="comment">// 5</span></span><br><span class="line"><span class="built_in">Math</span>.max.call(<span class="literal">null</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<p>可以看到，<em>apply()</em> 需要把参数封装好 <em>Araay</em> 数组再传入 ； <em>call()</em> 则需逐个传入参数。</p>
<h4 id="新的问题">新的问题</h4>
<p>在 <u>新变量指向方法</u> 小节中，我们尝试用 <em>apply</em> 来改变新变量函数指向：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;   </span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">        <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新变量指向对象方法</span></span><br><span class="line"><span class="keyword">var</span> my_age = hwh.age;</span><br><span class="line">my_age.apply(hwh,[]);    <span class="comment">// 改变this指向不成功？</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(my_age());    <span class="comment">// 输出： NaN</span></span><br></pre></td></tr></table></figure>
<p>却发现，<em>my_age</em> 方法指向并没有被改变，还是输出 <em>NaN</em> ?</p>
<blockquote>
<p>之所以不尝试，<u>多层函数内部用 <em>this</em></u> 一节用<em>apply</em> 改变，是因为无法取里层函数名。而直接尝试在里层函数里使用函数名，那就变成递归了！</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment">// 只能在这里可以取到getAge函数名，可是变成了递归</span></span><br><span class="line">            <span class="comment">// getAge.apply(hwh,[]);   // 报错：无限递归</span></span><br><span class="line">            <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">            <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getAge();    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="装饰器">装饰器</h4>
<p>利用 <em>apply()</em>，我们还可以动态改变函数的行为。</p>
<p><em>JavaScript</em> 的所有对象都是动态的，即使内置的函数，我们也可以重新指向新的函数。（ <u>覆写？？</u>）</p>
<blockquote>
<p>增加统计调用多少次方法 <em>parseInt()</em> ，在不改变原有功能基础上。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 装饰器 </span></span><br><span class="line"><span class="comment">// 下面代码在 VSCode + codeRunner报错：window is not defined</span></span><br><span class="line"><span class="comment">// 在浏览器中控制台可正常输出</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> count = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> oldParseInt = <span class="built_in">parseInt</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.parseInt = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     count++;</span><br><span class="line">     <span class="keyword">return</span> oldParseInt.apply(<span class="literal">null</span>,<span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">&#x27;10&#x27;</span>); <span class="built_in">parseInt</span>(<span class="string">&#x27;10&#x27;</span>); <span class="built_in">parseInt</span>(<span class="string">&#x27;10&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(count);    <span class="comment">// 输出：3</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>但是下面方法也能调用原函数，无法说明装饰器作用？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.parseInt = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     count++;     </span><br><span class="line"><span class="comment">//   return oldParseInt(null,arguments);     // 报错：parseInt是函数变量，这里返回的是函数值</span></span><br><span class="line">     <span class="keyword">return</span> oldParseInt;                     <span class="comment">// 成功输出 ：函数之间的赋值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-4-高阶函数">2.4 高阶函数</h2>
<p>在 <em>JavaScript</em> 中 ，变量可以指向函数，函数参数能接收变量，那么自然可以把 <u>函数当做另一个函数参数传递</u> 。</p>
<blockquote>
<p>高阶函数，简单来说就是把函数当参数，类似于C/C++中函数指针和C#中委托。</p>
</blockquote>
<p>下面是四个基本四则运算函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 除</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">div</span>(<span class="params">a,b</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a/b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 乘、减..</span></span><br></pre></td></tr></table></figure>
<p>我们可以把它们当做参数，实现一个函数就可以计算四种不同运算：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfuc</span>(<span class="params">a,b,f</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> f(a,b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result = myfuc(<span class="number">1</span>,<span class="number">3</span>,div);   <span class="comment">// 0.3333333..</span></span><br></pre></td></tr></table></figure>
<h3 id="映射：map-reduce">映射：<em>map / reduce</em></h3>
<h4 id="map"><em>map()</em></h4>
<p>这里的<em>map()</em> 和前面集合<em>map</em> 不同，它是一个方法，表现对数组每个元素进行某种映射关系。</p>
<p>假设存在一个数组：<em>arr</em> = [<em>x1</em>,<em>x2</em>,<em>x3</em>…]  ，和<u>回调函数</u> <em>f(x)</em>。</p>
<blockquote>
<p><em>arr.map()</em> 把函数 <em>f(x)</em> 作为参数 ，会返回一个新数组 [<em>f(x1)</em>, <em>f(x2)</em>, <em>f(x3)</em> …]</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x*x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newArr = arr.map(pow);</span><br><span class="line"><span class="built_in">console</span>.log(newArr);    <span class="comment">// 输出：[ 1, 4, 9, 16, 25 ]</span></span><br></pre></td></tr></table></figure>
<p>❔ 数组的元素会自动作为回调函数<em>f(x)</em> 第一个形参的实参进行赋值，如果<em>f(x)</em> 没有参数呢？或者不止一个参数呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果没有参数，每一次pow函数返回值 1 作为新数组元素</span></span><br><span class="line"><span class="keyword">var</span> newArr = arr.map(pow);</span><br><span class="line"><span class="built_in">console</span>.log(newArr);    <span class="comment">// 输出：[ 1, 1, 1, 1, 1 ]</span></span><br></pre></td></tr></table></figure>
<p>事实上回调函数 <em>f(x)</em> 有三个参数，通常我们只使用第一个参数，表示 <em>Array</em> 某个元素：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newArr = arr.map</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">element,index,self</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(element);   <span class="comment">// 依次打印: 1,2,3,4,5</span></span><br><span class="line">        <span class="built_in">console</span>.log(index);     <span class="comment">// 依次打印: 0,1,2,3,4</span></span><br><span class="line">        <span class="built_in">console</span>.log(self);      <span class="comment">// self就是变量arr,每次都打印arr:[ 1, 2, 3, 4, 5 ]</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> element*element;                       </span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr);    <span class="comment">// 输出：[ 1, 4, 9, 16, 25 ]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>试分析：把<em>parseInt</em>函数作为参数，为什么得到意料之外的结果？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> newArr = arr.map(<span class="built_in">parseInt</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(newArr);    <span class="comment">// 输出：[ 1, NaN, NaN, NaN, NaN ]</span></span><br></pre></td></tr></table></figure>
<p>🙂 查看MDN文档：<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/map"><em>MDN-Array.map()</em></a></p>
<h4 id="reduce"><em>reduce()</em></h4>
<p><em>reduce()</em> 和 <em>map()</em> 类似：传入的参数函数<strong>f</strong> 循环每次对数组前两个元素运算，运算结果r作为数组首元素插入头部。</p>
<p>假设存在一个数组：<em>arr</em> = [<em>x1</em>,<em>x2</em>,<em>x3</em>,<em>x4</em>…]  ，和某个函数 <em>f(x,y)</em>。</p>
<blockquote>
<p><em>arr.map()</em> 把函数 <em>f(x,y)</em> 作为参数 ，会返回一个值：<em>f(f(x1,x2),x3)</em></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// reduce</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x1,x2</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x1+x2;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = arr2.reduce(sum);</span><br><span class="line"><span class="built_in">console</span>.log(s);    <span class="comment">// 输出：15</span></span><br></pre></td></tr></table></figure>
<p>当然无论是 <em>map / reduce</em> 传递参数都可以用 <em>lambada</em> 表达式进行简化：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = arr2.reduce(<span class="function">(<span class="params">x1,x2</span>) =&gt;</span> x1+x2);</span><br><span class="line"><span class="built_in">console</span>.log(s);    <span class="comment">// 输出：15</span></span><br></pre></td></tr></table></figure>
<h3 id="自定规则：filter-sort-…">自定规则：<em>filter / sort …</em></h3>
<p>下列高级函数都有以下特点：</p>
<ul>
<li>根据传递的回调函数 <u>自定义某种判断规则</u></li>
<li>对数组每个元素进行判断，根据返回结果 <em>ture / false</em> 决定对元素进行不同操作</li>
</ul>
<h4 id="filter"><em>filter()</em></h4>
<p><em>filter</em>也是常用高级函数，它用于把<em>Array</em> 某些元素过滤掉，然后返回剩下的元素。</p>
<p>具体过程：*filter()*把传入的回调函数依次作用于每个元素 ，回调函数返回值为 <em>ture</em> 则该元素保留，否则删除。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr1 = arr.filter</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x % <span class="number">2</span> == <span class="number">0</span>; <span class="comment">// 只返回偶数</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr1);  <span class="comment">// 输出：[ 2, 4 ]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>给定数组<em>Array</em> ，去除里面重复的元素。（没看太明白）</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span>  r,</span><br><span class="line">     arr = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;strawberry&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"></span><br><span class="line">r = arr.filter</span><br><span class="line">(</span><br><span class="line">    <span class="comment">// 数组当前元素、数组当前元素索引、数组本身分别作为回调函数3形参的实参值</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">element, index, self</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> self.indexOf(element) === index;  <span class="comment">// 这里没太明白</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(r.toString());   <span class="comment">// 输出：apple,strawberry,banana,pear,orange</span></span><br></pre></td></tr></table></figure>
<h4 id="sort"><em>sort()</em></h4>
<p><em>JavaScript</em> 中的 <em>sort()</em> 高级排序函数，<u>无传递回调函数情况下</u>，排序的操作顺序如下：</p>
<ol>
<li>先将数组的所有元素转换成 <em>String</em> 字符串</li>
<li><em>sort()</em> 根据每个字符串  <u>首字符 <em>ASCII</em>值</u>  来从小到大排序</li>
</ol>
<p>所以看起来会有下面&quot;奇怪&quot;结果：10 排在 2 前面</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>].sort(); <span class="comment">// [1, 10, 2, 20]</span></span><br></pre></td></tr></table></figure>
<p>这是因为数组元素先转换成 <em>String</em> 类型，按 <u>首字符 <em>ASCII</em>值</u> 排序规则： ‘1’ &gt; ‘2’  ==&gt; ‘10’ &gt; ‘2’。</p>
<h5 id="定义自己的排序规则">定义自己的排序规则</h5>
<p>我们来定义数字从小到大排序规则回调函数，使得能正常输出我们期望的数字排序结果。</p>
<blockquote>
<p>排序规则：类比冒泡排序，判断两个元素大小，决定是否交换位置？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">arr1 = arr.sort</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;y)   <span class="keyword">return</span>  <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr1);  <span class="comment">// 输出：[ 1, 2, 10, 20 ]</span></span><br></pre></td></tr></table></figure>
<p>对应，冒泡排序写法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cmp</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;y)   <span class="keyword">return</span>  <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span>      <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length ; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(j = arr.length -<span class="number">1</span> ; j -i &gt; <span class="number">0</span>; j--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// cmp作为排序规则，决定是否交换两个元素</span></span><br><span class="line">        <span class="keyword">if</span>(cmp(s[j],s[j-<span class="number">1</span>]) == -<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = s[j];   </span><br><span class="line">            s[j] = s[j-<span class="number">1</span>];   </span><br><span class="line">            s[j-<span class="number">1</span>] = temp; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(s[i]);    <span class="comment">// 依次输出：1  2  10  20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果，要求从小到大输出呢？</p>
</blockquote>
<p>重新定义下 <u>何为大</u> 即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">arr1 = arr.sort</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&gt;y)   <span class="keyword">return</span> -<span class="number">1</span>;    <span class="comment">// 改成返回 -1</span></span><br><span class="line">        <span class="keyword">else</span>      <span class="keyword">return</span> <span class="number">1</span>;     <span class="comment">// 改成返回  1</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr1);  <span class="comment">// 输出：[ 20, 10, 2, 1 ]</span></span><br></pre></td></tr></table></figure>
<p>同理，对应冒泡排序改换<em>cmp</em>排序规则（交换<em>if / else</em>返回值）。已测试成功输出，这里不再赘述。</p>
<h4 id="every"><em>every()</em></h4>
<p><em>every()</em> 自定<u>回调函数</u>判断规则，对所有数组元素进行判断，如果回调函数<u>都</u> 返回<em>ture</em> ，说明所有元素都满足判断条件，那么*<u>every()</u>* 返回 <em>ture</em>，否则返回<em>false</em> 。</p>
<blockquote>
<p>给定一个包含指定字符串数组，判断字符串是否满足指定测试条件。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> b = arr.every</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">s</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> s.length &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">); </span><br><span class="line"><span class="built_in">console</span>.log(b);<span class="comment">// true, 因为每个元素都满足 s.length&gt;0</span></span><br></pre></td></tr></table></figure>
<h4 id="find"><em>find()</em></h4>
<p>同上自定 <u>回调函数</u>判断规则，对所有元素进行判断。如果回调函数返回 <em>ture</em> ，则找到第一个元素， <u><em>find()</em></u> 返回该元素；如果所有元素都遍历完毕，没有返回 <em>ture</em> ，则说明未找到元素，<em>find()</em> 返回 <em>undefined</em>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> tmp = arr.find</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">s</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        s.toLowerCase() === s;  <span class="comment">// 找到第一个全是小写字母的字符串</span></span><br><span class="line">    &#125;</span><br><span class="line">); </span><br><span class="line"><span class="built_in">console</span>.log(tmp);<span class="comment">// 输出：pear</span></span><br></pre></td></tr></table></figure>
<h4 id="findIndex"><em>findIndex()</em></h4>
<p>和 <em>find()</em> 类型，不同在于 <em>findIndex()</em> 找到元素返回该索引而非返回元素；如果没找到元素则返回 -1。</p>
<h3 id="特别：forEach">特别：<em>forEach()</em></h3>
<p>同前 <em>forEach</em>  循环，它可用来遍历 <u>数组</u>、<u>集合</u> 。只单纯传递数组元素等信息，具体对数组元素等进行什么操作由传递的回调函数决定。</p>
<blockquote>
<p>利用<em>forEach()</em> 尝试遍历一个数组。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line">arr.forEach(<span class="built_in">console</span>.log);</span><br></pre></td></tr></table></figure>
<p>由于回调函数默认有三个参数：<em>element、index、self</em> ，<em>console.log</em> 接收这三个实参依次打印它们信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Apple 0 [ &#x27;Apple&#x27;, &#x27;pear&#x27;, &#x27;orange&#x27; ]</span><br><span class="line">pear 1 [ &#x27;Apple&#x27;, &#x27;pear&#x27;, &#x27;orange&#x27; ]</span><br><span class="line">orange 2 [ &#x27;Apple&#x27;, &#x27;pear&#x27;, &#x27;orange&#x27; ]</span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>forEach()</em> 遍历一个数组，只打印出数组元素。</p>
</blockquote>
<p>我们可以重写 <em>console.log</em> 方法，让它只接收一个参数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&#x27;Apple&#x27;</span>, <span class="string">&#x27;pear&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> old_console_log = <span class="built_in">console</span>.log;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log = <span class="function"><span class="keyword">function</span>(<span class="params">element</span>) // 重写</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    old_console_log(element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr.forEach(<span class="built_in">console</span>.log);    <span class="comment">// 依次输出：Apple   pear    orange</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>forEach()</em> 还可以遍历集合，如 <em>Set</em>、<em>Map</em> 等。注：不能遍历对象！遍历对象直接<em>for</em> 循环就行。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr2 = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]); </span><br><span class="line">arr2.forEach</span><br><span class="line">(</span><br><span class="line">    <span class="built_in">console</span>.log    <span class="comment">// 依次输出：1  2  3</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h2 id="2-5-闭包">2.5 闭包</h2>
<h4 id="什么是闭包？">什么是闭包？</h4>
<p>前面我们了解到，函数可以作为 <u>参数</u>，那么函数自然也可作为 <u>返回值</u>。</p>
<p>闭包，简单来说就是携带状态的函数，其返回值是一个也是函数，而且它的状态可以完全对外隐藏起来。</p>
<p>它的作用有：</p>
<ul>
<li>可创建函数工厂、减少函数参数</li>
<li>实现携带状态的闭包，获取函数内部局部变量且变量一直在内存中</li>
</ul>
<h4 id="函数工厂">函数工厂</h4>
<blockquote>
<p>计算指定 <em>x</em> 值的 2次方 / 3次方。</p>
</blockquote>
<p>也许聪明的你，很快想到利用系统自带 <em>API</em> 计算<em>x</em> 次方：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">5</span>;   <span class="comment">// x值任意</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Math</span>.pow(x,<span class="number">2</span>);   <span class="comment">// 25</span></span><br><span class="line"><span class="built_in">Math</span>.pow(x,<span class="number">3</span>);   <span class="comment">// 125</span></span><br></pre></td></tr></table></figure>
<p>但是，如果计算指定 <em>x</em> 值的 2次方 / 3次方是 <u>常用</u> 的，你觉得没必要每次都指定参数 <u>幂次</u> ，干脆直接自定义 <em>pow2 / pow3</em> 函数，只接收参数 <u>x</u> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow2</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(x,<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pow3</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(x,<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pow2(<span class="number">5</span>);</span><br><span class="line">pow3(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>
<p>但是，如果计算 <em>x</em> 值的 4次方 / 5次方也 <u>常用</u>  ，定义4个函数显然不太简洁。</p>
<p>这里，可以用闭包创建一个函数工厂，返回同类我们需要的函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creat_pow</span>(<span class="params">n</span>)    // 创建<span class="title">pow</span>函数工程，参数为指定幂次</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)   // 返回函数，参数为变量<span class="title">x</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Math</span>.pow(x,n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pow2 = creat_pow(<span class="number">2</span>);   <span class="comment">// 注意这里参数是：幂次，返回计算指定幂次函数</span></span><br><span class="line"><span class="keyword">var</span> pow3 = creat_pow(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">pow2(<span class="number">5</span>);   <span class="comment">// 25        注意这里参数是：变量x，即闭包里隐藏的局部变量x，计算它的指定幂次</span></span><br><span class="line">pow3(<span class="number">5</span>);   <span class="comment">// 125</span></span><br></pre></td></tr></table></figure>
<p>在这里我们还可以看到，闭包函数<em>pow</em> 隐藏一个状态：变量<em>x</em> ，即<em>pow</em> 内部返回的匿名函数局部变量参数<em>x</em> 。从而把一个多参数函数，变为单参数函数。</p>
<blockquote>
<p>又有，利用闭包快速生成不同类似函数，给Web进行事件绑定。</p>
</blockquote>
<p>参照：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjvae/p/9786598.html">闭包的应用 – 应用于web开发</a></p>
<h4 id="更深入理解-“闭包”">更深入理解 “闭包”</h4>
<p>难道闭包只是为了返回函数进而创建函数工厂 OR 减少函数参数吗？怎么理解闭包是携带状态的函数？请看下例：</p>
<p>我们知道，函数内部的局部变量，在函数退出后便自动消亡：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creat_counter</span>(<span class="params">initial</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> n = initial;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> n++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = creat_counter(<span class="number">0</span>);  <span class="comment">// 返回的是函数，故带上()是为了执行然后返回函数</span></span><br><span class="line"><span class="built_in">console</span>.log(c());    <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">console</span>.log(c());    <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(c());    <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<p>非常奇怪的是，为什么这里的局部变量 <em>n</em> 实现了递增呢？变量<em>n</em> 不是应该在执行：<code>var c = creat_counter(0);</code> 后就已经消亡了吗？</p>
<p>其实：在返回的函数中，<u>实现了一个闭包环境，该闭包携带了外部无法访问的局部变量x</u> 。</p>
<p>这是由于 <em>creat_counter</em> 是内部匿名子函数的父函数，而<em>creat_counter</em> 被赋值给全局变量 <em>c</em>，因此其内部变量<em>n</em> 、匿名子函数都在内存中，没有被垃圾回收机制回收。</p>
<p>这样父函数内部，子函数外部的局部变量<em>n</em>，在 <em>JavaScript</em> 类似类的私有变量。我们还可以返回一个对象，看起来更像是 <u>类对象调用方法</u>。</p>
<blockquote>
<p>实现类似<em>class</em>机制封装私有变量的一个简单计数器。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creat_counter</span>(<span class="params">initial</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> n = initial;     <span class="comment">// 看起来就是一个私有变量，外部无法访问</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">increase</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> n++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回一个对象，里面有inc属性，这样调用起来像是对象调用方法。</span></span><br><span class="line">    <span class="comment">// 注意 inc:f2() 错误，带()是执行函数</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">inc</span>:increase&#125;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = creat_counter(<span class="number">0</span>);  <span class="comment">// 返回的是对象，带上()是为了执行函数后返回对象</span></span><br><span class="line"><span class="comment">// 看起来像是对象调用方法</span></span><br><span class="line">c.inc();   <span class="comment">// 1</span></span><br><span class="line">c.inc();   <span class="comment">// 2</span></span><br><span class="line">c.inc();   <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>
<h4 id="小心！返回函数不立即执行">小心！返回函数不立即执行</h4>
<p>我们需要注意一个问题，闭包返回的 <u>函数fun</u> 并不会立即执行，而是直到调用 <u>函数fun()</u> 才会执行。</p>
<p>这样，在我们返回函数引用任何后续会发生的变量都会产生意料之外结果，比如循环变量：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="keyword">var</span> arr = [];   <span class="comment">// 定义一个数组，用于压入三个函数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++)   <span class="comment">// 循环压入一个匿名函数计算当前i^2：用箭头函数简写     </span></span><br><span class="line">        arr.push( <span class="function">() =&gt;</span> &#123; <span class="keyword">return</span> i * i &#125;);</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> results = count();</span><br><span class="line"><span class="keyword">var</span> f1 = results[<span class="number">0</span>]; <span class="keyword">var</span> f2 = results[<span class="number">1</span>];  <span class="keyword">var</span> f3 = results[<span class="number">2</span>];</span><br></pre></td></tr></table></figure>
<p>当我们尝试执行 <em>f1()</em>、 <em>f2()</em>、 <em>f3()</em> 会发现一个出人意料的结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f1(); // 16</span><br><span class="line">f2(); // 16</span><br><span class="line">f3(); // 16</span><br></pre></td></tr></table></figure>
<p>全都是16！这是因为，由于变量提升，循环局部变量 <strong>i</strong> 已经是函数内部全局变量了。</p>
<p>同时，<em>arr.push()</em> 压入函数时，函数并未立即执行。等到 <em>return  arr</em> 时，此时引用的变量<strong>i</strong> 已经执行完<strong>3</strong>次循环后变为 <strong>4</strong> 了。</p>
<p>我们有两种解决办法：</p>
<ol>
<li>
<p>循环内部变量用 <em>let</em> 关键字声明，这样等到 <em>return  arr</em> 时，函数引用的变量是对应循环次数局部变量 <strong>i</strong> 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++)   <span class="comment">// let</span></span><br><span class="line">        arr.push( <span class="function">() =&gt;</span> &#123; <span class="keyword">return</span> i * i &#125;);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>再创建一个函数 <u>立即执行</u>，用该函数的参数绑定循环变量当前的值，参照：<a target="_blank" rel="noopener" href="https://www.liaoxuefeng.com/wiki/1022910821149312/1023021250770016">廖雪峰教程–闭包</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) </span><br><span class="line">    arr.push(</span><br><span class="line">        (</span><br><span class="line">            <span class="function"><span class="keyword">function</span> (<span class="params">n</span>)</span></span><br><span class="line"><span class="function">            </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> n * n;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        )(i)   <span class="comment">// 当前i赋值给函数形参n立即执行</span></span><br><span class="line">            );</span><br></pre></td></tr></table></figure>
<p>为什么直接压入匿名函数，而是要内部再返回一个函数，否则会报错？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    <span class="keyword">var</span> arr = [];   <span class="comment">// 定义一个数组，用于压入三个函数   </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">1</span>; i&lt;=<span class="number">3</span>; i++) </span><br><span class="line">        arr.push(</span><br><span class="line">            (</span><br><span class="line">                <span class="function"><span class="keyword">function</span> (<span class="params">n</span>)</span></span><br><span class="line"><span class="function">                </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> n * n;   <span class="comment">// 直接返回出错？？</span></span><br><span class="line">                &#125;</span><br><span class="line">            )(i)</span><br><span class="line">                );</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> results = count();</span><br><span class="line"><span class="keyword">var</span> f1 = results[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(f1());  <span class="comment">// 报错： f1 is not a function</span></span><br></pre></td></tr></table></figure>
<p>这是因为表面看<em>arr.push()</em> 压入的是一个函数，但由于立即执行，实际上压入的是函数返回值！所以才必须设计压入函数返回值是一个函数。</p>
</li>
</ol>
<h2 id="2-6-箭头函数">2.6 箭头函数</h2>
<p>箭头函数和 <em>Lambda</em> 表达式都用于简写匿名函数，其语法也基本相同：<code>(parameters) =&gt; &#123; statements; &#125;</code>。</p>
<p>同时在满足一定条件下，还可以进一步简写：</p>
<ul>
<li><em>参数类型可选</em> ：不需要声明参数类型，编译器可以统一识别参数值；</li>
<li><em>只有一个参数</em> ： 参数 ()可选</li>
<li><em>主体{}只有一条语句</em> ：此时 <em>return</em> 关键字 &amp; {} ，可不写。注意 ！
<ul>
<li>主体{} 不省略时，哪怕只有一条语句，函数有返回值<em>return</em>关键字不可省！</li>
<li>主体{} 省略时，<em>return</em> 也必须省略！</li>
</ul>
</li>
</ul>
<blockquote>
<p>利用箭头函数，实现给指定数组排序。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">10</span>, <span class="number">20</span>, <span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="comment">// arr.sort( (x, y) =&gt; x &gt; y ? 1: -1;);  // 错误：函数作为参数不要加分号！</span></span><br><span class="line">arr.sort( <span class="function">(<span class="params">x, y</span>) =&gt;</span> x &gt; y ? <span class="number">1</span>: -<span class="number">1</span> );</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">// [1, 2, 10, 20]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>⚠️ 试着指出下列箭头函数为什么不对？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.sort( <span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123;  x &gt; y ? <span class="number">1</span>: -<span class="number">1</span>; &#125;);    <span class="comment">// 错误写法</span></span><br></pre></td></tr></table></figure>
<p>主体{}只有一条语句，不省略{}时，语句要有分号 &amp; <em>return</em>不可省！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.sort( <span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123; <span class="keyword">return</span> x &gt; y ? <span class="number">1</span>: -<span class="number">1</span>; &#125;);  <span class="comment">// 正确写法</span></span><br></pre></td></tr></table></figure>
<h4 id="优雅的解决-this-错误指向">优雅的解决 <em>this</em> 错误指向</h4>
<p>在前面，我们提到 <em>JavaScript</em> 一个设计错误，在嵌套函数内部 <em>this</em> 会指向全局对象<em>window</em> (严格模式下指向 <em>undefined</em>) 而非调用函数的对象！为此我们提出一种解决办法：在嵌套函数里捕获<em>this</em>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 捕获this，此时this不在嵌套函数内部还是指向调用对象</span></span><br><span class="line">        <span class="keyword">var</span> that = <span class="built_in">this</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">getAge</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> nowYear = <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear();</span><br><span class="line">            <span class="keyword">return</span> nowYear - <span class="built_in">this</span>.birth;    <span class="comment">// 调用对象里属性，不用this会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> getAge();    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());   <span class="comment">// 输出：23</span></span><br></pre></td></tr></table></figure>
<p>现在我们可以箭头函数更加优雅的解决<em>this</em> 指向错误问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 无需捕获this，此时this也能正确指向调用方法的对象</span></span><br><span class="line">        <span class="keyword">var</span> getAge = <span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="built_in">this</span>.birth;  </span><br><span class="line">        <span class="keyword">return</span> getAge();   <span class="comment">// 注意：返回不是函数，而是调用后函数值 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());   <span class="comment">// 输出：23</span></span><br></pre></td></tr></table></figure>
<p>我的理解是，此时已经不是在嵌套函数内部调用<em>this</em> ，而在外层函数内调用<em>this</em>，不会出现<em>this</em> 错误指向问题。</p>
<p>因为在外层函数使用<em>this</em> 是可以自动绑定到当前调用函数的对象，但直接在对象内部调用<em>this</em> 还是会出错。</p>
<blockquote>
<p>试分析：为什么对象内部直接<em>this</em> 调用属性出错。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">my_birth</span>: <span class="built_in">this</span>.birth,</span><br><span class="line">    <span class="attr">age</span>:<span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="built_in">this</span>.birth</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.my_birth);  <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());     <span class="comment">// NaN</span></span><br></pre></td></tr></table></figure>
<p>比如调用 <em>hwh.my_birth</em> 相当于以下过程：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hwh = <span class="keyword">new</span> hwh();            </span><br><span class="line">hwh.my_birth = <span class="built_in">this</span>.birth;   <span class="comment">// 此时this指向了全局对象！</span></span><br></pre></td></tr></table></figure>
<p><em>hwh.age()</em> 调用错误同理。那么如何解决这个问题？</p>
<p>目前除了<em>apply、call</em> 改变 <em>this</em> 指向（没试过），可声明一个函数在里面<em>this</em> 调用可以绑定到正确对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">my_birth</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="keyword">return</span> <span class="built_in">this</span>.birth; &#125;,</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="built_in">this</span>.birth;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(hwh.my_birth);  <span class="comment">// 1996</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh.age());     <span class="comment">// 23</span></span><br></pre></td></tr></table></figure>
<h2 id="2-7-generator">2.7 <em>generator</em></h2>
<p><em>generator</em> 即生成器，是<em>ES6</em> 新引入数据类型，看上去像一个函数，但可以返回多次。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">f</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> x + <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myGenerator =  f(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">var</span> x1 = myGenerator.next();   <span class="built_in">console</span>.log(x1);  <span class="comment">// 输出：&#123; value: 1, done: false &#125;</span></span><br><span class="line"><span class="keyword">var</span> x2 = myGenerator.next();   <span class="built_in">console</span>.log(x2);  <span class="comment">// 输出：&#123; value: 2, done: false &#125;</span></span><br><span class="line"><span class="keyword">var</span> x3 = myGenerator.next();   <span class="built_in">console</span>.log(x3);  <span class="comment">// 输出：&#123; value: 3, done: false &#125;</span></span><br><span class="line"><span class="keyword">var</span> x4 = myGenerator.next();   <span class="built_in">console</span>.log(x4);  <span class="comment">// 输出：&#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure>
<p>它多个返回值可以 <u>记录函数不同时刻的执行状态</u>，从语法上看和函数有以下几个区别：</p>
<ul>
<li>基本定义：函数是<em>function f(x)</em> ，而生成器要多出一个<code>*</code> ，<em>function* f(x)</em></li>
<li>返回值：<em>generator</em> 生成器可以有多个返回值，记录函数不同时刻状态</li>
<li>使用：直接调用 <em>generator</em> 不是返回值，而是返回 <u>一个生成器对象</u> ，可调用它的 <em>next()</em> 函数来输出返回值。
<ul>
<li>生成器不同返回值以对象形式保存：<u>{<em>value</em> : 当前返回值，<em>done</em>: 判断是否已经输出完毕}</u></li>
</ul>
</li>
</ul>
<p>我们还可以更简洁用 <em>for…of</em> 循环来遍历<em>generator</em> 输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下面在浏览器里如是输出：如果直接在VSCode打印，还会在第一行输出：</span></span><br><span class="line"><span class="comment">// Object [Generator] &#123;&#125;</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> x <span class="keyword">of</span> myGenerator)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);  <span class="comment">// 依次输出：1  2  3</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么，<em>generator</em> 这种可以返回多个值，记录不同时刻执行状态的&quot;函数&quot;有什么作用呢？请看下例：</p>
<blockquote>
<p>试着编写一个以 <code>0、1</code> 开头的斐波那契数列：0 1 1 2 3 5 8 13 21 34 …</p>
</blockquote>
<p>按照以前思路，我们若要返回该斐波那契数列，必须要用 <u>数组保存多个值</u> ，且看更优雅的<em>generator</em> 如何做到：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fib</span>(<span class="params">x</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">0</span>, b = <span class="number">1</span>, c = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> a;   <span class="comment">// 返回 0</span></span><br><span class="line">    <span class="keyword">yield</span> b;   <span class="comment">// 返回 1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(c &lt; x)</span><br><span class="line">    &#123;</span><br><span class="line">        c = a + b;</span><br><span class="line">        [a,b] = [b,c];  </span><br><span class="line">        <span class="keyword">yield</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> myGenerator =  fib(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> x <span class="keyword">of</span> myGenerator)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(x);  <span class="comment">// 依次输出：0  1  1  2  3  5</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>generator</em> 不用数组来保存每次循环计算的值，而是直接将当前计算值的值 <em>yield</em> 返回即可。</p>
<h3 id="generator-简化-AJAX-（待）"><em>generator</em> 简化 <em>AJAX</em> （待）</h3>
<h1>第三章：标准对象</h1>
<h2 id="3-1-小城少年对象与坑">3.1 小城少年对象与坑</h2>
<h3 id="typeof"><em>typeof</em></h3>
<p>在 <em>JavaScript</em> 的世界里，一切都是对象，你喜欢但不喜欢你的姑娘也是。</p>
<p><em>typeof</em> 操作符获取对象的类型，它总是返回一个 <u>字符串</u>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.字符串、数值、布尔基本类型</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">123</span>;      <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span>;     <span class="comment">// &#x27;boolean&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">&#x27;str&#x27;</span>;    <span class="comment">// &#x27;string&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.函数</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="built_in">Math</span>.abs;  <span class="comment">// &#x27;function&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.预设特殊值</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">NaN</span>;       <span class="comment">// &#x27;number&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span>; <span class="comment">// &#x27;undefined&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>;      <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.[] &#123;&#125; ?</span></span><br><span class="line"><span class="keyword">typeof</span> [];        <span class="comment">// &#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;&#125;;        <span class="comment">// &#x27;object&#x27;</span></span><br></pre></td></tr></table></figure>
<p>根据利用 <em>tepeof</em> 来判断一些变量。比如：</p>
<blockquote>
<p>判读全局变量、局部变量是否存在。</p>
</blockquote>
<ul>
<li>判断全局变量是否存在：<code>typeof window.myVar === 'undefined'</code></li>
<li>判断局部变量是否存在：<code>typeof myVar === 'undefined'</code> 。</li>
</ul>
<blockquote>
<p>判断是否 <em>null</em>、<em>Array</em> 。</p>
</blockquote>
<p>我们从上也知道，<em>typeof</em> 无法判断出是否 <em>null</em>、<em>Array</em> (它们和 <strong>[]、 {}</strong> 都是 <em>object</em>类型)，但可以：</p>
<ul>
<li>判断 <em>null</em> ： <code>变量 === null；</code></li>
<li>判断 <em>Array</em>：<code>Array.isArray(arr);</code></li>
</ul>
<h3 id="包装对象">包装对象</h3>
<p>和 <em>java</em> 类似，<em>JavaScript</em> 还提供了包装对象，比如 <em>int</em> 可封装转换为 <em>integer</em> 类型对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 封装返回的是一个对象</span></span><br><span class="line"><span class="keyword">var</span> n = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>) ;     <span class="built_in">console</span>.log(n);  <span class="comment">// 输出：[Number: 123]</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>);    <span class="built_in">console</span>.log(b);  <span class="comment">// 输出：[Boolean: true]</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">&#x27;str&#x27;</span>);    <span class="built_in">console</span>.log(s);  <span class="comment">// 输出：[String: &#x27;str&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>但是注意：包装对象看上去值和原来一样但是已经是 <em>object</em> 类型！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> n);   <span class="comment">// 输出：object </span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> b);   <span class="comment">// 输出：object</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> s);   <span class="comment">// 输出：object</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 和此前不同！</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="number">123</span>);    <span class="comment">// 输出：number</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">true</span>);   <span class="comment">// 输出：boolean</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="string">&#x27;str&#x27;</span>);  <span class="comment">// 输出：string</span></span><br></pre></td></tr></table></figure>
<h2 id="3-2-Date">3.2 <em>Date</em></h2>
<p><code>Date</code>对象用来表示日期和时间，有以下三种创建其对象方式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.默认构造函数</span></span><br><span class="line"><span class="comment">// 用now对象获取的时间始终是[当前最新]时间</span></span><br><span class="line"><span class="comment">// 输出的是UTC时间，与本地时间相差8个小时</span></span><br><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>(); </span><br><span class="line"><span class="built_in">console</span>.log(now);          <span class="comment">// 输出：2019-07-23T08:25:35.884Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.指定日期和时间构建</span></span><br><span class="line"><span class="comment">// 默认参数 = 0</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2019</span>,<span class="number">6</span>,<span class="number">23</span>,<span class="number">16</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">123</span>);</span><br><span class="line"><span class="built_in">console</span>.log(date);         <span class="comment">// 输出：2019-07-23T16:20:30.123Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.指定时间戳创建</span></span><br><span class="line"><span class="comment">// 先将符合[ISO 8601格式]字符串---&gt;时间戳</span></span><br><span class="line"><span class="keyword">var</span> timeStamp = <span class="built_in">Date</span>.parse(<span class="string">&#x27;2019-07-23T16:20:30.123&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(timeStamp);     <span class="comment">// 输出：1563870030123，这是一个时间戳</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为Date对象</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(timeStamp);</span><br><span class="line"><span class="built_in">console</span>.log(date);          <span class="comment">// 输出：2019-07-23T16:20:30.123Z</span></span><br></pre></td></tr></table></figure>
<p>常用的获取时间各种信息对象方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">now;                       <span class="comment">// 2019-07-23T08:47:48.033Z</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象方法</span></span><br><span class="line">now.getFullYear();         <span class="comment">// 2019, 年份</span></span><br><span class="line">now.getMonth();            <span class="comment">// 6, 月份，注意月份范围是0~11，6表示7月</span></span><br><span class="line">now.getDate();             <span class="comment">// 23, 24号</span></span><br><span class="line">now.getDay();              <span class="comment">// 2, 星期二</span></span><br><span class="line">now.getHours();            <span class="comment">// 16, 24小时制</span></span><br><span class="line">now.getMinutes();          <span class="comment">// 47, 分钟</span></span><br><span class="line">now.getSeconds();          <span class="comment">// 48, 秒</span></span><br><span class="line">now.getMilliseconds();     <span class="comment">// 033, 毫秒数</span></span><br><span class="line">now.getTime();             <span class="comment">// 1563871956469, 时间戳</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 静态方法</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Date</span>.now());   <span class="comment">// 输出：1563871956469</span></span><br></pre></td></tr></table></figure>
<h3 id="时区问题">时区问题</h3>
<p>我们看到上面输出的时间，并不是我们本地时间，而是UTC时间和本地相差8个小时，我们可以输出本地时间。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.直接将当前时间转为本地时间</span></span><br><span class="line"><span class="built_in">console</span>.log(now.toLocaleString());   <span class="comment">// 输出：2019-7-23 5:10:21 PM</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.获取时间戳，然后进行时区转换</span></span><br><span class="line"><span class="comment">// 静态OR动态方法获取时间戳</span></span><br><span class="line"><span class="keyword">var</span> timeStamp = <span class="built_in">Date</span>.now();          <span class="comment">// 或者 var timeStamp = new Date().getTime();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接用时间戳构建对象</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(timeStamp);</span><br><span class="line"><span class="built_in">console</span>.log(date.toLocaleString());  <span class="comment">// 输出：2019-7-23 5:10:21 PM</span></span><br></pre></td></tr></table></figure>
<h2 id="3-3-RegExp（待）">3.3 <em>RegExp</em>（待）</h2>
<p><em>RegExp</em> 是专门用于正则解析的类，首先我们要对正则表达式熟悉。</p>
<h3 id="正则表达式">正则表达式</h3>
<h2 id="3-4-JSON">3.4 <em>JSON</em></h2>
<p><em>JSON</em> 是 <em>JavaScript Object Notation</em> 的缩写，它是一种数据交换格式，实际上也是 <em>JavaScript</em> 的一个子集。</p>
<p>其支持的数据类型有：</p>
<ul>
<li><em>object</em>：即<em>JavaScript</em> 的<code>&#123; ... &#125;</code>表示方式 (可嵌套)</li>
<li><em>number</em>、<em>boolean</em>、 <em>string</em>、<em>null</em>、<em>array</em>：和 <em>JavaScript</em> 中对应类型完全一致</li>
</ul>
<p><em>json</em> 数据可以是上面支持数据类型 <u>任意一个或多个组合</u> ，而不是只能在<em>object</em> <strong>{…}</strong> 包含键值对形式 。</p>
<blockquote>
<p>观察下面 <em>json</em> 格式数据{…}和 <em>js</em> 对象{…}有什么不同？</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组合成json格式数据</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;birth&quot;</span>: <span class="number">1996</span>,</span><br><span class="line"> <span class="string">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line"> <span class="string">&quot;school&quot;</span>: <span class="string">&quot;chongqingU&quot;</span>,</span><br><span class="line"> <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">  <span class="string">&quot;3C&quot;</span>,</span><br><span class="line">  <span class="string">&quot;python&quot;</span>,</span><br><span class="line">  <span class="string">&quot;2j&quot;</span></span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>只要是字符串，如键值必须用双引号 <strong>‘’ ‘’</strong></li>
</ul>
<p>而且 <em>json</em> 还规定字符集必须是 UTF-8，这样可以支持多语言了。</p>
<p><em><u>json</u></em> 和 <em>js</em> <u>对象/数组/字符串（<em>json</em>支持）等</u> 可以互相转换，这又称为序列化和反序列化。</p>
<h3 id="序列化">序列化</h3>
<p>将<em>JavaScript</em> 数据类型转换为 <em>json</em> 称之为序列化。如下面是一个对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">birth</span>: <span class="number">1996</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;M&#x27;</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span>,</span><br><span class="line">    <span class="attr">skills</span>: [<span class="string">&#x27;3C&#x27;</span>,<span class="string">&#x27;python&#x27;</span>,<span class="string">&#x27;2j&#x27;</span>],</span><br><span class="line">    <span class="attr">age</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Date</span>().getFullYear() - <span class="built_in">this</span>.birth; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 <em>JavaScript</em> 内置了 <em>json  API</em>，我们可以直接调用 <code>JSON.stringify()</code>来转换为 <em>json</em> 格式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @value：传递一个对象或者数组(?)</span></span><br><span class="line"><span class="comment">// @replacer: 传递一个方法用来改变结果显示，或者传递数组筛选指定键值</span></span><br><span class="line"><span class="comment">// @space : 传递空白字符等用来格式化结果，使得结果更易读</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">JSON</span>.stringify(hwh,<span class="literal">null</span>,<span class="string">&#x27; &#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>尝试输出结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回字符串</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify(hwh,<span class="literal">null</span>,<span class="string">&#x27; &#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> s);   <span class="comment">// 输出：string，说明转换后json格式数据是字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(s);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化结果</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;birth&quot;</span>: <span class="number">1996</span>,</span><br><span class="line"> <span class="string">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line"> <span class="string">&quot;school&quot;</span>: <span class="string">&quot;chongqingU&quot;</span>,</span><br><span class="line"> <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">  <span class="string">&quot;3C&quot;</span>,</span><br><span class="line">  <span class="string">&quot;python&quot;</span>,</span><br><span class="line">  <span class="string">&quot;2j&quot;</span></span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特别的，允许的数据类型如果不属于<em>json</em> 支持类型，序列化时不会显示该类型，如 <u>函数<em>age</em>键值对</u> 没有显示。</p>
<p>当然，我们也可以转换其它<em>json</em> 支持的数据类型：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="string">&#x27;str&#x27;</span>));  <span class="comment">// 输出：&quot;str&quot;</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="number">123</span>));    <span class="comment">// 输出：123</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(<span class="literal">true</span>));   <span class="comment">// 输出：true</span></span><br></pre></td></tr></table></figure>
<h4 id="进一步处理：传递函数">进一步处理：传递函数</h4>
<p>在前介绍，我们还可以通过第二个参数 <em>@replacer</em> 对键值对进行筛选、指定处理方法等。</p>
<blockquote>
<p>筛选出<em>JavaScript</em>对象指定键值：<em>birth、gender、school</em>  对应键值对。</p>
</blockquote>
<p>我们可以通过传递一个数组包含我们希望留下的键值，来达到目的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify(hwh,[<span class="string">&#x27;birth&#x27;</span>,<span class="string">&#x27;gender&#x27;</span>,<span class="string">&#x27;school&#x27;</span>],<span class="string">&#x27; &#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(s);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化结果</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;birth&quot;</span>: <span class="number">1996</span>,</span><br><span class="line"> <span class="string">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line"> <span class="string">&quot;school&quot;</span>: <span class="string">&quot;chongqingU&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组好像不行？？</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify([<span class="string">&#x27;hwh&#x27;</span>,<span class="string">&#x27;lt&#x27;</span>],[<span class="number">0</span>],<span class="string">&#x27; &#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化结果</span></span><br><span class="line">[</span><br><span class="line"> <span class="string">&quot;hwh&quot;</span>,</span><br><span class="line"> <span class="string">&quot;lt&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将所有键值转换为大写。（为什么不能对键值 <em>key</em> 大写？只能修改属性？）</p>
</blockquote>
<p>需要对键值对进行处理，可以传递一个函数，它会对所有键值对进行操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 箭头函数</span></span><br><span class="line"><span class="comment">// 必须判断是否是 string类型，因为如birth属性就是Number</span></span><br><span class="line"><span class="comment">// 注意：typeof返回String类型字符串！</span></span><br><span class="line"><span class="comment">// 为什么不能转换键值key为大写？</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span>  valueToUpper = <span class="function">(<span class="params">key,value</span>) =&gt;</span> <span class="keyword">typeof</span> value === <span class="string">&#x27;string&#x27;</span> ? value.toUpperCase():value;</span><br></pre></td></tr></table></figure>
<p>⚠️ 传递的函数任何情况要有返回值！比如上面不打算对属性<em>value</em> 进行修改也要 <code>return value</code> 。</p>
<p>我们尝试输出结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="built_in">JSON</span>.stringify(hwh,valueToUpper,<span class="string">&#x27; &#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.log(s);</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;birth&quot;</span>: <span class="number">1996</span>,</span><br><span class="line"> <span class="string">&quot;gender&quot;</span>: <span class="string">&quot;M&quot;</span>,</span><br><span class="line"> <span class="string">&quot;school&quot;</span>: <span class="string">&quot;CHONGQINGU&quot;</span>,</span><br><span class="line"> <span class="string">&quot;skills&quot;</span>: [</span><br><span class="line">  <span class="string">&quot;3C&quot;</span>,</span><br><span class="line">  <span class="string">&quot;PYTHON&quot;</span>,</span><br><span class="line">  <span class="string">&quot;2J&quot;</span></span><br><span class="line"> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="反序列化">反序列化</h3>
<p>我们也可以利用 <code>JSON.parse()</code> 将 <em>json</em> 格式字符串解析转换为 <em>javaScript</em>对象 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.反序列化对象 </span></span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="string">&#x27;&#123;&quot;name&quot;:&quot;hwh&quot;, &quot;age&quot;:23&#125;&#x27;</span>);  <span class="comment">// Object &#123;name: &#x27;hwh&#x27;, age: 23&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.反序列化数组</span></span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="string">&#x27;[1,2,3,true]&#x27;</span>);             <span class="comment">// [1, 2, 3, true]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.反序列化其它基本类型</span></span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="string">&#x27;true&#x27;</span>);                     <span class="comment">// true</span></span><br><span class="line"><span class="built_in">JSON</span>.parse(<span class="string">&#x27;123.45&#x27;</span>);                   <span class="comment">// 123.45</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 要解析的 <em>json</em> 数据一定要是字符串！</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.尝试解析对象？</span></span><br><span class="line"><span class="keyword">var</span> hwh = &#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;hwh&quot;</span>, <span class="string">&quot;age&quot;</span>:<span class="number">23</span>&#125;;  <span class="comment">// 这既不是对象（键值有&quot;&quot;），也不是字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(hwh));        <span class="comment">// 解析错误</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.尝试解析数组？</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="literal">true</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(arr));        <span class="comment">// 解析错误</span></span><br></pre></td></tr></table></figure>
<h4 id="进一步处理：传递函数-2">进一步处理：传递函数</h4>
<p>事实上<code>JSON.parse()</code> 有两个参数，还可传第二个函数参数 <em>@reviver</em> 对<em>json</em> 字符串进行处理：</p>
<blockquote>
<p>把传递进来的<em>json</em> 字符串，键值<em>name</em>对应属性后加上“同学”。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 反序列化：json字符串转换为对象</span></span><br><span class="line"><span class="comment">// JSON.parse(@text,@reviver)</span></span><br><span class="line"><span class="comment">// @text：传递合法json字符串</span></span><br><span class="line"><span class="comment">// @reviver：传递一个函数改变输出结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> json_hwh = <span class="string">&#x27;&#123;&quot;name&quot;:&quot;hwh&quot;, &quot;age&quot;:23&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> addSome = <span class="function"><span class="keyword">function</span>(<span class="params">key,value</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(key === <span class="string">&quot;name&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> value + <span class="string">&#x27;同学&#x27;</span>;  <span class="comment">// 对value进行修改</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> value;          <span class="comment">// 易错：其它情况也一定要有返回值！否则最后解析为undefined的！</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(json_hwh,addSome);</span><br></pre></td></tr></table></figure>
<p>尝试输出结果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(obj);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反序列化结果</span></span><br><span class="line">&#123; <span class="attr">name</span>: <span class="string">&#x27;hwh同学&#x27;</span>, <span class="attr">age</span>: <span class="number">23</span> &#125;</span><br></pre></td></tr></table></figure>
<h1>第四章：面对对象编程</h1>
<h2 id="4-1-在-JS-世界面对对象">4.1 在 <em>JS</em> 世界面对对象</h2>
<p><em>JavaScript</em> 所有数据都可以看成对象，比如我们之前使用：<em>Number</em>、<em>Array</em>、<em>string</em> &amp; 基本的**{…} **定义的对象。</p>
<p>但这并没有真正发挥面对对象编程威力。</p>
<p>熟悉 <em>java、C#</em> 的你一定知道：类 &amp;  实例之间区别，就是模板与创建的实例对象。<em>BUT</em> ，在<em>JavaScript</em> 中并没有类和实例概念，在<em>JavaScript</em> 世界里是通过 <u><em>原型（prototype）</em></u> 等方式实现的。</p>
<h3 id="1-创建对象">1.创建对象</h3>
<p>闲的蛋疼的你想创建一个<em>hwh</em>对象，他会唱 、跳、rap、喜欢打篮球，又懒得9点钟都不一定起床的你恰好看到你之前创建的一个<em>student</em>对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> student = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">name</span> : <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&quot;chongqingU&quot;</span>,</span><br><span class="line">    <span class="attr">sing</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am sing..&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可是<em>hwh</em> 不叫小明，也不是18岁啊！更重要的小明他居然不会跳、rap、🏀！</p>
<p>熟悉原型链的你微微一笑，不慌不忙的创建了一个<em>hwh</em> 对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;huangwanghui&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">23</span>,</span><br><span class="line">    <span class="comment">// 对象增加额外方法</span></span><br><span class="line">    <span class="attr">jump</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am jump..&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">rap</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am rap..&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">play_basketball</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am playing basketball ..&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后把<em>hwh._<em>proto</em>_</em> 属性指向<em>student</em>，看上去好像继承了<em>student</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hwh.__proto__ = student; <span class="comment">// 注意：proto左右各有两个_，不是一个！</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;大家好，我是渣渣辉 :&quot;</span> + hwh.name);</span><br><span class="line">hwh.sing();                <span class="comment">// 唱：i am sing..</span></span><br><span class="line">hwh.jump();                <span class="comment">// 跳：i am jump..</span></span><br><span class="line">hwh.rap();                 <span class="comment">// rap：i am rap..</span></span><br><span class="line">hwh.play_basketball();     <span class="comment">// 打篮球：i am playing basketball ..</span></span><br></pre></td></tr></table></figure>
<p>通过同名键值可以覆盖student原有键值，通过创建新键值对可以使得<em>hwh</em> 可以跳、<em>rap</em>、打篮球。</p>
<h4 id="扩展了解">扩展了解</h4>
<blockquote>
<p>为什么这种方式看上去好像 “继承”了 <em>student</em> 属性？</p>
</blockquote>
<p>因为在<em>JavaScript</em> 中，实例对象<em>hwh</em>如果没有找到属性、方法它会自动在其 <em>hwh._<em>proto</em>_</em> 对象属性中查找（<em>_<em>proto</em>_</em> 是一个对象）。这个时候把对象<em>student</em> 赋值 <em>hwh._<em>proto</em>_</em> ，那么就会自动查找对象 <em>student</em> 属性。</p>
<p>⚠️ <em>_<em>proto</em>_</em> 是每一个对象或函数都有的属性（<u>默认指向 <em>Object.prototype</em></u>），但是函数还有 <em>prototype</em> 属性。</p>
<p>所以<em>hwh._<em>proto</em>_</em> （也就是对象<em>student</em> ）中也有这个属性：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564110563722.png" alt="1564110563722"></p>
<p>此时查找的原型链为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564110665280.png" alt="1564110665280"></p>
<p>如果是用后面介绍 <u>构造函数创建<em>hwh</em>对象方式</u> ，其查找原型链为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564109191794.png" alt="1564109191794"></p>
<h4 id="Object-create-创建对象"><code>Object.create()</code>创建对象</h4>
<p>通常在写 <em>JavaScript</em> 代码，<u>不推荐</u> 使用 <code>对象名.__proto__</code> 方式改变对象原型。</p>
<p>我们应该用 <code>Object.create(对象o)</code> 创建一个基于<code>对象o</code> 原型新对象：</p>
<blockquote>
<p>用<code>Object.create()</code> 方式创建基于原型<em>student</em> 的对象<em>hwh</em> ，相当 <u>复制</u> 了<em>student</em>对象。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基于原型student创建对象hwh</span></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="built_in">Object</span>.create(student);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象修改属性</span></span><br><span class="line">hwh.name = <span class="string">&#x27;huangwanghui&#x27;</span>;</span><br><span class="line">hwh.age = <span class="number">23</span>;</span><br><span class="line"><span class="comment">// 对象增加方法</span></span><br><span class="line">hwh.jump = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am jump..&quot;</span>);</span><br><span class="line">hwh.rap = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am rap..&quot;</span>);</span><br><span class="line">hwh.play_basketball = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am playing basketball ..&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试调用</span></span><br><span class="line"><span class="built_in">console</span>.log(hwh.name);  <span class="comment">// 输出：huangwanghui</span></span><br><span class="line">hwh.jump();             <span class="comment">// 输出：i am jump..</span></span><br></pre></td></tr></table></figure>
<h4 id="构造函数创建对象">构造函数创建对象</h4>
<p>前面我们介绍了两种基于student原型创建<em>hwh</em> 对象方式：其中 <code>hwh.__proto___ = student</code>  这种创建对象方式，我们不推荐修改实例<em>hwh</em> 的*_<em>proto</em>__* 属性。</p>
<p>而且我们知道，此前<em>student</em> 都是对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 原型对象student</span></span><br><span class="line"><span class="keyword">var</span> student = </span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">name</span> : <span class="string">&quot;小明&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">school</span>: <span class="string">&quot;chongqingU&quot;</span>,</span><br><span class="line">    <span class="attr">sing</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am sing..&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们把<em>student</em> 改写成一个函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数Student</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age,school</span>)  // 构造函数首字母建议大写</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name =  name;</span><br><span class="line">    <span class="built_in">this</span>.age = age,</span><br><span class="line">    <span class="built_in">this</span>.school = school,</span><br><span class="line">    <span class="built_in">this</span>.sing = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)   // 必须全部用<span class="title">this</span>引用函数内部变量</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am sing..&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数内部看起来很像对象键值对形式只不过 <code>键值:属性</code> 变为：<code>this.键值:属性</code>，特别的</p>
<ul>
<li>函数所有变量（“键值”）必须用<em>this</em> 引用 ，在函数内部（非<em>strict</em> 模式）<em>this</em> 指向全局对象<em>window</em> ；<em>new</em> 创建新对象后，会自动将 <em>this</em> 指向到新创建的对象。</li>
</ul>
<p>这也就是构造函数，使用 <em>new</em> 它会返回一个实例对象：</p>
<ul>
<li>实例对象 <u>继承构造函数所有属性</u></li>
<li>实例对象 <em>_<em>proto</em>_</em> 属性自动绑定为构造函数原型<em>prototype</em> 属性。</li>
</ul>
<p>同样，自然我们也可以对对象进行增改：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// new返回一个对象</span></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student(<span class="string">&quot;hwh&quot;</span>,<span class="number">23</span>,<span class="string">&quot;chongqingU&quot;</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象增加额外方法</span></span><br><span class="line">hwh.jump = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am jump..&quot;</span>);</span><br><span class="line">hwh.rap = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am rap..&quot;</span>);</span><br><span class="line">hwh.play_basketball = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am playing basketball ..&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试输出</span></span><br><span class="line">hwh.sing();   <span class="comment">// 输出：i am sing..</span></span><br><span class="line">hwh.jump();   <span class="comment">// 输出：i am jump..</span></span><br></pre></td></tr></table></figure>
<p>同前，此时原型链查找顺序为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564109191794.png" alt="1564109191794"></p>
<ol>
<li>
<p>对象<em>student</em> 原型对象<em>prototype</em> 会自动赋值给 <em>hwh._<em>proto</em>_</em> （<em>student.prototype</em> 属性也是一个对象）</p>
</li>
<li>
<p>如果没有在实例<em>hwh</em> 中找到属性、方法就会自动在<em>hwh._<em>proto</em>_</em> 中查找，等价于在 <em>student.prototype</em> 查找</p>
</li>
<li>
<p>对象<em>student.prototype</em> 又有个对象属性 <em>student.prototype._<em>proto</em>_</em> 它被赋值为<em>Object</em> 原型<em>Object.prototype</em></p>
</li>
<li>
<p>如果<em>student.prototype</em> 没有找到属性，就会接着在 <em>student.prototype._<em>proto</em>_</em> 中查找（等价在原型<em>Object.prototype</em> 中查找）</p>
</li>
<li>
<p>最后还有还找到返回null</p>
</li>
</ol>
<h3 id="2-初识原型链">2. 初识原型链</h3>
<p>当我们用<code>对象名.xxx</code>访问一个对象属性时，<em>JavaScript</em> 引擎查找顺序如下：</p>
<ol>
<li>先在当前对象上查找该属性，如果没有找到；</li>
<li>在其原型对象上找，如果还没有找到；</li>
<li>一直上溯到 <em>Object.prototype</em> --&gt; <em>null</em>  ；</li>
<li>上溯到<em>null</em> 说明未找到，返回 <em>undefined</em> 。</li>
</ol>
<blockquote>
<p>等等，这里原型链是什么？</p>
</blockquote>
<p>当我们创建一个 <em>Array</em> 对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure>
<p>数组 <em>arr</em> 它的原型链是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr ----&gt; <span class="built_in">Array</span>.prototype ----&gt; <span class="built_in">Object</span>.prototype ----&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>由于 <em>Array.prototype</em> 定义了 <em>indexof()</em> 、<em>shift()</em> 等方法，所以我们可以直接使用。</p>
<p>同理，创建一个函数 <em>fun()</em> 其原型链为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo ----&gt; <span class="built_in">Function</span>.prototype ----&gt; <span class="built_in">Object</span>.prototype ----&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>那么前面以构造函数创建的hwh对象原型链是？（参考 <u>1.创建对象 — 构造函数创建对象</u> 一节）</p>
</blockquote>
<p><code>构造函数</code> 创建的<em>hwh</em>对象其原型链：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ----&gt; Student.prototype ----&gt; <span class="built_in">Object</span>.prototype ----&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>或者用图表达：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564109191794.png" alt="1564109191794"></p>
<p>⚠️ 这里 <em>Array、Function、Student</em> 都是构造函数，因此有<em>prototype</em> 属性 即<u>函数原型</u>（见下详述）。</p>
<p>​      注：每一个对象或函数都有*_<em>proto</em>_*属性（<u>默认指向 <em>Object.prototype</em></u>），但只有函数才有 <em>prototype</em> 属性。</p>
<h4 id="使用原型链基本原则">使用原型链基本原则</h4>
<p>基本使用原型链原则：</p>
<ul>
<li>
<p>原型链不应该过长，这会在查找对象属性花费过多时间。</p>
</li>
<li>
<p>构造函数名首字母应该为大写（像约定类名首字母大写）。</p>
</li>
</ul>
<h3 id="3-深入理解原型链">3.深入理解原型链</h3>
<h4 id="prototype-proto"><em>prototype</em> &amp; <em>_<em>proto</em>_</em></h4>
<p>在前我们知道构造函数也是可以拥有属性的，<em>prototype</em> 是只有函数才拥有的共有属性。属性<em>prototype</em> 又称为 <u>函数原型</u>，它是一个对象。</p>
<p><em>_<em>proto</em>_</em>  是所有对象、函数都有属性，它也是一个对象，指向生成它的构造函数原型<em>prototype</em> 属性。因为所有对象都派生自 <em>Object</em> 构造函数，所以默认指向原型<em>object.prototype</em> 属性。如果是通过构造函数创建的实例对象，则指向生成它的构造函数原型<em>prototype</em> 。</p>
<p>（而<em>prototype</em> 也是一个对象，所以不难理解它也有*_<em>proto</em>_*属性 ：<em>prototype._<em>proto</em>_</em>）</p>
<p><u>在函数原型上定义的方法、属性会被所有实例“继承”</u>，（<strong>准确来说，构造函数<em>new</em> 出的实例才会继承构造函数所有属性，函数原型上定义的方法、属性只是可以通过原型链查找而被使用，看上去好像“继承”了</strong>）。</p>
<p>函数原型对象<em>prototype</em>主要包含的属性方法如下（<em>prototype</em> 是一个对象所以也有很多键值对属性）：</p>
<ul>
<li>
<p>原型本身定义的 <strong>原型</strong> 属性、方法（只有通过 <code>函数名.prototype.属性名 = 方法/属性</code> 定义的才是原型方法、属性 ）</p>
</li>
<li>
<p><em>constructor</em> 属性：指向构造函数本身</p>
</li>
<li>
<p><em>_<em>proto</em>_</em> 属性：和原型链上级构造函数原型<em>prototype</em>属性等价</p>
</li>
</ul>
<blockquote>
<p>进一步理解函数原型对象？</p>
</blockquote>
<p>我们创建一个空构造函数 <em>Student()</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)  // 构造函数首字母建议大写</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = <span class="string">&quot;hwh&quot;</span>;  <span class="comment">// [注1]</span></span><br><span class="line">&#125;</span><br><span class="line">Student.prototype.shcool = <span class="string">&quot;chongqingU&quot;</span>;   <span class="comment">// 给Student函数增加属性，这样可以增加到原型对象上</span></span><br><span class="line">Student.age = <span class="number">23</span>;       <span class="comment">// [注2]</span></span><br></pre></td></tr></table></figure>
<p>试想一下，如果我们之前用对象来作为原型创建实例， 把函数<em>Student()<em>改为对象</em>Student</em>应该是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// [注1] 添加的属性name不属于函数原型方法属性，但可被创建的实例继承，是实例属性</span></span><br><span class="line"><span class="comment">// [注2] 添加的属性age，既不属于函数原型方法属性，也不会被实例继承，只能自娱自乐</span></span><br><span class="line"></span><br><span class="line">Student     </span><br><span class="line">&#123;</span><br><span class="line">   <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样我们便有了函数原型 <em>Student.prototype</em> 的一个初步雏形：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype   </span><br><span class="line">&#123;</span><br><span class="line">   <span class="attr">school</span>: <span class="string">&#x27;chongqingU&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，实际的 <em>Student.prototype</em> 属性不会这么简单：它还拥有<em>constructor</em>属性指向构造函数本身 ；<em>_<em>proto</em>_</em> 属性指向上一级构造函数原型<em>prototype</em> 。</p>
<p>我们尝试打印会出来类似下面结构：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(Student.prototype);</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">shcool</span>:<span class="string">&quot;chongqingU&quot;</span>               <span class="comment">// 1.函数原型增加的原型属性：shcool</span></span><br><span class="line">    <span class="attr">constructor</span>: ƒ doSomething(),     <span class="comment">// 2.constructor：指向Student本身</span></span><br><span class="line">    <span class="attr">__proto__</span>: &#123;                      <span class="comment">// 3.__proto__：== object.prototype</span></span><br><span class="line">        <span class="attr">constructor</span>: ƒ <span class="built_in">Object</span>(),</span><br><span class="line">        <span class="attr">hasOwnProperty</span>: ƒ hasOwnProperty(),</span><br><span class="line">        <span class="attr">isPrototypeOf</span>: ƒ isPrototypeOf(),</span><br><span class="line">        <span class="attr">propertyIsEnumerable</span>: ƒ propertyIsEnumerable(),</span><br><span class="line">        <span class="attr">toLocaleString</span>: ƒ toLocaleString(),</span><br><span class="line">        <span class="attr">toString</span>: ƒ toString(),</span><br><span class="line">        <span class="attr">valueOf</span>: ƒ valueOf()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到构造函数<em>Student.prototype._<em>proto</em>_</em> 属性指向—&gt;上一级构造函数<em>object.prototype</em> 属性。</p>
<p>(<em>_<em>proto</em>_</em> 属性默认指向<em>Object</em> 原型)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype.__proto__ === object.prototype;   <span class="comment">// ture</span></span><br></pre></td></tr></table></figure>
<p>t由上介绍我们也知道，用构造函数创建的实例*_<em>proto</em>_* 属性，会指向生成它的构造函数原型 <em>prototype</em> 属性。</p>
<blockquote>
<p>利用构造函数<em>Student</em> 创建实例<em>hwh</em> 对象，打印出它的 <em>_<em>proto</em>_</em> 属性。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line"><span class="built_in">console</span>.log(hwh.__proto__);</span><br></pre></td></tr></table></figure>
<p>下面打印出的实际就是原型 <em>Student.prototype</em> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">shcool</span>:<span class="string">&quot;chongqingU&quot;</span>               <span class="comment">// 1.原型本身拥有的属性：shcool</span></span><br><span class="line">    <span class="attr">constructor</span>: ƒ doSomething(),     <span class="comment">// 2.constructor：指向Student本身</span></span><br><span class="line">    <span class="attr">__proto__</span>: &#123;                      <span class="comment">// 3.__proto__：== object.prototype</span></span><br><span class="line">         <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>总结一下，函数原型可看作是 <u>构造函数的一个&quot;实例&quot;</u> ，但是：</p>
<ul>
<li>只有 <code>函数名.prototype.属性</code> OR  <code>函数名.prototype.方法</code> 声明的属性/方法才是原型属性/方法</li>
<li>&quot;实例&quot;还自动拥有 <em>constructor</em> &amp; <em>_<em>proto</em>_</em> 属性分别指向函数本身和下一级构造函数原型</li>
</ul>
<h4 id="原型链查找">原型链查找</h4>
<p>好的聪明的你肯定想起来，我们前面写出的 <em>Student</em> 构造函数创建的 <em>hwh</em> 对象原型链：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564109191794.png" alt="1564109191794"></p>
<p>和我们此前说过的原型链查找某属性规则：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当前对象查找属性 ---&gt; 上一级原型查找 ---&gt; .... ---&gt; object原型查找 ---&gt; 还没找到则为<span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>用一张图概况整个过程应该是：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564027583727.png" alt="1564027583727"></p>
<ul>
<li>在对象 <em>hwh</em> 本身实例属性查找，未找到则在 <em>hwh._<em>proto</em>_</em> 查找</li>
<li><em>hwh._proto__</em> 实际 ===上级原型<em>Student.prototype</em> ，在该原型中查找定义的原型属性、方法</li>
<li>未找到则在<em>hwh._<em>proto</em>_.prototype._<em>proto</em>_</em> === <em>Student.prototype._<em>proto</em>_</em> ===上级原型 <em>Object.prototype</em>，查找该原型中定义的属性、方法</li>
<li>还未找到则返回null</li>
</ul>
<p>如果我们把构造函数<em>Student</em> 原型指向另外一个实例，那么原型链查找顺序如何变化？</p>
<blockquote>
<p>创建实例lt，它有属性<code>name = “liuting”</code> 。把<em>Student.prototype</em>指向lt后，分析原型链查找<em>name</em>过程。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lt = <span class="keyword">new</span> Student();  </span><br><span class="line">lt.name = <span class="string">&quot;liuting&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>此时我们还可以看到：<code>lt.__proto__ === Student.prototype</code> 为<em>ture</em> ，指向生成它的构造函数原型。</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564044783639.png" alt="1564044783639"></p>
<p>而当把<em>Student</em> 原型指向<em>lt</em> 后：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype = lt;   <span class="comment">// Student原型指向lt</span></span><br></pre></td></tr></table></figure>
<p><code>lt.__proto__ === Student.prototype</code> 为 <em>false</em>， <em><em><em>lt._<em>proto</em>_</em> 还是保存原来未修改前的</em>Student</em> 函数原型**。</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564046067250.png" alt="1564046067250"></p>
<p>再用构造函<em>Student</em>数创建新对象hwh：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.__proto__ === Student.prototype === lt;   <span class="comment">// ture</span></span><br></pre></td></tr></table></figure>
<p>用一张图概括原型链变化应该是：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564049416082.png" alt="1564049416082"></p>
<p>我们尝试输出 <code>hwh.name</code>，显然可以在原型链 <code>实例lt</code> 的 <code>lt属性方法</code> 找到 <code>name</code> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(hwh.name);     <span class="comment">// 输出:liuting</span></span><br></pre></td></tr></table></figure>
<h2 id="4-2-构造函数继承">4.2 构造函数继承</h2>
<p>我们定义一个构造函数 <em>Student()</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br></pre></td></tr></table></figure>
<p>其原型链为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ---&gt; Student.prototype ---&gt; <span class="built_in">Object</span>.prototype ---&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>现在我们又定义了个构造函数 <em>People()</em> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">People</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.eat = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am eating&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们希望<em>Student</em> 能继承  <em>People</em> ,从而可以使用 <em>People</em> 的 <em>eat()</em> 方法，并且把原型链修改为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ---&gt; Student.prototype ---&gt; People.prototype ---&gt; <span class="built_in">Object</span>.prototype ---&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>那么该怎么办呢？</p>
<h3 id="1-构造函数绑定">1. 构造函数绑定</h3>
<p>前面我们讲过<em>apply</em>方法：<code>函数名.apply(对象名,[])</code> 。</p>
<p>可以将函数所有 <u>绑定到this的属性</u> 转而—&gt; <u>绑定到指定对象</u> 上。（注：非严格模式下函数<em>this</em> 指向 <em>undefined</em>）</p>
<p>因此，我们可以将构造函数<em>People</em> <u>绑定到this的属性</u> —&gt; 绑定到构造函数<em>Student</em> 生成的对象上。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// this指向Student构造函数创建的对象</span></span><br><span class="line">    <span class="comment">// 将构造函数People绑定到this的属性(不是People所有属性) ---&gt; 绑定到Student对象上</span></span><br><span class="line">    People.apply(<span class="built_in">this</span>,[]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();   <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>这样只是继承了<em>Student</em> 所有的属性，但是其原型链没有改变，还是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ---&gt; Student.prototype ---&gt; <span class="built_in">Object</span>.prototype ---&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>之所以<em>hwh</em> 能调用 <em>eat()</em> 方法，是因为该方法已经绑定到 <em>hwh</em> 对象上。</p>
<h3 id="2-prototype-模式">2. <em>prototype</em> 模式</h3>
<p>如果我们把 <em>Student</em> 原型指向 —&gt;一个 <em>People</em> 的实例，那么所有<em>Student</em> 实例都能“继承”<em>People</em> 属性、方法（准确来说，是通过原型链使得<em>Student</em> 实例对象<em>hwh</em> 可以使用构造函数<em>People</em> 的属性、方法）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype = <span class="keyword">new</span> People();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 良好习惯：修改了prototype要设置回prototype.constructor</span></span><br><span class="line">Student.prototype.constructor = Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();    <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>此时原型继承链为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh --&gt;Student.prototype == <span class="keyword">new</span> People() --&gt;People.prototype --&gt;<span class="built_in">Object</span>.prototype --&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>用一张图表示为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564115792502.png" alt="1564115792502"></p>
<h4 id="为什么有“良好习惯”？">为什么有“良好习惯”？</h4>
<p>在上面我们修改了 <em>Student.prototype</em> 指向，立马有重新设置了 <em>Student.prototype.constructor</em> 指回<em>Student</em> 。</p>
<p>如果不这么做：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype = <span class="keyword">new</span> People();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();   <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>不影响通过原型链使用<em>People.eat()</em> 方法，但我们尝试输出：<em>hwh.constructor</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cosole.log(hwh.constructor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">People</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.eat = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am eating&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>发现构造函数<em>Student</em> 生成的对象<em>hwh.constructor</em> 属性是指向构造函数<em>People</em> ！</p>
<p>首先，我们要知道<em>hwh</em> 本身是没有<em>constructor</em>这个属性的。它是通过原型链查找到构造函数 <em>People.prototype.constructor</em> 属性的，自然它是指向构造函数 <em>People</em> 了：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564133255074.png" alt="1564133255074"></p>
<p>但是对象<em>hwh</em>，是由构造函数<em>Student()</em> 生成的，我们在应该让<em>hwh.constructor</em>  指向生成它的构造函数<em>Student()</em>！</p>
<p>所以就有了上面的 <strong>“良好习惯</strong>”：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype.constructor = Student;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>但是，你可能会担心，<u>这样<em>People.prototype.constructor</em> 不就被修改了吗</u>？</p>
</blockquote>
<p>实际上，这样做只会在<em>Student.prototype</em> 也就是匿名对象 <em>new People()</em> +键值对：<code>constructor : f Student()</code></p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564133877508.png" alt="1564133877508"></p>
<p>看上去好像基本解决了原型链继承问题？但是由于要创建实例对象，开销较大。</p>
<h3 id="3-直接继承-prototype">3. 直接继承 <em>prototype</em></h3>
<p>通过直接把<em>Student.prototype</em> 原型属性直接指向 <em>People.prototype</em> 原型属性，来达到继承<em>People</em> 属性、方法。</p>
<p>通过这种方式，需要把<em>People</em> 的属性、方法绑定到原型对象<em>People.prototype</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">People</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">People.prototype.eat = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am eating&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>好了，我们开始 “ 继承 ” <em>People.prototype</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype = People.prototype;</span><br><span class="line"><span class="comment">// 良好的习惯：每次修改函数原型，都应该设置回constructor</span></span><br><span class="line">Student.prototype.constructor = Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();      <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>看起来天衣无缝，而且这比第 <strong>2</strong> 种方法效率更高：不用创建 <em>People</em> 实例。</p>
<p>但这种方式的原型链为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ---&gt; Student.prototype == People.prototype ---&gt; <span class="built_in">Object</span>.prototype ---&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564129946659.png" alt="1564129946659"></p>
<p>它没有体现  <em>Student</em> 和<em>People</em>之间原型继承关系，而且也隐藏了一个缺点。</p>
<h4 id="继承-prototype-方式缺点">继承 <em>prototype</em> 方式缺点</h4>
<p>这种方式， <em>Student.prototype</em> 和 <em>People.prototype</em> 现在指向了 <u>同一个对象</u> ，任何对 <em>Student.prototype</em> 修改都将反应在<em>People.prototype</em> 上。</p>
<p>我们在第二行修改了：<code>Student.prototype.constructor = Student;</code> ，会导致<em>People.prototype.constructor</em> 也被指向为构造函数 <em>Student</em> 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">People.prototype.constructor</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="我的疑问？">我的疑问？</h4>
<blockquote>
<p>为什么不可以直接设置 <em>Student.prototype._<em>proto</em>_</em> 指向 <em>People.prototype</em>  ？？？</p>
</blockquote>
<p>这种方式被很多博文都指出不应该提倡，原因影响性能？<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/proto">MDN-不推荐使用<em>Object.prototype._<em>proto</em>_</em></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Student.prototype.__proto__ = People.prototype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();      <span class="comment">// 可以输出：i am eating</span></span><br></pre></td></tr></table></figure>
<ul>
<li>实现了原型链继承关系</li>
<li>同时因为没有修改<em>Student.prototype</em> ，不用设置 <code>Student.prototype.constructor = Student</code></li>
</ul>
<h3 id="4-利用空对象作为中介">4. 利用空对象作为中介</h3>
<blockquote>
<p>一种基本完美的方法：既可体现原型链 <em>Student</em> 和<em>People</em> 继承关系，也不会导致<em>constructor</em> 之类问题。</p>
</blockquote>
<p>由于第3种办法，会出现指向同一对象导致<em>constructor</em> 意料之外被修改问题，我们可以借用一个空函数作为中介。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 空函数F作为媒介</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把F原型指向People原型</span></span><br><span class="line">F.prototype = People.prototype;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时Student.prototype原型指向空函数F实例对象</span></span><br><span class="line">Student.prototype = <span class="keyword">new</span> F();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 良好习惯：每次修改函数原型，都应该设置回constructor</span></span><br><span class="line"><span class="comment">// 由于此时Student.prototype 和 People.prototype不再指向同一对象</span></span><br><span class="line"><span class="comment">// 此时修改constructor不会导致 People.prototype.constructor 被同步修改</span></span><br><span class="line">Student.prototype.constructor = Student; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();    <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>噢，我的天！这是再变魔术吗？到底怎么一回事呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwh ---&gt; Student.prototype == <span class="keyword">new</span> F() ---&gt; F.prototype = People.prototype --&gt; <span class="built_in">Object</span>.prototype ---&gt; <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564128658845.png" alt="1564128658845"></p>
<h3 id="5-拷贝继承">5. 拷贝继承</h3>
<p>这种方式比较暴力…</p>
<p>首先，把<em>People</em> 的属性、方法绑定到原型对象<em>People.prototype</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">People</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">People.prototype.eat = <span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&quot;i am eating&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>接着实现将<em>People</em> 原型属性全部拷贝到 <em>Student</em> 原型属性上：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 遍历对象只需普通for循环</span></span><br><span class="line"><span class="comment">// 遍历循环只能用&lt;对象名[&#x27;key&#x27;]&gt;方式，其中&#x27;&#x27;在[i]不用加，i已经是字符串</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> People.prototype)</span><br><span class="line">&#123;</span><br><span class="line">    Student.prototype[i] = People.prototype[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student();</span><br><span class="line">hwh.eat();        <span class="comment">// 输出：i am eating</span></span><br></pre></td></tr></table></figure>
<p>可以看到，<u>通过原型链</u> 实例对象<em>hwh</em> 可以访问到构造函数<em>Student.prototype.eat</em> 属性方法。</p>
<h2 id="4-3-class-继承">4.3 <em>class</em> 继承</h2>
<blockquote>
<p>写的比较简单，需要时再补充。</p>
</blockquote>
<h3 id="初识-class">初识 <em>class</em></h3>
<p>在ES6标准引入了 <em>class</em> 关键字，比原先<em>JavaScript</em> 基于原型链的对象模型更加简单。</p>
<p>现在有一个构造函数 <em>Student</em> 可用来<em>new</em> 出实例对象，它像下面这样：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name,age</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name; </span><br><span class="line">    <span class="built_in">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">Student.prototype.learn =  <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;i am learning..&quot;</span>); &#125;;</span><br></pre></td></tr></table></figure>
<p>把它改写成<em>class</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">// 构造方法</span></span><br><span class="line">    <span class="comment">// new生成实例对象时自动调用该方法，为所有类实例对象生成下列实例属性</span></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name,age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// learn方法</span></span><br><span class="line">    <span class="function"><span class="title">learn</span>(<span class="params"></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;i am learning..&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 尝试调用</span></span><br><span class="line"><span class="keyword">var</span> hwh = <span class="keyword">new</span> Student(<span class="string">&#x27;hwh&#x27;</span>,<span class="number">23</span>);</span><br><span class="line">hwh.learn();   <span class="comment">// 输出：i am learning..</span></span><br></pre></td></tr></table></figure>
<p>看起来比此前写法简单多了，但其实在<em>JavaScript</em> 类 <em>class</em> 本质还是函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> Student;  <span class="comment">//  function</span></span><br></pre></td></tr></table></figure>
<p>另一方面，函数自然一定有原型属性<em>prototype</em>  ：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1564147389409.png" alt="1564147389409"></p>
<p>当然，这个’'函数&quot;有点特殊，所有直接在类中定义的属性、方法会被直接绑定到函数原型上。</p>
<p>所以上面 <em>class Student</em> 等价这么写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name,age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype.learn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;i am learning..&quot;</span>); &#125;;</span><br></pre></td></tr></table></figure>
<h3 id="使用-class-实现继承">使用 <em>class</em> 实现继承</h3>
<p>使用<em>class</em> 可以方便的实现继承，我想刚刚学完原型继承的你不会忘记被它支配的恐惧。</p>
<p>现在这有一个类 <em>Girl_Student</em> 继承 <em>Student</em> ，你可以这么写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Girl_Student</span> <span class="keyword">extends</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params">name,age,grade</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ES6规定必须调用父类构造函数一次</span></span><br><span class="line">        <span class="built_in">super</span>(name,age);</span><br><span class="line">        <span class="built_in">this</span>.grade = grade;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">myGrade</span>(<span class="params"></span>)</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;I am at grade: &#x27;</span> + <span class="built_in">this</span>.grade);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gs = <span class="keyword">new</span> Girl_Student(<span class="string">&#x27;lt&#x27;</span>,<span class="number">23</span>,<span class="number">395</span>);</span><br><span class="line">gs.myGrade();  <span class="comment">// 调用自身方法：I am at grade 395</span></span><br><span class="line">gs.learn();    <span class="comment">// 调用父类方法：i am learning..</span></span><br></pre></td></tr></table></figure>
<h1>第五章：浏览器</h1>
<h2 id="5-1-浏览器常用对象">5.1 浏览器常用对象</h2>
<h3 id="window"><em>window</em></h3>
<p><em>window</em> 对象不但充当全局作用域，而且表示 <u>浏览器窗口</u>，常用属性如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>innerWidth</em></td>
<td style="text-align:center">内宽度，不包含菜单栏、工具栏等占位元素</td>
</tr>
<tr>
<td style="text-align:center"><em>innerHeight</em></td>
<td style="text-align:center">内高度，不包含菜单栏、工具栏等占位元素</td>
</tr>
</tbody>
</table>
<h3 id="screen"><em>screen</em></h3>
<p><em>screen</em> 对象表示 <u>屏幕</u> 的信息，常用属性有：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>width</em></td>
<td style="text-align:center">屏幕宽度，以像素为单位</td>
</tr>
<tr>
<td style="text-align:center"><em>height</em></td>
<td style="text-align:center">屏幕高度，以像素为单位</td>
</tr>
<tr>
<td style="text-align:center"><em>colorDepth</em></td>
<td style="text-align:center">颜色位数，如16</td>
</tr>
</tbody>
</table>
<h3 id="navigator"><em>navigator</em></h3>
<p><em>navigator</em> 对象表示 <u>浏览器</u> 信息，常用属性有：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>appName</em></td>
<td style="text-align:center">浏览器名称</td>
</tr>
<tr>
<td style="text-align:center"><em>appVersion</em></td>
<td style="text-align:center">浏览器版本</td>
</tr>
<tr>
<td style="text-align:center"><em>language</em></td>
<td style="text-align:center">浏览器语言</td>
</tr>
<tr>
<td style="text-align:center"><em>platform</em></td>
<td style="text-align:center">操作系统类型</td>
</tr>
<tr>
<td style="text-align:center"><em>userAgent</em></td>
<td style="text-align:center">浏览器设定的 <em>user-Agent</em> 字符串</td>
</tr>
</tbody>
</table>
<h3 id="location"><em>location</em></h3>
<p><em>location</em> 对象表示 <u>当前页面<em>URL</em></u> 信息，常用属性有：</p>
<blockquote>
<p>以 <em><a target="_blank" rel="noopener" href="http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP">http://www.example.com:8080/path/index.html?a=1&amp;b=2#TOP</a></em> 为例。</p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>href</em></td>
<td style="text-align:center">完整地址：上面全部蓝字域名</td>
</tr>
<tr>
<td style="text-align:center"><em>protocol</em></td>
<td style="text-align:center">协议名： http</td>
</tr>
<tr>
<td style="text-align:center"><em>host</em></td>
<td style="text-align:center">域名： <a target="_blank" rel="noopener" href="http://www.example.com">www.example.com</a></td>
</tr>
<tr>
<td style="text-align:center"><em>port</em></td>
<td style="text-align:center">端口： 8080</td>
</tr>
<tr>
<td style="text-align:center"><em>pathname</em></td>
<td style="text-align:center">路径名： /path/index.html</td>
</tr>
<tr>
<td style="text-align:center"><em>search</em></td>
<td style="text-align:center">查询？：?a=1&amp;b=2</td>
</tr>
<tr>
<td style="text-align:center"><em>hash</em></td>
<td style="text-align:center">哈希？：TOP</td>
</tr>
</tbody>
</table>
<p>还可以利用对象方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>reload()</em></td>
<td style="text-align:center"><em>location.reload();</em>  // 重新加载当前界面</td>
</tr>
<tr>
<td style="text-align:center"><em>assign()</em></td>
<td style="text-align:center"><em>location.assign(‘<a target="_blank" rel="noopener" href="https://www.baidu.com">https://www.baidu.com</a>’);</em>  // 当前界面打开百度，必须带有协议类型！</td>
</tr>
</tbody>
</table>
<h3 id="history"><em>history</em></h3>
<p>已不推荐使用，简单介绍常用方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>back()</em></td>
<td style="text-align:center"><em>history.back()</em>     // 相当点击浏览器后退按钮</td>
</tr>
<tr>
<td style="text-align:center"><em>forward()</em></td>
<td style="text-align:center"><em>history.forward()</em>   // 相当点击浏览器前进按钮</td>
</tr>
</tbody>
</table>
<blockquote>
<p>不推荐使用的一个实例场景。</p>
</blockquote>
<p>如果我们在登陆成功调用 <em>history.back()</em> 试图回到登陆前界面，又要重新登陆了！</p>
<h3 id="document"><em>document</em></h3>
<p><em>document</em> 对象是浏览器中 <u>DOM树根节点</u> ，可利用它进行操作DOM、获取cookie等，常用属性如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>cookie</em></td>
<td style="text-align:center"><em>document.cookie()</em>  // 获取 <em>cookie</em></td>
</tr>
</tbody>
</table>
<p>更多操作DOM，详见下节分解。</p>
<h2 id="5-2-操作DOM">5.2 操作DOM</h2>
<h3 id="1-获取节点">1.获取节点</h3>
<h4 id="getElementBy…-获取节点"><em>getElementBy…()</em> 获取节点</h4>
<p>注：标签也可称为元素、节点。</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>getElementById()</em></td>
<td style="text-align:center">根据 <u>标签ID属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByName()</em></td>
<td style="text-align:center">根据 <u>name属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByClassName()</em></td>
<td style="text-align:center">根据 <u>标签class属性</u> 来获取节点</td>
</tr>
<tr>
<td style="text-align:center"><em>getElementByTagName()</em></td>
<td style="text-align:center">根据 <u>标签名</u> 来获取节点，如div、img</td>
</tr>
</tbody>
</table>
<blockquote>
<p>一些简单操作实例。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回ID为&#x27;test&#x27;的节点：</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下的所有直属[子节点]:</span></span><br><span class="line"><span class="keyword">var</span> cs = test.children;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取节点test下第一个、最后一个[子节点]：</span></span><br><span class="line"><span class="keyword">var</span> first = test.firstElementChild;</span><br><span class="line"><span class="keyword">var</span> last = test.lastElementChild;</span><br></pre></td></tr></table></figure>
<h4 id="CSS选择器获取节点"><em>CSS</em>选择器获取节点</h4>
<p>我们也可以利用 <u>CSS选择器 <em>selector</em> 语法</u>来获取节点：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>querySelector(selector)</em></td>
<td style="text-align:center">获取满足条件的第一个节点</td>
</tr>
<tr>
<td style="text-align:center"><em>querySelectorAll(selector)</em></td>
<td style="text-align:center">获取满足条件的所有节点</td>
</tr>
</tbody>
</table>
<p>基本选择器用法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">选择器类型</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">标签选择器：<code>标签名</code></td>
<td style="text-align:center"><em>document.querySelector(“div”)</em> //  获取第一个div标签节点</td>
</tr>
<tr>
<td style="text-align:center">类选择器：<code>.类名</code></td>
<td style="text-align:center"><em>document.querySelector(“.key”)</em> // 获取第一个class = key节点</td>
</tr>
<tr>
<td style="text-align:center">ID选择器：<code>#ID名</code></td>
<td style="text-align:center"><em>document.querySelector(“#uid”)</em> // 获取第一个ID = uid 节点</td>
</tr>
<tr>
<td style="text-align:center">属性选择器：<code>[属性=属性名]</code></td>
<td style="text-align:center"><em>document.querySelector(“[type=text]”)</em> // 获取第一个name =&quot; text&quot; 节点</td>
</tr>
</tbody>
</table>
<h5 id="层级选择器">层级选择器</h5>
<p>我们还可以进行选择器组合筛选指定元素后代：</p>
<table>
<thead>
<tr>
<th style="text-align:center">关系选择器组合</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>A B</code></td>
<td style="text-align:center">匹配A元素中的子元素B，B可以是A <u>任意级别后代</u></td>
</tr>
<tr>
<td style="text-align:center"><code>A &gt; B</code></td>
<td style="text-align:center">匹配A元素中的下级子元素B，只能是 <u>直系后代</u></td>
</tr>
<tr>
<td style="text-align:center"><code>A + B</code></td>
<td style="text-align:center">匹配A元素中的任一下一个兄弟元素B（同级）</td>
</tr>
<tr>
<td style="text-align:center"><code>B ~ E</code></td>
<td style="text-align:center">匹配B元素后面的拥有共同父元素的兄弟元素E</td>
</tr>
</tbody>
</table>
<h5 id="过滤器">过滤器</h5>
<p>过滤器一般不单独使用，附加到选择器上更精确定位元素 ：<code>&lt;选择器&gt;：&lt;元素状态关键字&gt;</code></p>
<p>⚠️ 在<em>jQuery</em> 中冒号<code>： </code>和选择器前一定要有空格！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(&#x27;#test-form:radio&#x27;);    // 错误写法：无法选择表单中单选框</span><br><span class="line">$(&#x27;#test-form :radio&#x27;);   // 正确写法，要有空格！</span><br></pre></td></tr></table></figure>
<blockquote>
<p>指定选定元素处于何种状态时的CSS样式 。</p>
</blockquote>
<ul>
<li>
<p>指定a标签处于各种状态的样式</p>
<blockquote>
<p>以 在CSS中修改不同状态<em>a</em> 标签颜色为例。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// link-匹配当前元素连接</span></span><br><span class="line"><span class="attr">a</span> :link &#123;<span class="attr">color</span>: slategray;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// visited-匹配已访问过的连接</span></span><br><span class="line"><span class="attr">a</span> :link &#123;<span class="attr">color</span>: #4b2f89;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// active-匹配元素当中激活状态（鼠标悬停）的链接</span></span><br><span class="line"><span class="attr">a</span> :active &#123;<span class="attr">color</span>: blue;&#125;</span><br><span class="line">             </span><br><span class="line"><span class="comment">// hover-匹配元素当中未激活状态的链接</span></span><br><span class="line"><span class="attr">a</span> :hover &#123;<span class="attr">color</span>: blue;&#125;             </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>匹配一组兄弟元素某元素</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:first-child</em></td>
<td style="text-align:center">匹配一组p标签第一个p标签：<em>p:first-child</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:nth-child()</em></td>
<td style="text-align:center">匹配一组p标签第一个p标签：<em>p:nth-child(1)</em></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">匹配表格中的奇数行：<em>tr:nth-child(2n+1)</em></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">匹配表格中的偶数行：<em>tr:nth-child(2n)</em></td>
</tr>
</tbody>
</table>
<p>更多：<em>:nth-last-child(an + b)、:nth-of-type(an+b)、:last-of-type</em> …</p>
</li>
<li>
<p>表单相关</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:input</em></td>
<td style="text-align:center">选择 <u>表单</u> 以下标签：<code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>，<code>&lt;select&gt;</code>和<code>&lt;button&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>:enabled</em></td>
<td style="text-align:center">选择 <u>表单</u> 可以正常输入的<code>&lt;input&gt;</code>、<code>&lt;select&gt;</code> ：<em>$(‘#test-form :enabled’)</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:disabled</em></td>
<td style="text-align:center">选择 <u>表单</u> 那些不能输入的 <code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>：<em>$(‘#test-form :disabled’)</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:file</em></td>
<td style="text-align:center">选择文件： <em>input : file   === input[type=file]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:checkbox</em></td>
<td style="text-align:center">选择复选框：<em>input : checkbox=== input[type=checkbox]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:radio</em></td>
<td style="text-align:center">选择单选框：<em>input : radio   === input[type=radio]</em></td>
</tr>
<tr>
<td style="text-align:center"><em>:focus</em></td>
<td style="text-align:center">选择当前输入焦点：例如把光标放到一个<code>&lt;input&gt;</code>上，<em>$(‘input:focus’)</em> 便可选中</td>
</tr>
<tr>
<td style="text-align:center"><em>:checked</em></td>
<td style="text-align:center">选择当前勾上的单选框和复选框：<em>$(‘input[type=radio]:checked’)</em></td>
</tr>
</tbody>
</table>
<blockquote>
<p>选择表单<em>id = test-form</em> 下所有 <code>&lt;input&gt;</code>，<code>&lt;textarea&gt;</code>，<code>&lt;select&gt;</code>和<code>&lt;button&gt;</code> 节点。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无法用：document.querySelectorALL(&#x27;#test-form :input&#x27;) ？？</span></span><br><span class="line">$(<span class="string">&#x27;#test-form :input&#x27;</span>);   </span><br></pre></td></tr></table></figure>
</li>
<li>
<p>其它更多</p>
<table>
<thead>
<tr>
<th style="text-align:center">分类</th>
<th style="text-align:center">实例</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>:empty</em></td>
<td style="text-align:center">匹配没有子元素的元素</td>
</tr>
<tr>
<td style="text-align:center"><em>:target</em></td>
<td style="text-align:center">用于匹配URI中的ID标识（即：锚点）部分</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="获取节点基本信息">获取节点基本信息</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以获取基本属性等信息，不存在的属性字符串类型返回空字符串 <code>“”</code> ，布尔类型默认返回 <code>false</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> u = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取存在的属性</span></span><br><span class="line">u.type;    <span class="comment">// &quot;text&quot;</span></span><br><span class="line">u.id;      <span class="comment">// &quot;user&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取不存在的属性</span></span><br><span class="line">u.name;    <span class="comment">// &quot;&quot;</span></span><br><span class="line">u.checked; <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 文本框值</span></span><br><span class="line">u.value ;  <span class="comment">// &quot;hwh&quot;，已经在文本框中输入hwh</span></span><br></pre></td></tr></table></figure>
<h3 id="2-更新DOM">2.更新DOM</h3>
<h4 id="更新DOM节点文本">更新DOM节点文本</h4>
<p>我们常用以下属性对DOM节点文本内容进行修改：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>innerHTML</em></td>
<td style="text-align:center">可以插入HTML标签 &amp; 字符串</td>
</tr>
<tr>
<td style="text-align:center"><em>innerText</em></td>
<td style="text-align:center">只能插入字符串，插入HTML标签会解析成字符串</td>
</tr>
<tr>
<td style="text-align:center"><em>textContent</em></td>
<td style="text-align:center">同上，但会返回所有文本包括隐藏文本</td>
</tr>
</tbody>
</table>
<blockquote>
<p>更新标签、字符串实例。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span> test <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;content&#x27;</span>);</span><br><span class="line">c.innerText; <span class="comment">// 输出：&quot;test&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.插入HTML</span></span><br><span class="line">c.innerHTML = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;      <span class="comment">// 打开浏览器div标签内输出：hello test!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.插入字符串</span></span><br><span class="line">c.innerText = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;      <span class="comment">// 打开浏览器div标签内输出：&lt;p&gt; hello test!&lt;/p&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.插入字符串</span></span><br><span class="line">c.textContent = <span class="string">&#x27;&lt;p&gt; hello test!&lt;/p&gt;&#x27;</span>;    <span class="comment">// 打开浏览器div标签内输出：&lt;p&gt; hello test!&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="更新CSS样式">更新CSS样式</h4>
<p>获取节点后，利用 <em>style</em> 属性进行样式设置。</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>style</em></td>
<td style="text-align:center">DOM节点 <em>style</em> 属性对应所有的CSS，可直接获取OR设置。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>进行简单CSS样式设置。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> c = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;content&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置CSS</span></span><br><span class="line">c.style.color = <span class="string">&#x27;#ff0000&#x27;</span>;</span><br><span class="line">c.style.fontSize = <span class="string">&#x27;1200px&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>⚠️ 注意 <u><em>fontSize</em></u> 等在<em>javaScript</em> 中是驼峰命名，而在CSS中是 <u><em>font-size</em></u>  ！</p>
<h3 id="3-插入DOM">3.插入DOM</h3>
<p>在前我们利用：<code>c.innerHTML = '&lt;p&gt; hello test!&lt;/p&gt;';</code>  可以在<code>&lt;div&gt; ... &lt;/div&gt;</code>插入HTML标签，但是会替换掉里面所有DOM节点内容。</p>
<p>为此我们可以利用以下方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>appendChild(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>最后一个子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>insertBefore(newElem，ref)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>另一个子节点<em>ref</em>前</u></td>
</tr>
</tbody>
</table>
<p>下面为预设好的HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建一个新节点：<code>&lt;li id=&quot;javascript&quot;&gt;javascript&lt;/li&gt;</code> 插入到列表末尾。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新节点</span></span><br><span class="line"><span class="keyword">var</span> li_js =  <span class="built_in">document</span>.createElement(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">li_js.id = <span class="string">&#x27;python&#x27;</span>;</span><br><span class="line">li_js.innerText = <span class="string">&#x27;javaScript&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入到末尾</span></span><br><span class="line">ul_pl.appendChild(li_js);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>创建一个新节点：<code>&lt;li id=&quot;C++&quot;&gt;C++&lt;/li&gt;</code> 插入到列 <code>python</code> 前。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> li_py = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;python&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新节点</span></span><br><span class="line"><span class="keyword">var</span> li_cpp =  <span class="built_in">document</span>.createElement(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">li_cpp.id = <span class="string">&#x27;C++&#x27;</span>;</span><br><span class="line">li_cpp.innerText = <span class="string">&#x27;C++&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入到末尾</span></span><br><span class="line">ul_pl.insertBefore(li_cpp,li_py);</span><br></pre></td></tr></table></figure>
<h3 id="4-删除DOM">4. 删除DOM</h3>
<p>要删除一个节点，首先要获得该节点本身以及它的父节点，然后调用父节点的<code>removeChild()</code>把自己删掉：</p>
<blockquote>
<p>删除指定列表第三个节点。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ul_pl = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;programLanguage&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取列表第三个子节点</span></span><br><span class="line"><span class="keyword">var</span> li3 = ul_pl.children[<span class="number">2</span>];</span><br><span class="line"><span class="comment">// 调用该付节点删除该子节点</span></span><br><span class="line">ul_pl.removeChild(li3);</span><br></pre></td></tr></table></figure>
<p>⚠️ 注意：</p>
<ul>
<li>DOM树中节点虽然被删除，但是还在内存中，可以随时被添加到别的位置</li>
<li><code>children</code>属性 <u>实时变化</u>，删除后<code>父节点.chidren</code>返回的列表会对应减少</li>
</ul>
<h2 id="5-3-操作表单">5.3 操作表单</h2>
<h3 id="常用表单元素">常用表单元素</h3>
<p>&lt;form&gt; 元素定义 HTML 表单，收集用户输入 ：<code>&lt;form&gt;... 表单元素...&lt;/form&gt;</code> 。以下是常用表单元素：</p>
<center>常用表单元素</center>
<table>
<thead>
<tr>
<th style="text-align:center">表单元素</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">&lt;input&gt;</td>
<td style="text-align:center">最重要的表单元素，含有<u>不同类型的 input 元素</u> 、复选框、单选按钮、提交按钮等。</td>
</tr>
<tr>
<td style="text-align:center">&lt;select&gt;</td>
<td style="text-align:center">定义下拉列表：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230361276.png" alt="1565230361276"></td>
</tr>
<tr>
<td style="text-align:center">&lt;textarea&gt;</td>
<td style="text-align:center">定义多行输入文本域：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230342229.png" alt="1565230342229"></td>
</tr>
<tr>
<td style="text-align:center">&lt;button&gt;</td>
<td style="text-align:center">按钮：点击后出发onclick事件代码，输出Hello World!<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565230477491.png" alt="1565230477491"></td>
</tr>
</tbody>
</table>
<p><u>不同类型的 input 元素</u> ：有复选框、单选按钮、提交按钮等：</p>
<center>常用input类型</center>
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>text</em></td>
<td style="text-align:center">文本输入：<code>&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>password</em></td>
<td style="text-align:center">密码输入：<code>&lt;input type=&quot;password&quot; name=&quot;psw&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>submit</em></td>
<td style="text-align:center">提交表单按钮：<code>&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</code></td>
</tr>
<tr>
<td style="text-align:center"><em>radio</em></td>
<td style="text-align:center">单选按钮： ○<em>Male</em>  ○<em>Female</em> （多个单选按钮组合成 <u>多选一</u> ，name要相同）  <img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231160124.png" alt="1565231160124"></td>
</tr>
<tr>
<td style="text-align:center"><em>checkbox</em></td>
<td style="text-align:center">复选框：□ <em>I have a bike</em>  □ <em>I have a car</em><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231125219.png" alt="1565231125219"></td>
</tr>
<tr>
<td style="text-align:center"><em>button</em></td>
<td style="text-align:center">和前表单元素button类似，但没有后面&lt;/button&gt;：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231341774.png" alt="1565231341774"></td>
</tr>
<tr>
<td style="text-align:center"><em>number</em></td>
<td style="text-align:center">输入数值，并可对其作出限制：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231462510.png" alt="1565231462510"></td>
</tr>
<tr>
<td style="text-align:center"><em>date</em></td>
<td style="text-align:center">包含日期的输入字段：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565232828624.png" alt="1565232828624"></td>
</tr>
<tr>
<td style="text-align:center"><em>color</em></td>
<td style="text-align:center">颜色选择器会出现输入字段：<img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565231606516.png" alt="1565231606516"></td>
</tr>
</tbody>
</table>
<p>更多输入类型：time（时间选择器）、datetime &amp; datetime-local（日期选择器）、search（搜索字段类似文本字段）、tel &amp; url &amp; email （可自动验证是否是电话、网址、邮箱地址）</p>
<h3 id="操作表单">操作表单</h3>
<h4 id="操作值">操作值</h4>
<p>对于 <code>text</code>、<code>password</code>、<code>hidden</code>以及<code>select</code> 等直接<em>value</em> 获取、设置值即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;input type=&quot;text&quot; name = &quot;username&quot;&gt;</span></span><br><span class="line"><span class="keyword">var</span> input = <span class="built_in">document</span>.getElementsByName(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line"></span><br><span class="line">input.value; <span class="comment">// 用户输入值</span></span><br><span class="line">input.value = <span class="string">&quot;hello!&quot;</span>;  <span class="comment">// 设置值</span></span><br></pre></td></tr></table></figure>
<p>对于 <code>radio</code> 、<code>checkbox</code>，如果获取 <em>value</em> 始终是预设值，不能获取用户输入选择值。</p>
<p>应该用节点 <code>checked</code>属性判断用户选中：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&lt;form&gt;</span></span><br><span class="line"><span class="comment">&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; id=&quot;b&quot; value=&quot;Bike&quot;&gt;I have a bike</span></span><br><span class="line"><span class="comment">&lt;input type=&quot;checkbox&quot; name=&quot;vehicle&quot; id=&quot;c&quot; value=&quot;Car&quot;&gt;I have a car </span></span><br><span class="line"><span class="comment">&lt;/form&gt; </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> bike = <span class="built_in">document</span>.getElementsById(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(bike.checked)</span><br><span class="line">&#123;</span><br><span class="line">     <span class="comment">// do something</span></span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">bike.checked = <span class="literal">false</span>; <span class="comment">// 设置按钮未被选中</span></span><br></pre></td></tr></table></figure>
<h4 id="提交表单">提交表单</h4>
<p>HTML 表单用于收集用户输入，比如下例收集用户输入的账号、密码验证登陆：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565691221197.png" alt="1565691221197"></p>
<p>提交表单一般有如下三种方法：</p>
<ul>
<li>通过 <em><input type="submit"></em> 按钮提交</li>
<li>通过 <em>form</em> 对象 <em>submit()</em> 方法提交</li>
<li><em>ajax</em> 方式提交</li>
</ul>
<h5 id="type-“submit”-表单提交"><em>type=“submit”</em> 表单提交</h5>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;demo_form.asp&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><em>action</em> 属性：定义提交表单执行的动作，如果省略则会被置为当前页面。在这里提交的表单值会交给脚本代码 <em>demo_form.asp</em> 处理。</li>
<li><em>method</em> 属性：定义提交方式为<em>GET</em> 或者 <em>POST</em></li>
</ul>
<p>点击 <em>立即登陆</em> 按钮后，会自动把表单值提交给脚本文件 <em>demo_form.asp</em> 处理 。</p>
<p>服务器接收到的提交内容为（<em>GET</em> 方式提交）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=hwh&amp;pwd=123456</span><br></pre></td></tr></table></figure>
<p>⚠️ 只有设置 <em>name</em> 属性的表单值才会被提交，提交的值构造方式为：<em>name1:value1&amp;name2:value2…</em></p>
<h5 id="submit-方法提交"><em>submit()</em> 方法提交</h5>
<p>可以通过：<em><u>点击button</u></em>、<em><u>点击链接</u></em> 等方式触发事件，<em>js</em> 调用<em>form</em> DOM对象<em>submit()</em> 方法提交表单数据。</p>
<p>⚠️ 不推荐这种方式，扰乱了原有浏览器提交表单。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;demo_form.asp&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;btn&#x27;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;submitForm()&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>和前面 <u><em>type=“submit”</em> 表单提交方式</u>  对比，<em>type=“submit”</em> 被修改为 —&gt; <em>type=“button”</em></li>
<li><em>button</em>  按钮设置了属性 <em>onclick</em> ，绑定<em>click</em> 事件执行 <em>submitForm()</em> 函数。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">&quot;demo_form&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     form.submit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可用 <em>jQuery</em> 实现 ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> form = $(<span class="string">&quot;#demo_form&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> button = $(<span class="string">&quot;#btn&quot;</span>);</span><br><span class="line">button.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       form.submit();</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>服务器接收到的提交内容为（<em>GET</em> 方式提交）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=hwh&amp;pwd=123456</span><br></pre></td></tr></table></figure>
<h5 id="ajax-提交"><em>ajax</em> 提交</h5>
<p><em>ajax</em> 方式提交需要先理解 <u>5.5 <em>AJAX</em></u> 一节。</p>
<p><em>html</em> 代码部分：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;demo_form&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;text-align: center&#x27;</span> <span class="attr">method</span>=<span class="string">&quot;GET&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span> <span class="attr">name</span> = <span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>   </span><br><span class="line">     <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;btn&#x27;</span> <span class="attr">value</span>=<span class="string">&quot;立即登陆&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;submitForm()&quot;</span> <span class="attr">style</span>=<span class="string">&#x27;width:210px&#x27;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>点击登陆按钮，发送 <em>ajax</em> 请求</li>
</ul>
<p><em>js</em> 代码部分：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">            alert(xmlhttp.responseText)</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/demo_form.asp&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>🙂 也可用 <em>jQuery</em> 实现 <em>ajax</em> 请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">submitForm</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">var</span> userName = $(<span class="string">&#x27;#user&#x27;</span>).val();</span><br><span class="line">     <span class="keyword">var</span> password = $(<span class="string">&#x27;#pwd&#x27;</span>).val();</span><br><span class="line">     $.ajax</span><br><span class="line">     (</span><br><span class="line">     &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&quot;Get&quot;</span>,</span><br><span class="line">      <span class="attr">url</span>: <span class="string">&quot;/demo_form.asp&quot;</span>,</span><br><span class="line">      <span class="attr">username</span>: userName,</span><br><span class="line">      <span class="attr">password</span>:password,</span><br><span class="line">      <span class="attr">dataType</span> : <span class="string">&quot;json&quot;</span>,</span><br><span class="line">      <span class="attr">success</span>: <span class="function"><span class="keyword">function</span>(<span class="params">respMsg</span>)</span>&#123;&#125;</span><br><span class="line">     &#125;</span><br><span class="line">     );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="更多提交方式">更多提交方式</h5>
<p>更多提交方式，参考：<a target="_blank" rel="noopener" href="http://www.anyrt.com/blog/list/submit.html">六种提交 <em>form</em> 表单方式</a></p>
<h2 id="5-4-操作文件">5.4 操作文件</h2>
<p>用到再提。</p>
<h2 id="5-5-AJAX">5.5 <em>AJAX</em></h2>
<h3 id="什么是-AJAX">什么是 <em>AJAX</em> ?</h3>
<p>传统的网页（不使用 <em>AJAX</em>）如果需要更新内容，必需重载整个网页面。</p>
<blockquote>
<p>如何不重新加载界面更新内容？</p>
</blockquote>
<p><em>AJAX = 异步 JavaScript 和 XML</em>，可以实现网页异步更新，这意味着不重新加载网页而进行更新。</p>
<h3 id="AJAX-应用实例"><em>AJAX</em> 应用实例</h3>
<p>当我们使用百度搜索，在输入框输入搜索内容时，通过<em>AJAX</em>和服务器进行请求返回一列推荐搜索结果。在这个过程中，并没有重新加载界面。</p>
<blockquote>
<p>那么在前端和服务器后台都是具体怎么实现沟通呢？这里以一个推荐姓名实例demo为例。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565667374702.png" alt="1565667374702"></p>
<h4 id="PART1-：-前端html"><em>PART1</em> ： 前端<em>html</em></h4>
<p>前端 <em>html</em> 实现见下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"> <span class="comment">// ajax部分...</span></span></span><br><span class="line"><span class="javascript">    </span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>请在下面的输入框中键入字母（A - Z）：<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span> </span><br><span class="line">姓氏：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;txt1&quot;</span> <span class="attr">onkeyup</span>=<span class="string">&quot;showHint(this.value)&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>建议：<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;txtHint&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="PART2-：前端-js-实现-AJAX"><em>PART2</em> ：前端 <em>js</em>  实现 <em>AJAX</em></h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax部分...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">res</span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">res</span>)    </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             success(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             fail(xmlhttp.responseText); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以下细分<em>ajax</em> 执行过程：</p>
<ol>
<li>
<p>创建对象</p>
<p>现代浏览器使用 <em>XMLHttpRequest</em> 对象  用于在后台与服务器交换数据：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
<p>对于IE5、6不得不使用 <em>ActiveXObject</em>  对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xmlhttp=<span class="keyword">new</span> XMLHttpRequest();</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>发送请求</p>
<p>如需将请求发送到服务器，我们使用 <em>XMLHttpRequest</em> 对象的 <em>open() &amp; send()</em> 方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>open(method,url,async)</em></td>
<td style="text-align:center">规定：<em>请求的类型</em>、<em>URL处理脚本文件</em>  、<em>是否异步处理请求</em></td>
</tr>
<tr>
<td style="text-align:center"><em>send(string)</em></td>
<td style="text-align:center">将请求发送到服务器：<em>string</em> 参数仅用于 <em>POST</em> 请求</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">xmlhttp.send();</span><br></pre></td></tr></table></figure>
<ul>
<li>请求方法为<em>GET</em> 类型，在以下情况推荐使用 <em>POST</em> 请求：
<ul>
<li>无法使用缓存文件（更新服务器上的文件或数据库）</li>
<li>向服务器发送大量数据（POST 没有数据量限制）</li>
<li>发送包含未知字符的用户输入时，POST 比 GET 更稳定也更可靠</li>
</ul>
</li>
<li><em>url = /ajax/gethint.asp?q= str</em> ：<em>/ajax/gethint.asp</em> 是处理脚本通常为 <em>ASP/PHP</em> 文件 ；<em>?q=str</em>  是请求的参数，<em>GET</em> 方式必须向<em>URL</em> 添加信息。</li>
<li><em>true</em> ：表示开启异步，<em>XMLHttpRequest</em> 对象如果要用于 <em>AJAX</em> 的话必须设置为 <em>true</em> 。</li>
</ul>
</li>
<li>
<p>服务器响应</p>
<p>如需获得来自服务器的响应，使用 <em>XMLHttpRequest</em> 对象的 <em>responseText</em> 、 <em>responseXML</em> 属性：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>responseText</em></td>
<td style="text-align:center">获得字符串形式的响应数据</td>
</tr>
<tr>
<td style="text-align:center"><em>responseXML</em></td>
<td style="text-align:center">获得 <em>XML</em> 形式的响应数据</td>
</tr>
</tbody>
</table>
<p>同时，通过脚本和服务器交互过程，我们需要根据连接状态来触发执行操作。我们可以使用<em>XMLHttpRequest</em> 对象的 <em>onreadystatechange</em> 事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>onreadystatechange</em></td>
<td style="text-align:center">存储函数（或函数名），每当 <em>readyState</em> 属性改变时，就会调用该函数。</td>
</tr>
</tbody>
</table>
<p><em>readyState</em> 同前 <em>responseText</em> 、 <em>responseXML</em> 也是<em>XMLHttpRequest</em> 对象属性：</p>
<table>
<thead>
<tr>
<th style="text-align:center">属性</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>readyState</em></td>
<td style="text-align:center">存有 <em>XMLHttpRequest</em> 的状态：从 0 --&gt;  4 发生变化</td>
</tr>
<tr>
<td style="text-align:center"><em>status</em></td>
<td style="text-align:center">200: “OK”     404: 未找到页面</td>
</tr>
</tbody>
</table>
<p>对应实际代码为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">      &#123;</span><br><span class="line">           success(xmlhttp.responseText);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">           fail(xmlhttp.responseText); </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="PART3-：服务器端-ASP-脚本"><em>PART3</em> ：服务器端*.ASP* 脚本</h4>
<p>以下为 <em>gethint.asp</em> 文件，根据用户输入字母返回推荐的名字：</p>
<blockquote>
<p>🙂 当然你也可以用 <em>PHP</em>  实现，这里从略。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">response.expires=-1</span><br><span class="line">dim a(30)</span><br><span class="line">&#x27;用名字来填充数组</span><br><span class="line">a(1)=&quot;Anna&quot;</span><br><span class="line">a(2)=&quot;Brittany&quot;</span><br><span class="line">a(3)=&quot;Cinderella&quot;</span><br><span class="line">a(4)=&quot;Diana&quot;</span><br><span class="line">a(5)=&quot;Eva&quot;</span><br><span class="line">a(6)=&quot;Fiona&quot;</span><br><span class="line">a(7)=&quot;Gunda&quot;</span><br><span class="line">a(8)=&quot;Hege&quot;</span><br><span class="line">a(9)=&quot;Inga&quot;</span><br><span class="line">a(10)=&quot;Johanna&quot;</span><br><span class="line">a(11)=&quot;Kitty&quot;</span><br><span class="line">a(12)=&quot;Linda&quot;</span><br><span class="line">a(13)=&quot;Nina&quot;</span><br><span class="line">a(14)=&quot;Ophelia&quot;</span><br><span class="line">a(15)=&quot;Petunia&quot;</span><br><span class="line">a(16)=&quot;Amanda&quot;</span><br><span class="line">a(17)=&quot;Raquel&quot;</span><br><span class="line">a(18)=&quot;Cindy&quot;</span><br><span class="line">a(19)=&quot;Doris&quot;</span><br><span class="line">a(20)=&quot;Eve&quot;</span><br><span class="line">a(21)=&quot;Evita&quot;</span><br><span class="line">a(22)=&quot;Sunniva&quot;</span><br><span class="line">a(23)=&quot;Tove&quot;</span><br><span class="line">a(24)=&quot;Unni&quot;</span><br><span class="line">a(25)=&quot;Violet&quot;</span><br><span class="line">a(26)=&quot;Liza&quot;</span><br><span class="line">a(27)=&quot;Elizabeth&quot;</span><br><span class="line">a(28)=&quot;Ellen&quot;</span><br><span class="line">a(29)=&quot;Wenche&quot;</span><br><span class="line">a(30)=&quot;Vicky&quot;</span><br><span class="line"></span><br><span class="line">&#x27;获得来自 URL 的 q 参数</span><br><span class="line">q=ucase(request.querystring(&quot;q&quot;))</span><br><span class="line"></span><br><span class="line">&#x27;如果 q 大于 0，则查找数组中的所有提示</span><br><span class="line">if len(q)&gt;0 then</span><br><span class="line">  hint=&quot;&quot;</span><br><span class="line">  for i=1 to 30</span><br><span class="line">    if q=ucase(mid(a(i),1,len(q))) then</span><br><span class="line">      if hint=&quot;&quot; then</span><br><span class="line">        hint=a(i)</span><br><span class="line">      else</span><br><span class="line">        hint=hint &amp; &quot; , &quot; &amp; a(i)</span><br><span class="line">      end if</span><br><span class="line">    end if</span><br><span class="line">  next</span><br><span class="line">end if</span><br><span class="line"></span><br><span class="line">&#x27;如果未找到提示，则输出 &quot;no suggestion&quot;</span><br><span class="line">&#x27;否则输出正确的值</span><br><span class="line">if hint=&quot;&quot; then</span><br><span class="line">  response.write(&quot;no suggestion&quot;)</span><br><span class="line">else</span><br><span class="line">  response.write(hint)</span><br><span class="line">end if</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<h3 id="jQuery-ajax"><em>jQuery</em> &amp; <em>ajax</em></h3>
<p><em>jQuery</em> 提供了对<em>JavaScript</em> <em>ajax</em> 高度的封装<em>API</em> ，常用方法如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">函数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>$.ajax({name:val, name:val,…})</em></td>
<td style="text-align:center"><strong>常用于其他<em>jQuery Ajax</em>方法不能完成的请求</strong></td>
</tr>
<tr>
<td style="text-align:center"><em>$.post(url, data, func, dataType)</em></td>
<td style="text-align:center"><em>POST</em>方式执行<em>Ajax</em>请求，从服务器加载数据。</td>
</tr>
<tr>
<td style="text-align:center"><em>$.get(url, data, func, dataType)</em></td>
<td style="text-align:center"><em>GET</em>方式执行<em>Ajax</em>请求，从服务器加载数据。</td>
</tr>
<tr>
<td style="text-align:center"><em>$.getJSON(url, data, func)</em></td>
<td style="text-align:center"><em>GET</em>方式从服务器加载<em>JSON</em>格式数据。相较于$.get()不必再指定<em>dataType</em></td>
</tr>
<tr>
<td style="text-align:center"><em>$.load(url, data, func)</em></td>
<td style="text-align:center"><em>POST</em>方式将服务器加载的数据插入指定DOM中，<u><em>data</em>不存在则以<em>GET</em>方式</u></td>
</tr>
<tr>
<td style="text-align:center"><em>$.getScript(url, func)</em></td>
<td style="text-align:center"><em>GET</em>方式执行<em>Ajax</em>请求，从服务器加载并执行回传的<em>JavaScript</em>。</td>
</tr>
</tbody>
</table>
<p>注：上述方法 <em>func</em> 都是指在方法完成后执行的回调（<em>callback</em>）函数 。</p>
<ul>
<li>格式：<em>func(data, status, xhr)</em></li>
<li>参数：<em>data</em> — 服务器返回数据；<em>status</em> — 响应状态 ；<em>xhr</em> – <em>XMLHttpRequest</em>对象。一般关注 <em>data</em> 即可。</li>
</ul>
<h4 id="ajax"><em>$.ajax()</em></h4>
<p><em><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">.</mi><mi>a</mi><mi>j</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>∗</mo><mtext>完整参数形式为：</mtext><mo>∗</mo></mrow><annotation encoding="application/x-tex">.ajax()* 完整参数形式为：*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord mathnormal">aja</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">完整参数形式为：</span><span class="mord">∗</span></span></span></span>.ajax({name:val, name:val,…})</em> ，其参数为一个对象 <strong>{}</strong> ，可选字段为：</p>
<ul>
<li><em><strong>url</strong></em>：链接地址，字符串表示</li>
<li><em><strong>data</strong></em>：需发送到服务器的数据，<em>GET、POST</em>都可以，格式为 <em>{A: ‘…’, B: ‘…’}</em></li>
<li><em><strong>type</strong></em>：指定请求类型为：“POST” 或 “GET”</li>
<li><em>timeout</em>：请求超时时间 / 毫秒</li>
<li><em>cache</em>：是否缓存请求结果，<em>bool</em>表示</li>
<li><em>contentType</em>：内容类型，默认为 <em>“application/x-www-form-urlencoded”</em></li>
<li><em><strong>dataType</strong></em>：<u>服务器响应的数据类型</u>，<u>字符串表示</u></li>
<li><em>success</em>：请求成功后，服务器回调的函数</li>
<li><em>error</em>：请求失败后，服务器回调的函数</li>
<li><em>complete</em>：请求完成后调用的函数，无论请求是成功还是失败，都会调用该函数；<u>如果设置了success与error</u>函数，则该函数在它们之后被调用</li>
<li><em><strong>async</strong></em>：是否异步处理，bool表示，默认为true；设置该值为false后，JS不会向下执行，而是原地等待服务器返回数据，并完成相应的回调函数后，再向下执行</li>
<li><em><strong>username</strong></em>：访问认证请求中携带的用户名，字符串表示</li>
<li><em><strong>password</strong></em>：返回认证请求中携带的密码，字符串表示</li>
</ul>
<blockquote>
<p>下面通过 <em>$.ajax()</em> 方法请求服务器加载一个txt文本。</p>
</blockquote>
<p>html代码部分：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>通过 AJAX 改变文本<span class="tag">&lt;/<span class="name">h2</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;b01&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>点我加载txt<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// ajax实现部分...</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565842814777.png" alt="1565842814777"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span></span><br><span class="line">   &#125;);</span><br><span class="line">   $(<span class="string">&quot;#myDiv&quot;</span>).html(htmlobj.responseText);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565843001023.png" alt="1565843001023"></p>
<h5 id="回调函数">回调函数</h5>
<p>也可使用回调函数，如果成功就显示：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span>,</span><br><span class="line">      <span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(data); &#125;</span><br><span class="line">   &#125;);  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>回调函数<em>success</em>有参数 <em>data</em> ，接收服务器返回数据，这里接收的是文本：<em>test1.txt</em> 。</p>
</li>
<li>
<p>也可以使用链式调用回调函数，类似前面 <em>Promise</em> ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  htmlobj=$.ajax</span><br><span class="line">  (&#123;</span><br><span class="line">      <span class="attr">url</span>:<span class="string">&quot;/jquery/test1.txt&quot;</span>,</span><br><span class="line">      <span class="attr">type</span>:<span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      <span class="attr">async</span>:<span class="literal">false</span></span><br><span class="line">   &#125;)</span><br><span class="line">  .done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(data); &#125;)</span><br><span class="line">  .fail(<span class="function"><span class="keyword">function</span> (<span class="params">xhr,status</span>)</span>&#123; $(<span class="string">&quot;#myDiv&quot;</span>).html(<span class="string">&#x27;失败:&#x27;</span>+xhr.status+<span class="string">&#x27;原因:&#x27;</span>+  status);&#125;)</span><br><span class="line">  .always(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="string">&#x27;请求完成: 无论成功或失败都会调用&#x27;</span>);&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="get"><em>$.get()</em></h4>
<p>简单的 <em>GET</em> 请求功能以*<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">.</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>∗</mo><mtext>取代复杂</mtext><mo>∗</mo></mrow><annotation encoding="application/x-tex">.get()* 取代复杂 *</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord cjk_fallback">取代复杂</span><span class="mord">∗</span></span></span></span>.ajax()* ，请求成功时可调用回调函数。</p>
<p>其格式为：<em>$.get(url, data, func, dataType)</em></p>
<ul>
<li><em>url</em>：链接地址，字符串表示</li>
<li><em>data</em>：需要发生到服务器的数据，以键值对形式</li>
<li><em>func(data, status, xhr)</em>：回调函数，<em>data</em> — 服务器返回数据；<em>status</em> — 响应状态 ；<em>xhr</em> – <em>XMLHttpRequest</em>对象。一般关注 <em>data</em> 即可。</li>
<li><em>dataType</em>：服务器返回数据的格式</li>
</ul>
<blockquote>
<p>以*$.get()* 实现上述点击按钮加载指定文本。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   htmlobj=$.get(<span class="string">&quot;/jquery/test1.txt&quot;</span></span><br><span class="line">   ,<span class="function"><span class="keyword">function</span>(<span class="params">data,status</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       $(<span class="string">&quot;#myDiv&quot;</span>).html(data);</span><br><span class="line">   &#125;);   </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>回调函数<em>function(data,status)</em> 参数<em>data、status</em> 分别接收服务器返回的数据、状态。</li>
</ul>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565843001023.png" alt="1565843001023"></p>
<p>⚠️ 经过测试，似乎只能在回调函数里接收数据，像*$.ajax()* 一样用<em>responseText</em> 获取返回数据不成功：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax实现部分...</span></span><br><span class="line">$(<span class="string">&quot;#b01&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   htmlobj=$.get(<span class="string">&quot;/jquery/test1.txt&quot;</span>);</span><br><span class="line">   $(<span class="string">&quot;#myDiv&quot;</span>).html(htmlobj.responseText); <span class="comment">// 点击按钮加载数据不成功？？！</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="post"><em>$.post()</em></h4>
<p>和  <em>$.get()</em> 类似，接收参数一致，除了请求方式变为了 <em>post</em> 方式。</p>
<p>其格式为：<em>$.post(url, data, func, dataType)</em></p>
<blockquote>
<p>向指定界面发送 <em>HTTP POST</em> 请求，并获得返回的结果 。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565858154265.png" alt="1565858154265"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 城市：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;city&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>发送 POST 请求，获取返回结果 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript"></span>&#123;</span></span><br><span class="line"><span class="javascript">      $.post(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span></span><br><span class="line"><span class="javascript">      &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span></span><br><span class="line"><span class="javascript">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span></span><br><span class="line"><span class="javascript">      &#125;,</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span>(<span class="params">data,status</span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript">      </span>&#123;</span></span><br><span class="line"><span class="javascript">          $(<span class="string">&#x27;#myDiv&#x27;</span>).html(<span class="string">&quot;数据：&quot;</span> + data + <span class="string">&quot;&lt;br&gt;状态：&quot;</span> + status);</span></span><br><span class="line"><span class="javascript">      &#125;);</span></span><br><span class="line"><span class="javascript">&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="load"><em>$.load()</em></h4>
<p><em>$.load()</em> 如果数据存在则以 <em>POST</em> 方式（不存在则以 <em>GET</em> 方式）加载服务器返回的数据到 <u>指定 DOM 节点</u>中 。</p>
<p>其格式为：<em>$(selector).load(URL,data,func)</em>。</p>
<h5 id="举个例子">举个例子</h5>
<blockquote>
<p>依旧以上 <em>$.post()</em> 所举实例为例，加载服务器返回的结果到指定节点中。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859062033.png" alt="1565859062033"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span> 城市：<span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&#x27;city&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>发送 POST 请求，获取返回结果 <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myDiv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript"></span>&#123;</span></span><br><span class="line"><span class="javascript">   </span></span><br><span class="line"><span class="javascript">      $(<span class="string">&#x27;#myDiv&#x27;</span>).load(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span></span><br><span class="line"><span class="javascript">      &#123;</span></span><br><span class="line"><span class="javascript">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span></span><br><span class="line"><span class="javascript">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">      );</span></span><br><span class="line"><span class="javascript">&#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面会将返回的结果自动加载到指定节点 <em><u>#myDiv</u></em> 中，当然你也可以使用回调函数来自定义加载：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;button&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   </span><br><span class="line">      $(<span class="string">&#x27;#myDiv&#x27;</span>).load(<span class="string">&quot;/example/jquery/demo_test_post.asp&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="attr">name</span>:$(<span class="string">&#x27;#user&#x27;</span>).val(),</span><br><span class="line">          <span class="attr">city</span>:$(<span class="string">&#x27;#city&#x27;</span>).val()</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="function"><span class="keyword">function</span>(<span class="params">data,status,xhr</span>)</span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">         $(<span class="string">&#x27;#myDiv&#x27;</span>).html(<span class="string">&quot;数据：&quot;</span> + data + <span class="string">&quot;&lt;br&gt;状态：&quot;</span> + status);</span><br><span class="line">      &#125;</span><br><span class="line">      );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>回调函数参数意义同前，显示结果为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859613517.png" alt="1565859613517"></p>
<h5 id="再举个例子">再举个例子</h5>
<p>也可直接加载<em>url</em> 指定资源，不用传递其它参数。</p>
<blockquote>
<p>点击按钮后，指定节点直接加载 <em>demo_test.txt</em> 文件内容。</p>
</blockquote>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565860429522.png" alt="1565860429522"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/jquery/jquery-1.11.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">&quot;test&quot;</span>&gt;</span>请点击下面的按钮，通过 jQuery AJAX 改变这段文本。<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;btn1&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>获得外部的内容<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">  $(<span class="string">&quot;#btn1&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="function"><span class="javascript">  </span>&#123;</span></span><br><span class="line"><span class="javascript">    $(<span class="string">&#x27;#test&#x27;</span>).load(<span class="string">&#x27;/example/jquery/demo_test.txt&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  &#125;);</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>点击后显示：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565859858855.png" alt="1565859858855"></p>
<h2 id="5-6-Promise">5.6 <em>Promise</em></h2>
<h3 id="初识-Promise">初识 <em>Promise</em></h3>
<p>先不理会那些复杂的概念，我们来直观了解下 <em>Promise</em> 是什么：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565770221805.png" alt="1565770221805"></p>
<p>很容易得知，<em>Promise</em> 原来是一个构造函数：</p>
<ul>
<li>在自己身上有 <em>all()、reject()、resolve()</em> 等方法</li>
<li>在原型上有 <em>then()、catch()</em> 等方法，<em>then()</em> 返回一个 <em>Promise</em> 对象。</li>
</ul>
<p>那么 <em>new Promise()</em> 出来的对象自然也拥有以上方法。</p>
<h3 id="举个栗子">举个栗子</h3>
<h4 id="原生-JavaScript-执行异步">原生 <em>JavaScript</em> 执行异步</h4>
<p>在 <em>JavaScript</em> 世界里，所有代码都是单线程执行。因此 <em>JavaScript</em> 所有网络操作、浏览器事件都必须异步执行。</p>
<p>也就是说，在某个时间点，会执行某个函数。然后根据函数状态执行不同的处理函数，也就是常说的回调函数。</p>
<blockquote>
<p>如，生成一个0-2之间的随机数，如果小于1，则等待1s后返回成功，否则返回失败。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">str</span>)</span>&#123;  <span class="built_in">console</span>.log(str); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">str</span>)   </span>&#123;  <span class="built_in">console</span>.log(str); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeOut = <span class="built_in">Math</span>.random() * <span class="number">2</span>;</span><br><span class="line">    log(<span class="string">&#x27;set timeout to: &#x27;</span> + timeOut + <span class="string">&#x27; seconds.&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeOut &lt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            success(<span class="string">&#x27;成功：生成随机数小于1&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            fail(<span class="string">&#x27;失败：生成随机数大于1&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<ul>
<li>本文中所有异步操作均以 <em>setTimeout</em>为例子，而不使用 <em>ajax</em> 。</li>
</ul>
<p>可以看到，执行<em>test()</em> —&gt; 延迟1s后执行匿名判断函数 —&gt; 根据判断结果执行回调函数：<em>success()</em> 、<em>fail()</em> 。</p>
<h4 id="Promise-执行异步"><em>Promise</em>  执行异步</h4>
<p>如果我们用 <em>Promise</em> 对象来执行可以达到相同效果：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> timeOut = <span class="built_in">Math</span>.random() * <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (timeOut &lt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="string">&#x27;生成随机数小于1&#x27;</span>;</span><br><span class="line">            resolve(date);  <span class="comment">// 传递参数date给Promise对象.then方法内部匿名函数参数</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> date = <span class="string">&#x27;生成随机数大于1&#x27;</span>;</span><br><span class="line">            reject(date);  <span class="comment">// 传递参数date给Promise对象.catch方法内部匿名函数参数</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(test);</span><br><span class="line"><span class="keyword">var</span> p2 = p1.then</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); <span class="comment">// 如果执行成功输出：&#x27;成功：生成随机数小于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> p3 = p2.catch</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); <span class="comment">// 如果执行失败输出：&#x27;失败：生成随机数大于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>咋看之下首先方法 <em>function test(…)</em> 和之前没什么区别，只不过多了两个函数参数 <em>resolve, reject</em> ，替换了之前回调函数 <em>success、fail</em> 在接下来代码中位置，整体逻辑没有变化。</p>
<ul>
<li><em>resolve, reject</em> 可以分别将 <em>Promise</em> 状态置为：<em>fullfiled、 rejected</em></li>
<li><em>resolve, reject</em> 还可将自身的接收的参数（本例为<em>date</em>） ，分别传给<em>then、catch</em> 方法（见下）</li>
</ul>
<p>只不过在下面多了一层对 <em>test()</em> 的封装：创建一个 <em>Promise</em> 对象，传递一个函数作为参数，承诺一定执行。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(test);</span><br></pre></td></tr></table></figure>
<p>紧接着根据此时 <em>Promise</em> 状态是<em>fullfiled、 rejected</em>  执行 <em>then()</em> 还是 <em>catch()</em> 方法。</p>
<p>比如，随机数&lt;1 —&gt; 执行<em>resolve()</em> —&gt; <em>Promise</em> 状态为<em>fullfiled</em>  ----&gt; 执行 <em>then()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p2 = p1.then</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); <span class="comment">// 如果执行成功输出：&#x27;成功：生成随机数小于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><em>then(func)</em> 参数为一个函数，同时它也拿到了<em>resolve(date)</em>  的参数<em>date</em> ，赋值给了<em>result</em> （我是这么理解的的）。</p>
<p>所以如果执行会打印出：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565772961295.png" alt="1565772961295"></p>
<p>同理，随机数&gt;1 —&gt; 执行<em>reject()</em> —&gt; <em>Promise</em> 状态为 <em>rejected</em>   ----&gt; 执行 <em>catch()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p3 = p2.catch</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); <span class="comment">// 如果执行失败输出：&#x27;失败：生成随机数大于1&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><em>Promise</em> 对象可以串联起来，所以上述代码可以简化为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(test).then (<span class="function"><span class="keyword">function</span> (<span class="params">result</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&#x27;成功：&#x27;</span> + result); &#125;</span><br><span class="line">                 .catch(<span class="function"><span class="keyword">function</span> (<span class="params">reason</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&#x27;失败：&#x27;</span> + reason); &#125;</span><br></pre></td></tr></table></figure>
<h4 id="这就完了？">这就完了？</h4>
<p>看到这儿你可能不屑一顾，这么传的神乎其神的 <em>Promise</em> 就这点能耐？把原来好好的 <em>test()</em> 方法，整两个参数然后用 <em>Promise</em> 封装一下就没了？</p>
<p>当然，看到这你也可能发现了 <em>Promise</em> 其中一个优点：<em>执行代码和处理结果的代码清晰地分离</em> 。</p>
<p>比如上面：执行代码 <em>test()</em> 只负责整体逻辑传递数据，而处理代码接收数据进行处理由<em>then()</em> 、 <em>catch()</em> 完成。</p>
<p>更大优点，是用 <em>Promise</em> 处理多个异步操作，请看下节。</p>
<h3 id="更正确的使用Promise姿势：处理多异步">更正确的使用<em>Promise</em>姿势：处理多异步</h3>
<p>试想有多个异步任务函数，<em>job1、job2、job3</em>…：</p>
<blockquote>
<p>执行<em>job1</em>，<em>job1</em>执行成功 —&gt; 执行<em>job2</em>，<em>job2</em>执行成功 —&gt; 执行<em>job3</em>，<em>job3</em>执行成功 —&gt; …</p>
</blockquote>
<p>显然<em>job1</em>成了一个多层回调函数，<em>job2</em>执行完成后也有相应回调函数<em>job3</em>执行，<em>job3</em>有回调函数<em>job4</em>…</p>
<p>如果不使用 <em>Promise</em> 意味着我们要层层嵌套 <em>job1、job2、job3…</em>。这既不易读，也不灵活，而我们使用 <em>Promise</em> 后</p>
<p>可以将代码简写为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.then(job1).then(job2).then(job3).then...;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>分别实现异步函数<em>job1_add1、job2_mul2、job3_div3</em> 依次对数字0进行 *<em>+1、<em>2、/3</em></em>：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建一个Promise对象</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    resolve(<span class="number">0</span>); <span class="comment">// 传递数据：数字0</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// job1任务：将传过来的数字加1,这里传过来的数字是0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job1_add1</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">       为什么返回 Promise 对象？</span></span><br><span class="line"><span class="comment">       首先我们要知道，setTimeout共有四个参数，后面两个参数会传入回调函数（这里是resolve）</span></span><br><span class="line"><span class="comment">       我们知道，resolve参数可以被then方法拿到，这样在接下来的then方法可以获取到传递的参数:</span></span><br><span class="line"><span class="comment">            p.then(job1_add1).then(job2_mul2).then(job3_div3)</span></span><br><span class="line"><span class="comment">       你也可以直接传递数据而非Promise对象，后面then也可以接收到：</span></span><br><span class="line"><span class="comment">       return num+1;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; + 1&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">600</span>, num + <span class="number">1</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// job2任务：将传过来的数字×2，这里传过来的是0+1 = 1</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job2_mul2</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; * 2&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">500</span>, num * <span class="number">2</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// job2任务：将传过来的数字÷3，这里传过来的是 (0+1)*2 = 2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">job3_div3</span>(<span class="params">num</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;计算：&#x27;</span>+ num + <span class="string">&#x27; / 3&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(resolve, <span class="number">400</span>, num / <span class="number">3</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行多异步任务</span></span><br><span class="line">p.then(job1_add1).then(job2_mul2).then(job3_div3);</span><br></pre></td></tr></table></figure>
<p>执行结果：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565779644046.png" alt="1565779644046"></p>
<h3 id="更多有关-Promise">更多有关 <em>Promise</em></h3>
<p>除了前面提到 <em>then、catch</em> 方法，<em>Promise</em> 还提供了<u>静态</u> 方法 <em>all、race</em> 等。</p>
<h4 id="all-方法"><em>all()</em> 方法</h4>
<p><em>Promise</em> 的<em>all(PromiesArr)</em> 方法提供了并行执行异步操作的能力，并且在所有异步操作执行完后才执行回调。</p>
<p>由于可以在一个回调中处理所有返回数据，这样比如在打开网页，预先加载需要用到的所有资源如图片等，等全部加载完在执行回调。</p>
<p>依旧以上面异步函数<em>job1_add1、job2_mul2、job3_div3</em> 为例：</p>
<blockquote>
<p>异步执行三个异步函数，分别将各自传递的参数值进行：+1、*2、/3。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Promise.all([job1_add1(1),job2_mul2(2),job3_div3(3)])</span><br><span class="line">       .then(function(results)</span><br><span class="line">        &#123;</span><br><span class="line">           console.log(results);      </span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>三个异步操作都执行完毕后，<em>all(PromiesArr)</em> 会把它们返回的数据组成数组传给 <em>then()</em>，也就是上面<em>results</em>。</p>
</li>
<li>
<p>注意是传递 <em>Promise</em> 对象数组，而非函数，下面这种写法错误：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Promise</span>.all([job1_add1,job2_mul2,job3_div3])</span><br></pre></td></tr></table></figure>
<p>这是传递的参数是函数数组，而非<em>Promise</em>对象 数组。只有函数都执行后才是<em>Promise</em>对象数组（<em>job1_add1、job2_mul2、job3_div3</em> 返回<em>Promise</em>对象）。</p>
<p>所以，<em>all()</em> 不能实现前面三个异步操作结果交互依次进行：+1、*2、/3，因为传递的参数值被写死了，它们不存在嵌套关系，更何况论传值了。</p>
</li>
</ul>
<p>最后执行的结果为：</p>
<p><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565783438113.png" alt="1565783438113"></p>
<h4 id="race-方法"><em>race()</em> 方法</h4>
<p>有些时候，多个异步任务是为了容错。比如，同时向两个URL读取用户的个人信息，只需要获得先返回的结果即可。这种情况下，用<code>Promise.race()</code>实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">500</span>, <span class="string">&#x27;P1&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(resolve, <span class="number">600</span>, <span class="string">&#x27;P2&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.race([p1, p2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">// &#x27;P1&#x27;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="练习：将AJAX-异步执行函数转为-Promise-对象">练习：将<em>AJAX</em> 异步执行函数转为 <em>Promise</em> 对象</h3>
<p>在前我们举个<em>ajax</em>应用实例：根据用户输入字母，触发<em>showHint</em> 方法<em>ajax</em> 方式请求服务器返回推荐姓名。</p>
<p>其中 <em>ajax</em> 实现部分见下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax部分...</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span>(<span class="params">res</span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res); &#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span>(<span class="params">res</span>)    </span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="comment">// 创建对象</span></span><br><span class="line">   <span class="keyword">var</span> xmlhttp = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             success(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             fail(xmlhttp.status); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>现要求：将<em>ajax</em> 异步执行函数*showHint()*转换为 <em>Promise</em> 对象简化异步处理。</p>
</blockquote>
<p>最开始，我用<em>Promise</em> 对象直接封装 <em>showHint</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)  // 参数不对，应该为 <span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">resolve, reject</span>)</span></span></span><br><span class="line"><span class="function"><span class="function"></span>&#123;</span></span><br><span class="line"><span class="function">   // 创建对象</span></span><br><span class="line"><span class="function">   <span class="title">var</span> <span class="title">xmlhttp</span> = <span class="title">new</span> <span class="title">XMLHttpRequest</span>(<span class="params"></span>)</span>;</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">        &#123;</span><br><span class="line">             resolve(xmlhttp.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">             reject(xmlhttp.status); </span><br><span class="line">        &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(showHint);</span><br><span class="line">p.then (<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器成功响应结果：&quot;</span> + res);&#125;)</span><br><span class="line"> .catch(<span class="function"><span class="keyword">function</span>(<span class="params">res</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">&quot;拿到服务器失败响应结果：&quot;</span> + res);&#125;);</span><br></pre></td></tr></table></figure>
<p>但是这样有一个问题：<em>function showHint(str){…}</em> 参数不对，应该为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function showHint(resolve, reject)</span><br><span class="line">&#123;</span><br><span class="line">     ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>否则无法在后面使用 <em>resolve、reject</em> 函数！但是这样又无法使用函数自带 <em>str</em> 参数，所以解决办法为：把函数<em>showHint</em> 内部需要判断执行不同回调函数的部分，包装成 <em>Promise</em>对象返回：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">str</span>)  // 参数不对，应该为 <span class="function"><span class="keyword">function</span> <span class="title">showHint</span>(<span class="params">resolve, reject</span>)</span></span></span><br><span class="line"><span class="function"><span class="function"></span>&#123;</span></span><br><span class="line"><span class="function">   // 创建对象</span></span><br><span class="line"><span class="function">   <span class="title">var</span> <span class="title">xmlhttp</span> = <span class="title">new</span> <span class="title">XMLHttpRequest</span>(<span class="params"></span>)</span>;</span><br><span class="line">   <span class="comment">// 绑定onreadystatechange事件处理服务器响应</span></span><br><span class="line">   p = <span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        xmlhttp.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">             <span class="keyword">if</span> (xmlhttp.readyState==<span class="number">4</span> &amp;&amp; xmlhttp.status==<span class="number">200</span>)</span><br><span class="line">             &#123;</span><br><span class="line">                 resolve(xmlhttp.responseText);</span><br><span class="line">             &#125;</span><br><span class="line">             <span class="keyword">else</span></span><br><span class="line">             &#123;</span><br><span class="line">                 reject(xmlhttp.responseText); </span><br><span class="line">             &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">   <span class="comment">// 发送请求</span></span><br><span class="line">   xmlhttp.open(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/ajax/gethint.asp?q=&quot;</span>+str,<span class="literal">true</span>);</span><br><span class="line">   xmlhttp.send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就可以使用<em>resolve、reject</em> 函数了，然后再让返回的<em>Promise</em>对象执行 <em>then</em> 、<em>catch</em> ：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p.then (function(res)&#123; console.log(&quot;拿到服务器成功响应结果：&quot; + res);&#125;)</span><br><span class="line"> .catch(function(res)&#123; console.log(&quot;拿到服务器失败响应结果：&quot; + res);&#125;);</span><br></pre></td></tr></table></figure>
<h1>第六章：<em>jQuery</em></h1>
<h2 id="6-1-选择器">6.1 选择器</h2>
<p>在前 <u>5.2节</u> 介绍了：</p>
<ul>
<li>获取<em>DOM</em> 节点：<em>getElementby…()</em> 方法 <u>OR</u>  <em>CSS</em> 层级选择器</li>
<li>操作<em>DOM</em> 节点
<ul>
<li>通过 <em>innerText、innerHtml</em> 属性修改节点文本</li>
<li>通过 <em>style</em> 属性修改<em>CSS</em> 样式</li>
<li>通过 <em>appendChild()</em> 、<em>insertBefore()</em> 、*removeChild()*方法插入、删除节点</li>
</ul>
</li>
</ul>
<p><em>jQuery</em> 提供获取<em>DOM</em> 节点方法 本质是 <u><em>CSS</em> 层级选择器</u> 语法，不再赘述。但是还特别提供 <em>find()、filter()、map()</em> 方法进行查找和过滤，详见下。</p>
<h3 id="查找和过滤">查找和过滤</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="find-、next-、prev-、parent"><em>find()</em>、<em>next()</em>、<em>prev()</em>、<em>parent()</em></h4>
<p>在前面我们知道怎么获取一个节点，但是如果获取一个节点后，还想获取它的子、兄弟、父节点呢？</p>
<p><em>jQuery</em> 为我们提供了 <em>find()</em>、<em>next()</em>、<em>prev()</em> 方法来做到这一点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// find()</span></span><br><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#programLanguage&#x27;</span>).find(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.text();  <span class="comment">// 输出: C</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// parent()</span></span><br><span class="line"><span class="keyword">var</span> pl = C.parent(); </span><br><span class="line">pl;        <span class="comment">// 节点：ul#programLanguage</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// next()、prev()</span></span><br><span class="line">C.next();  <span class="comment">// 节点：li#python</span></span><br><span class="line"></span><br><span class="line">C.prev();  <span class="comment">// 节点：li#C#</span></span><br></pre></td></tr></table></figure>
<h4 id="first-、last"><em>first()、last()</em></h4>
<p>如果我们获取到一个节点数组，对节点数组的操作和普通数组操作有什么不同吗？</p>
<p>普通数组可以使用的API方法和<em>jQuery</em> 对象提供的API多有不同，不可混为一谈，以下是常用一些方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"></span><br><span class="line">lis.first();     <span class="comment">// 获取第一个节点，等价于：#programLanguage li:first-child</span></span><br><span class="line">lis.last();      <span class="comment">// 获取最后一个节点，等价于：#programLanguage li:last-child</span></span><br><span class="line">lis.slice(<span class="number">0</span>, <span class="number">2</span>); <span class="comment">// 输出：[C#,C], 数组的slice()方法一致</span></span><br></pre></td></tr></table></figure>
<p>更多方法以后用到再提。</p>
<h4 id="filter-、map"><em>filter()、map()</em></h4>
<p><em>filter()、map()</em> 和我们前介绍的高阶函数类似。</p>
<blockquote>
<p>通过 <em>filter()</em>  过滤出 ’C‘ 开头编程语言。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// filter()过滤符合条件的原对象数组元素</span></span><br><span class="line"><span class="comment">// 返回：数组 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> firstIsC = lis.filter</span><br><span class="line">(</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">      过滤条件；首字母为C</span></span><br><span class="line"><span class="comment">      注意：此时是DOM节点对象不是jQuery对象</span></span><br><span class="line"><span class="comment">      why? 直接箭头函数this绑定window</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="comment">// () =&gt; this.innerHTML.indexOf(&#x27;C&#x27;) === 0</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">      <span class="keyword">return</span>  <span class="built_in">this</span>.innerHTML.indexOf(<span class="string">&#x27;C&#x27;</span>) === <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出测试</span></span><br><span class="line">firstIsC ;    <span class="comment">// jQuery.fn.init(2) [li#C#, li#C, prevObject: jQuery.fn.init(4)]</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过 <em>map()</em>  遍历返回所有对象节点文本。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map()</span></span><br><span class="line"><span class="comment">// 遍历所有对象元素返回一个数组</span></span><br><span class="line"><span class="keyword">var</span> lis = $(<span class="string">&#x27;#programLanguage li&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> texts = lis.map</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.innerHTML;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出测试</span></span><br><span class="line">texts;  <span class="comment">//  [&quot;C#&quot;, &quot;C&quot;, &quot;python&quot;, &quot;java&quot;]</span></span><br></pre></td></tr></table></figure>
<h4 id="综合练习">综合练习</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;test-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;#0&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return false;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Email: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>Password: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Gender: </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;m&quot;</span> <span class="attr">checked</span>&gt;</span> Male<span class="tag">&lt;/<span class="name">label</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;gender&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;f&quot;</span>&gt;</span> Female<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span>City: </span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;BJ&quot;</span> <span class="attr">selected</span>&gt;</span>Beijing<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;SH&quot;</span>&gt;</span>Shanghai<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;CD&quot;</span>&gt;</span>Chengdu<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;XM&quot;</span>&gt;</span>Xiamen<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>输入值后，用 <em>jQuery</em> 获取表单的 <em>JSON</em> 字符串，如：<code>&#123;&quot;name&quot;:&quot;Michael&quot;,&quot;email&quot;:...&#125;</code>。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 限定状态:input 可获取：&lt;input&gt;，&lt;textarea&gt;，&lt;select&gt;和&lt;button&gt; 元素</span></span><br><span class="line">$(<span class="string">&#x27;#test-form :input&#x27;</span>).filter</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="comment">// 过滤节点数组中：未选中的radio单选框节点和submit按钮节点</span></span><br><span class="line">      <span class="comment">// this是DOM对象，获取节点属性type、checked等</span></span><br><span class="line">       <span class="keyword">var</span> isNotChecked  = <span class="built_in">this</span>.type === <span class="string">&#x27;radio&#x27;</span> &amp;&amp; !<span class="built_in">this</span>.checked;</span><br><span class="line">       <span class="keyword">if</span>( isNotChecked  || <span class="built_in">this</span>.type === <span class="string">&#x27;submit&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">).map</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">       <span class="comment">// select元素可直接获取name属性和选中的值</span></span><br><span class="line">       <span class="keyword">return</span> obj[<span class="built_in">this</span>.name] = <span class="built_in">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">json = <span class="built_in">JSON</span>.stringify(obj,<span class="literal">null</span>,<span class="string">&#x27;  &#x27;</span>);</span><br></pre></td></tr></table></figure>
<h2 id="6-2-jQuery-操作-DOM">6.2 <em>jQuery</em> 操作 <em>DOM</em></h2>
<h3 id="修改-Text-HTML">修改 <em>Text</em> &amp; <em>HTML</em></h3>
<p><em>jQuery</em> 对象提供了 <em>text()、html()</em> 方法来获取节点文本和HTML文本，例如以下HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;python&quot;</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;java&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>分别获取文本和HTML：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).html();    <span class="comment">// C</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).text();    <span class="comment">// C</span></span><br></pre></td></tr></table></figure>
<p>设置文本 &amp; HTML，只需给<em>text()、html()</em> 方法传递参数即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).text(<span class="string">&#x27;我是西语言&#x27;</span>);    <span class="comment">// 我是西语言</span></span><br></pre></td></tr></table></figure>
<p>特别巧妙的是，<em>jQuery</em> 可以给选中多个节点设置文本、CSS、属性等，具有 <u>批量操作</u> 特点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// docment对象不具有 批量操作 特点</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">&#x27;li&#x27;</span>).innerText = <span class="string">&#x27;test&#x27;</span>;   <span class="comment">// 设置不成功，节点内容未被改变</span></span><br><span class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">&#x27;li&#x27;</span>).innerText = <span class="string">&#x27;test&#x27;</span>;       <span class="comment">// 设置不成功，节点内容未被改变</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// jQuery对象具有 批量操作 特点</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).text(<span class="string">&#x27;test&#x27;</span>);        <span class="comment">// 设置成功，所有li节点文本被设置 &#x27;test&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="修改CSS">修改<em>CSS</em></h3>
<p>同前，也可用 CSS() 方法获取、修改CSS样式，也具有 <u>批量操作</u> 特点，关于该特点以下不再赘述。</p>
<p>获取CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>);        <span class="comment">// &quot;rgb(0, 0, 0)&quot;</span></span><br></pre></td></tr></table></figure>
<p>设置CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);  <span class="comment">// 文本全变为红色</span></span><br></pre></td></tr></table></figure>
<p>清除CSS样式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;&#x27;</span>);    <span class="comment">// 等价把该属性设置为空即可</span></span><br></pre></td></tr></table></figure>
<h3 id="显示和隐藏DOM">显示和隐藏DOM</h3>
<p>隐藏DOM节点，注意DOM树结构没有被改变：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).hide();   <span class="comment">// 对应CSS设置：display = none;</span></span><br></pre></td></tr></table></figure>
<p>显示DOM节点：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).show();   <span class="comment">// 对应CSS设置：display = inline; 或者 display = block;</span></span><br></pre></td></tr></table></figure>
<h3 id="修改DOM信息">修改DOM信息</h3>
<h4 id="节点宽高：width-、heigth">节点宽高：<em>width()、heigth()</em></h4>
<p>获取宽高：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).width();   <span class="comment">// 1860</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).heigth();  <span class="comment">// 21.5126</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 经过测试，多个标签显示的是其中一个标签宽高？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).width();   <span class="comment">// 1860</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).heigth();  <span class="comment">// 21.5126</span></span><br></pre></td></tr></table></figure>
<p>设置宽高：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).width(<span class="number">400</span>);   </span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).heigth(<span class="number">1800</span>);  </span><br></pre></td></tr></table></figure>
<h4 id="节点属性：attr-、removeAttr">节点属性：<em>attr() 、removeAttr()</em></h4>
<p>获取属性，不存在返回 <em>undefined</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;id&#x27;</span>);    <span class="comment">// C</span></span><br><span class="line">$(<span class="string">&#x27;li&#x27;</span>).attr(<span class="string">&#x27;id&#x27;</span>);    <span class="comment">// C#，多个节点返回第一个节点指定属性值</span></span><br><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;name&#x27;</span>);  <span class="comment">// undefined，不存在返回undefined</span></span><br></pre></td></tr></table></figure>
<p>设置属性，类似<em>CSS()</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).attr(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;iamC&#x27;</span>);  <span class="comment">//  &lt;li id=&quot;C&quot; name=&#x27;iamC&#x27;&gt;C&lt;/li&gt;</span></span><br></pre></td></tr></table></figure>
<p>删除属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#C&#x27;</span>).removeAttr(<span class="string">&#x27;name&#x27;</span>); </span><br></pre></td></tr></table></figure>
<blockquote>
<p>特别的，关于一些属性只有出现和没出现两种情况判断，如： <em>checked</em>、<em>selected</em> 。</p>
</blockquote>
<p>对于以下HTML结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;test-radio&quot;</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span> <span class="attr">checked</span>=<span class="string">&quot;checked&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果使用<em>attr()</em> 获取 <em>checked</em> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-radio&#x27;</span>).attr(<span class="string">&#x27;checked&#x27;</span>); <span class="comment">// &#x27;checked&#x27;</span></span><br></pre></td></tr></table></figure>
<p>虽然正确返回了属性值，但是 <em>checked</em> 属性只有[被选中]、[未被选中]两种情况，用 <em>true、false</em>返回更好：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-radio&#x27;</span>).is(<span class="string">&#x27;:checked&#x27;</span>); <span class="comment">// true,用is()方法判断更好</span></span><br></pre></td></tr></table></figure>
<p>⚠️ 不知道为什么有时候 <em>attr</em> 设置选中无效，建议使用 <em>prop</em> 方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test_checkbox&#x27;</span>).attr(<span class="string">&#x27;checked&#x27;</span>,<span class="string">&#x27;checked&#x27;</span>); <span class="comment">// 选中无效？</span></span><br><span class="line">$(<span class="string">&#x27;#test_checkbox&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>);      <span class="comment">// 可选中</span></span><br></pre></td></tr></table></figure>
<p><em>selected</em> 等同理不再赘述。</p>
<h3 id="修改DOM结构">修改DOM结构</h3>
<h4 id="添加节点">添加节点</h4>
<p>如果我们要在以下 <em>ul</em>  节点添加子节点 <code>&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><em>jQuery</em> 虽然提供了<em>html()</em> 方法，但是会修改 <em>ul</em> 节点所有节点。</p>
<p>为此我们可以利用以下方法：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>append(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>最后一个子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>prepend(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前父节点对象 <u>第一个子节点</u></td>
</tr>
</tbody>
</table>
<p>如果是同级节点对象，还可以用：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>after(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前节点对象 <u>下一个兄弟子节点</u></td>
</tr>
<tr>
<td style="text-align:center"><em>before(newElem)</em></td>
<td style="text-align:center">添加子节点<em>newElem</em> 为当前节点对象 <u>前一个兄弟子节点</u></td>
</tr>
</tbody>
</table>
<blockquote>
<p>将 <em>python</em> 新节点添加为<em>ul</em> 列表最后一个新节点。</p>
</blockquote>
<p>父节点对象方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pl = $(<span class="string">&#x27;#programLanguage&#x27;</span>);</span><br><span class="line">pl.append(<span class="string">&#x27;&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>同级节点对象方法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> last = $(<span class="string">&#x27;#programLanguage li:last-child&#x27;</span>);</span><br><span class="line">last.after(<span class="string">&#x27;&lt;li id=&quot;python&quot;&gt;python&lt;/li&gt;&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="删除节点">删除节点</h4>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>remove()</em></td>
<td style="text-align:center">删除当前节点对象，可作用于多个节点对象。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>删除所有列表项。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;li&#x27;</span>).remove();   <span class="comment">// 所有&lt;li&gt;被删除</span></span><br></pre></td></tr></table></figure>
<h4 id="综合测试">综合测试</h4>
<blockquote>
<p>对于以下<em>html</em> 结构：除了列出语言外，请再添加 <em>Pascal、Lua 、Ruby</em>，然后按字母顺序排序节点。</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;test-div&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Python<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>Swift<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> language = [<span class="string">&#x27;Pascal&#x27;</span>,<span class="string">&#x27;Lua&#x27;</span>,<span class="string">&#x27;Ruby&#x27;</span>];</span><br><span class="line"><span class="keyword">var</span> ul = $(<span class="string">&#x27;#test-div ul&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; language.length; i++ )</span><br><span class="line">&#123;</span><br><span class="line">    ul.append(<span class="string">&#x27;&lt;li&gt;&lt;span&gt;&#x27;</span> + language[i] + <span class="string">&#x27;&lt;/span&gt;&lt;/li&gt;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取所有li标签排序</span></span><br><span class="line"><span class="keyword">var</span> lis = ul.find(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">lis.sort</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">x,y</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 不是jQuery对象，而是DOM对象？不能用x.text() &gt; y.text()</span></span><br><span class="line">        <span class="keyword">if</span>(x.innerText &gt; y.innerText)  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>                           <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加已排序好的li标签</span></span><br><span class="line">ul.html(lis);</span><br></pre></td></tr></table></figure>
<h3 id="表单输入框值">表单输入框值</h3>
<p>对于表单元素，<em>jQuery</em> 统一用<em>val()</em> 方法获取 <em>DOM</em> 对象 <em>value</em> 属性，统一输入框取值和赋值问题：</p>
<table>
<thead>
<tr>
<th style="text-align:center">方法名</th>
<th style="text-align:center">用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>val()</em></td>
<td style="text-align:center">无参数获取文本框值；有参数设置文本框值。</td>
</tr>
</tbody>
</table>
<p>对于以下 <em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>尝试对以上不同 <em>input</em> 类型输入框值操作。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取输入框值</span></span><br><span class="line">$(<span class="string">&#x27;#test-input&#x27;</span>).val();      <span class="comment">// &#x27;test&#x27;</span></span><br><span class="line">$(<span class="string">&#x27;#test-select&#x27;</span>).val();     <span class="comment">// &#x27;BJ&#x27;</span></span><br><span class="line">$(<span class="string">&#x27;#test-textarea&#x27;</span>).val();   <span class="comment">// &#x27;Hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置输入框值</span></span><br><span class="line">$(<span class="string">&#x27;#test-input&#x27;</span>).val(<span class="string">&#x27;abc@example.com&#x27;</span>);   <span class="comment">// 文本框的内容已变为abc@example.com</span></span><br><span class="line">$(<span class="string">&#x27;#test-select&#x27;</span>).val(<span class="string">&#x27;SH&#x27;</span>);               <span class="comment">// 选择框已变为Shanghai</span></span><br><span class="line">$(<span class="string">&#x27;#test-textarea&#x27;</span>).val(<span class="string">&#x27;Hi&#x27;</span>);             <span class="comment">// 本区域已更新为&#x27;Hi&#x27;</span></span><br></pre></td></tr></table></figure>
<p>对应<em>docment</em> 对象 <em>value</em> 属性：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;#test-input&#x27;</span>).value = <span class="string">&#x27;abc@example.com&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="不要尝试用-attr-方法">不要尝试用 <em>attr()</em> 方法</h4>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p><em>attr()</em> 方法是用来获取、设置属性，用于文本框会导致意想不到的错误：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#user&#x27;</span>).attr(<span class="string">&#x27;value&#x27;</span>,<span class="string">&#x27;hwh&#x27;</span>);    <span class="comment">// 成功设置文本框值为:&#x27;hwh&#x27;</span></span><br></pre></td></tr></table></figure>
<p>但是当我们重新修改文本框值为：‘lt’，再去尝试获取文本框值：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#user&#x27;</span>).attr(<span class="string">&#x27;value&#x27;</span>);          <span class="comment">// &#x27;hwh&#x27;</span></span><br></pre></td></tr></table></figure>
<p>读取结果还是hwh！这是因为实际html结构已经是：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;hwh&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>每次读取都是value值， <u>修改文本框内容不会改变value属性</u> 。</p>
<h2 id="6-3-事件">6.3 事件</h2>
<p>类似C#事件，常用有鼠标事件、键盘事件、其他事件等。</p>
<h3 id="鼠标事件">鼠标事件</h3>
<p>常用鼠标事件，参数为函数用于处理事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>click(func)</em></td>
<td style="text-align:center">鼠标单击时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>dblclick(func)</em></td>
<td style="text-align:center">鼠标双击时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mouseenter(func)</em></td>
<td style="text-align:center">鼠标进入时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mouseleave(func)</em></td>
<td style="text-align:center">鼠标离开时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>mousemove(func)</em></td>
<td style="text-align:center">鼠标内部移动时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>hover(func)</em></td>
<td style="text-align:center">鼠标进入和退出时触发，相当于 <em>mouseenter()</em>+ <em>mouseleave()</em> 。</td>
</tr>
</tbody>
</table>
<p>存在以下html结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;programLanguage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C#&quot;</span>&gt;</span>C#<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">id</span>=<span class="string">&quot;C&quot;</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>绑定 <em>click</em> 事件，点击 <code>&lt;li#C&gt;</code> 时触发。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;hello C!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>有时候还会用到一种 <em>on()</em> 方法绑定事件：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>on(evet,func)</em></td>
<td style="text-align:center"><em>on()</em> 绑定事件，传入事件名称 &amp; 事件处理函数</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> C = $(<span class="string">&#x27;#C&#x27;</span>);</span><br><span class="line">C.on</span><br><span class="line">(<span class="string">&#x27;click&#x27;</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;hello C!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="事件参数">事件参数</h4>
<p>所有时间 都会传入<em>Event</em> 对象作为参数，可以获取更多信息。</p>
<blockquote>
<p>绑定 <em>mousemove</em> 事件，当鼠标在 <code>&lt;div#testMouseMoveDiv&gt;</code> 区域移动可以获取到鼠标位置。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#testMouseMoveDiv&#x27;</span>).mousemove</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $(<span class="string">&#x27;#testMouseMoveSpan&#x27;</span>).text(<span class="string">&#x27;pageX = &#x27;</span> + e.pageX + <span class="string">&#x27;, pageY = &#x27;</span> + e.pageY);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="键盘事件">键盘事件</h3>
<p>键盘事件仅作用在当前焦点的DOM上，通常是<code>&lt;input&gt;</code>和<code>&lt;textarea&gt;</code>：</p>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>keydown(func)</em></td>
<td style="text-align:center">键盘按下时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>keyup(func)</em></td>
<td style="text-align:center">键盘松开时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>keypress(func)</em></td>
<td style="text-align:center">按一次键后触发</td>
</tr>
</tbody>
</table>
<p>有以下<em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">label</span> <span class="attr">id</span>=<span class="string">&quot;check&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p>当用户在 <em>&lt;input#user&gt;</em> 输入完毕，右侧 <em>&lt;lable#check&gt;</em> 显示是否已存在用户名。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = $(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line">user.change</span><br><span class="line">(      </span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value === <span class="string">&#x27;hwh&#x27;</span>)</span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;用户存在！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;可以使用！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="其他事件">其他事件</h3>
<table>
<thead>
<tr>
<th style="text-align:center">事件方法</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><em>change(func)</em></td>
<td style="text-align:center">当<code>&lt;input&gt;</code>、<code>&lt;select&gt;</code>或<code>&lt;textarea&gt;</code>的内容改变时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>focus(func)</em></td>
<td style="text-align:center">当 <em>DOM</em> 获得焦点时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>blur(func)</em></td>
<td style="text-align:center">当 <em>DOM</em> 失去焦点时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>submit(func)</em></td>
<td style="text-align:center">当<code>&lt;form&gt;</code>提交时触发</td>
</tr>
<tr>
<td style="text-align:center"><em>ready(func)</em></td>
<td style="text-align:center">当页面被载入并且 <em>DOM</em> 树完成初始化后触发</td>
</tr>
</tbody>
</table>
<p>有以下<em>html</em> 结构：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;user&#x27;</span>&gt;</span> <span class="tag">&lt;/<span class="name">p</span>&gt;</span> <span class="tag">&lt;<span class="name">label</span> <span class="attr">id</span>=<span class="string">&quot;check&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&#x27;pwd&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<blockquote>
<p><em>change(func)</em> 事件：当用户在 <em>&lt;input#user&gt;</em> 输入完毕，右侧 <em>&lt;lable#check&gt;</em> 显示是否已存在用户名。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = $(<span class="string">&#x27;#user&#x27;</span>);</span><br><span class="line">user.change</span><br><span class="line">(      </span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">this</span>.value === <span class="string">&#x27;hwh&#x27;</span>)</span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;用户存在！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;red&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            $(<span class="string">&#x27;#check&#x27;</span>).text(<span class="string">&#x27;可以使用！&#x27;</span>).css(<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;blue&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><em>change</em> 事件当输入框失去焦点才会触发（移到别处了不再输入了）</p>
</li>
<li>
<p>最好把函数直接写在<em>change</em> 里面，否则不知道为什么触发不了？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.change(changeUserName());  <span class="comment">// 封装好的函数写入不成？</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p><em>ready</em> 事件作用于<em>docment</em>对象，当<em>DOM</em>节点都载入浏览器触发：试分析以下错误？</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">        // 代码有误:</span><br><span class="line">        $(&#x27;#testForm).on(&#x27;submit&#x27;, function () </span><br><span class="line">        &#123;</span><br><span class="line">            alert(&#x27;submit!&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;testForm&quot;</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<script> 标签内js代码在<body>前，DOM 节点还没加载完毕就操作 <form> 节点所以出错。我们可以：


- 把<script> 标签在<body>后

- 或者，<u>用 *docment* 对象 *read* 事件函数</u> 保证DOM节点都加载完毕 <u>再绑定*submit*事件</u>

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     $(<span class="string">&#x27;#testForm).on(&#x27;</span>submit<span class="string">&#x27;, function () </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            alert(&#x27;</span>submit!<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

  也可以像前一般简化不用on方法：

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> $(<span class="built_in">document</span>).on(<span class="string">&#x27;ready&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     $(<span class="string">&#x27;#testForm).submit(function () </span></span><br><span class="line"><span class="string">        &#123;</span></span><br><span class="line"><span class="string">            alert(&#x27;</span>submit!<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">        &#125;);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure>

  甚至*read* 事件还可以再简化： *$(document).on('ready', function ()...*   ---> *$(function ()..* 

  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&#x27;init A...&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



### 事件触发条件

事件的触发总是由用户操作引发的，但是，比如用JavaScript代码去改动文本框的值，不会触发`change`事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> input = $(<span class="string">&#x27;#test-input&#x27;</span>);</span><br><span class="line">input.val(<span class="string">&#x27;change it!&#x27;</span>); <span class="comment">// 无法触发change事件</span></span><br></pre></td></tr></table></figure>

我们可以通过直接调用无参数 *change()* 方法手动触发事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> input = $(<span class="string">&#x27;#test-input&#x27;</span>);</span><br><span class="line">input.val(<span class="string">&#x27;change it!&#x27;</span>);</span><br><span class="line">input.change(); <span class="comment">// 触发change事件</span></span><br></pre></td></tr></table></figure>

#### 浏览器安全限制

在浏览器中，有些 *JavaScript* 代码只有在用户触发下才能执行。例如，`window.open()`函数：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 无法弹出新窗口，将被浏览器屏蔽:</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">window</span>.open(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

这些“敏感代码”只能由用户操作来触发。



### 综合测试

有以下 *Form* 表单：

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;test-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;test&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span>请选择想要学习的编程语言：<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;selectAll&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;selectAll&quot;</span>&gt;</span>全选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;deselectAll&quot;</span>&gt;</span>全不选<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;python&quot;</span>&gt;</span> Python<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ruby&quot;</span>&gt;</span> Ruby<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;haskell&quot;</span>&gt;</span> Haskell<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;lang&quot;</span> <span class="attr">value</span>=<span class="string">&quot;scheme&quot;</span>&gt;</span> Scheme<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

> 要求完成：
>
> - 当用户勾上“全选”时，自动选中所有语言，并把“全选”变成“全不选”
> - 当用户去掉“全不选”时，自动不选中所有语言，并把“全不选”变成“全选”

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line">    form = $(<span class="string">&#x27;#test-form&#x27;</span>),</span><br><span class="line">    langs = form.find(<span class="string">&#x27;[name=lang]&#x27;</span>),</span><br><span class="line">    selectAll = form.find(<span class="string">&#x27;label.selectAll :checkbox&#x27;</span>),</span><br><span class="line">    selectAllLabel = form.find(<span class="string">&#x27;label.selectAll span.selectAll&#x27;</span>),</span><br><span class="line">    deselectAllLabel = form.find(<span class="string">&#x27;label.selectAll span.deselectAll&#x27;</span>),</span><br><span class="line">    invertSelect = form.find(<span class="string">&#x27;a.invertSelect&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重置初始化状态:</span></span><br><span class="line">form.find(<span class="string">&#x27;*&#x27;</span>).show().off();</span><br><span class="line">form.find(<span class="string">&#x27;:checkbox&#x27;</span>).prop(<span class="string">&#x27;checked&#x27;</span>, <span class="literal">false</span>).off();</span><br><span class="line">deselectAllLabel.hide();</span><br><span class="line"><span class="comment">// 拦截form提交事件:</span></span><br><span class="line">form.off().submit(<span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    alert(form.serialize());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

接上，绑定事件：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isAllSelected = <span class="literal">false</span>;</span><br><span class="line">selectAll.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!isAllSelected )</span><br><span class="line">        &#123;</span><br><span class="line">            langs.each</span><br><span class="line">            (</span><br><span class="line">                <span class="comment">/* </span></span><br><span class="line"><span class="comment">                不能用lambada表达式，应该下面this都未绑定正确？</span></span><br><span class="line"><span class="comment">                经过测试在function()&#123;...&#125; this绑定正确。</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="comment">// () =&gt; this.checked = &#x27;checked&#x27;     </span></span><br><span class="line">                <span class="comment">// () =&gt; $(this).prop(&#x27;checked&#x27;,true)</span></span><br><span class="line">   </span><br><span class="line">                <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">                </span>&#123;     </span><br><span class="line">                    <span class="comment">/* attr无法成功设置属性 ：不起作用？ */</span></span><br><span class="line">                    <span class="comment">// $(this).attr(&#x27;checked&#x27;,&#x27;checked&#x27;) ;  </span></span><br><span class="line"></span><br><span class="line">                    $(<span class="built_in">this</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>);        <span class="comment">// 测试成功</span></span><br><span class="line">                &#125;            </span><br><span class="line">           )</span><br><span class="line">           deselectAllLabel.show();</span><br><span class="line">           selectAllLabel.hide();</span><br><span class="line">           selectAll.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);</span><br><span class="line">           isAllSelected = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            langs.each</span><br><span class="line">            (</span><br><span class="line">                <span class="comment">/* </span></span><br><span class="line"><span class="comment">                不能用lambada表达式，应该下面this都未绑定正确？</span></span><br><span class="line"><span class="comment">                经过测试在function()&#123;...&#125; this绑定正确。</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="comment">// () =&gt; this.checked = &#x27;checked&#x27;     </span></span><br><span class="line">                <span class="comment">// () =&gt; $(this).prop(&#x27;checked&#x27;,true)</span></span><br><span class="line">   </span><br><span class="line">                <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">                </span>&#123;     </span><br><span class="line">                    <span class="comment">/* attr无法成功设置属性 ：不起作用？ */</span></span><br><span class="line">                    <span class="comment">// $(this).attr(&#x27;checked&#x27;,&#x27;checked&#x27;) ;  </span></span><br><span class="line"></span><br><span class="line">                    $(<span class="built_in">this</span>).prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);        <span class="comment">// 测试成功</span></span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">            deselectAllLabel.hide();</span><br><span class="line">            selectAllLabel.show();</span><br><span class="line">            isAllSelected = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

可以利用*jQuery* 批量操作特点，不用*each()*遍历:

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> isAllSelected = <span class="literal">false</span>; <span class="comment">// 判断此时单选框是：全部勾选 OR 全不勾选</span></span><br><span class="line">selectAll.click</span><br><span class="line">(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!isAllSelected )  </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 全部勾选</span></span><br><span class="line">            langs.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">true</span>); </span><br><span class="line">            <span class="comment">// 全选隐藏、全不选显示</span></span><br><span class="line">            deselectAllLabel.show();</span><br><span class="line">            selectAllLabel.hide();</span><br><span class="line">            selectAll.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>);</span><br><span class="line">            isAllSelected = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 全部取消勾选</span></span><br><span class="line">            langs.prop(<span class="string">&#x27;checked&#x27;</span>,<span class="literal">false</span>); </span><br><span class="line">            <span class="comment">// 全选显示，全不选隐藏</span></span><br><span class="line">            deselectAllLabel.hide();</span><br><span class="line">            selectAllLabel.show();</span><br><span class="line">            isAllSelected = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

## 6.4 动画

用 *JavaScript* 实现动画，比如实现淡出效果，让选中元素在1s内改变 *CSS*  *opacity（透明度）*  属性值至0。

本质都是通过修改CSS属性，*jQuery* 封装了函数让这一切变得更加简单。

### 逐渐显隐

无参数的 *show()、hide()* 方法直接显示、隐藏元素；有参数指定时间可以实现动画效果。

|            方法            |                             描述                             |
| :------------------------: | :----------------------------------------------------------: |
|  *show(timeSeconds,func)*  | 在指定 *timeSeconds* 显示全部，*func* 指定显示完成后指定的方法 |
|  *hide(timeSeconds,func)*  | 在指定 *timeSeconds* 隐藏全部，*func* 指定显示完成后指定的方法 |
| *toggle(timeSeconds,func)* |         根据当前状态，自动调用 *show()、hide()* 方法         |

- *timeSeconds* 以毫秒为单位，同时可以用 *‘slow’、‘fast’* 等特殊字符串作为参数值。

- 显示过程是从左上角 ---> 展开铺满整个平面 ；隐藏则是从右下角 --> 隐藏整个平面。

> :slightly_smiling_face: 简单实例 

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = $(<span class="string">&#x27;#test-show-hide&#x27;</span>);</span><br><span class="line"><span class="comment">// 在1秒钟内逐渐消失</span></span><br><span class="line">div.hide(<span class="number">1000</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 在0.6秒钟内逐渐显示</span></span><br><span class="line">div.show(<span class="string">&#x27;slow&#x27;</span>); </span><br></pre></td></tr></table></figure>

就像此前说过，上面显示是从左上展开，下面方法可以从垂直方法逐渐展开、收缩 ~ just like 拉窗帘。

|              方法               |       描述       |
| :-----------------------------: | :--------------: |
|   *slideUp(timeSeconds,func)*   |   拉窗帘般显示   |
|  *slideDown(timeSeconds,func)*  | 拉窗帘般收起隐藏 |
| *slideToggle(timeSeconds,func)* | 自动调用上面方法 |

### 淡入淡出

*fadeIn()  、fadeOut()* 可通过不断设置 *DOM* *CSS* *opacity* 属性来实现淡入淡出动画效果。

|              方法              |       描述       |
| :----------------------------: | :--------------: |
|   *fadeIn(timeSeconds,func)*   |     淡入显示     |
|  *fadeOut(timeSeconds,func)*   |     淡出隐藏     |
| *fadeToggle(timeSeconds,func)* | 自动调用上面方法 |

存在以下表格：

![1565600702619](https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/1565600702619.png)

> 试完成以下代码，使得每次删除表中第一项可以淡出显示。

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteFirstTR</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tr = $(<span class="string">&#x27;#test-table&gt;tbody&gt;tr:visible&#x27;</span>).first();</span><br><span class="line">    <span class="comment">// 在以下完成事件绑定...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">deleteFirstTR();</span><br></pre></td></tr></table></figure>

完成的代码如下：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tr.fadeOut(<span class="number">1000</span>,<span class="function">() =&gt;</span> tr.remove());</span><br></pre></td></tr></table></figure>

### 自定义动画

对上面提供的动画效果不满意？尝试自定义动画吧。

|                 方法                  |                             描述                             |
| :-----------------------------------: | :----------------------------------------------------------: |
| *animate(cssStyle，timeSeconds,func)* | 在指定*timeSeconds*  达到预设*cssStyle* 值，最后执行 *func* 函数 |

现在我们来试试自定义实现上面淡出删除表格效果吧。

> 淡出删除表格。

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteFirstTR</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tr = $(<span class="string">&#x27;#test-table&gt;tbody&gt;tr:visible&#x27;</span>).first();</span><br><span class="line">    <span class="comment">// 在以下完成事件绑定...</span></span><br><span class="line">    tr.animate(&#123; <span class="attr">opacity</span>:<span class="number">0</span> &#125;, <span class="number">1000</span>, <span class="function">() =&gt;</span> tr.remove())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">deleteFirstTR();</span><br></pre></td></tr></table></figure>

### 串行动画

如果有两个动画效果：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> div = $(<span class="string">&#x27;#test-animates&#x27;</span>);</span><br><span class="line"><span class="comment">// 放大</span></span><br><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br><span class="line"><span class="comment">// 缩小</span></span><br><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

希望实现放大 --> 缩小 连续动画效果，如果这样简单的连续执行两个动画：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>).animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

是无法实现的，因为：*动画需要执行一段时间，所以jQuery必须不断返回新的Promise对象才能后续执行操作* 。

所以我们需要借助 *delay()* 方法实现暂停，给予时间返回新的 *Promise* 对象执行后续操作：

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">div.animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;256px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;256px&#x27;</span>&#125;, <span class="number">2000</span>)</span><br><span class="line">   .delay(<span class="number">1000</span>)</span><br><span class="line">   .animate( &#123; <span class="attr">width</span>: <span class="string">&#x27;128px&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;128px&#x27;</span>&#125;, <span class="number">2000</span>);</span><br></pre></td></tr></table></figure>

### 动画没有效果？

*jQuery* 动画的原理是逐渐改变 *CSS* 值，而有些情况是无法改变成功的。例如：

- *slideUp()* 逐渐把*CSS*属性*height* --> 0，但是非*block* 属性值*DOM* 元素对它们设置 *height* 是不起作用的。
- *animate()* 设置 *background-color* 没有效果，因为 *jQuery* 没有实现。</div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://blog-imgs-1256686095.cos.ap-guangzhou.myqcloud.com/cat.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Wanghui Huang</div><div class="author-info__description">tech & life</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">36</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wanghui-Huang"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wanghui-Huang" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:hwh199601@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">royhuang's studio</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/43924/" title="C++从零开始（三）：面对对象（中）运算符重载">C++从零开始（三）：面对对象（中）运算符重载</a><time datetime="2022-01-27T06:47:34.826Z" title="发表于 2022-01-27 14:47:34">2022-01-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/17506/" title="C++从零开始（三）：面对对象（上）快速入门">C++从零开始（三）：面对对象（上）快速入门</a><time datetime="2022-01-24T07:37:07.955Z" title="发表于 2022-01-24 15:37:07">2022-01-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/6587/" title="C++从零开始（二）：务实基础（下）复合类型及转换">C++从零开始（二）：务实基础（下）复合类型及转换</a><time datetime="2022-01-16T13:04:18.006Z" title="发表于 2022-01-16 21:04:18">2022-01-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/p/26224/" title="C++从零开始（二）：务实基础（上）快速入门">C++从零开始（二）：务实基础（上）快速入门</a><time datetime="2022-01-16T12:56:08.897Z" title="发表于 2022-01-16 20:56:08">2022-01-16</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/C/"><span class="card-category-list-name">C++</span><span class="card-category-list-count">9</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/"><span class="card-category-list-name">从零开始</span><span class="card-category-list-count">9</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">C++基础</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E8%BF%9B%E9%98%B6/"><span class="card-category-list-name">C++进阶</span><span class="card-category-list-count">1</span></a></li></ul></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Git/"><span class="card-category-list-name">Git</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%BB%BA%E7%AB%99/"><span class="card-category-list-name">建站</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/"><span class="card-category-list-name">校招笔记</span><span class="card-category-list-count">15</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/JAVA/"><span class="card-category-list-name">JAVA</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"><span class="card-category-list-name">计算机基础</span><span class="card-category-list-count">8</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/C/" style="font-size: 1.45em; color: rgb(68, 0, 50)">C++</a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 1.45em; color: rgb(184, 128, 184)">教程</a><a href="/tags/C-%E5%9F%BA%E7%A1%80/" style="font-size: 1.35em; color: rgb(124, 71, 16)">C++基础</a><a href="/tags/%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91/" style="font-size: 1.15em; color: rgb(49, 67, 20)">远程开发</a><a href="/tags/C-%E8%BF%9B%E9%98%B6/" style="font-size: 1.15em; color: rgb(21, 115, 57)">C++进阶</a><a href="/tags/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/" style="font-size: 1.25em; color: rgb(113, 66, 192)">快速入门</a><a href="/tags/%E9%9D%A2%E5%AF%B9%E5%AF%B9%E8%B1%A1/" style="font-size: 1.15em; color: rgb(6, 97, 119)">面对对象</a><a href="/tags/CMake/" style="font-size: 1.15em; color: rgb(64, 193, 67)">CMake</a><a href="/tags/Makefile/" style="font-size: 1.15em; color: rgb(135, 65, 86)">Makefile</a><a href="/tags/g/" style="font-size: 1.15em; color: rgb(32, 32, 0)">g++</a><a href="/tags/%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD/" style="font-size: 1.15em; color: rgb(36, 77, 132)">运算符重载</a><a href="/tags/%E7%BB%93%E6%9E%84%E4%BD%93/" style="font-size: 1.15em; color: rgb(6, 32, 197)">结构体</a><a href="/tags/%E6%9E%9A%E4%B8%BE/" style="font-size: 1.15em; color: rgb(92, 63, 58)">枚举</a><a href="/tags/%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2/" style="font-size: 1.15em; color: rgb(68, 166, 149)">类型转换</a><a href="/tags/%E6%8C%87%E9%92%88/" style="font-size: 1.15em; color: rgb(156, 124, 61)">指针</a><a href="/tags/%E5%87%BD%E6%95%B0/" style="font-size: 1.15em; color: rgb(23, 178, 110)">函数</a><a href="/tags/%E7%BD%91%E7%AB%99%E5%BB%BA%E8%AE%BE/" style="font-size: 1.15em; color: rgb(148, 107, 72)">网站建设</a><a href="/tags/hexo/" style="font-size: 1.15em; color: rgb(41, 44, 141)">hexo</a><a href="/tags/github-pages/" style="font-size: 1.15em; color: rgb(118, 115, 69)">github pages</a><a href="/tags/Git/" style="font-size: 1.25em; color: rgb(62, 77, 110)">Git</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">17</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2021-11-23T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">272.7k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-02-06T11:43:56.870Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Wanghui Huang</div><div class="footer_custom_text">Support By <a target="_blank" rel="noopener" href="https://cloud.tencent.com/" style="text-decoration:underline; color:#476679;"> Tencent Cloud </a> |  <a target="_blank" rel="noopener" href="https://hexo.io/" style="text-decoration:underline; color:#476679;">Hexo</a> | <a target="_blank" rel="noopener" href="https://butterfly.js.org/" style="text-decoration:underline; color:#476679;">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{
  const $countDom = document.getElementById('twikoo-count')
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai'
    }, null))
  }

  const getCount = () => {
    twikoo.getCommentsCount({
      envId: 'blog-comments-5g2cfsved8c0de34',
      region: 'ap-shanghai',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      $countDom.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const loadTwikoo = (bool = false) => {
    if (typeof twikoo === 'object') {
      init()
      bool && $countDom && setTimeout(getCount,0)
    } else {
      getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(()=> {
        init()
        bool && $countDom && setTimeout(getCount,0)
      })
    }
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo(true)
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script src="https://cdn.jsdelivr.net/npm/hexo-widget-tree@0.2.2/js/index.js"></script><div id="widget-tree">
      <h1 id="tree-toc-title" style="text-align:center;margin:0;line-hight:1.5"> <a href="https://hwh.zone/categories/">目 录 </a> </h1>
      <h5 id="tree-toc-subtitle" style="text-align:center;margin:0;line-hight:1.5"> <a href="https://hwh.zone/">royhuang's blog</a> </h5>
      <ul>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/">
          C++
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/">
          从零开始
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E5%9F%BA%E7%A1%80/">
          C++基础
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/18652/" title="C++从零开始（一）：环境搭建（上）VSCode远程开发"><i class="post-icon gg-file-document"></i>C++从零开始（一）：环境搭建（上）VSCode远程开发</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/2834/" title="C++从零开始（一）：环境搭建（下）g++/Makefile/CMake快速入门"><i class="post-icon gg-file-document"></i>C++从零开始（一）：环境搭建（下）g++/Makefile/CMake快速入门</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/43924/" title="C++从零开始（三）：面对对象（中）运算符重载"><i class="post-icon gg-file-document"></i>C++从零开始（三）：面对对象（中）运算符重载</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/26224/" title="C++从零开始（二）：务实基础（上）快速入门"><i class="post-icon gg-file-document"></i>C++从零开始（二）：务实基础（上）快速入门</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/6587/" title="C++从零开始（二）：务实基础（下）复合类型及转换"><i class="post-icon gg-file-document"></i>C++从零开始（二）：务实基础（下）复合类型及转换</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/24237/" title="C++从零开始（二）：务实基础（中）指针和引用"><i class="post-icon gg-file-document"></i>C++从零开始（二）：务实基础（中）指针和引用</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/51595/" title="C++从零开始（二）：务实基础（下）函数"><i class="post-icon gg-file-document"></i>C++从零开始（二）：务实基础（下）函数</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/C/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B/C-%E8%BF%9B%E9%98%B6/">
          C++进阶
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/17506/" title="C++从零开始（三）：面对对象（上）快速入门"><i class="post-icon gg-file-document"></i>C++从零开始（三）：面对对象（上）快速入门</a></li></ul></li></ul></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E5%BB%BA%E7%AB%99/">
          建站
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/56326/" title="Hexo+Github Pages快速打造属于自己的网站"><i class="post-icon gg-file-document"></i>Hexo+Github Pages快速打造属于自己的网站</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/Git/">
          Git
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/43848/" title="Git基础笔记（初步整理）"><i class="post-icon gg-file-document"></i>Git基础笔记（初步整理）</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/">
          校招笔记
        </a>
      <ul class="tree-list-children">
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/JAVA/">
          JAVA
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/42516/" title="校招笔记（一）_Java_JVM"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_JVM</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/51787/" title="校招笔记（一）_Java_Java入门"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_Java入门</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/45493/" title="校招笔记（一）_Java_锁"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_锁</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/7257/" title="校招笔记（一）_Java_面对对象"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_面对对象</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/8959/" title="校招笔记（一）_Java_多线程"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_多线程</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/21069/" title="校招笔记（一）_Java_集合"><i class="post-icon gg-file-document"></i>校招笔记（一）_Java_集合</a></li></ul></li>
      <li class="tree-list-item">
        <i class="toggle-post-icon gg-folder-add"></i>
        <a class="tree-list-link" href="/categories/%E6%A0%A1%E6%8B%9B%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">
          计算机基础
        </a>
      <ul class="tree-list-children"><li class="tree-list-item"><a class="tree-list-post-link" href="/p/61434/" title="校招笔记（七）_计算机基础_数据结构"><i class="post-icon gg-file-document"></i>校招笔记（七）_计算机基础_数据结构</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/5582/" title="校招笔记（九）_计算机基础_相关补充"><i class="post-icon gg-file-document"></i>校招笔记（九）_计算机基础_相关补充</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/46361/" title="校招笔记（三）_计算机基础_计算机网络"><i class="post-icon gg-file-document"></i>校招笔记（三）_计算机基础_计算机网络</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/44980/" title="校招笔记（二）_计算机基础_Linux&Git"><i class="post-icon gg-file-document"></i>校招笔记（二）_计算机基础_Linux&Git</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/56848/" title="校招笔记（五）_计算机基础_MySQL"><i class="post-icon gg-file-document"></i>校招笔记（五）_计算机基础_MySQL</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/31667/" title="校招笔记（八）_计算机基础_场景&智力题"><i class="post-icon gg-file-document"></i>校招笔记（八）_计算机基础_场景&智力题</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/31215/" title="校招笔记（六）_计算机基础_Redis"><i class="post-icon gg-file-document"></i>校招笔记（六）_计算机基础_Redis</a></li><li class="tree-list-item"><a class="tree-list-post-link" href="/p/15646/" title="校招笔记（四）_计算机基础_操作系统"><i class="post-icon gg-file-document"></i>校招笔记（四）_计算机基础_操作系统</a></li></ul></li></ul></li></ul>
        <div id="widget-tree-button">
          <i class="gg-chevron-right"></i>
        </div>
      </div><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>